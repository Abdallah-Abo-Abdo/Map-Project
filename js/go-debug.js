(function () {
  var t;
  function ba(a) {
    var b = 0;
    return function () {
      return b < a.length ? { done: !1, value: a[b++] } : { done: !0 };
    };
  }
  function ca(a) {
    var b =
      "undefined" != typeof Symbol && Symbol.iterator && a[Symbol.iterator];
    return b ? b.call(a) : { next: ba(a) };
  }
  function da(a) {
    for (var b, c = []; !(b = a.next()).done; ) c.push(b.value);
    return c;
  }
  var ea =
      "function" == typeof Object.create
        ? Object.create
        : function (a) {
            function b() {}
            b.prototype = a;
            return new b();
          },
    fa;
  if ("function" == typeof Object.setPrototypeOf) fa = Object.setPrototypeOf;
  else {
    var ha;
    a: {
      var ja = { a: !0 },
        ka = {};
      try {
        ka.__proto__ = ja;
        ha = ka.a;
        break a;
      } catch (a) {}
      ha = !1;
    }
    fa = ha
      ? function (a, b) {
          a.__proto__ = b;
          if (a.__proto__ !== b) throw new TypeError(a + " is not extensible");
          return a;
        }
      : null;
  }
  var la = fa;
  function na(a, b) {
    a.prototype = ea(b.prototype);
    a.prototype.constructor = a;
    if (la) la(a, b);
    else
      for (var c in b)
        if ("prototype" != c)
          if (Object.defineProperties) {
            var d = Object.getOwnPropertyDescriptor(b, c);
            d && Object.defineProperty(a, c, d);
          } else a[c] = b[c];
    a.wB = b.prototype;
  }
  var oa = "undefined" != typeof global && null != global ? global : self,
    pa =
      "function" == typeof Object.assign
        ? Object.assign
        : function (a, b) {
            for (var c = 1; c < arguments.length; c++) {
              var d = arguments[c];
              if (d)
                for (var e in d)
                  Object.prototype.hasOwnProperty.call(d, e) && (a[e] = d[e]);
            }
            return a;
          },
    qa =
      "function" == typeof Object.defineProperties
        ? Object.defineProperty
        : function (a, b, c) {
            a != Array.prototype && a != Object.prototype && (a[b] = c.value);
          };
  function ra(a, b) {
    if (b) {
      var c = oa;
      a = a.split(".");
      for (var d = 0; d < a.length - 1; d++) {
        var e = a[d];
        e in c || (c[e] = {});
        c = c[e];
      }
      a = a[a.length - 1];
      d = c[a];
      b = b(d);
      b != d &&
        null != b &&
        qa(c, a, { configurable: !0, writable: !0, value: b });
    }
  }
  ra("Object.assign", function (a) {
    return a || pa;
  });
  ra("String.prototype.startsWith", function (a) {
    return a
      ? a
      : function (a, c) {
          if (null == this)
            throw new TypeError(
              "The 'this' value for String.prototype.startsWith must not be null or undefined"
            );
          if (a instanceof RegExp)
            throw new TypeError(
              "First argument to String.prototype.startsWith must not be a regular expression"
            );
          var b = this.length,
            e = a.length;
          c = Math.max(0, Math.min(c | 0, this.length));
          for (var f = 0; f < e && c < b; ) if (this[c++] != a[f++]) return !1;
          return f >= e;
        };
  });
  ra("Array.prototype.fill", function (a) {
    return a
      ? a
      : function (a, c, d) {
          var b = this.length || 0;
          0 > c && (c = Math.max(0, b + c));
          if (null == d || d > b) d = b;
          d = Number(d);
          0 > d && (d = Math.max(0, b + d));
          for (c = Number(c || 0); c < d; c++) this[c] = a;
          return this;
        };
  });
  var sa =
    ("object" === typeof globalThis && globalThis) ||
    ("object" === typeof global && global.global === global && global) ||
    ("object" === typeof self && self.self === self && self) ||
    {};
  void 0 === sa.requestAnimationFrame &&
    (void 0 === sa.setImmediate
      ? (sa.requestAnimationFrame = function (a) {
          sa.setTimeout(a, 0);
        })
      : (sa.requestAnimationFrame = sa.setImmediate));
  function ta() {}
  function ua(a, b) {
    var c = -1;
    return function () {
      var d = this,
        e = arguments;
      -1 !== c && sa.clearTimeout(c);
      c = va(function () {
        c = -1;
        a.apply(d, e);
      }, b);
    };
  }
  function va(a, b) {
    return sa.setTimeout(a, b);
  }
  function wa(a) {
    return sa.document.createElement(a);
  }
  function v(a) {
    throw Error(a);
  }
  function xa(a, b) {
    a =
      "The object is frozen, so its properties cannot be set: " + a.toString();
    void 0 !== b && (a += "  to value: " + b);
    v(a);
  }
  function x(a, b, c, d) {
    a instanceof b ||
      ((c = ya(c)), void 0 !== d && (c += "." + d), za(a, b, c));
  }
  function A(a, b, c, d) {
    typeof a !== b &&
      ((c = ya(c)), void 0 !== d && (c += "." + d), za(a, b, c));
  }
  function D(a, b, c) {
    ("number" === typeof a && isFinite(a)) ||
      ((b = ya(b)),
      void 0 !== c && (b += "." + c),
      v(b + " must be a real number type, and not NaN or Infinity: " + a));
  }
  function za(a, b, c, d) {
    b = " value is not an instance of " + ya(b) + ": ";
    c = ya(c);
    void 0 !== d && (c += "." + d);
    "string" === typeof a && (a = '"' + a + '"');
    v(c + b + a);
  }
  function Aa(a, b, c, d) {
    c = ya(c);
    void 0 !== d && (c += "." + d);
    v(c + " is not in the range " + b + ": " + a);
  }
  function Ca(a) {
    v(
      ("string" === typeof a.className ? a.className : "") +
        " constructor cannot take any arguments."
    );
  }
  function Da(a) {
    v(
      "Collection was modified during iteration: " +
        a.toString() +
        "\n  Perhaps you should iterate over a copy of the collection,\n  or you could collect items to be removed from the collection after the iteration."
    );
  }
  function Ea(a, b) {
    v("No property to set for this enum value: " + b + " on " + a.toString());
  }
  function Fa(a) {
    sa.console && sa.console.log(a);
  }
  function Ga(a) {
    return "object" === typeof a && null !== a;
  }
  function Ha(a) {
    return (
      Array.isArray(a) ||
      (sa.NodeList && a instanceof sa.NodeList) ||
      (sa.HTMLCollection && a instanceof sa.HTMLCollection)
    );
  }
  function Ia(a, b, c) {
    Ha(a) || za(a, "Array or NodeList or HTMLCollection", b, c);
  }
  function Ja(a) {
    return Array.prototype.slice.call(a);
  }
  function Ka(a, b, c) {
    Array.isArray(a)
      ? b >= a.length
        ? a.push(c)
        : a.splice(b, 0, c)
      : v(
          "Cannot insert an object into an HTMLCollection or NodeList: " +
            c +
            " at " +
            b
        );
  }
  function La(a, b) {
    Array.isArray(a)
      ? b >= a.length
        ? a.pop()
        : a.splice(b, 1)
      : v("Cannot remove an object from an HTMLCollection or NodeList at " + b);
  }
  function Ma() {
    var a = Oa.pop();
    return void 0 === a ? [] : a;
  }
  function Pa(a) {
    a.length = 0;
    Oa.push(a);
  }
  function ya(a) {
    return null === a
      ? "*"
      : "string" === typeof a
      ? a
      : "function" === typeof a && "string" === typeof a.className
      ? a.className
      : "";
  }
  function Qa(a) {
    if ("function" === typeof a) {
      if (a.className) return a.className;
      if (a.name) return a.name;
      var b = a.toString();
      b = b.substring(9, b.indexOf("(")).trim();
      if ("" !== b) return (a._className = b);
    } else if (Ga(a) && a.constructor) return Qa(a.constructor);
    return typeof a;
  }
  function Ra(a) {
    var b = a;
    Ga(a) &&
      (a.text
        ? (b = a.text)
        : a.name
        ? (b = a.name)
        : void 0 !== a.key
        ? (b = a.key)
        : void 0 !== a.id
        ? (b = a.id)
        : a.constructor === Object &&
          (a.Text
            ? (b = a.Text)
            : a.Name
            ? (b = a.Name)
            : void 0 !== a.Key
            ? (b = a.Key)
            : void 0 !== a.Id
            ? (b = a.Id)
            : void 0 !== a.ID && (b = a.ID)));
    return void 0 === b ? "undefined" : null === b ? "null" : b.toString();
  }
  function Sa(a, b) {
    if (a.hasOwnProperty(b)) return !0;
    for (a = Object.getPrototypeOf(a); a && a !== Function; ) {
      if (a.hasOwnProperty(b)) return !0;
      var c = a.mB;
      if (c && c[b]) return !0;
      a = Object.getPrototypeOf(a);
    }
    return !1;
  }
  function Ta(a, b, c) {
    Object.defineProperty(Ua.prototype, a, { get: b, set: c });
  }
  function Va(a) {
    for (var b = [], c = 0; 256 > c; c++)
      b["0123456789abcdef".charAt(c >> 4) + "0123456789abcdef".charAt(c & 15)] =
        String.fromCharCode(c);
    a.length % 2 && (a = "0" + a);
    c = [];
    for (var d = 0, e = 0; e < a.length; e += 2) c[d++] = b[a.substr(e, 2)];
    a = c.join("");
    a = "" === a ? "0" : a;
    b = [];
    for (c = 0; 256 > c; c++) b[c] = c;
    for (c = d = 0; 256 > c; c++)
      (d = (d + b[c] + 119) % 256), (e = b[c]), (b[c] = b[d]), (b[d] = e);
    d = c = 0;
    for (var f = "", g = 0; g < a.length; g++)
      (c = (c + 1) % 256),
        (d = (d + b[c]) % 256),
        (e = b[c]),
        (b[c] = b[d]),
        (b[d] = e),
        (f += String.fromCharCode(a.charCodeAt(g) ^ b[(b[c] + b[d]) % 256]));
    return f;
  }
  var Wa =
      void 0 !== sa.navigator &&
      0 < sa.navigator.userAgent.indexOf("Trident/7"),
    Ya = void 0 !== sa.navigator && 0 < sa.navigator.userAgent.indexOf("Edge/"),
    $a =
      void 0 !== sa.navigator &&
      void 0 !== sa.navigator.platform &&
      null !== sa.navigator.platform.match(/(iPhone|iPod|iPad|Mac)/i),
    Oa = [];
  Object.freeze([]);
  ta.className = "Util";
  ta.Dx = "32ab5ff3b26f42dc0ed90f21462913b5";
  ta.vfo = "28e644fdb267";
  ta.className = "Util";
  function F(a, b, c) {
    ab(this);
    this.j = a;
    this.ua = b;
    this.o = c;
  }
  F.prototype.toString = function () {
    return "EnumValue." + this.ua;
  };
  function bb(a, b) {
    return void 0 === b || null === b || "" === b ? null : a[b];
  }
  function cb(a, b, c, d) {
    a.classType !== b &&
      ((c = ya(c)),
      void 0 !== d && (c += "." + d),
      za(
        a,
        "function" === "a constant of class " + typeof b.className
          ? b.className
          : "",
        c
      ));
  }
  oa.Object.defineProperties(F.prototype, {
    classType: {
      configurable: !0,
      get: function () {
        return this.j;
      },
    },
    name: {
      configurable: !0,
      get: function () {
        return this.ua;
      },
    },
    value: {
      configurable: !0,
      get: function () {
        return this.o;
      },
    },
  });
  F.className = "EnumValue";
  function db() {
    this.Fw = [];
  }
  db.prototype.toString = function () {
    return this.Fw.join("");
  };
  db.prototype.add = function (a) {
    "" !== a && this.Fw.push(a);
  };
  db.className = "StringBuilder";
  function eb() {}
  eb.className = "PropertyCollection";
  var G = {
    fm: !1,
    Rx: !1,
    oB: !1,
    qB: !1,
    uB: !1,
    iy: !1,
    Qx: !1,
    nB: null,
    trace: function (a) {
      sa.console && sa.console.log(a);
    },
    pB: function (a, b, c, d) {
      a.strokeStyle = "red";
      a.fillStyle = "red";
      a.font = "8px sans-serif";
      a.beginPath();
      a.moveTo(-10, 0);
      a.lineTo(10, 0);
      a.moveTo(0, -10);
      a.lineTo(0, 10);
      a.stroke();
      a.setTransform(1, 0, 0, 1, 0, 0);
      a.scale(c, c);
      a.transform(b.m11, b.m12, b.m21, b.m22, b.dx, b.dy);
      a.lineWidth = 2;
      a.beginPath();
      a.moveTo(d.left, d.top + 20);
      a.lineTo(d.left, d.top);
      a.lineTo(d.left + 20, d.top);
      a.moveTo(d.right, d.bottom - 20);
      a.lineTo(d.right, d.bottom);
      a.lineTo(d.right - 20, d.bottom);
      a.stroke();
      a.fillText(
        "DB: " +
          Math.round(d.x) +
          ", " +
          Math.round(d.y) +
          ", " +
          Math.round(d.width) +
          ", " +
          Math.round(d.height),
        d.left,
        d.top - 5
      );
    },
    qz: function (a) {
      var b = {},
        c;
      for (c in a) {
        b.x = c;
        if ("licenseKey" !== b.x) {
          var d = a[b.x];
          if (void 0 !== d.prototype) {
            b.vm = Object.getOwnPropertyNames(d.prototype);
            for (
              var e = { tk: 0 };
              e.tk < b.vm.length;
              e = { tk: e.tk }, e.tk++
            ) {
              var f = Object.getOwnPropertyDescriptor(d.prototype, b.vm[e.tk]);
              void 0 !== f.get &&
                void 0 === f.set &&
                Object.defineProperty(d.prototype, b.vm[e.tk], {
                  set: (function (a, b) {
                    return function () {
                      throw Error(
                        "Property " +
                          a.vm[b.tk] +
                          " of " +
                          a.x +
                          " is read-only."
                      );
                    };
                  })(b, e),
                });
            }
          }
        }
        b = { vm: b.vm, x: b.x };
      }
    },
  };
  function gb() {}
  gb.prototype.reset = function () {};
  gb.prototype.next = function () {
    return !1;
  };
  gb.prototype.yd = function () {
    return !1;
  };
  gb.prototype.first = function () {
    return null;
  };
  gb.prototype.any = function () {
    return !1;
  };
  gb.prototype.all = function () {
    return !0;
  };
  gb.prototype.each = function () {
    return this;
  };
  gb.prototype.map = function () {
    return this;
  };
  gb.prototype.filter = function () {
    return this;
  };
  gb.prototype.Zd = function () {};
  gb.prototype.toString = function () {
    return "EmptyIterator";
  };
  oa.Object.defineProperties(gb.prototype, {
    iterator: {
      configurable: !0,
      get: function () {
        return this;
      },
    },
    count: {
      configurable: !0,
      get: function () {
        return 0;
      },
    },
  });
  gb.prototype.first = gb.prototype.first;
  gb.prototype.hasNext = gb.prototype.yd;
  gb.prototype.next = gb.prototype.next;
  gb.prototype.reset = gb.prototype.reset;
  var hb = null;
  gb.className = "EmptyIterator";
  hb = new gb();
  function ib(a) {
    this.key = -1;
    this.value = a;
  }
  ib.prototype.reset = function () {
    this.key = -1;
  };
  ib.prototype.next = function () {
    return -1 === this.key ? ((this.key = 0), !0) : !1;
  };
  ib.prototype.yd = function () {
    return this.next();
  };
  ib.prototype.first = function () {
    this.key = 0;
    return this.value;
  };
  ib.prototype.any = function (a) {
    this.key = -1;
    return a(this.value);
  };
  ib.prototype.all = function (a) {
    this.key = -1;
    return a(this.value);
  };
  ib.prototype.each = function (a) {
    this.key = -1;
    a(this.value);
    return this;
  };
  ib.prototype.map = function (a) {
    return new ib(a(this.value));
  };
  ib.prototype.filter = function (a) {
    return a(this.value) ? new ib(this.value) : hb;
  };
  ib.prototype.Zd = function () {
    this.value = null;
  };
  ib.prototype.toString = function () {
    return "SingletonIterator(" + this.value + ")";
  };
  oa.Object.defineProperties(ib.prototype, {
    iterator: {
      configurable: !0,
      get: function () {
        return this;
      },
    },
    count: {
      configurable: !0,
      get: function () {
        return 1;
      },
    },
  });
  ib.prototype.first = ib.prototype.first;
  ib.prototype.hasNext = ib.prototype.yd;
  ib.prototype.next = ib.prototype.next;
  ib.prototype.reset = ib.prototype.reset;
  ib.className = "SingletonIterator";
  function jb(a) {
    this.xb = a;
    this.nf = null;
    a.Pa = null;
    this.qa = a.w;
    this.Xa = -1;
  }
  jb.prototype.reset = function () {
    var a = this.xb;
    a.Pa = null;
    this.qa = a.w;
    this.Xa = -1;
  };
  jb.prototype.next = function () {
    var a = this.xb;
    if (a.w !== this.qa) {
      if (0 > this.key) return !1;
      Da(a);
    }
    a = a.m;
    var b = a.length,
      c = ++this.Xa,
      d = this.nf;
    if (null !== d)
      for (; c < b; ) {
        var e = a[c];
        if (d(e)) return (this.key = this.Xa = c), (this.value = e), !0;
        c++;
      }
    else {
      if (c < b) return (this.key = c), (this.value = a[c]), !0;
      this.Zd();
    }
    return !1;
  };
  jb.prototype.yd = function () {
    return this.next();
  };
  jb.prototype.first = function () {
    var a = this.xb;
    this.qa = a.w;
    this.Xa = 0;
    a = a.m;
    var b = a.length,
      c = this.nf;
    if (null !== c) {
      for (var d = 0; d < b; ) {
        var e = a[d];
        if (c(e)) return (this.key = this.Xa = d), (this.value = e);
        d++;
      }
      return null;
    }
    return 0 < b ? ((a = a[0]), (this.key = 0), (this.value = a)) : null;
  };
  jb.prototype.any = function (a) {
    var b = this.xb;
    b.Pa = null;
    var c = b.w;
    this.Xa = -1;
    for (var d = b.m, e = d.length, f = this.nf, g = 0; g < e; g++) {
      var h = d[g];
      if (null === f || f(h)) {
        if (a(h)) return !0;
        b.w !== c && Da(b);
      }
    }
    return !1;
  };
  jb.prototype.all = function (a) {
    var b = this.xb;
    b.Pa = null;
    var c = b.w;
    this.Xa = -1;
    for (var d = b.m, e = d.length, f = this.nf, g = 0; g < e; g++) {
      var h = d[g];
      if (null === f || f(h)) {
        if (!a(h)) return !1;
        b.w !== c && Da(b);
      }
    }
    return !0;
  };
  jb.prototype.each = function (a) {
    var b = this.xb;
    b.Pa = null;
    var c = b.w;
    this.Xa = -1;
    for (var d = b.m, e = d.length, f = this.nf, g = 0; g < e; g++) {
      var h = d[g];
      if (null === f || f(h)) a(h), b.w !== c && Da(b);
    }
    return this;
  };
  jb.prototype.map = function (a) {
    var b = this.xb;
    b.Pa = null;
    var c = b.w;
    this.Xa = -1;
    for (var d = [], e = b.m, f = e.length, g = this.nf, h = 0; h < f; h++) {
      var k = e[h];
      if (null === g || g(k)) d.push(a(k)), b.w !== c && Da(b);
    }
    a = new H();
    a.m = d;
    a.sb();
    return a.iterator;
  };
  jb.prototype.filter = function (a) {
    var b = this.xb;
    b.Pa = null;
    var c = b.w;
    this.Xa = -1;
    for (var d = [], e = b.m, f = e.length, g = this.nf, h = 0; h < f; h++) {
      var k = e[h];
      if (null === g || g(k)) a(k) && d.push(k), b.w !== c && Da(b);
    }
    a = new H();
    a.m = d;
    a.sb();
    return a.iterator;
  };
  jb.prototype.Zd = function () {
    this.key = -1;
    this.value = null;
    this.qa = -1;
    this.nf = null;
    this.xb.Pa = this;
  };
  jb.prototype.toString = function () {
    return "ListIterator@" + this.Xa + "/" + this.xb.count;
  };
  oa.Object.defineProperties(jb.prototype, {
    iterator: {
      configurable: !0,
      get: function () {
        return this;
      },
    },
    predicate: {
      configurable: !0,
      get: function () {
        return this.nf;
      },
      set: function (a) {
        this.nf = a;
      },
    },
    count: {
      configurable: !0,
      get: function () {
        var a = this.nf;
        if (null !== a) {
          for (var b = 0, c = this.xb.m, d = c.length, e = 0; e < d; e++)
            a(c[e]) && b++;
          return b;
        }
        return this.xb.m.length;
      },
    },
  });
  jb.prototype.first = jb.prototype.first;
  jb.prototype.hasNext = jb.prototype.yd;
  jb.prototype.next = jb.prototype.next;
  jb.prototype.reset = jb.prototype.reset;
  jb.className = "ListIterator";
  function kb(a) {
    this.xb = a;
    a.Yg = null;
    this.qa = a.w;
    this.Xa = a.m.length;
  }
  kb.prototype.reset = function () {
    var a = this.xb;
    a.Yg = null;
    this.qa = a.w;
    this.Xa = a.m.length;
  };
  kb.prototype.next = function () {
    var a = this.xb;
    if (a.w !== this.qa) {
      if (0 > this.key) return !1;
      Da(a);
    }
    var b = --this.Xa;
    if (0 <= b) return (this.key = b), (this.value = a.m[b]), !0;
    this.Zd();
    return !1;
  };
  kb.prototype.yd = function () {
    return this.next();
  };
  kb.prototype.first = function () {
    var a = this.xb;
    this.qa = a.w;
    var b = a.m;
    this.Xa = a = b.length - 1;
    return 0 <= a ? ((b = b[a]), (this.key = a), (this.value = b)) : null;
  };
  kb.prototype.any = function (a) {
    var b = this.xb;
    b.Yg = null;
    var c = b.w,
      d = b.m,
      e = d.length;
    this.Xa = e;
    for (--e; 0 <= e; e--) {
      if (a(d[e])) return !0;
      b.w !== c && Da(b);
    }
    return !1;
  };
  kb.prototype.all = function (a) {
    var b = this.xb;
    b.Yg = null;
    var c = b.w,
      d = b.m,
      e = d.length;
    this.Xa = e;
    for (--e; 0 <= e; e--) {
      if (!a(d[e])) return !1;
      b.w !== c && Da(b);
    }
    return !0;
  };
  kb.prototype.each = function (a) {
    var b = this.xb;
    b.Yg = null;
    var c = b.w,
      d = b.m,
      e = d.length;
    this.Xa = e;
    for (--e; 0 <= e; e--) a(d[e]), b.w !== c && Da(b);
    return this;
  };
  kb.prototype.map = function (a) {
    var b = this.xb;
    b.Yg = null;
    var c = b.w,
      d = [],
      e = b.m,
      f = e.length;
    this.Xa = f;
    for (--f; 0 <= f; f--) d.push(a(e[f])), b.w !== c && Da(b);
    a = new H();
    a.m = d;
    a.sb();
    return a.iterator;
  };
  kb.prototype.filter = function (a) {
    var b = this.xb;
    b.Yg = null;
    var c = b.w,
      d = [],
      e = b.m,
      f = e.length;
    this.Xa = f;
    for (--f; 0 <= f; f--) {
      var g = e[f];
      a(g) && d.push(g);
      b.w !== c && Da(b);
    }
    a = new H();
    a.m = d;
    a.sb();
    return a.iterator;
  };
  kb.prototype.Zd = function () {
    this.key = -1;
    this.value = null;
    this.qa = -1;
    this.xb.Yg = this;
  };
  kb.prototype.toString = function () {
    return "ListIteratorBackwards(" + this.Xa + "/" + this.xb.count + ")";
  };
  oa.Object.defineProperties(kb.prototype, {
    iterator: {
      configurable: !0,
      get: function () {
        return this;
      },
    },
    count: {
      configurable: !0,
      get: function () {
        return this.xb.m.length;
      },
    },
  });
  kb.prototype.first = kb.prototype.first;
  kb.prototype.hasNext = kb.prototype.yd;
  kb.prototype.next = kb.prototype.next;
  kb.prototype.reset = kb.prototype.reset;
  kb.className = "ListIteratorBackwards";
  function H(a) {
    ab(this);
    this.u = !1;
    this.m = [];
    this.w = 0;
    this.Yg = this.Pa = null;
    ((G && "function" === typeof a) || "string" === typeof a) &&
      v(
        "Error: Since 2.0 List/Map/Set constructors no longer take an argument that enforces type."
      );
    void 0 !== a && this.addAll(a);
  }
  t = H.prototype;
  t.sb = function () {
    var a = this.w;
    a++;
    999999999 < a && (a = 0);
    this.w = a;
  };
  t.freeze = function () {
    this.u = !0;
    return this;
  };
  t.la = function () {
    this.u = !1;
    return this;
  };
  t.toString = function () {
    return "List()#" + lb(this);
  };
  t.add = function (a) {
    if (null === a) return this;
    this.u && xa(this, a);
    this.m.push(a);
    this.sb();
    return this;
  };
  t.push = function (a) {
    this.add(a);
  };
  t.addAll = function (a) {
    if (null === a) return this;
    this.u && xa(this);
    var b = this.m;
    if (Ha(a)) for (var c = a.length, d = 0; d < c; d++) b.push(a[d]);
    else for (a = a.iterator; a.next(); ) b.push(a.value);
    this.sb();
    return this;
  };
  t.clear = function () {
    this.u && xa(this);
    this.m.length = 0;
    this.sb();
  };
  t.contains = function (a) {
    return null === a ? !1 : -1 !== this.m.indexOf(a);
  };
  t.has = function (a) {
    return this.contains(a);
  };
  t.indexOf = function (a) {
    return null === a ? -1 : this.m.indexOf(a);
  };
  t.N = function (a) {
    G && D(a, H, "elt:i");
    var b = this.m;
    (0 > a || a >= b.length) && Aa(a, "0 <= i < length", H, "elt:i");
    return b[a];
  };
  t.get = function (a) {
    return this.N(a);
  };
  t.Vc = function (a, b) {
    G && D(a, H, "setElt:i");
    var c = this.m;
    (0 > a || a >= c.length) && Aa(a, "0 <= i < length", H, "setElt:i");
    this.u && xa(this, a);
    c[a] = b;
  };
  t.set = function (a, b) {
    this.Vc(a, b);
  };
  t.first = function () {
    var a = this.m;
    return 0 === a.length ? null : a[0];
  };
  t.fc = function () {
    var a = this.m,
      b = a.length;
    return 0 < b ? a[b - 1] : null;
  };
  t.pop = function () {
    this.u && xa(this);
    var a = this.m;
    return 0 < a.length ? a.pop() : null;
  };
  H.prototype.any = function (a) {
    for (var b = this.m, c = this.w, d = b.length, e = 0; e < d; e++) {
      if (a(b[e])) return !0;
      this.w !== c && Da(this);
    }
    return !1;
  };
  H.prototype.all = function (a) {
    for (var b = this.m, c = this.w, d = b.length, e = 0; e < d; e++) {
      if (!a(b[e])) return !1;
      this.w !== c && Da(this);
    }
    return !0;
  };
  H.prototype.each = function (a) {
    for (var b = this.m, c = this.w, d = b.length, e = 0; e < d; e++)
      a(b[e]), this.w !== c && Da(this);
    return this;
  };
  H.prototype.map = function (a) {
    for (
      var b = new H(), c = [], d = this.m, e = this.w, f = d.length, g = 0;
      g < f;
      g++
    )
      c.push(a(d[g])), this.w !== e && Da(this);
    b.m = c;
    b.sb();
    return b;
  };
  H.prototype.filter = function (a) {
    for (
      var b = new H(), c = [], d = this.m, e = this.w, f = d.length, g = 0;
      g < f;
      g++
    ) {
      var h = d[g];
      a(h) && c.push(h);
      this.w !== e && Da(this);
    }
    b.m = c;
    b.sb();
    return b;
  };
  t = H.prototype;
  t.Cb = function (a, b) {
    G && D(a, H, "insertAt:i");
    0 > a && Aa(a, ">= 0", H, "insertAt:i");
    this.u && xa(this, a);
    var c = this.m;
    a >= c.length ? c.push(b) : c.splice(a, 0, b);
    this.sb();
  };
  t.remove = function (a) {
    if (null === a) return !1;
    this.u && xa(this, a);
    var b = this.m;
    a = b.indexOf(a);
    if (-1 === a) return !1;
    a === b.length - 1 ? b.pop() : b.splice(a, 1);
    this.sb();
    return !0;
  };
  t.delete = function (a) {
    return this.remove(a);
  };
  t.nb = function (a) {
    G && D(a, H, "removeAt:i");
    var b = this.m;
    (0 > a || a >= b.length) && Aa(a, "0 <= i < length", H, "removeAt:i");
    this.u && xa(this, a);
    a === b.length - 1 ? b.pop() : b.splice(a, 1);
    this.sb();
  };
  t.removeRange = function (a, b) {
    G && (D(a, H, "removeRange:from"), D(b, H, "removeRange:to"));
    var c = this.m,
      d = c.length;
    if (0 > a) a = 0;
    else if (a >= d) return this;
    if (0 > b) return this;
    b >= d && (b = d - 1);
    if (a > b) return this;
    this.u && xa(this);
    for (var e = a, f = b + 1; f < d; ) c[e++] = c[f++];
    c.length = d - (b - a + 1);
    this.sb();
    return this;
  };
  H.prototype.copy = function () {
    var a = new H(),
      b = this.m;
    0 < b.length && (a.m = Array.prototype.slice.call(b));
    return a;
  };
  t = H.prototype;
  t.Ga = function () {
    for (var a = this.m, b = this.count, c = Array(b), d = 0; d < b; d++)
      c[d] = a[d];
    return c;
  };
  t.ew = function () {
    for (var a = new I(), b = this.m, c = this.count, d = 0; d < c; d++)
      a.add(b[d]);
    return a;
  };
  t.sort = function (a) {
    G && A(a, "function", H, "sort:sortfunc");
    this.u && xa(this);
    this.m.sort(a);
    this.sb();
    return this;
  };
  t.ej = function (a, b, c) {
    var d = this.m,
      e = d.length;
    void 0 === b && (b = 0);
    void 0 === c && (c = e);
    G &&
      (A(a, "function", H, "sortRange:sortfunc"),
      D(b, H, "sortRange:from"),
      D(c, H, "sortRange:to"));
    this.u && xa(this);
    var f = c - b;
    if (1 >= f) return this;
    (0 > b || b >= e - 1) && Aa(b, "0 <= from < length", H, "sortRange:from");
    if (2 === f)
      return (
        (c = d[b]),
        (e = d[b + 1]),
        0 < a(c, e) && ((d[b] = e), (d[b + 1] = c), this.sb()),
        this
      );
    if (0 === b)
      if (c >= e) d.sort(a);
      else for (b = d.slice(0, c), b.sort(a), a = 0; a < c; a++) d[a] = b[a];
    else if (c >= e)
      for (c = d.slice(b), c.sort(a), a = b; a < e; a++) d[a] = c[a - b];
    else for (e = d.slice(b, c), e.sort(a), a = b; a < c; a++) d[a] = e[a - b];
    this.sb();
    return this;
  };
  t.reverse = function () {
    this.u && xa(this);
    this.m.reverse();
    this.sb();
    return this;
  };
  oa.Object.defineProperties(H.prototype, {
    _dataArray: {
      configurable: !0,
      get: function () {
        return this.m;
      },
    },
    count: {
      configurable: !0,
      get: function () {
        return this.m.length;
      },
    },
    size: {
      configurable: !0,
      get: function () {
        return this.m.length;
      },
    },
    length: {
      configurable: !0,
      get: function () {
        return this.m.length;
      },
    },
    iterator: {
      configurable: !0,
      get: function () {
        if (0 >= this.m.length) return hb;
        var a = this.Pa;
        return null !== a ? (a.reset(), a) : new jb(this);
      },
    },
    iteratorBackwards: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        if (0 >= this.m.length) return hb;
        var a = this.Yg;
        return null !== a ? (a.reset(), a) : new kb(this);
      },
    },
  });
  H.prototype.reverse = H.prototype.reverse;
  H.prototype.sortRange = H.prototype.ej;
  H.prototype.sort = H.prototype.sort;
  H.prototype.toSet = H.prototype.ew;
  H.prototype.toArray = H.prototype.Ga;
  H.prototype.removeRange = H.prototype.removeRange;
  H.prototype.removeAt = H.prototype.nb;
  H.prototype["delete"] = H.prototype.delete;
  H.prototype.remove = H.prototype.remove;
  H.prototype.insertAt = H.prototype.Cb;
  H.prototype.pop = H.prototype.pop;
  H.prototype.last = H.prototype.fc;
  H.prototype.first = H.prototype.first;
  H.prototype.set = H.prototype.set;
  H.prototype.setElt = H.prototype.Vc;
  H.prototype.get = H.prototype.get;
  H.prototype.elt = H.prototype.N;
  H.prototype.indexOf = H.prototype.indexOf;
  H.prototype.has = H.prototype.has;
  H.prototype.contains = H.prototype.contains;
  H.prototype.clear = H.prototype.clear;
  H.prototype.addAll = H.prototype.addAll;
  H.prototype.push = H.prototype.push;
  H.prototype.add = H.prototype.add;
  H.prototype.thaw = H.prototype.la;
  H.prototype.freeze = H.prototype.freeze;
  H.className = "List";
  function mb(a) {
    this.lg = a;
    a.Pa = null;
    this.qa = a.w;
    this.sa = null;
  }
  mb.prototype.reset = function () {
    var a = this.lg;
    a.Pa = null;
    this.qa = a.w;
    this.sa = null;
  };
  mb.prototype.next = function () {
    var a = this.lg;
    if (a.w !== this.qa) {
      if (null === this.key) return !1;
      Da(a);
    }
    var b = this.sa;
    b = null === b ? a.ga : b.va;
    if (null !== b)
      return (this.sa = b), (this.value = b.value), (this.key = b.key), !0;
    this.Zd();
    return !1;
  };
  mb.prototype.yd = function () {
    return this.next();
  };
  mb.prototype.first = function () {
    var a = this.lg;
    this.qa = a.w;
    a = a.ga;
    if (null !== a) {
      this.sa = a;
      var b = a.value;
      this.key = a.key;
      return (this.value = b);
    }
    return null;
  };
  mb.prototype.any = function (a) {
    var b = this.lg;
    b.Pa = null;
    var c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) {
      if (a(d.value)) return !0;
      b.w !== c && Da(b);
      d = d.va;
    }
    return !1;
  };
  mb.prototype.all = function (a) {
    var b = this.lg;
    b.Pa = null;
    var c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) {
      if (!a(d.value)) return !1;
      b.w !== c && Da(b);
      d = d.va;
    }
    return !0;
  };
  mb.prototype.each = function (a) {
    var b = this.lg;
    b.Pa = null;
    var c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) a(d.value), b.w !== c && Da(b), (d = d.va);
    return this;
  };
  mb.prototype.map = function (a) {
    var b = this.lg;
    b.Pa = null;
    for (var c = new H(), d = b.w, e = b.ga; null !== e; )
      c.add(a(e.value)), b.w !== d && Da(b), (e = e.va);
    return c.iterator;
  };
  mb.prototype.filter = function (a) {
    var b = this.lg;
    b.Pa = null;
    for (var c = new H(), d = b.w, e = b.ga; null !== e; ) {
      var f = e.value;
      a(f) && c.add(f);
      b.w !== d && Da(b);
      e = e.va;
    }
    return c.iterator;
  };
  mb.prototype.Zd = function () {
    this.value = this.key = null;
    this.qa = -1;
    this.lg.Pa = this;
  };
  mb.prototype.toString = function () {
    return null !== this.sa ? "SetIterator@" + this.sa.value : "SetIterator";
  };
  oa.Object.defineProperties(mb.prototype, {
    iterator: {
      configurable: !0,
      get: function () {
        return this;
      },
    },
    count: {
      configurable: !0,
      get: function () {
        return this.lg.Qb;
      },
    },
  });
  mb.prototype.first = mb.prototype.first;
  mb.prototype.hasNext = mb.prototype.yd;
  mb.prototype.next = mb.prototype.next;
  mb.prototype.reset = mb.prototype.reset;
  mb.className = "SetIterator";
  function I(a) {
    ab(this);
    this.u = !1;
    this.Rb = {};
    this.Qb = 0;
    this.Pa = null;
    this.w = 0;
    this.hf = this.ga = null;
    ((G && "function" === typeof a) || "string" === typeof a) &&
      v(
        "Error: Since 2.0 List/Map/Set constructors no longer take an argument that enforces type."
      );
    void 0 !== a && this.addAll(a);
  }
  t = I.prototype;
  t.sb = function () {
    var a = this.w;
    a++;
    999999999 < a && (a = 0);
    this.w = a;
  };
  t.freeze = function () {
    this.u = !0;
    return this;
  };
  t.la = function () {
    this.u = !1;
    return this;
  };
  t.toString = function () {
    return "Set()#" + lb(this);
  };
  t.add = function (a) {
    if (null === a) return this;
    this.u && xa(this, a);
    var b = a;
    Ga(a) && (b = nb(a));
    void 0 === this.Rb[b] &&
      (this.Qb++,
      (a = new ob(a, a)),
      (this.Rb[b] = a),
      (b = this.hf),
      null === b ? (this.ga = a) : ((a.Nl = b), (b.va = a)),
      (this.hf = a),
      this.sb());
    return this;
  };
  t.addAll = function (a) {
    if (null === a) return this;
    this.u && xa(this);
    if (Ha(a)) for (var b = a.length, c = 0; c < b; c++) this.add(a[c]);
    else for (a = a.iterator; a.next(); ) this.add(a.value);
    return this;
  };
  t.contains = function (a) {
    if (null === a) return !1;
    var b = a;
    return Ga(a) && ((b = lb(a)), void 0 === b) ? !1 : void 0 !== this.Rb[b];
  };
  t.has = function (a) {
    return this.contains(a);
  };
  t.zz = function (a) {
    if (null === a) return !0;
    for (a = a.iterator; a.next(); ) if (!this.contains(a.value)) return !1;
    return !0;
  };
  t.Az = function (a) {
    if (null === a) return !0;
    for (a = a.iterator; a.next(); ) if (this.contains(a.value)) return !0;
    return !1;
  };
  t.first = function () {
    var a = this.ga;
    return null === a ? null : a.value;
  };
  I.prototype.any = function (a) {
    for (var b = this.w, c = this.ga; null !== c; ) {
      if (a(c.value)) return !0;
      this.w !== b && Da(this);
      c = c.va;
    }
    return !1;
  };
  I.prototype.all = function (a) {
    for (var b = this.w, c = this.ga; null !== c; ) {
      if (!a(c.value)) return !1;
      this.w !== b && Da(this);
      c = c.va;
    }
    return !0;
  };
  I.prototype.each = function (a) {
    for (var b = this.w, c = this.ga; null !== c; )
      a(c.value), this.w !== b && Da(this), (c = c.va);
    return this;
  };
  I.prototype.map = function (a) {
    for (var b = new I(), c = this.w, d = this.ga; null !== d; )
      b.add(a(d.value)), this.w !== c && Da(this), (d = d.va);
    return b;
  };
  I.prototype.filter = function (a) {
    for (var b = new I(), c = this.w, d = this.ga; null !== d; ) {
      var e = d.value;
      a(e) && b.add(e);
      this.w !== c && Da(this);
      d = d.va;
    }
    return b;
  };
  t = I.prototype;
  t.remove = function (a) {
    if (null === a) return !1;
    this.u && xa(this, a);
    var b = a;
    if (Ga(a) && ((b = lb(a)), void 0 === b)) return !1;
    a = this.Rb[b];
    if (void 0 === a) return !1;
    var c = a.va,
      d = a.Nl;
    null !== c && (c.Nl = d);
    null !== d && (d.va = c);
    this.ga === a && (this.ga = c);
    this.hf === a && (this.hf = d);
    delete this.Rb[b];
    this.Qb--;
    this.sb();
    return !0;
  };
  t.delete = function (a) {
    return this.remove(a);
  };
  t.zq = function (a) {
    if (null === a) return this;
    this.u && xa(this);
    if (Ha(a)) for (var b = a.length, c = 0; c < b; c++) this.remove(a[c]);
    else for (a = a.iterator; a.next(); ) this.remove(a.value);
    return this;
  };
  t.XA = function (a) {
    if (null === a || 0 === this.count) return this;
    this.u && xa(this);
    var b = new I();
    b.addAll(a);
    a = [];
    for (var c = this.iterator; c.next(); ) {
      var d = c.value;
      b.contains(d) || a.push(d);
    }
    this.zq(a);
    return this;
  };
  t.clear = function () {
    this.u && xa(this);
    this.Rb = {};
    this.Qb = 0;
    null !== this.Pa && this.Pa.reset();
    this.hf = this.ga = null;
    this.sb();
  };
  I.prototype.copy = function () {
    var a = new I(),
      b = this.Rb,
      c;
    for (c in b) a.add(b[c].value);
    return a;
  };
  I.prototype.Ga = function () {
    var a = Array(this.Qb),
      b = this.Rb,
      c = 0,
      d;
    for (d in b) (a[c] = b[d].value), c++;
    return a;
  };
  I.prototype.dw = function () {
    var a = new H(),
      b = this.Rb,
      c;
    for (c in b) a.add(b[c].value);
    return a;
  };
  function ab(a) {
    a.__gohashid = pb++;
  }
  function nb(a) {
    var b = a.__gohashid;
    void 0 === b && ((b = pb++), (a.__gohashid = b));
    return b;
  }
  function lb(a) {
    return a.__gohashid;
  }
  oa.Object.defineProperties(I.prototype, {
    count: {
      configurable: !0,
      get: function () {
        return this.Qb;
      },
    },
    size: {
      configurable: !0,
      get: function () {
        return this.Qb;
      },
    },
    iterator: {
      configurable: !0,
      get: function () {
        if (0 >= this.Qb) return hb;
        var a = this.Pa;
        return null !== a ? (a.reset(), a) : new mb(this);
      },
    },
  });
  I.prototype.toList = I.prototype.dw;
  I.prototype.toArray = I.prototype.Ga;
  I.prototype.clear = I.prototype.clear;
  I.prototype.retainAll = I.prototype.XA;
  I.prototype.removeAll = I.prototype.zq;
  I.prototype["delete"] = I.prototype.delete;
  I.prototype.remove = I.prototype.remove;
  I.prototype.first = I.prototype.first;
  I.prototype.containsAny = I.prototype.Az;
  I.prototype.containsAll = I.prototype.zz;
  I.prototype.has = I.prototype.has;
  I.prototype.contains = I.prototype.contains;
  I.prototype.addAll = I.prototype.addAll;
  I.prototype.add = I.prototype.add;
  I.prototype.thaw = I.prototype.la;
  I.prototype.freeze = I.prototype.freeze;
  var pb = 1;
  I.className = "Set";
  I.uniqueHash = ab;
  I.hashIdUnique = nb;
  I.hashId = lb;
  function rb(a) {
    this.oa = a;
    this.qa = a.w;
    this.sa = null;
  }
  rb.prototype.reset = function () {
    this.qa = this.oa.w;
    this.sa = null;
  };
  rb.prototype.next = function () {
    var a = this.oa;
    if (a.w !== this.qa) {
      if (null === this.key) return !1;
      Da(a);
    }
    var b = this.sa;
    b = null === b ? a.ga : b.va;
    if (null !== b)
      return (this.sa = b), (this.value = this.key = a = b.key), !0;
    this.Zd();
    return !1;
  };
  rb.prototype.yd = function () {
    return this.next();
  };
  rb.prototype.first = function () {
    var a = this.oa;
    this.qa = a.w;
    a = a.ga;
    return null !== a
      ? ((this.sa = a), (this.value = this.key = a = a.key))
      : null;
  };
  rb.prototype.any = function (a) {
    var b = this.oa,
      c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) {
      if (a(d.key)) return !0;
      b.w !== c && Da(b);
      d = d.va;
    }
    return !1;
  };
  rb.prototype.all = function (a) {
    var b = this.oa,
      c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) {
      if (!a(d.key)) return !1;
      b.w !== c && Da(b);
      d = d.va;
    }
    return !0;
  };
  rb.prototype.each = function (a) {
    var b = this.oa,
      c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) a(d.key), b.w !== c && Da(b), (d = d.va);
    return this;
  };
  rb.prototype.map = function (a) {
    var b = this.oa,
      c = b.w;
    this.sa = null;
    for (var d = new H(), e = b.ga; null !== e; )
      d.add(a(e.key)), b.w !== c && Da(b), (e = e.va);
    return d.iterator;
  };
  rb.prototype.filter = function (a) {
    var b = this.oa,
      c = b.w;
    this.sa = null;
    for (var d = new H(), e = b.ga; null !== e; ) {
      var f = e.key;
      a(f) && d.add(f);
      b.w !== c && Da(b);
      e = e.va;
    }
    return d.iterator;
  };
  rb.prototype.Zd = function () {
    this.value = this.key = null;
    this.qa = -1;
  };
  rb.prototype.toString = function () {
    return null !== this.sa
      ? "MapKeySetIterator@" + this.sa.value
      : "MapKeySetIterator";
  };
  oa.Object.defineProperties(rb.prototype, {
    iterator: {
      configurable: !0,
      get: function () {
        return this;
      },
    },
    count: {
      configurable: !0,
      get: function () {
        return this.oa.Qb;
      },
    },
  });
  rb.prototype.first = rb.prototype.first;
  rb.prototype.hasNext = rb.prototype.yd;
  rb.prototype.next = rb.prototype.next;
  rb.prototype.reset = rb.prototype.reset;
  rb.className = "MapKeySetIterator";
  function ub(a) {
    I.call(this);
    ab(this);
    this.u = !0;
    this.oa = a;
  }
  na(ub, I);
  t = ub.prototype;
  t.freeze = function () {
    return this;
  };
  t.la = function () {
    return this;
  };
  t.toString = function () {
    return "MapKeySet(" + this.oa.toString() + ")";
  };
  t.add = function () {
    v("This Set is read-only: " + this.toString());
  };
  t.contains = function (a) {
    return this.oa.contains(a);
  };
  t.has = function (a) {
    return this.contains(a);
  };
  t.remove = function () {
    v("This Set is read-only: " + this.toString());
  };
  t.delete = function (a) {
    return this.remove(a);
  };
  t.clear = function () {
    v("This Set is read-only: " + this.toString());
  };
  t.first = function () {
    var a = this.oa.ga;
    return null !== a ? a.key : null;
  };
  ub.prototype.any = function (a) {
    for (var b = this.oa.ga; null !== b; ) {
      if (a(b.key)) return !0;
      b = b.va;
    }
    return !1;
  };
  ub.prototype.all = function (a) {
    for (var b = this.oa.ga; null !== b; ) {
      if (!a(b.key)) return !1;
      b = b.va;
    }
    return !0;
  };
  ub.prototype.each = function (a) {
    for (var b = this.oa.ga; null !== b; ) a(b.key), (b = b.va);
    return this;
  };
  ub.prototype.map = function (a) {
    for (var b = new I(), c = this.oa.ga; null !== c; )
      b.add(a(c.key)), (c = c.va);
    return b;
  };
  ub.prototype.filter = function (a) {
    for (var b = new I(), c = this.oa.ga; null !== c; ) {
      var d = c.key;
      a(d) && b.add(d);
      c = c.va;
    }
    return b;
  };
  ub.prototype.copy = function () {
    return new ub(this.oa);
  };
  ub.prototype.ew = function () {
    var a = new I(),
      b = this.oa.Rb,
      c;
    for (c in b) a.add(b[c].key);
    return a;
  };
  ub.prototype.Ga = function () {
    var a = this.oa.Rb,
      b = Array(this.oa.Qb),
      c = 0,
      d;
    for (d in a) (b[c] = a[d].key), c++;
    return b;
  };
  ub.prototype.dw = function () {
    var a = new H(),
      b = this.oa.Rb,
      c;
    for (c in b) a.add(b[c].key);
    return a;
  };
  oa.Object.defineProperties(ub.prototype, {
    count: {
      configurable: !0,
      get: function () {
        return this.oa.Qb;
      },
    },
    size: {
      configurable: !0,
      get: function () {
        return this.oa.Qb;
      },
    },
    iterator: {
      configurable: !0,
      get: function () {
        return 0 >= this.oa.Qb ? hb : new rb(this.oa);
      },
    },
  });
  ub.prototype.toList = ub.prototype.dw;
  ub.prototype.toArray = ub.prototype.Ga;
  ub.prototype.toSet = ub.prototype.ew;
  ub.prototype.first = ub.prototype.first;
  ub.prototype.clear = ub.prototype.clear;
  ub.prototype["delete"] = ub.prototype.delete;
  ub.prototype.remove = ub.prototype.remove;
  ub.prototype.has = ub.prototype.has;
  ub.prototype.contains = ub.prototype.contains;
  ub.prototype.add = ub.prototype.add;
  ub.prototype.thaw = ub.prototype.la;
  ub.prototype.freeze = ub.prototype.freeze;
  ub.className = "MapKeySet";
  function vb(a) {
    this.oa = a;
    a.gf = null;
    this.qa = a.w;
    this.sa = null;
  }
  vb.prototype.reset = function () {
    var a = this.oa;
    a.gf = null;
    this.qa = a.w;
    this.sa = null;
  };
  vb.prototype.next = function () {
    var a = this.oa;
    if (a.w !== this.qa) {
      if (null === this.key) return !1;
      Da(a);
    }
    var b = this.sa;
    b = null === b ? a.ga : b.va;
    if (null !== b)
      return (this.sa = b), (this.value = b.value), (this.key = b.key), !0;
    this.Zd();
    return !1;
  };
  vb.prototype.yd = function () {
    return this.next();
  };
  vb.prototype.first = function () {
    var a = this.oa;
    this.qa = a.w;
    a = a.ga;
    if (null !== a) {
      this.sa = a;
      var b = a.value;
      this.key = a.key;
      return (this.value = b);
    }
    return null;
  };
  vb.prototype.any = function (a) {
    var b = this.oa;
    b.gf = null;
    var c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) {
      if (a(d.value)) return !0;
      b.w !== c && Da(b);
      d = d.va;
    }
    return !1;
  };
  vb.prototype.all = function (a) {
    var b = this.oa;
    b.gf = null;
    var c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) {
      if (!a(d.value)) return !1;
      b.w !== c && Da(b);
      d = d.va;
    }
    return !0;
  };
  vb.prototype.each = function (a) {
    var b = this.oa;
    b.gf = null;
    var c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) a(d.value), b.w !== c && Da(b), (d = d.va);
    return this;
  };
  vb.prototype.map = function (a) {
    var b = this.oa;
    b.gf = null;
    var c = b.w;
    this.sa = null;
    for (var d = new H(), e = b.ga; null !== e; )
      d.add(a(e.value)), b.w !== c && Da(b), (e = e.va);
    return d.iterator;
  };
  vb.prototype.filter = function (a) {
    var b = this.oa;
    b.gf = null;
    var c = b.w;
    this.sa = null;
    for (var d = new H(), e = b.ga; null !== e; ) {
      var f = e.value;
      a(f) && d.add(f);
      b.w !== c && Da(b);
      e = e.va;
    }
    return d.iterator;
  };
  vb.prototype.Zd = function () {
    this.value = this.key = null;
    this.qa = -1;
    this.oa.gf = this;
  };
  vb.prototype.toString = function () {
    return null !== this.sa
      ? "MapValueSetIterator@" + this.sa.value
      : "MapValueSetIterator";
  };
  oa.Object.defineProperties(vb.prototype, {
    iterator: {
      configurable: !0,
      get: function () {
        return this;
      },
    },
    count: {
      configurable: !0,
      get: function () {
        return this.oa.Qb;
      },
    },
  });
  vb.prototype.first = vb.prototype.first;
  vb.prototype.hasNext = vb.prototype.yd;
  vb.prototype.next = vb.prototype.next;
  vb.prototype.reset = vb.prototype.reset;
  vb.className = "MapValueSetIterator";
  function ob(a, b) {
    this.key = a;
    this.value = b;
    this.Nl = this.va = null;
  }
  ob.prototype.toString = function () {
    return "{" + this.key + ":" + this.value + "}";
  };
  ob.className = "KeyValuePair";
  function wb(a) {
    this.oa = a;
    a.Pa = null;
    this.qa = a.w;
    this.sa = null;
  }
  wb.prototype.reset = function () {
    var a = this.oa;
    a.Pa = null;
    this.qa = a.w;
    this.sa = null;
  };
  wb.prototype.next = function () {
    var a = this.oa;
    if (a.w !== this.qa) {
      if (null === this.key) return !1;
      Da(a);
    }
    var b = this.sa;
    b = null === b ? a.ga : b.va;
    if (null !== b)
      return (this.sa = b), (this.key = b.key), (this.value = b.value), !0;
    this.Zd();
    return !1;
  };
  wb.prototype.yd = function () {
    return this.next();
  };
  wb.prototype.first = function () {
    var a = this.oa;
    this.qa = a.w;
    a = a.ga;
    return null !== a
      ? ((this.sa = a), (this.key = a.key), (this.value = a.value), a)
      : null;
  };
  wb.prototype.any = function (a) {
    var b = this.oa;
    b.Pa = null;
    var c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) {
      if (a(d)) return !0;
      b.w !== c && Da(b);
      d = d.va;
    }
    return !1;
  };
  wb.prototype.all = function (a) {
    var b = this.oa;
    b.Pa = null;
    var c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) {
      if (!a(d)) return !1;
      b.w !== c && Da(b);
      d = d.va;
    }
    return !0;
  };
  wb.prototype.each = function (a) {
    var b = this.oa;
    b.Pa = null;
    var c = b.w;
    this.sa = null;
    for (var d = b.ga; null !== d; ) a(d), b.w !== c && Da(b), (d = d.va);
    return this;
  };
  wb.prototype.map = function (a) {
    var b = this.oa;
    b.Pa = null;
    var c = b.w;
    this.sa = null;
    for (var d = new H(), e = b.ga; null !== e; )
      d.add(a(e)), b.w !== c && Da(b), (e = e.va);
    return d.iterator;
  };
  wb.prototype.filter = function (a) {
    var b = this.oa;
    b.Pa = null;
    var c = b.w;
    this.sa = null;
    for (var d = new H(), e = b.ga; null !== e; )
      a(e) && d.add(e), b.w !== c && Da(b), (e = e.va);
    return d.iterator;
  };
  wb.prototype.Zd = function () {
    this.value = this.key = null;
    this.qa = -1;
    this.oa.Pa = this;
  };
  wb.prototype.toString = function () {
    return null !== this.sa ? "MapIterator@" + this.sa : "MapIterator";
  };
  oa.Object.defineProperties(wb.prototype, {
    iterator: {
      configurable: !0,
      get: function () {
        return this;
      },
    },
    count: {
      configurable: !0,
      get: function () {
        return this.oa.Qb;
      },
    },
  });
  wb.prototype.first = wb.prototype.first;
  wb.prototype.hasNext = wb.prototype.yd;
  wb.prototype.next = wb.prototype.next;
  wb.prototype.reset = wb.prototype.reset;
  wb.className = "MapIterator";
  function xb(a) {
    ab(this);
    this.u = !1;
    this.Rb = {};
    this.Qb = 0;
    this.gf = this.Pa = null;
    this.w = 0;
    this.hf = this.ga = null;
    ((G && "function" === typeof a) || "string" === typeof a) &&
      v(
        "Error: Since 2.0 List/Map/Set constructors no longer take an argument that enforces type."
      );
    void 0 !== a && this.addAll(a);
  }
  t = xb.prototype;
  t.sb = function () {
    var a = this.w;
    a++;
    999999999 < a && (a = 0);
    this.w = a;
  };
  t.freeze = function () {
    this.u = !0;
    return this;
  };
  t.la = function () {
    this.u = !1;
    return this;
  };
  t.toString = function () {
    return "Map()#" + lb(this);
  };
  t.add = function (a, b) {
    this.u && xa(this, a);
    var c = a;
    Ga(a) && (c = nb(a));
    var d = this.Rb[c];
    void 0 === d
      ? (this.Qb++,
        (a = new ob(a, b)),
        (this.Rb[c] = a),
        (c = this.hf),
        null === c ? (this.ga = a) : ((a.Nl = c), (c.va = a)),
        (this.hf = a),
        this.sb())
      : (d.value = b);
    return this;
  };
  t.set = function (a, b) {
    return this.add(a, b);
  };
  t.addAll = function (a) {
    if (null === a) return this;
    if (Ha(a))
      for (var b = a.length, c = 0; c < b; c++) {
        var d = a[c];
        this.add(d.key, d.value);
      }
    else if (a instanceof xb)
      for (a = a.iterator; a.next(); ) this.add(a.key, a.value);
    else
      for (a = a.iterator; a.next(); ) (b = a.value), this.add(b.key, b.value);
    return this;
  };
  t.first = function () {
    return this.ga;
  };
  xb.prototype.any = function (a) {
    for (var b = this.w, c = this.ga; null !== c; ) {
      if (a(c)) return !0;
      this.w !== b && Da(this);
      c = c.va;
    }
    return !1;
  };
  xb.prototype.all = function (a) {
    for (var b = this.w, c = this.ga; null !== c; ) {
      if (!a(c)) return !1;
      this.w !== b && Da(this);
      c = c.va;
    }
    return !0;
  };
  xb.prototype.each = function (a) {
    for (var b = this.w, c = this.ga; null !== c; )
      a(c), this.w !== b && Da(this), (c = c.va);
    return this;
  };
  xb.prototype.map = function (a) {
    for (var b = new xb(), c = this.w, d = this.ga; null !== d; )
      b.add(d.key, a(d)), this.w !== c && Da(this), (d = d.va);
    return b;
  };
  xb.prototype.filter = function (a) {
    for (var b = new xb(), c = this.w, d = this.ga; null !== d; )
      a(d) && b.add(d.key, d.value), this.w !== c && Da(this), (d = d.va);
    return b;
  };
  t = xb.prototype;
  t.contains = function (a) {
    var b = a;
    return Ga(a) && ((b = lb(a)), void 0 === b) ? !1 : void 0 !== this.Rb[b];
  };
  t.has = function (a) {
    return this.contains(a);
  };
  t.K = function (a) {
    var b = a;
    if (Ga(a) && ((b = lb(a)), void 0 === b)) return null;
    a = this.Rb[b];
    return void 0 === a ? null : a.value;
  };
  t.get = function (a) {
    return this.K(a);
  };
  t.remove = function (a) {
    if (null === a) return !1;
    this.u && xa(this, a);
    var b = a;
    if (Ga(a) && ((b = lb(a)), void 0 === b)) return !1;
    a = this.Rb[b];
    if (void 0 === a) return !1;
    var c = a.va,
      d = a.Nl;
    null !== c && (c.Nl = d);
    null !== d && (d.va = c);
    this.ga === a && (this.ga = c);
    this.hf === a && (this.hf = d);
    delete this.Rb[b];
    this.Qb--;
    this.sb();
    return !0;
  };
  t.delete = function (a) {
    return this.remove(a);
  };
  t.clear = function () {
    this.u && xa(this);
    this.Rb = {};
    this.Qb = 0;
    null !== this.Pa && this.Pa.reset();
    null !== this.gf && this.gf.reset();
    this.hf = this.ga = null;
    this.sb();
  };
  xb.prototype.copy = function () {
    var a = new xb(),
      b = this.Rb,
      c;
    for (c in b) {
      var d = b[c];
      a.add(d.key, d.value);
    }
    return a;
  };
  xb.prototype.Ga = function () {
    var a = this.Rb,
      b = Array(this.Qb),
      c = 0,
      d;
    for (d in a) {
      var e = a[d];
      b[c] = new ob(e.key, e.value);
      c++;
    }
    return b;
  };
  xb.prototype.Qf = function () {
    return new ub(this);
  };
  oa.Object.defineProperties(xb.prototype, {
    count: {
      configurable: !0,
      get: function () {
        return this.Qb;
      },
    },
    size: {
      configurable: !0,
      get: function () {
        return this.Qb;
      },
    },
    iterator: {
      configurable: !0,
      get: function () {
        if (0 >= this.count) return hb;
        var a = this.Pa;
        return null !== a ? (a.reset(), a) : new wb(this);
      },
    },
    iteratorKeys: {
      configurable: !0,
      get: function () {
        return 0 >= this.count ? hb : new rb(this);
      },
    },
    iteratorValues: {
      configurable: !0,
      get: function () {
        if (0 >= this.count) return hb;
        var a = this.gf;
        return null !== a ? (a.reset(), a) : new vb(this);
      },
    },
  });
  xb.prototype.toKeySet = xb.prototype.Qf;
  xb.prototype.toArray = xb.prototype.Ga;
  xb.prototype.clear = xb.prototype.clear;
  xb.prototype["delete"] = xb.prototype.delete;
  xb.prototype.remove = xb.prototype.remove;
  xb.prototype.get = xb.prototype.get;
  xb.prototype.getValue = xb.prototype.K;
  xb.prototype.has = xb.prototype.has;
  xb.prototype.contains = xb.prototype.contains;
  xb.prototype.first = xb.prototype.first;
  xb.prototype.addAll = xb.prototype.addAll;
  xb.prototype.set = xb.prototype.set;
  xb.prototype.add = xb.prototype.add;
  xb.prototype.thaw = xb.prototype.la;
  xb.prototype.freeze = xb.prototype.freeze;
  xb.className = "Map";
  function K(a, b) {
    void 0 === a
      ? (this.J = this.I = 0)
      : "number" === typeof a && "number" === typeof b
      ? ((this.I = a), (this.J = b))
      : v("Invalid arguments to Point constructor: " + a + ", " + b);
    this.u = !1;
  }
  var yb, zb, Ab, Bb, Cb;
  K.prototype.assign = function (a) {
    this.I = a.I;
    this.J = a.J;
    return this;
  };
  K.prototype.h = function (a, b) {
    this.I = a;
    this.J = b;
    return this;
  };
  K.prototype.yg = function (a, b) {
    G &&
      (A(a, "number", K, "setTo:x"), A(b, "number", K, "setTo:y"), this.ha());
    this.I = a;
    this.J = b;
    return this;
  };
  K.prototype.set = function (a) {
    G && (x(a, K, K, "set:p"), this.ha());
    this.I = a.I;
    this.J = a.J;
    return this;
  };
  K.prototype.copy = function () {
    var a = new K();
    a.I = this.I;
    a.J = this.J;
    return a;
  };
  t = K.prototype;
  t.ia = function () {
    this.u = !0;
    Object.freeze(this);
    return this;
  };
  t.L = function () {
    return this.u || Object.isFrozen(this) ? this : this.copy().freeze();
  };
  t.freeze = function () {
    this.u = !0;
    return this;
  };
  t.la = function () {
    Object.isFrozen(this) && v("cannot thaw constant: " + this);
    this.u = !1;
    return this;
  };
  t.ha = function (a) {
    if (G && this.u) {
      var b =
        "The Point is frozen, so its properties cannot be set: " +
        this.toString();
      void 0 !== a && (b += "  to value: " + a);
      v(b);
    }
  };
  function Db(a) {
    if ("string" === typeof a) {
      a = a.split(" ");
      for (var b = 0, c = 0; "" === a[b]; ) b++;
      var d = a[b++];
      d && (c = parseFloat(d));
      for (var e = 0; "" === a[b]; ) b++;
      (d = a[b++]) && (e = parseFloat(d));
      return new K(c, e);
    }
    return new K();
  }
  function Eb(a) {
    G && x(a, K);
    return a.x.toString() + " " + a.y.toString();
  }
  t.toString = function () {
    return "Point(" + this.x + "," + this.y + ")";
  };
  t.D = function (a) {
    return a instanceof K ? this.I === a.x && this.J === a.y : !1;
  };
  t.Oi = function (a, b) {
    return this.I === a && this.J === b;
  };
  t.$a = function (a) {
    return L.C(this.I, a.x) && L.C(this.J, a.y);
  };
  t.add = function (a) {
    G && (x(a, K, K, "add:p"), this.ha());
    this.I += a.x;
    this.J += a.y;
    return this;
  };
  t.ne = function (a) {
    G && (x(a, K, K, "subtract:p"), this.ha());
    this.I -= a.x;
    this.J -= a.y;
    return this;
  };
  t.offset = function (a, b) {
    G && (D(a, K, "offset:dx"), D(b, K, "offset:dy"), this.ha());
    this.I += a;
    this.J += b;
    return this;
  };
  K.prototype.rotate = function (a) {
    G && (D(a, K, "rotate:angle"), this.ha());
    if (0 === a) return this;
    var b = this.I,
      c = this.J;
    if (0 === b && 0 === c) return this;
    360 <= a ? (a -= 360) : 0 > a && (a += 360);
    if (90 === a) {
      a = 0;
      var d = 1;
    } else
      180 === a
        ? ((a = -1), (d = 0))
        : 270 === a
        ? ((a = 0), (d = -1))
        : ((d = (a * Math.PI) / 180), (a = Math.cos(d)), (d = Math.sin(d)));
    this.I = a * b - d * c;
    this.J = d * b + a * c;
    return this;
  };
  t = K.prototype;
  t.scale = function (a, b) {
    G && (D(a, K, "scale:sx"), D(b, K, "scale:sy"), this.ha());
    this.I *= a;
    this.J *= b;
    return this;
  };
  t.Ff = function (a) {
    G && x(a, K, K, "distanceSquaredPoint:p");
    var b = a.x - this.I;
    a = a.y - this.J;
    return b * b + a * a;
  };
  t.xd = function (a, b) {
    G && (D(a, K, "distanceSquared:px"), D(b, K, "distanceSquared:py"));
    a -= this.I;
    b -= this.J;
    return a * a + b * b;
  };
  t.normalize = function () {
    G && this.ha();
    var a = this.I,
      b = this.J,
      c = Math.sqrt(a * a + b * b);
    0 < c && ((this.I = a / c), (this.J = b / c));
    return this;
  };
  t.Ya = function (a) {
    G && x(a, K, K, "directionPoint:p");
    return Fb(a.x - this.I, a.y - this.J);
  };
  t.direction = function (a, b) {
    G && (D(a, K, "direction:px"), D(b, K, "direction:py"));
    return Fb(a - this.I, b - this.J);
  };
  function Fb(a, b) {
    if (0 === a) return 0 < b ? 90 : 0 > b ? 270 : 0;
    if (0 === b) return 0 < a ? 0 : 180;
    if (isNaN(a) || isNaN(b)) return 0;
    var c = (180 * Math.atan(Math.abs(b / a))) / Math.PI;
    0 > a ? (c = 0 > b ? c + 180 : 180 - c) : 0 > b && (c = 360 - c);
    return c;
  }
  t.yz = function (a, b) {
    G &&
      (x(a, K, K, "compareWithLineSegmentPoint:p"),
      x(b, K, K, "compareWithLineSegmentPoint:q"));
    return L.hm(a.x, a.y, b.x, b.y, this.x, this.y);
  };
  t.NA = function (a, b, c, d) {
    G &&
      (D(a, K, "projectOntoLineSegment:px"),
      D(b, K, "projectOntoLineSegment:py"),
      D(c, K, "projectOntoLineSegment:qx"),
      D(d, K, "projectOntoLineSegment:qy"));
    L.Nh(a, b, c, d, this.I, this.J, this);
    return this;
  };
  t.OA = function (a, b) {
    G &&
      (x(a, K, K, "projectOntoLineSegmentPoint:p"),
      x(b, K, K, "projectOntoLineSegmentPoint:q"));
    L.Nh(a.x, a.y, b.x, b.y, this.I, this.J, this);
    return this;
  };
  t.bB = function (a, b, c, d) {
    G &&
      (D(a, K, "snapToGrid:originx"),
      D(b, K, "snapToGrid:originy"),
      D(c, K, "snapToGrid:cellwidth"),
      D(d, K, "snapToGrid:cellheight"));
    L.gq(this.I, this.J, a, b, c, d, this);
    return this;
  };
  t.cB = function (a, b) {
    G && (x(a, K, K, "snapToGridPoint:p"), x(b, Gb, K, "snapToGridPoint:q"));
    L.gq(this.I, this.J, a.x, a.y, b.width, b.height, this);
    return this;
  };
  t.cj = function (a, b) {
    G &&
      (x(a, M, K, "setRectSpot:r"), x(b, Ib, K, "setRectSpot:spot"), this.ha());
    this.I = a.x + b.x * a.width + b.offsetX;
    this.J = a.y + b.y * a.height + b.offsetY;
    return this;
  };
  t.dj = function (a, b, c, d, e) {
    G &&
      (D(a, K, "setSpot:x"),
      D(b, K, "setSpot:y"),
      D(c, K, "setSpot:w"),
      D(d, K, "setSpot:h"),
      (0 > c || 0 > d) &&
        v("Point.setSpot:Width and height cannot be negative"),
      x(e, Ib, K, "setSpot:spot"),
      this.ha());
    this.I = a + e.x * c + e.offsetX;
    this.J = b + e.y * d + e.offsetY;
    return this;
  };
  t.transform = function (a) {
    G && x(a, Kb, K, "transform:t");
    a.Ha(this);
    return this;
  };
  function Lb(a, b) {
    G && x(b, Kb, K, "transformInverted:t");
    b.Od(a);
    return a;
  }
  function Mb(a, b, c, d, e, f) {
    G &&
      (D(a, K, "distanceLineSegmentSquared:px"),
      D(b, K, "distanceLineSegmentSquared:py"),
      D(c, K, "distanceLineSegmentSquared:ax"),
      D(d, K, "distanceLineSegmentSquared:ay"),
      D(e, K, "distanceLineSegmentSquared:bx"),
      D(f, K, "distanceLineSegmentSquared:by"));
    var g = e - c,
      h = f - d,
      k = g * g + h * h;
    c -= a;
    d -= b;
    var l = -c * g - d * h;
    if (0 >= l || l >= k)
      return (g = e - a), (h = f - b), Math.min(c * c + d * d, g * g + h * h);
    a = g * d - h * c;
    return (a * a) / k;
  }
  function Nb(a, b, c, d) {
    G &&
      (D(a, K, "distanceSquared:px"),
      D(b, K, "distanceSquared:py"),
      D(c, K, "distanceSquared:qx"),
      D(d, K, "distanceSquared:qy"));
    a = c - a;
    b = d - b;
    return a * a + b * b;
  }
  function Ob(a, b, c, d) {
    G &&
      (D(a, K, "direction:px"),
      D(b, K, "direction:py"),
      D(c, K, "direction:qx"),
      D(d, K, "direction:qy"));
    a = c - a;
    b = d - b;
    if (0 === a) return 0 < b ? 90 : 0 > b ? 270 : 0;
    if (0 === b) return 0 < a ? 0 : 180;
    if (isNaN(a) || isNaN(b)) return 0;
    d = (180 * Math.atan(Math.abs(b / a))) / Math.PI;
    0 > a ? (d = 0 > b ? d + 180 : 180 - d) : 0 > b && (d = 360 - d);
    return d;
  }
  t.s = function () {
    return isFinite(this.x) && isFinite(this.y);
  };
  K.alloc = function () {
    var a = Pb.pop();
    return void 0 === a ? new K() : a;
  };
  K.allocAt = function (a, b) {
    var c = Pb.pop();
    if (void 0 === c) return new K(a, b);
    c.x = a;
    c.y = b;
    return c;
  };
  K.free = function (a) {
    Pb.push(a);
  };
  oa.Object.defineProperties(K.prototype, {
    x: {
      configurable: !0,
      get: function () {
        return this.I;
      },
      set: function (a) {
        G && (A(a, "number", K, "x"), this.ha(a));
        this.I = a;
      },
    },
    y: {
      configurable: !0,
      get: function () {
        return this.J;
      },
      set: function (a) {
        G && (A(a, "number", K, "y"), this.ha(a));
        this.J = a;
      },
    },
  });
  K.prototype.isReal = K.prototype.s;
  K.prototype.setSpot = K.prototype.dj;
  K.prototype.setRectSpot = K.prototype.cj;
  K.prototype.snapToGridPoint = K.prototype.cB;
  K.prototype.snapToGrid = K.prototype.bB;
  K.prototype.projectOntoLineSegmentPoint = K.prototype.OA;
  K.prototype.projectOntoLineSegment = K.prototype.NA;
  K.intersectingLineSegments = function (a, b, c, d, e, f, g, h) {
    G &&
      (D(a, K, "intersectingLineSegments:a1x"),
      D(b, K, "intersectingLineSegments:a1y"),
      D(c, K, "intersectingLineSegments:a2x"),
      D(d, K, "intersectingLineSegments:a2y"),
      D(e, K, "intersectingLineSegments:b1x"),
      D(f, K, "intersectingLineSegments:b1y"),
      D(g, K, "intersectingLineSegments:b2x"),
      D(h, K, "intersectingLineSegments:b2y"));
    return L.om(a, b, c, d, e, f, g, h);
  };
  K.prototype.compareWithLineSegmentPoint = K.prototype.yz;
  K.compareWithLineSegment = function (a, b, c, d, e, f) {
    G &&
      (D(a, K, "compareWithLineSegment:a1x"),
      D(b, K, "compareWithLineSegment:a1y"),
      D(c, K, "compareWithLineSegment:a2x"),
      D(d, K, "compareWithLineSegment:a2y"),
      D(e, K, "compareWithLineSegment:b1x"),
      D(f, K, "compareWithLineSegment:b1y"));
    return L.hm(a, b, c, d, e, f);
  };
  K.prototype.direction = K.prototype.direction;
  K.prototype.directionPoint = K.prototype.Ya;
  K.prototype.normalize = K.prototype.normalize;
  K.prototype.distanceSquared = K.prototype.xd;
  K.prototype.distanceSquaredPoint = K.prototype.Ff;
  K.prototype.scale = K.prototype.scale;
  K.prototype.rotate = K.prototype.rotate;
  K.prototype.offset = K.prototype.offset;
  K.prototype.subtract = K.prototype.ne;
  K.prototype.add = K.prototype.add;
  K.prototype.equalsApprox = K.prototype.$a;
  K.prototype.equalTo = K.prototype.Oi;
  K.prototype.equals = K.prototype.D;
  K.prototype.set = K.prototype.set;
  K.prototype.setTo = K.prototype.yg;
  var Pb = [];
  K.className = "Point";
  K.parse = Db;
  K.stringify = Eb;
  K.distanceLineSegmentSquared = Mb;
  K.distanceSquared = Nb;
  K.direction = Ob;
  K.Origin = yb = new K(0, 0).ia();
  K.InfiniteTopLeft = zb = new K(-Infinity, -Infinity).ia();
  K.InfiniteBottomRight = Ab = new K(Infinity, Infinity).ia();
  K.SixPoint = Bb = new K(6, 6).ia();
  K.NoPoint = Cb = new K(NaN, NaN).ia();
  K.parse = Db;
  K.stringify = Eb;
  K.distanceLineSegmentSquared = Mb;
  K.distanceSquared = Nb;
  K.direction = Ob;
  function Gb(a, b) {
    void 0 === a
      ? (this.ea = this.fa = 0)
      : "number" === typeof a &&
        (0 <= a || isNaN(a)) &&
        "number" === typeof b &&
        (0 <= b || isNaN(b))
      ? ((this.fa = a), (this.ea = b))
      : v("Invalid arguments to Size constructor: " + a + ", " + b);
    this.u = !1;
  }
  var Rb, Sb, Tb, Xb, Yb, Zb, $b;
  Gb.prototype.assign = function (a) {
    this.fa = a.fa;
    this.ea = a.ea;
    return this;
  };
  Gb.prototype.h = function (a, b) {
    this.fa = a;
    this.ea = b;
    return this;
  };
  Gb.prototype.yg = function (a, b) {
    G &&
      (A(a, "number", Gb, "setTo:w"),
      A(b, "number", Gb, "setTo:h"),
      0 > a && Aa(a, ">= 0", Gb, "setTo:w"),
      0 > b && Aa(b, ">= 0", Gb, "setTo:h"),
      this.ha());
    this.fa = a;
    this.ea = b;
    return this;
  };
  Gb.prototype.set = function (a) {
    G && (x(a, Gb, Gb, "set:s"), this.ha());
    this.fa = a.fa;
    this.ea = a.ea;
    return this;
  };
  Gb.prototype.copy = function () {
    var a = new Gb();
    a.fa = this.fa;
    a.ea = this.ea;
    return a;
  };
  t = Gb.prototype;
  t.ia = function () {
    this.u = !0;
    Object.freeze(this);
    return this;
  };
  t.L = function () {
    return this.u || Object.isFrozen(this) ? this : this.copy().freeze();
  };
  t.freeze = function () {
    this.u = !0;
    return this;
  };
  t.la = function () {
    Object.isFrozen(this) && v("cannot thaw constant: " + this);
    this.u = !1;
    return this;
  };
  t.ha = function (a) {
    if (G && this.u) {
      var b =
        "The Size is frozen, so its properties cannot be set: " +
        this.toString();
      void 0 !== a && (b += "  to value: " + a);
      v(b);
    }
  };
  function ac(a) {
    if ("string" === typeof a) {
      a = a.split(" ");
      for (var b = 0, c = 0; "" === a[b]; ) b++;
      var d = a[b++];
      d && (c = parseFloat(d));
      for (var e = 0; "" === a[b]; ) b++;
      (d = a[b++]) && (e = parseFloat(d));
      return new Gb(c, e);
    }
    return new Gb();
  }
  function bc(a) {
    G && x(a, Gb);
    return a.width.toString() + " " + a.height.toString();
  }
  t.toString = function () {
    return "Size(" + this.width + "," + this.height + ")";
  };
  t.D = function (a) {
    return a instanceof Gb ? this.fa === a.width && this.ea === a.height : !1;
  };
  t.Oi = function (a, b) {
    return this.fa === a && this.ea === b;
  };
  t.$a = function (a) {
    return L.C(this.fa, a.width) && L.C(this.ea, a.height);
  };
  t.s = function () {
    return isFinite(this.width) && isFinite(this.height);
  };
  Gb.alloc = function () {
    var a = cc.pop();
    return void 0 === a ? new Gb() : a;
  };
  Gb.free = function (a) {
    cc.push(a);
  };
  oa.Object.defineProperties(Gb.prototype, {
    width: {
      configurable: !0,
      get: function () {
        return this.fa;
      },
      set: function (a) {
        G && (A(a, "number", Gb, "width"), this.ha(a));
        0 > a && Aa(a, ">= 0", Gb, "width");
        this.fa = a;
      },
    },
    height: {
      configurable: !0,
      get: function () {
        return this.ea;
      },
      set: function (a) {
        G && (A(a, "number", Gb, "height"), this.ha(a));
        0 > a && Aa(a, ">= 0", Gb, "height");
        this.ea = a;
      },
    },
  });
  Gb.prototype.isReal = Gb.prototype.s;
  Gb.prototype.equalsApprox = Gb.prototype.$a;
  Gb.prototype.equalTo = Gb.prototype.Oi;
  Gb.prototype.equals = Gb.prototype.D;
  Gb.prototype.set = Gb.prototype.set;
  Gb.prototype.setTo = Gb.prototype.yg;
  var cc = [];
  Gb.className = "Size";
  Gb.parse = ac;
  Gb.stringify = bc;
  Gb.ZeroSize = Rb = new Gb(0, 0).ia();
  Gb.OneSize = Sb = new Gb(1, 1).ia();
  Gb.SixSize = Tb = new Gb(6, 6).ia();
  Gb.EightSize = Xb = new Gb(8, 8).ia();
  Gb.TenSize = Yb = new Gb(10, 10).ia();
  Gb.InfiniteSize = Zb = new Gb(Infinity, Infinity).ia();
  Gb.NoSize = $b = new Gb(NaN, NaN).ia();
  Gb.parse = ac;
  Gb.stringify = bc;
  function M(a, b, c, d) {
    void 0 === a
      ? (this.ea = this.fa = this.J = this.I = 0)
      : "number" === typeof a &&
        "number" === typeof b &&
        "number" === typeof c &&
        (0 <= c || isNaN(c)) &&
        "number" === typeof d &&
        (0 <= d || isNaN(d))
      ? ((this.I = a), (this.J = b), (this.fa = c), (this.ea = d))
      : a instanceof K
      ? ((c = a.x),
        (a = a.y),
        b instanceof K
          ? ((d = b.x),
            (b = b.y),
            (this.I = Math.min(c, d)),
            (this.J = Math.min(a, b)),
            (this.fa = Math.abs(c - d)),
            (this.ea = Math.abs(a - b)))
          : b instanceof Gb
          ? ((this.I = c),
            (this.J = a),
            (this.fa = b.width),
            (this.ea = b.height))
          : v("Incorrect second argument supplied to Rect constructor " + b))
      : v(
          "Invalid arguments to Rect constructor: " +
            a +
            ", " +
            b +
            ", " +
            c +
            ", " +
            d
        );
    this.u = !1;
  }
  t = M.prototype;
  t.assign = function (a) {
    this.I = a.I;
    this.J = a.J;
    this.fa = a.fa;
    this.ea = a.ea;
    return this;
  };
  t.h = function (a, b, c, d) {
    this.I = a;
    this.J = b;
    this.fa = c;
    this.ea = d;
    return this;
  };
  function dc(a, b, c) {
    a.fa = b;
    a.ea = c;
  }
  t.yg = function (a, b, c, d) {
    G &&
      (A(a, "number", M, "setTo:x"),
      A(b, "number", M, "setTo:y"),
      A(c, "number", M, "setTo:w"),
      A(d, "number", M, "setTo:h"),
      0 > c && Aa(c, ">= 0", M, "setTo:w"),
      0 > d && Aa(d, ">= 0", M, "setTo:h"),
      this.ha());
    this.I = a;
    this.J = b;
    this.fa = c;
    this.ea = d;
    return this;
  };
  t.set = function (a) {
    G && (x(a, M, M, "set:r"), this.ha());
    this.I = a.I;
    this.J = a.J;
    this.fa = a.fa;
    this.ea = a.ea;
    return this;
  };
  t.Wc = function (a) {
    G && (x(a, K, M, "setPoint:p"), this.ha());
    this.I = a.x;
    this.J = a.y;
    return this;
  };
  t.aB = function (a) {
    G && (x(a, Gb, M, "setSize:s"), this.ha());
    this.fa = a.width;
    this.ea = a.height;
    return this;
  };
  M.prototype.copy = function () {
    var a = new M();
    a.I = this.I;
    a.J = this.J;
    a.fa = this.fa;
    a.ea = this.ea;
    return a;
  };
  t = M.prototype;
  t.ia = function () {
    this.u = !0;
    Object.freeze(this);
    return this;
  };
  t.L = function () {
    return this.u || Object.isFrozen(this) ? this : this.copy().freeze();
  };
  t.freeze = function () {
    this.u = !0;
    return this;
  };
  t.la = function () {
    Object.isFrozen(this) && v("cannot thaw constant: " + this);
    this.u = !1;
    return this;
  };
  t.ha = function (a) {
    if (G && this.u) {
      var b =
        "The Rect is frozen, so its properties cannot be set: " +
        this.toString();
      void 0 !== a && (b += "  to value: " + a);
      v(b);
    }
  };
  function ec(a) {
    if ("string" === typeof a) {
      a = a.split(" ");
      for (var b = 0, c = 0; "" === a[b]; ) b++;
      var d = a[b++];
      d && (c = parseFloat(d));
      for (var e = 0; "" === a[b]; ) b++;
      (d = a[b++]) && (e = parseFloat(d));
      for (var f = 0; "" === a[b]; ) b++;
      (d = a[b++]) && (f = parseFloat(d));
      for (var g = 0; "" === a[b]; ) b++;
      (d = a[b++]) && (g = parseFloat(d));
      return new M(c, e, f, g);
    }
    return new M();
  }
  function fc(a) {
    G && x(a, M);
    return (
      a.x.toString() +
      " " +
      a.y.toString() +
      " " +
      a.width.toString() +
      " " +
      a.height.toString()
    );
  }
  t.toString = function () {
    return (
      "Rect(" +
      this.x +
      "," +
      this.y +
      "," +
      this.width +
      "," +
      this.height +
      ")"
    );
  };
  t.D = function (a) {
    return a instanceof M
      ? this.I === a.x &&
          this.J === a.y &&
          this.fa === a.width &&
          this.ea === a.height
      : !1;
  };
  t.Oi = function (a, b, c, d) {
    return this.I === a && this.J === b && this.fa === c && this.ea === d;
  };
  t.$a = function (a) {
    return (
      L.C(this.I, a.x) &&
      L.C(this.J, a.y) &&
      L.C(this.fa, a.width) &&
      L.C(this.ea, a.height)
    );
  };
  function gc(a, b) {
    return (
      L.da(a.I, b.x) &&
      L.da(a.J, b.y) &&
      L.da(a.fa, b.width) &&
      L.da(a.ea, b.height)
    );
  }
  t.ca = function (a) {
    G && x(a, K, M, "containsPoint:p");
    return (
      this.I <= a.x &&
      this.I + this.fa >= a.x &&
      this.J <= a.y &&
      this.J + this.ea >= a.y
    );
  };
  t.Qe = function (a) {
    G && x(a, M, M, "containsRect:r");
    return (
      this.I <= a.x &&
      a.x + a.width <= this.I + this.fa &&
      this.J <= a.y &&
      a.y + a.height <= this.J + this.ea
    );
  };
  t.contains = function (a, b, c, d) {
    G
      ? (D(a, M, "contains:x"),
        D(b, M, "contains:y"),
        void 0 === c ? (c = 0) : D(c, M, "contains:w"),
        void 0 === d ? (d = 0) : D(d, M, "contains:h"),
        (0 > c || 0 > d) &&
          v("Rect.contains:Width and height cannot be negative"))
      : (void 0 === c && (c = 0), void 0 === d && (d = 0));
    return (
      this.I <= a &&
      a + c <= this.I + this.fa &&
      this.J <= b &&
      b + d <= this.J + this.ea
    );
  };
  t.offset = function (a, b) {
    G && (D(a, M, "offset:dx"), D(b, M, "offset:dy"), this.ha());
    this.I += a;
    this.J += b;
    return this;
  };
  t.Qc = function (a, b) {
    G && (D(a, M, "inflate:w"), D(b, M, "inflate:h"));
    return hc(this, b, a, b, a);
  };
  t.Up = function (a) {
    G && x(a, ic, M, "addMargin:m");
    return hc(this, a.top, a.right, a.bottom, a.left);
  };
  t.cw = function (a) {
    G && x(a, ic, M, "subtractMargin:m");
    return hc(this, -a.top, -a.right, -a.bottom, -a.left);
  };
  t.qA = function (a, b, c, d) {
    G &&
      (D(a, M, "grow:t"),
      D(b, M, "grow:r"),
      D(c, M, "grow:b"),
      D(d, M, "grow:l"));
    return hc(this, a, b, c, d);
  };
  function hc(a, b, c, d, e) {
    G && a.ha();
    var f = a.fa;
    c + e <= -f ? ((a.I += f / 2), (a.fa = 0)) : ((a.I -= e), (a.fa += c + e));
    c = a.ea;
    b + d <= -c ? ((a.J += c / 2), (a.ea = 0)) : ((a.J -= b), (a.ea += b + d));
    return a;
  }
  t.jy = function (a) {
    G && x(a, M, M, "intersectRect:r");
    return kc(this, a.x, a.y, a.width, a.height);
  };
  t.Av = function (a, b, c, d) {
    G &&
      (D(a, M, "intersect:x"),
      D(b, M, "intersect:y"),
      D(c, M, "intersect:w"),
      D(d, M, "intersect:h"),
      (0 > c || 0 > d) &&
        v("Rect.intersect:Width and height cannot be negative"));
    return kc(this, a, b, c, d);
  };
  function kc(a, b, c, d, e) {
    G && a.ha();
    var f = Math.max(a.I, b),
      g = Math.max(a.J, c);
    b = Math.min(a.I + a.fa, b + d);
    c = Math.min(a.J + a.ea, c + e);
    a.I = f;
    a.J = g;
    a.fa = Math.max(0, b - f);
    a.ea = Math.max(0, c - g);
    return a;
  }
  t.Sc = function (a) {
    G && x(a, M, M, "intersectsRect:r");
    return this.Bv(a.x, a.y, a.width, a.height);
  };
  t.Bv = function (a, b, c, d) {
    G &&
      (D(a, M, "intersects:x"),
      D(b, M, "intersects:y"),
      D(a, M, "intersects:w"),
      D(b, M, "intersects:h"),
      (0 > c || 0 > d) &&
        v("Rect.intersects:Width and height cannot be negative"));
    var e = this.fa,
      f = this.I;
    if (
      Infinity !== e &&
      Infinity !== c &&
      ((e += f), (c += a), isNaN(c) || isNaN(e) || f > c || a > e)
    )
      return !1;
    a = this.ea;
    c = this.J;
    return Infinity !== a &&
      Infinity !== d &&
      ((a += c), (d += b), isNaN(d) || isNaN(a) || c > d || b > a)
      ? !1
      : !0;
  };
  function lc(a, b) {
    var c = a.fa,
      d = a.I,
      e = b.x - 10;
    if (d > b.width + 10 + 10 + e || e > c + d) return !1;
    c = a.ea;
    a = a.J;
    d = b.y - 10;
    return a > b.height + 10 + 10 + d || d > c + a ? !1 : !0;
  }
  t.Ye = function (a) {
    G && x(a, K, M, "unionPoint:p");
    return mc(this, a.x, a.y, 0, 0);
  };
  t.Xc = function (a) {
    G && x(a, M, M, "unionRect:r");
    return mc(this, a.I, a.J, a.fa, a.ea);
  };
  t.gw = function (a, b, c, d) {
    G
      ? (D(a, M, "union:x"),
        D(b, M, "union:y"),
        void 0 === c ? (c = 0) : D(c, M, "union:w"),
        void 0 === d ? (d = 0) : D(d, M, "union:h"),
        (0 > c || 0 > d) && v("Rect.union:Width and height cannot be negative"),
        this.ha())
      : (void 0 === c && (c = 0), void 0 === d && (d = 0));
    return mc(this, a, b, c, d);
  };
  function mc(a, b, c, d, e) {
    var f = Math.min(a.I, b),
      g = Math.min(a.J, c);
    b = Math.max(a.I + a.fa, b + d);
    c = Math.max(a.J + a.ea, c + e);
    a.I = f;
    a.J = g;
    a.fa = b - f;
    a.ea = c - g;
    return a;
  }
  t.dj = function (a, b, c) {
    G &&
      (D(a, M, "setSpot:x"),
      D(b, M, "setSpot:y"),
      x(c, Ib, M, "setSpot:spot"),
      this.ha());
    this.I = a - c.offsetX - c.x * this.fa;
    this.J = b - c.offsetY - c.y * this.ea;
    return this;
  };
  function nc(a, b, c, d, e, f, g, h) {
    G
      ? (D(a, M, "contains:rx"),
        D(b, M, "contains:ry"),
        D(c, M, "contains:rw"),
        D(d, M, "contains:rh"),
        D(e, M, "contains:x"),
        D(f, M, "contains:y"),
        void 0 === g ? (g = 0) : D(g, M, "contains:w"),
        void 0 === h ? (h = 0) : D(h, M, "contains:h"),
        (0 > c || 0 > d || 0 > g || 0 > h) &&
          v("Rect.contains:Width and height cannot be negative"))
      : (void 0 === g && (g = 0), void 0 === h && (h = 0));
    return a <= e && e + g <= a + c && b <= f && f + h <= b + d;
  }
  function oc(a, b, c, d, e, f, g, h) {
    G &&
      (D(a, M, "intersects:rx"),
      D(b, M, "intersects:ry"),
      D(c, M, "intersects:rw"),
      D(d, M, "intersects:rh"),
      D(e, M, "intersects:x"),
      D(f, M, "intersects:y"),
      D(g, M, "intersects:w"),
      D(h, M, "intersects:h"),
      (0 > c || 0 > d || 0 > g || 0 > h) &&
        v("Rect.intersects:Width and height cannot be negative"));
    return a > g + e || e > c + a ? !1 : b > h + f || f > d + b ? !1 : !0;
  }
  t.s = function () {
    return (
      isFinite(this.x) &&
      isFinite(this.y) &&
      isFinite(this.width) &&
      isFinite(this.height)
    );
  };
  t.wA = function () {
    return 0 === this.width && 0 === this.height;
  };
  M.alloc = function () {
    var a = pc.pop();
    return void 0 === a ? new M() : a;
  };
  M.allocAt = function (a, b, c, d) {
    var e = pc.pop();
    return void 0 === e ? new M(a, b, c, d) : e.h(a, b, c, d);
  };
  M.free = function (a) {
    pc.push(a);
  };
  oa.Object.defineProperties(M.prototype, {
    x: {
      configurable: !0,
      get: function () {
        return this.I;
      },
      set: function (a) {
        G && (A(a, "number", M, "x"), this.ha(a));
        this.I = a;
      },
    },
    y: {
      configurable: !0,
      get: function () {
        return this.J;
      },
      set: function (a) {
        G && (A(a, "number", M, "y"), this.ha(a));
        this.J = a;
      },
    },
    width: {
      configurable: !0,
      get: function () {
        return this.fa;
      },
      set: function (a) {
        G && (A(a, "number", M, "width"), this.ha(a));
        0 > a && Aa(a, ">= 0", M, "width");
        this.fa = a;
      },
    },
    height: {
      configurable: !0,
      get: function () {
        return this.ea;
      },
      set: function (a) {
        G && (A(a, "number", M, "height"), this.ha(a));
        0 > a && Aa(a, ">= 0", M, "height");
        this.ea = a;
      },
    },
    left: {
      configurable: !0,
      get: function () {
        return this.I;
      },
      set: function (a) {
        G && (A(a, "number", M, "left"), this.ha(a));
        this.I = a;
      },
    },
    top: {
      configurable: !0,
      get: function () {
        return this.J;
      },
      set: function (a) {
        G && (A(a, "number", M, "top"), this.ha(a));
        this.J = a;
      },
    },
    right: {
      configurable: !0,
      get: function () {
        return this.I + this.fa;
      },
      set: function (a) {
        G && (D(a, M, "right"), this.ha(a));
        this.I += a - (this.I + this.fa);
      },
    },
    bottom: {
      configurable: !0,
      get: function () {
        return this.J + this.ea;
      },
      set: function (a) {
        G && (D(a, M, "top"), this.ha(a));
        this.J += a - (this.J + this.ea);
      },
    },
    position: {
      configurable: !0,
      get: function () {
        return new K(this.I, this.J);
      },
      set: function (a) {
        G && (x(a, K, M, "position"), this.ha(a));
        this.I = a.x;
        this.J = a.y;
      },
    },
    size: {
      configurable: !0,
      get: function () {
        return new Gb(this.fa, this.ea);
      },
      set: function (a) {
        G && (x(a, Gb, M, "size"), this.ha(a));
        this.fa = a.width;
        this.ea = a.height;
      },
    },
    center: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return new K(this.I + this.fa / 2, this.J + this.ea / 2);
      },
      set: function (a) {
        G && (x(a, K, M, "center"), this.ha(a));
        this.I = a.x - this.fa / 2;
        this.J = a.y - this.ea / 2;
      },
    },
    centerX: {
      configurable: !0,
      get: function () {
        return this.I + this.fa / 2;
      },
      set: function (a) {
        G && (D(a, M, "centerX"), this.ha(a));
        this.I = a - this.fa / 2;
      },
    },
    centerY: {
      configurable: !0,
      get: function () {
        return this.J + this.ea / 2;
      },
      set: function (a) {
        G && (D(a, M, "centerY"), this.ha(a));
        this.J = a - this.ea / 2;
      },
    },
  });
  M.prototype.isEmpty = M.prototype.wA;
  M.prototype.isReal = M.prototype.s;
  M.intersectsLineSegment = function (a, b, c, d, e, f, g, h) {
    G &&
      (D(a, M, "intersectsLineSegment:x"),
      D(b, M, "intersectsLineSegment:y"),
      D(c, M, "intersectsLineSegment:w"),
      D(d, M, "intersectsLineSegment:h"),
      D(e, M, "intersectsLineSegment:p1x"),
      D(f, M, "intersectsLineSegment:p1y"),
      D(g, M, "intersectsLineSegment:p2x"),
      D(h, M, "intersectsLineSegment:p2y"),
      (0 > c || 0 > d) &&
        v("Rect.intersectsLineSegment: width and height cannot be negative"));
    return L.ky(a, b, c, d, e, f, g, h);
  };
  M.prototype.setSpot = M.prototype.dj;
  M.prototype.union = M.prototype.gw;
  M.prototype.unionRect = M.prototype.Xc;
  M.prototype.unionPoint = M.prototype.Ye;
  M.prototype.intersects = M.prototype.Bv;
  M.prototype.intersectsRect = M.prototype.Sc;
  M.prototype.intersect = M.prototype.Av;
  M.prototype.intersectRect = M.prototype.jy;
  M.prototype.grow = M.prototype.qA;
  M.prototype.subtractMargin = M.prototype.cw;
  M.prototype.addMargin = M.prototype.Up;
  M.prototype.inflate = M.prototype.Qc;
  M.prototype.offset = M.prototype.offset;
  M.prototype.contains = M.prototype.contains;
  M.prototype.containsRect = M.prototype.Qe;
  M.prototype.containsPoint = M.prototype.ca;
  M.prototype.equalsApprox = M.prototype.$a;
  M.prototype.equalTo = M.prototype.Oi;
  M.prototype.equals = M.prototype.D;
  M.prototype.setSize = M.prototype.aB;
  M.prototype.setPoint = M.prototype.Wc;
  M.prototype.set = M.prototype.set;
  M.prototype.setTo = M.prototype.yg;
  var qc = null,
    uc = null,
    pc = [];
  M.className = "Rect";
  M.parse = ec;
  M.stringify = fc;
  M.contains = nc;
  M.intersects = oc;
  M.ZeroRect = qc = new M(0, 0, 0, 0).ia();
  M.NoRect = uc = new M(NaN, NaN, NaN, NaN).ia();
  M.parse = ec;
  M.stringify = fc;
  M.contains = nc;
  M.intersects = oc;
  function ic(a, b, c, d) {
    void 0 === a
      ? (this.Ce = this.re = this.Me = this.Oe = 0)
      : void 0 === b
      ? (this.left = this.bottom = this.right = this.top = a)
      : void 0 === c
      ? ((this.top = a), (this.right = b), (this.bottom = a), (this.left = b))
      : void 0 !== d
      ? ((this.top = a), (this.right = b), (this.bottom = c), (this.left = d))
      : v(
          "Invalid arguments to Margin constructor: " +
            a +
            ", " +
            b +
            ", " +
            c +
            ", " +
            d
        );
    this.u = !1;
  }
  ic.prototype.assign = function (a) {
    this.Oe = a.Oe;
    this.Me = a.Me;
    this.re = a.re;
    this.Ce = a.Ce;
    return this;
  };
  ic.prototype.yg = function (a, b, c, d) {
    G &&
      (A(a, "number", ic, "setTo:t"),
      A(b, "number", ic, "setTo:r"),
      A(c, "number", ic, "setTo:b"),
      A(d, "number", ic, "setTo:l"),
      this.ha());
    this.Oe = a;
    this.Me = b;
    this.re = c;
    this.Ce = d;
    return this;
  };
  ic.prototype.set = function (a) {
    G && (x(a, ic, ic, "assign:m"), this.ha());
    this.Oe = a.Oe;
    this.Me = a.Me;
    this.re = a.re;
    this.Ce = a.Ce;
    return this;
  };
  ic.prototype.copy = function () {
    var a = new ic();
    a.Oe = this.Oe;
    a.Me = this.Me;
    a.re = this.re;
    a.Ce = this.Ce;
    return a;
  };
  t = ic.prototype;
  t.ia = function () {
    this.u = !0;
    Object.freeze(this);
    return this;
  };
  t.L = function () {
    return this.u || Object.isFrozen(this) ? this : this.copy().freeze();
  };
  t.freeze = function () {
    this.u = !0;
    return this;
  };
  t.la = function () {
    Object.isFrozen(this) && v("cannot thaw constant: " + this);
    this.u = !1;
    return this;
  };
  t.ha = function (a) {
    if (G && this.u) {
      var b =
        "The Margin is frozen, so its properties cannot be set: " +
        this.toString();
      void 0 !== a && (b += "  to value: " + a);
      v(b);
    }
  };
  function vc(a) {
    if ("string" === typeof a) {
      a = a.split(" ");
      for (var b = 0, c = NaN; "" === a[b]; ) b++;
      var d = a[b++];
      d && (c = parseFloat(d));
      if (isNaN(c)) return new ic();
      for (var e = NaN; "" === a[b]; ) b++;
      (d = a[b++]) && (e = parseFloat(d));
      if (isNaN(e)) return new ic(c);
      for (var f = NaN; "" === a[b]; ) b++;
      (d = a[b++]) && (f = parseFloat(d));
      if (isNaN(f)) return new ic(c, e);
      for (var g = NaN; "" === a[b]; ) b++;
      (d = a[b++]) && (g = parseFloat(d));
      return isNaN(g) ? new ic(c, e) : new ic(c, e, f, g);
    }
    return new ic();
  }
  function wc(a) {
    G && x(a, ic);
    return (
      a.top.toString() +
      " " +
      a.right.toString() +
      " " +
      a.bottom.toString() +
      " " +
      a.left.toString()
    );
  }
  t.toString = function () {
    return (
      "Margin(" +
      this.top +
      "," +
      this.right +
      "," +
      this.bottom +
      "," +
      this.left +
      ")"
    );
  };
  t.D = function (a) {
    return a instanceof ic
      ? this.Oe === a.top &&
          this.Me === a.right &&
          this.re === a.bottom &&
          this.Ce === a.left
      : !1;
  };
  t.Oi = function (a, b, c, d) {
    return this.Oe === a && this.Me === b && this.re === c && this.Ce === d;
  };
  t.$a = function (a) {
    return (
      L.C(this.Oe, a.top) &&
      L.C(this.Me, a.right) &&
      L.C(this.re, a.bottom) &&
      L.C(this.Ce, a.left)
    );
  };
  t.s = function () {
    return (
      isFinite(this.top) &&
      isFinite(this.right) &&
      isFinite(this.bottom) &&
      isFinite(this.left)
    );
  };
  ic.alloc = function () {
    var a = xc.pop();
    return void 0 === a ? new ic() : a;
  };
  ic.free = function (a) {
    xc.push(a);
  };
  oa.Object.defineProperties(ic.prototype, {
    top: {
      configurable: !0,
      get: function () {
        return this.Oe;
      },
      set: function (a) {
        G && (D(a, ic, "top"), this.ha(a));
        this.Oe = a;
      },
    },
    right: {
      configurable: !0,
      get: function () {
        return this.Me;
      },
      set: function (a) {
        G && (D(a, ic, "right"), this.ha(a));
        this.Me = a;
      },
    },
    bottom: {
      configurable: !0,
      get: function () {
        return this.re;
      },
      set: function (a) {
        G && (D(a, ic, "bottom"), this.ha(a));
        this.re = a;
      },
    },
    left: {
      configurable: !0,
      get: function () {
        return this.Ce;
      },
      set: function (a) {
        G && (D(a, ic, "left"), this.ha(a));
        this.Ce = a;
      },
    },
  });
  ic.prototype.isReal = ic.prototype.s;
  ic.prototype.equalsApprox = ic.prototype.$a;
  ic.prototype.equalTo = ic.prototype.Oi;
  ic.prototype.equals = ic.prototype.D;
  ic.prototype.set = ic.prototype.set;
  ic.prototype.setTo = ic.prototype.yg;
  var Cc = null,
    Dc = null,
    xc = [];
  ic.className = "Margin";
  ic.parse = vc;
  ic.stringify = wc;
  ic.ZeroMargin = Cc = new ic(0, 0, 0, 0).ia();
  ic.TwoMargin = Dc = new ic(2, 2, 2, 2).ia();
  ic.parse = vc;
  ic.stringify = wc;
  function Ib(a, b, c, d) {
    void 0 === a
      ? (this.he = this.ge = this.J = this.I = 0)
      : (void 0 === b && (b = 0),
        void 0 === c && (c = 0),
        void 0 === d && (d = 0),
        (this.x = a),
        (this.y = b),
        (this.offsetX = c),
        (this.offsetY = d));
    this.u = !1;
  }
  var Ec,
    Fc,
    Gc,
    Ic,
    Jc,
    Kc,
    Lc,
    Mc,
    Nc,
    Pc,
    Qc,
    Rc,
    Sc,
    Tc,
    Uc,
    Vc,
    Wc,
    Xc,
    Yc,
    Zc,
    bd,
    cd,
    dd,
    ed,
    fd,
    gd,
    hd,
    id,
    md,
    nd,
    od,
    pd,
    qd,
    rd,
    sd,
    td;
  Ib.prototype.assign = function (a) {
    this.I = a.I;
    this.J = a.J;
    this.ge = a.ge;
    this.he = a.he;
    return this;
  };
  Ib.prototype.yg = function (a, b, c, d) {
    G &&
      (ud(a, "setTo:x"),
      ud(b, "setTo:y"),
      vd(c, "setTo:offx"),
      vd(d, "setTo:offy"),
      this.ha());
    this.I = a;
    this.J = b;
    this.ge = c;
    this.he = d;
    return this;
  };
  Ib.prototype.set = function (a) {
    G && (x(a, Ib, Ib, "set:s"), this.ha());
    this.I = a.I;
    this.J = a.J;
    this.ge = a.ge;
    this.he = a.he;
    return this;
  };
  Ib.prototype.copy = function () {
    var a = new Ib();
    a.I = this.I;
    a.J = this.J;
    a.ge = this.ge;
    a.he = this.he;
    return a;
  };
  t = Ib.prototype;
  t.ia = function () {
    this.u = !0;
    Object.freeze(this);
    return this;
  };
  t.L = function () {
    return this.u || Object.isFrozen(this) ? this : this.copy().freeze();
  };
  t.freeze = function () {
    this.u = !0;
    return this;
  };
  t.la = function () {
    Object.isFrozen(this) && v("cannot thaw constant: " + this);
    this.u = !1;
    return this;
  };
  t.ha = function (a) {
    if (G && this.u) {
      var b =
        "The Spot is frozen, so its properties cannot be set: " +
        this.toString();
      void 0 !== a && (b += "  to value: " + a);
      v(b);
    }
  };
  function wd(a, b) {
    a.I = NaN;
    a.J = NaN;
    a.ge = b;
    return a;
  }
  function ud(a, b) {
    (isNaN(a) || 1 < a || 0 > a) && Aa(a, "0 <= " + b + " <= 1", Ib, b);
  }
  function vd(a, b) {
    (isNaN(a) || Infinity === a || -Infinity === a) &&
      Aa(a, "real number, not NaN or Infinity", Ib, b);
  }
  function xd(a) {
    if ("string" === typeof a) {
      a = a.trim();
      if ("None" === a) return Ec;
      if ("TopLeft" === a) return Fc;
      if ("Top" === a || "TopCenter" === a || "MiddleTop" === a) return Gc;
      if ("TopRight" === a) return Ic;
      if ("Left" === a || "LeftCenter" === a || "MiddleLeft" === a) return Jc;
      if ("Center" === a) return Kc;
      if ("Right" === a || "RightCenter" === a || "MiddleRight" === a)
        return Lc;
      if ("BottomLeft" === a) return Mc;
      if ("Bottom" === a || "BottomCenter" === a || "MiddleBottom" === a)
        return Nc;
      if ("BottomRight" === a) return Pc;
      if ("TopSide" === a) return Qc;
      if ("LeftSide" === a) return Rc;
      if ("RightSide" === a) return Sc;
      if ("BottomSide" === a) return Tc;
      if ("TopBottomSides" === a) return Uc;
      if ("LeftRightSides" === a) return Vc;
      if ("TopLeftSides" === a) return Wc;
      if ("TopRightSides" === a) return Xc;
      if ("BottomLeftSides" === a) return Yc;
      if ("BottomRightSides" === a) return Zc;
      if ("NotTopSide" === a) return bd;
      if ("NotLeftSide" === a) return cd;
      if ("NotRightSide" === a) return dd;
      if ("NotBottomSide" === a) return ed;
      if ("AllSides" === a) return fd;
      if ("Default" === a) return gd;
      a = a.split(" ");
      for (var b = 0, c = 0; "" === a[b]; ) b++;
      var d = a[b++];
      void 0 !== d && 0 < d.length && (c = parseFloat(d));
      for (var e = 0; "" === a[b]; ) b++;
      d = a[b++];
      void 0 !== d && 0 < d.length && (e = parseFloat(d));
      for (var f = 0; "" === a[b]; ) b++;
      d = a[b++];
      void 0 !== d && 0 < d.length && (f = parseFloat(d));
      for (var g = 0; "" === a[b]; ) b++;
      d = a[b++];
      void 0 !== d && 0 < d.length && (g = parseFloat(d));
      return new Ib(c, e, f, g);
    }
    return new Ib();
  }
  function yd(a) {
    G && x(a, Ib);
    return a.ib()
      ? a.x.toString() +
          " " +
          a.y.toString() +
          " " +
          a.offsetX.toString() +
          " " +
          a.offsetY.toString()
      : a.toString();
  }
  t.toString = function () {
    return this.ib()
      ? 0 === this.ge && 0 === this.he
        ? "Spot(" + this.x + "," + this.y + ")"
        : "Spot(" +
          this.x +
          "," +
          this.y +
          "," +
          this.offsetX +
          "," +
          this.offsetY +
          ")"
      : this.D(Ec)
      ? "None"
      : this.D(Fc)
      ? "TopLeft"
      : this.D(Gc)
      ? "Top"
      : this.D(Ic)
      ? "TopRight"
      : this.D(Jc)
      ? "Left"
      : this.D(Kc)
      ? "Center"
      : this.D(Lc)
      ? "Right"
      : this.D(Mc)
      ? "BottomLeft"
      : this.D(Nc)
      ? "Bottom"
      : this.D(Pc)
      ? "BottomRight"
      : this.D(Qc)
      ? "TopSide"
      : this.D(Rc)
      ? "LeftSide"
      : this.D(Sc)
      ? "RightSide"
      : this.D(Tc)
      ? "BottomSide"
      : this.D(Uc)
      ? "TopBottomSides"
      : this.D(Vc)
      ? "LeftRightSides"
      : this.D(Wc)
      ? "TopLeftSides"
      : this.D(Xc)
      ? "TopRightSides"
      : this.D(Yc)
      ? "BottomLeftSides"
      : this.D(Zc)
      ? "BottomRightSides"
      : this.D(bd)
      ? "NotTopSide"
      : this.D(cd)
      ? "NotLeftSide"
      : this.D(dd)
      ? "NotRightSide"
      : this.D(ed)
      ? "NotBottomSide"
      : this.D(fd)
      ? "AllSides"
      : this.D(gd)
      ? "Default"
      : "None";
  };
  t.D = function (a) {
    return a instanceof Ib
      ? (this.I === a.x || (isNaN(this.I) && isNaN(a.x))) &&
          (this.J === a.y || (isNaN(this.J) && isNaN(a.y))) &&
          this.ge === a.offsetX &&
          this.he === a.offsetY
      : !1;
  };
  t.Jv = function () {
    return new Ib(
      0.5 - (this.I - 0.5),
      0.5 - (this.J - 0.5),
      -this.ge,
      -this.he
    );
  };
  t.Lf = function (a) {
    if (!this.Uc()) return !1;
    if (!a.Uc())
      if (a.D(hd)) a = Rc;
      else if (a.D(id)) a = Sc;
      else if (a.D(md)) a = Qc;
      else if (a.D(nd)) a = Tc;
      else return !1;
    a = a.offsetY;
    return (this.he & a) === a;
  };
  t.ib = function () {
    return !isNaN(this.x) && !isNaN(this.y);
  };
  t.ec = function () {
    return isNaN(this.x) || isNaN(this.y);
  };
  t.Uc = function () {
    return (
      isNaN(this.x) && isNaN(this.y) && 1 === this.offsetX && 0 !== this.offsetY
    );
  };
  t.pq = function () {
    return (
      isNaN(this.x) && isNaN(this.y) && 0 === this.offsetX && 0 === this.offsetY
    );
  };
  t.Nb = function () {
    return (
      isNaN(this.x) &&
      isNaN(this.y) &&
      -1 === this.offsetX &&
      0 === this.offsetY
    );
  };
  Ib.alloc = function () {
    var a = zd.pop();
    return void 0 === a ? new Ib() : a;
  };
  Ib.free = function (a) {
    zd.push(a);
  };
  oa.Object.defineProperties(Ib.prototype, {
    x: {
      configurable: !0,
      get: function () {
        return this.I;
      },
      set: function (a) {
        G && (ud(a, "x"), this.ha(a));
        this.I = a;
      },
    },
    y: {
      configurable: !0,
      get: function () {
        return this.J;
      },
      set: function (a) {
        G && (ud(a, "y"), this.ha(a));
        this.J = a;
      },
    },
    offsetX: {
      configurable: !0,
      get: function () {
        return this.ge;
      },
      set: function (a) {
        G && (vd(a, "offsetX"), this.ha(a));
        this.ge = a;
      },
    },
    offsetY: {
      configurable: !0,
      get: function () {
        return this.he;
      },
      set: function (a) {
        G && (vd(a, "offsetY"), this.ha(a));
        this.he = a;
      },
    },
  });
  Ib.prototype.isDefault = Ib.prototype.Nb;
  Ib.prototype.isNone = Ib.prototype.pq;
  Ib.prototype.isSide = Ib.prototype.Uc;
  Ib.prototype.isNoSpot = Ib.prototype.ec;
  Ib.prototype.isSpot = Ib.prototype.ib;
  Ib.prototype.includesSide = Ib.prototype.Lf;
  Ib.prototype.opposite = Ib.prototype.Jv;
  Ib.prototype.equals = Ib.prototype.D;
  Ib.prototype.set = Ib.prototype.set;
  Ib.prototype.setTo = Ib.prototype.yg;
  var zd = [];
  Ib.className = "Spot";
  Ib.parse = xd;
  Ib.stringify = yd;
  Ib.None = Ec = wd(new Ib(0, 0, 0, 0), 0).ia();
  Ib.Default = gd = wd(new Ib(0, 0, -1, 0), -1).ia();
  Ib.TopLeft = Fc = new Ib(0, 0, 0, 0).ia();
  Ib.TopCenter = Gc = new Ib(0.5, 0, 0, 0).ia();
  Ib.TopRight = Ic = new Ib(1, 0, 0, 0).ia();
  Ib.LeftCenter = Jc = new Ib(0, 0.5, 0, 0).ia();
  Ib.Center = Kc = new Ib(0.5, 0.5, 0, 0).ia();
  Ib.RightCenter = Lc = new Ib(1, 0.5, 0, 0).ia();
  Ib.BottomLeft = Mc = new Ib(0, 1, 0, 0).ia();
  Ib.BottomCenter = Nc = new Ib(0.5, 1, 0, 0).ia();
  Ib.BottomRight = Pc = new Ib(1, 1, 0, 0).ia();
  Ib.MiddleTop = od = Gc;
  Ib.MiddleLeft = pd = Jc;
  Ib.MiddleRight = qd = Lc;
  Ib.MiddleBottom = rd = Nc;
  Ib.Top = md = Gc;
  Ib.Left = hd = Jc;
  Ib.Right = id = Lc;
  Ib.Bottom = nd = Nc;
  Ib.TopSide = Qc = wd(new Ib(0, 0, 1, 1), 1).ia();
  Ib.LeftSide = Rc = wd(new Ib(0, 0, 1, 2), 1).ia();
  Ib.RightSide = Sc = wd(new Ib(0, 0, 1, 4), 1).ia();
  Ib.BottomSide = Tc = wd(new Ib(0, 0, 1, 8), 1).ia();
  Ib.TopBottomSides = Uc = wd(new Ib(0, 0, 1, 9), 1).ia();
  Ib.LeftRightSides = Vc = wd(new Ib(0, 0, 1, 6), 1).ia();
  Ib.TopLeftSides = Wc = wd(new Ib(0, 0, 1, 3), 1).ia();
  Ib.TopRightSides = Xc = wd(new Ib(0, 0, 1, 5), 1).ia();
  Ib.BottomLeftSides = Yc = wd(new Ib(0, 0, 1, 10), 1).ia();
  Ib.BottomRightSides = Zc = wd(new Ib(0, 0, 1, 12), 1).ia();
  Ib.NotTopSide = bd = wd(new Ib(0, 0, 1, 14), 1).ia();
  Ib.NotLeftSide = cd = wd(new Ib(0, 0, 1, 13), 1).ia();
  Ib.NotRightSide = dd = wd(new Ib(0, 0, 1, 11), 1).ia();
  Ib.NotBottomSide = ed = wd(new Ib(0, 0, 1, 7), 1).ia();
  Ib.AllSides = fd = wd(new Ib(0, 0, 1, 15), 1).ia();
  sd = new Ib(0.156, 0.156).ia();
  td = new Ib(0.844, 0.844).ia();
  Ib.parse = xd;
  Ib.stringify = yd;
  function Kb() {
    this.m11 = 1;
    this.m21 = this.m12 = 0;
    this.m22 = 1;
    this.dy = this.dx = 0;
  }
  Kb.prototype.set = function (a) {
    this.m11 = a.m11;
    this.m12 = a.m12;
    this.m21 = a.m21;
    this.m22 = a.m22;
    this.dx = a.dx;
    this.dy = a.dy;
    return this;
  };
  Kb.prototype.setTransform = function (a, b, c, d, e, f) {
    this.m11 = a;
    this.m12 = b;
    this.m21 = c;
    this.m22 = d;
    this.dx = e;
    this.dy = f;
    return this;
  };
  Kb.prototype.copy = function () {
    var a = new Kb();
    a.m11 = this.m11;
    a.m12 = this.m12;
    a.m21 = this.m21;
    a.m22 = this.m22;
    a.dx = this.dx;
    a.dy = this.dy;
    return a;
  };
  Kb.prototype.toString = function () {
    return (
      "Transform(" +
      this.m11 +
      "," +
      this.m12 +
      "," +
      this.m21 +
      "," +
      this.m22 +
      "," +
      this.dx +
      "," +
      this.dy +
      ")"
    );
  };
  Kb.prototype.D = function (a) {
    return (
      this.m11 === a.m11 &&
      this.m12 === a.m12 &&
      this.m21 === a.m21 &&
      this.m22 === a.m22 &&
      this.dx === a.dx &&
      this.dy === a.dy
    );
  };
  Kb.prototype.Ps = function () {
    return (
      0 === this.dx &&
      0 === this.dy &&
      1 === this.m11 &&
      0 === this.m12 &&
      0 === this.m21 &&
      1 === this.m22
    );
  };
  Kb.prototype.reset = function () {
    this.m11 = 1;
    this.m21 = this.m12 = 0;
    this.m22 = 1;
    this.dy = this.dx = 0;
    return this;
  };
  Kb.prototype.multiply = function (a) {
    var b = this.m11 * a.m11 + this.m21 * a.m12,
      c = this.m12 * a.m11 + this.m22 * a.m12,
      d = this.m11 * a.m21 + this.m21 * a.m22,
      e = this.m12 * a.m21 + this.m22 * a.m22;
    this.dx = this.m11 * a.dx + this.m21 * a.dy + this.dx;
    this.dy = this.m12 * a.dx + this.m22 * a.dy + this.dy;
    this.m11 = b;
    this.m12 = c;
    this.m21 = d;
    this.m22 = e;
    return this;
  };
  Kb.prototype.Hv = function (a) {
    var b = 1 / (a.m11 * a.m22 - a.m12 * a.m21),
      c = a.m22 * b,
      d = -a.m12 * b,
      e = -a.m21 * b,
      f = a.m11 * b,
      g = b * (a.m21 * a.dy - a.m22 * a.dx);
    a = b * (a.m12 * a.dx - a.m11 * a.dy);
    b = this.m11 * c + this.m21 * d;
    c = this.m12 * c + this.m22 * d;
    d = this.m11 * e + this.m21 * f;
    e = this.m12 * e + this.m22 * f;
    this.dx = this.m11 * g + this.m21 * a + this.dx;
    this.dy = this.m12 * g + this.m22 * a + this.dy;
    this.m11 = b;
    this.m12 = c;
    this.m21 = d;
    this.m22 = e;
    return this;
  };
  Kb.prototype.Ns = function () {
    var a = 1 / (this.m11 * this.m22 - this.m12 * this.m21),
      b = -this.m12 * a,
      c = -this.m21 * a,
      d = this.m11 * a,
      e = a * (this.m21 * this.dy - this.m22 * this.dx),
      f = a * (this.m12 * this.dx - this.m11 * this.dy);
    this.m11 = this.m22 * a;
    this.m12 = b;
    this.m21 = c;
    this.m22 = d;
    this.dx = e;
    this.dy = f;
    return this;
  };
  Kb.prototype.rotate = function (a, b, c) {
    360 <= a ? (a -= 360) : 0 > a && (a += 360);
    if (0 === a) return this;
    this.translate(b, c);
    if (90 === a) {
      a = 0;
      var d = 1;
    } else
      180 === a
        ? ((a = -1), (d = 0))
        : 270 === a
        ? ((a = 0), (d = -1))
        : ((d = (a * Math.PI) / 180), (a = Math.cos(d)), (d = Math.sin(d)));
    var e = this.m12 * a + this.m22 * d,
      f = this.m11 * -d + this.m21 * a,
      g = this.m12 * -d + this.m22 * a;
    this.m11 = this.m11 * a + this.m21 * d;
    this.m12 = e;
    this.m21 = f;
    this.m22 = g;
    this.translate(-b, -c);
    return this;
  };
  t = Kb.prototype;
  t.translate = function (a, b) {
    this.dx += this.m11 * a + this.m21 * b;
    this.dy += this.m12 * a + this.m22 * b;
    return this;
  };
  t.scale = function (a, b) {
    void 0 === b && (b = a);
    this.m11 *= a;
    this.m12 *= a;
    this.m21 *= b;
    this.m22 *= b;
    return this;
  };
  t.Ha = function (a) {
    var b = a.x,
      c = a.y;
    return a.h(
      b * this.m11 + c * this.m21 + this.dx,
      b * this.m12 + c * this.m22 + this.dy
    );
  };
  t.Od = function (a) {
    var b = 1 / (this.m11 * this.m22 - this.m12 * this.m21),
      c = a.x,
      d = a.y;
    return a.h(
      c * this.m22 * b +
        d * -this.m21 * b +
        b * (this.m21 * this.dy - this.m22 * this.dx),
      c * -this.m12 * b +
        d * this.m11 * b +
        b * (this.m12 * this.dx - this.m11 * this.dy)
    );
  };
  t.Fx = function (a) {
    var b = 1 / (this.m11 * this.m22 - this.m12 * this.m21),
      c = 1.25 * a.x,
      d = 1.2 * a.y;
    return a.h(
      c * this.m22 * b +
        d * -this.m21 * b +
        b * (this.m21 * this.dy - this.m22 * this.dx),
      c * -this.m12 * b +
        d * this.m11 * b +
        b * (this.m12 * this.dx - this.m11 * this.dy)
    );
  };
  t.Hq = function (a) {
    var b = a.x,
      c = a.y,
      d = b + a.width,
      e = c + a.height,
      f = this.m11,
      g = this.m12,
      h = this.m21,
      k = this.m22,
      l = this.dx,
      m = this.dy,
      n = b * f + c * h + l,
      p = b * g + c * k + m,
      r = d * f + c * h + l,
      q = d * g + c * k + m;
    c = b * f + e * h + l;
    b = b * g + e * k + m;
    f = d * f + e * h + l;
    d = d * g + e * k + m;
    e = Math.min(n, r);
    n = Math.max(n, r);
    r = Math.min(p, q);
    p = Math.max(p, q);
    e = Math.min(e, c);
    n = Math.max(n, c);
    r = Math.min(r, b);
    p = Math.max(p, b);
    e = Math.min(e, f);
    n = Math.max(n, f);
    r = Math.min(r, d);
    p = Math.max(p, d);
    a.h(e, r, n - e, p - r);
    return a;
  };
  Kb.alloc = function () {
    var a = Ad.pop();
    return void 0 === a ? new Kb() : a;
  };
  Kb.free = function (a) {
    Ad.push(a);
  };
  Kb.prototype.transformRect = Kb.prototype.Hq;
  Kb.prototype.transformPoint = Kb.prototype.Ha;
  Kb.prototype.scale = Kb.prototype.scale;
  Kb.prototype.translate = Kb.prototype.translate;
  Kb.prototype.rotate = Kb.prototype.rotate;
  Kb.prototype.invert = Kb.prototype.Ns;
  Kb.prototype.multiplyInverted = Kb.prototype.Hv;
  Kb.prototype.multiply = Kb.prototype.multiply;
  Kb.prototype.reset = Kb.prototype.reset;
  Kb.prototype.isIdentity = Kb.prototype.Ps;
  Kb.prototype.equals = Kb.prototype.D;
  Kb.prototype.setTransform = Kb.prototype.setTransform;
  Kb.prototype.set = Kb.prototype.set;
  var Ad = [];
  Kb.className = "Transform";
  Kb.xF = "54a702f3e53909c447824c6706603faf4c";
  var L = {
    kB: "7da71ca0ad381e90",
    Bg: ((Math.sqrt(2) - 1) / 3) * 4,
    uw: null,
    sqrt: function (a) {
      if (0 >= a) return 0;
      var b = L.uw;
      if (null === b) {
        b = [];
        for (var c = 0; 2e3 >= c; c++) b[c] = Math.sqrt(c);
        L.uw = b;
      }
      return 1 > a
        ? ((c = 1 / a), 2e3 >= c ? 1 / b[c | 0] : Math.sqrt(a))
        : 2e3 >= a
        ? b[a | 0]
        : Math.sqrt(a);
    },
    C: function (a, b) {
      a -= b;
      return 0.5 > a && -0.5 < a;
    },
    da: function (a, b) {
      a -= b;
      return 5e-8 > a && -5e-8 < a;
    },
    Ub: function (a, b, c, d, e, f, g) {
      0 >= e && (e = 1e-6);
      if (a < c) {
        var h = a;
        var k = c;
      } else (h = c), (k = a);
      if (b < d) {
        var l = b;
        var m = d;
      } else (l = d), (m = b);
      if (a === c) return l <= g && g <= m && a - e <= f && f <= a + e;
      if (b === d) return h <= f && f <= k && b - e <= g && g <= b + e;
      k += e;
      h -= e;
      if (h <= f && f <= k && ((m += e), (l -= e), l <= g && g <= m))
        if (k - h > m - l)
          if (a - c > e || c - a > e) {
            if (
              ((f = ((d - b) / (c - a)) * (f - a) + b),
              f - e <= g && g <= f + e)
            )
              return !0;
          } else return !0;
        else if (b - d > e || d - b > e) {
          if (
            ((g = ((c - a) / (d - b)) * (g - b) + a), g - e <= f && f <= g + e)
          )
            return !0;
        } else return !0;
      return !1;
    },
    vs: function (a, b, c, d, e, f, g, h, k, l, m, n) {
      if (L.Ub(a, b, g, h, n, c, d) && L.Ub(a, b, g, h, n, e, f))
        return L.Ub(a, b, g, h, n, l, m);
      var p = (a + c) / 2,
        r = (b + d) / 2,
        q = (c + e) / 2,
        u = (d + f) / 2;
      e = (e + g) / 2;
      f = (f + h) / 2;
      d = (p + q) / 2;
      c = (r + u) / 2;
      q = (q + e) / 2;
      u = (u + f) / 2;
      var w = (d + q) / 2,
        y = (c + u) / 2;
      return (
        L.vs(a, b, p, r, d, c, w, y, k, l, m, n) ||
        L.vs(w, y, q, u, e, f, g, h, k, l, m, n)
      );
    },
    sz: function (a, b, c, d, e, f, g, h, k) {
      var l = (c + e) / 2,
        m = (d + f) / 2;
      k.h(
        (((a + c) / 2 + l) / 2 + (l + (e + g) / 2) / 2) / 2,
        (((b + d) / 2 + m) / 2 + (m + (f + h) / 2) / 2) / 2
      );
      return k;
    },
    rz: function (a, b, c, d, e, f, g, h) {
      var k = (c + e) / 2,
        l = (d + f) / 2;
      return Ob(
        ((a + c) / 2 + k) / 2,
        ((b + d) / 2 + l) / 2,
        (k + (e + g) / 2) / 2,
        (l + (f + h) / 2) / 2
      );
    },
    em: function (a, b, c, d, e, f, g, h, k, l) {
      if (L.Ub(a, b, g, h, k, c, d) && L.Ub(a, b, g, h, k, e, f))
        mc(l, a, b, 0, 0), mc(l, g, h, 0, 0);
      else {
        var m = (a + c) / 2,
          n = (b + d) / 2,
          p = (c + e) / 2,
          r = (d + f) / 2;
        e = (e + g) / 2;
        f = (f + h) / 2;
        d = (m + p) / 2;
        c = (n + r) / 2;
        p = (p + e) / 2;
        r = (r + f) / 2;
        var q = (d + p) / 2,
          u = (c + r) / 2;
        L.em(a, b, m, n, d, c, q, u, k, l);
        L.em(q, u, p, r, e, f, g, h, k, l);
      }
      return l;
    },
    Pe: function (a, b, c, d, e, f, g, h, k, l) {
      if (L.Ub(a, b, g, h, k, c, d) && L.Ub(a, b, g, h, k, e, f))
        0 === l.length && (l.push(a), l.push(b)), l.push(g), l.push(h);
      else {
        var m = (a + c) / 2,
          n = (b + d) / 2,
          p = (c + e) / 2,
          r = (d + f) / 2;
        e = (e + g) / 2;
        f = (f + h) / 2;
        d = (m + p) / 2;
        c = (n + r) / 2;
        p = (p + e) / 2;
        r = (r + f) / 2;
        var q = (d + p) / 2,
          u = (c + r) / 2;
        L.Pe(a, b, m, n, d, c, q, u, k, l);
        L.Pe(q, u, p, r, e, f, g, h, k, l);
      }
      return l;
    },
    Mv: function (a, b, c, d, e, f, g, h, k, l) {
      if (L.Ub(a, b, e, f, l, c, d)) return L.Ub(a, b, e, f, l, h, k);
      var m = (a + c) / 2,
        n = (b + d) / 2;
      c = (c + e) / 2;
      d = (d + f) / 2;
      var p = (m + c) / 2,
        r = (n + d) / 2;
      return (
        L.Mv(a, b, m, n, p, r, g, h, k, l) || L.Mv(p, r, c, d, e, f, g, h, k, l)
      );
    },
    vB: function (a, b, c, d, e, f, g) {
      g.h(((a + c) / 2 + (c + e) / 2) / 2, ((b + d) / 2 + (d + f) / 2) / 2);
      return g;
    },
    Lv: function (a, b, c, d, e, f, g, h) {
      if (L.Ub(a, b, e, f, g, c, d)) mc(h, a, b, 0, 0), mc(h, e, f, 0, 0);
      else {
        var k = (a + c) / 2,
          l = (b + d) / 2;
        c = (c + e) / 2;
        d = (d + f) / 2;
        var m = (k + c) / 2,
          n = (l + d) / 2;
        L.Lv(a, b, k, l, m, n, g, h);
        L.Lv(m, n, c, d, e, f, g, h);
      }
      return h;
    },
    vq: function (a, b, c, d, e, f, g, h) {
      if (L.Ub(a, b, e, f, g, c, d))
        0 === h.length && (h.push(a), h.push(b)), h.push(e), h.push(f);
      else {
        var k = (a + c) / 2,
          l = (b + d) / 2;
        c = (c + e) / 2;
        d = (d + f) / 2;
        var m = (k + c) / 2,
          n = (l + d) / 2;
        L.vq(a, b, k, l, m, n, g, h);
        L.vq(m, n, c, d, e, f, g, h);
      }
      return h;
    },
    Wp: function (a, b, c, d, e, f, g, h, k, l, m, n, p, r) {
      if (L.Ub(a, b, g, h, p, c, d) && L.Ub(a, b, g, h, p, e, f)) {
        if (!L.om(a, b, g, h, k, l, m, n)) return !1;
        p = (a - g) * (l - n) - (b - h) * (k - m);
        if (0 === p) return !1;
        r.h(
          ((a * h - b * g) * (k - m) - (a - g) * (k * n - l * m)) / p,
          ((a * h - b * g) * (l - n) - (b - h) * (k * n - l * m)) / p
        );
        return !0;
      }
      var q = (a + c) / 2,
        u = (b + d) / 2,
        w = (c + e) / 2,
        y = (d + f) / 2;
      e = (e + g) / 2;
      f = (f + h) / 2;
      d = (q + w) / 2;
      c = (u + y) / 2;
      w = (w + e) / 2;
      y = (y + f) / 2;
      var z = (d + w) / 2,
        B = (c + y) / 2,
        C = Infinity,
        E = !1,
        J = 0,
        S = 0;
      L.Wp(a, b, q, u, d, c, z, B, k, l, m, n, p, r) &&
        ((a = (r.x - k) * (r.x - k) + (r.y - l) * (r.y - l)),
        a < C && ((C = a), (E = !0), (J = r.x), (S = r.y)));
      L.Wp(z, B, w, y, e, f, g, h, k, l, m, n, p, r) &&
        (r.x - k) * (r.x - k) + (r.y - l) * (r.y - l) < C &&
        ((E = !0), (J = r.x), (S = r.y));
      E && ((r.x = J), (r.y = S));
      return E;
    },
    Xp: function (a, b, c, d, e, f, g, h, k, l, m, n, p) {
      var r = 0;
      if (L.Ub(a, b, g, h, p, c, d) && L.Ub(a, b, g, h, p, e, f)) {
        p = (a - g) * (l - n) - (b - h) * (k - m);
        if (0 === p) return r;
        var q = ((a * h - b * g) * (k - m) - (a - g) * (k * n - l * m)) / p,
          u = ((a * h - b * g) * (l - n) - (b - h) * (k * n - l * m)) / p;
        if (q >= m) return r;
        if ((k > m ? k - m : m - k) < (l > n ? l - n : n - l)) {
          if ((b < h ? ((k = b), (a = h)) : ((k = h), (a = b)), u < k || u > a))
            return r;
        } else if ((a < g ? ((k = a), (a = g)) : (k = g), q < k || q > a))
          return r;
        0 < p ? r++ : 0 > p && r--;
      } else {
        q = (a + c) / 2;
        u = (b + d) / 2;
        var w = (c + e) / 2,
          y = (d + f) / 2;
        e = (e + g) / 2;
        f = (f + h) / 2;
        d = (q + w) / 2;
        c = (u + y) / 2;
        w = (w + e) / 2;
        y = (y + f) / 2;
        var z = (d + w) / 2,
          B = (c + y) / 2;
        r += L.Xp(a, b, q, u, d, c, z, B, k, l, m, n, p);
        r += L.Xp(z, B, w, y, e, f, g, h, k, l, m, n, p);
      }
      return r;
    },
    Nh: function (a, b, c, d, e, f, g) {
      if (L.da(a, c)) {
        b < d ? ((c = b), (b = d)) : (c = d);
        if (f < c) return g.h(a, c), !1;
        if (f > b) return g.h(a, b), !1;
        g.h(a, f);
        return !0;
      }
      if (L.da(b, d)) {
        a < c ? ((d = a), (a = c)) : (d = c);
        if (e < d) return g.h(d, b), !1;
        if (e > a) return g.h(a, b), !1;
        g.h(e, b);
        return !0;
      }
      e =
        ((a - e) * (a - c) + (b - f) * (b - d)) /
        ((c - a) * (c - a) + (d - b) * (d - b));
      if (-5e-6 > e) return g.h(a, b), !1;
      if (1.000005 < e) return g.h(c, d), !1;
      g.h(a + e * (c - a), b + e * (d - b));
      return !0;
    },
    Ve: function (a, b, c, d, e, f, g, h, k) {
      if (L.C(a, c) && L.C(b, d)) return k.h(a, b), !1;
      if (L.da(e, g))
        return L.da(a, c)
          ? (L.Nh(a, b, c, d, e, f, k), !1)
          : L.Nh(a, b, c, d, e, ((d - b) / (c - a)) * (e - a) + b, k);
      h = (h - f) / (g - e);
      if (L.da(a, c)) {
        c = h * (a - e) + f;
        b < d ? ((e = b), (b = d)) : (e = d);
        if (c < e) return k.h(a, e), !1;
        if (c > b) return k.h(a, b), !1;
        k.h(a, c);
        return !0;
      }
      g = (d - b) / (c - a);
      if (L.da(h, g)) return L.Nh(a, b, c, d, e, f, k), !1;
      e = (g * a - h * e + f - b) / (g - h);
      if (L.da(g, 0)) {
        a < c ? ((d = a), (a = c)) : (d = c);
        if (e < d) return k.h(d, b), !1;
        if (e > a) return k.h(a, b), !1;
        k.h(e, b);
        return !0;
      }
      return L.Nh(a, b, c, d, e, g * (e - a) + b, k);
    },
    tB: function (a, b, c, d, e) {
      return L.Ve(c.x, c.y, d.x, d.y, a.x, a.y, b.x, b.y, e);
    },
    sB: function (a, b, c, d, e, f, g, h, k, l) {
      function m(c, d) {
        var e = (c - a) * (c - a) + (d - b) * (d - b);
        e < n && ((n = e), k.h(c, d));
      }
      var n = Infinity;
      m(k.x, k.y);
      var p = 0,
        r = 0,
        q = 0,
        u = 0;
      e < g ? ((p = e), (r = g)) : ((p = g), (r = e));
      f < h ? ((q = e), (u = g)) : ((q = g), (u = e));
      p = (r - p) / 2 + l;
      l = (u - q) / 2 + l;
      e = (e + g) / 2;
      f = (f + h) / 2;
      if (0 === p || 0 === l) return k;
      if (0.5 > (c > a ? c - a : a - c)) {
        p = 1 - ((c - e) * (c - e)) / (p * p);
        if (0 > p) return k;
        p = Math.sqrt(p);
        d = -l * p + f;
        m(c, l * p + f);
        m(c, d);
      } else {
        c = (d - b) / (c - a);
        d = 1 / (p * p) + (c * c) / (l * l);
        h =
          (2 * c * (b - c * a)) / (l * l) -
          (2 * c * f) / (l * l) -
          (2 * e) / (p * p);
        p =
          h * h -
          4 *
            d *
            ((2 * c * a * f) / (l * l) -
              (2 * b * f) / (l * l) +
              (f * f) / (l * l) +
              (e * e) / (p * p) -
              1 +
              ((b - c * a) * (b - c * a)) / (l * l));
        if (0 > p) return k;
        p = Math.sqrt(p);
        l = (-h + p) / (2 * d);
        m(l, c * l - c * a + b);
        p = (-h - p) / (2 * d);
        m(p, c * p - c * a + b);
      }
      return k;
    },
    Kf: function (a, b, c, d, e, f, g, h, k) {
      var l = 1e21,
        m = a,
        n = b;
      if (L.Ve(a, b, a, d, e, f, g, h, k)) {
        var p = (k.x - e) * (k.x - e) + (k.y - f) * (k.y - f);
        p < l && ((l = p), (m = k.x), (n = k.y));
      }
      L.Ve(c, b, c, d, e, f, g, h, k) &&
        ((p = (k.x - e) * (k.x - e) + (k.y - f) * (k.y - f)),
        p < l && ((l = p), (m = k.x), (n = k.y)));
      L.Ve(a, b, c, b, e, f, g, h, k) &&
        ((b = (k.x - e) * (k.x - e) + (k.y - f) * (k.y - f)),
        b < l && ((l = b), (m = k.x), (n = k.y)));
      L.Ve(a, d, c, d, e, f, g, h, k) &&
        ((a = (k.x - e) * (k.x - e) + (k.y - f) * (k.y - f)),
        a < l && ((l = a), (m = k.x), (n = k.y)));
      k.h(m, n);
      return 1e21 > l;
    },
    rB: function (a, b, c, d, e, f, g, h, k) {
      c = a - c;
      g = e - g;
      0 === c || 0 === g
        ? 0 === c
          ? ((b = (f - h) / g), (h = a), (e = b * h + (f - b * e)))
          : ((f = (b - d) / c), (h = e), (e = f * h + (b - f * a)))
        : ((d = (b - d) / c),
          (h = (f - h) / g),
          (a = b - d * a),
          (h = (f - h * e - a) / (d - h)),
          (e = d * h + a));
      k.h(h, e);
      return k;
    },
    Ls: function (a, b, c) {
      return L.ky(a.x, a.y, a.width, a.height, b.x, b.y, c.x, c.y);
    },
    ky: function (a, b, c, d, e, f, g, h) {
      var k = a + c,
        l = b + d;
      return e === g
        ? (f < h ? ((g = f), (f = h)) : (g = h),
          a <= e && e <= k && g <= l && f >= b)
        : f === h
        ? (e < g ? ((h = e), (e = g)) : (h = g),
          b <= f && f <= l && h <= k && e >= a)
        : nc(a, b, c, d, e, f) ||
          nc(a, b, c, d, g, h) ||
          L.om(a, b, k, b, e, f, g, h) ||
          L.om(k, b, k, l, e, f, g, h) ||
          L.om(k, l, a, l, e, f, g, h) ||
          L.om(a, l, a, b, e, f, g, h)
        ? !0
        : !1;
    },
    om: function (a, b, c, d, e, f, g, h) {
      return (
        0 >= L.hm(a, b, c, d, e, f) * L.hm(a, b, c, d, g, h) &&
        0 >= L.hm(e, f, g, h, a, b) * L.hm(e, f, g, h, c, d)
      );
    },
    hm: function (a, b, c, d, e, f) {
      c -= a;
      d -= b;
      a = e - a;
      b = f - b;
      f = a * d - b * c;
      0 === f &&
        ((f = a * c + b * d),
        0 < f && ((f = (a - c) * c + (b - d) * d), 0 > f && (f = 0)));
      return f;
    },
    tq: function (a) {
      0 > a && (a += 360);
      360 <= a && (a -= 360);
      return a;
    },
    Lx: function (a, b, c, d, e, f) {
      var g = Math.PI;
      f || ((d *= g / 180), (e *= g / 180));
      var h = d > e ? -1 : 1;
      f = [];
      var k = g / 2,
        l = d;
      d = Math.min(2 * g, Math.abs(e - d));
      if (1e-5 > d)
        return (
          (k = l + h * Math.min(d, k)),
          (h = a + c * Math.cos(l)),
          (l = b + c * Math.sin(l)),
          (a += c * Math.cos(k)),
          (b += c * Math.sin(k)),
          (c = (h + a) / 2),
          (k = (l + b) / 2),
          f.push([h, l, c, k, c, k, a, b]),
          f
        );
      for (; 1e-5 < d; )
        (e = l + h * Math.min(d, k)),
          f.push(L.Cz(c, l, e, a, b)),
          (d -= Math.abs(e - l)),
          (l = e);
      return f;
    },
    Cz: function (a, b, c, d, e) {
      var f = (c - b) / 2,
        g = a * Math.cos(f),
        h = a * Math.sin(f),
        k = -h,
        l = g * g + k * k,
        m = l + g * g + k * h;
      l = ((4 / 3) * (Math.sqrt(2 * l * m) - m)) / (g * h - k * g);
      h = g - l * k;
      g = k + l * g;
      k = -g;
      l = f + b;
      f = Math.cos(l);
      l = Math.sin(l);
      return [
        d + a * Math.cos(b),
        e + a * Math.sin(b),
        d + h * f - g * l,
        e + h * l + g * f,
        d + h * f - k * l,
        e + h * l + k * f,
        d + a * Math.cos(c),
        e + a * Math.sin(c),
      ];
    },
    gq: function (a, b, c, d, e, f, g) {
      c = Math.floor((a - c) / e) * e + c;
      d = Math.floor((b - d) / f) * f + d;
      var h = c;
      c + e - a < e / 2 && (h = c + e);
      a = d;
      d + f - b < f / 2 && (a = d + f);
      g.h(h, a);
      return g;
    },
    Xx: function (a, b) {
      var c = Math.max(a, b);
      a = Math.min(a, b);
      var d;
      do (b = c % a), (c = d = a), (a = b);
      while (0 < b);
      return d;
    },
    Hz: function (a, b, c, d) {
      var e = 0 > c,
        f = 0 > d;
      if (a < b) {
        var g = 1;
        var h = 0;
      } else (g = 0), (h = 1);
      var k = 0 === g ? a : b;
      var l = 0 === g ? c : d;
      if (0 === g ? e : f) l = -l;
      g = h;
      c = 0 === g ? c : d;
      if (0 === g ? e : f) c = -c;
      return L.Iz(k, 0 === g ? a : b, l, c, 0, 0);
    },
    Iz: function (a, b, c, d, e, f) {
      if (0 < d)
        if (0 < c) {
          e = a * a;
          f = b * b;
          a *= c;
          var g = b * d,
            h = -f + g,
            k = -f + Math.sqrt(a * a + g * g);
          b = h;
          for (var l = 0; 9999999999 > l; ++l) {
            b = 0.5 * (h + k);
            if (b === h || b === k) break;
            var m = a / (b + e),
              n = g / (b + f);
            m = m * m + n * n - 1;
            if (0 < m) h = b;
            else if (0 > m) k = b;
            else break;
          }
          c = (e * c) / (b + e) - c;
          d = (f * d) / (b + f) - d;
          c = Math.sqrt(c * c + d * d);
        } else c = Math.abs(d - b);
      else
        (d = a * a - b * b),
          (f = a * c),
          f < d
            ? ((d = f / d),
              (f = b * Math.sqrt(Math.abs(1 - d * d))),
              (c = a * d - c),
              (c = Math.sqrt(c * c + f * f)))
            : (c = Math.abs(c - a));
      return c;
    },
    pe: new eb(),
    Sm: new eb(),
    Rf: new eb(),
    Sf: 0,
    Tm: 100,
  };
  L.za = L.kB;
  function N(a) {
    G &&
      1 < arguments.length &&
      v(
        "Geometry constructor can take at most one optional argument, the Geometry type."
      );
    ab(this);
    this.u = !1;
    void 0 === a ? (a = N.o) : G && cb(a, N, N, "constructor:type");
    this.pa = a;
    this.xc = this.oc = this.kd = this.jd = 0;
    this.Aj = new H();
    this.lr = this.Aj.w;
    this.Xq = new M().freeze();
    this.xa = !0;
    this.an = this.Pk = null;
    this.bn = NaN;
    this.vf = Fc;
    this.wf = Pc;
    this.ql = this.rl = NaN;
    this.Wf = Fd;
  }
  N.prototype.copy = function () {
    var a = new N();
    a.pa = this.pa;
    a.jd = this.jd;
    a.kd = this.kd;
    a.oc = this.oc;
    a.xc = this.xc;
    for (var b = this.Aj.m, c = b.length, d = a.Aj, e = 0; e < c; e++) {
      var f = b[e].copy();
      d.add(f);
    }
    a.lr = this.lr;
    a.Xq.assign(this.Xq);
    a.xa = this.xa;
    a.Pk = this.Pk;
    a.an = this.an;
    a.bn = this.bn;
    a.vf = this.vf.L();
    a.wf = this.wf.L();
    a.rl = this.rl;
    a.ql = this.ql;
    a.Wf = this.Wf;
    return a;
  };
  N.prototype.ia = function () {
    this.freeze();
    Object.freeze(this);
    return this;
  };
  N.prototype.freeze = function () {
    this.u = !0;
    var a = this.figures;
    a.freeze();
    a = a.m;
    for (var b = a.length, c = 0; c < b; c++) a[c].freeze();
    return this;
  };
  N.prototype.la = function () {
    Object.isFrozen(this) && v("cannot thaw constant: " + this);
    this.u = !1;
    var a = this.figures;
    a.la();
    a = a.m;
    for (var b = a.length, c = 0; c < b; c++) a[c].la();
    return this;
  };
  N.prototype.$a = function (a) {
    if (!(a instanceof N)) return !1;
    if (this.type !== a.type)
      return this.type === N.j && a.type === N.o
        ? Gd(this, a)
        : a.type === N.j && this.type === N.o
        ? Gd(a, this)
        : !1;
    if (this.type === N.o) {
      var b = this.figures.m;
      a = a.figures.m;
      var c = b.length;
      if (c !== a.length) return !1;
      for (var d = 0; d < c; d++) if (!b[d].$a(a[d])) return !1;
      return !0;
    }
    return (
      L.C(this.startX, a.startX) &&
      L.C(this.startY, a.startY) &&
      L.C(this.endX, a.endX) &&
      L.C(this.endY, a.endY)
    );
  };
  function Gd(a, b) {
    return a.type !== N.j || b.type !== N.o
      ? !1
      : 1 === b.figures.count &&
        ((b = b.figures.N(0)),
        1 === b.segments.count &&
          L.C(a.startX, b.startX) &&
          L.C(a.startY, b.startY) &&
          ((b = b.segments.N(0)),
          b.type === Hd && L.C(a.endX, b.endX) && L.C(a.endY, b.endY)))
      ? !0
      : !1;
  }
  N.Ba = function (a) {
    return a.toString();
  };
  N.prototype.pb = function (a) {
    a.classType === N ? (this.type = a) : Ea(this, a);
  };
  N.prototype.toString = function (a) {
    void 0 === a && (a = -1);
    switch (this.type) {
      case N.j:
        return 0 > a
          ? "M" +
              this.startX.toString() +
              " " +
              this.startY.toString() +
              "L" +
              this.endX.toString() +
              " " +
              this.endY.toString()
          : "M" +
              this.startX.toFixed(a) +
              " " +
              this.startY.toFixed(a) +
              "L" +
              this.endX.toFixed(a) +
              " " +
              this.endY.toFixed(a);
      case N.B:
        var b = new M(this.startX, this.startY, 0, 0);
        b.gw(this.endX, this.endY, 0, 0);
        return 0 > a
          ? "M" +
              b.x.toString() +
              " " +
              b.y.toString() +
              "H" +
              b.right.toString() +
              "V" +
              b.bottom.toString() +
              "H" +
              b.left.toString() +
              "z"
          : "M" +
              b.x.toFixed(a) +
              " " +
              b.y.toFixed(a) +
              "H" +
              b.right.toFixed(a) +
              "V" +
              b.bottom.toFixed(a) +
              "H" +
              b.left.toFixed(a) +
              "z";
      case N.M:
        b = new M(this.startX, this.startY, 0, 0);
        b.gw(this.endX, this.endY, 0, 0);
        if (0 > a)
          return (
            (a = b.left.toString() + " " + (b.y + b.height / 2).toString()),
            "M" +
              a +
              "A" +
              (b.width / 2).toString() +
              " " +
              (b.height / 2).toString() +
              " 0 0 1 " +
              (b.right.toString() + " " + (b.y + b.height / 2).toString()) +
              "A" +
              (b.width / 2).toString() +
              " " +
              (b.height / 2).toString() +
              " 0 0 1 " +
              a
          );
        var c = b.left.toFixed(a) + " " + (b.y + b.height / 2).toFixed(a);
        return (
          "M" +
          c +
          "A" +
          (b.width / 2).toFixed(a) +
          " " +
          (b.height / 2).toFixed(a) +
          " 0 0 1 " +
          (b.right.toFixed(a) + " " + (b.y + b.height / 2).toFixed(a)) +
          "A" +
          (b.width / 2).toFixed(a) +
          " " +
          (b.height / 2).toFixed(a) +
          " 0 0 1 " +
          c
        );
      case N.o:
        b = "";
        c = this.figures.m;
        for (var d = c.length, e = 0; e < d; e++) {
          var f = c[e];
          0 < e && (b += " x ");
          f.isFilled && (b += "F ");
          b += f.toString(a);
        }
        return b;
      default:
        return this.type.toString();
    }
  };
  N.eb = function (a) {
    "string" !== typeof a && za(a, "string", N, "fillPath:str");
    a = a.split(/[Xx]/);
    for (var b = a.length, c = "", d = 0; d < b; d++) {
      var e = a[d];
      c =
        null !== e.match(/[Ff]/)
          ? 0 === d
            ? c + e
            : c + ("X" + (" " === e[0] ? "" : " ") + e)
          : c + ((0 === d ? "" : "X ") + "F" + (" " === e[0] ? "" : " ") + e);
    }
    return c;
  };
  N.parse = function (a, b) {
    function c() {
      return u >= C - 1 ? !0 : null !== l[u + 1].match(E);
    }
    function d() {
      u++;
      return l[u];
    }
    function e(a) {
      var b = parseFloat(d()),
        c = parseFloat(d());
      w === w.toLowerCase() && ((b = B.x + b), (c = B.y + c));
      a.h(b, c);
    }
    function f() {
      e(B);
      return B;
    }
    function g() {
      e(z);
      return z;
    }
    function h() {
      var a = y.toLowerCase();
      return "c" !== a && "s" !== a && "q" !== a && "t" !== a
        ? B
        : new K(2 * B.x - z.x, 2 * B.y - z.y);
    }
    void 0 === b && (b = !1);
    "string" !== typeof a && za(a, "string", N, "parse:str");
    var k =
      /([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm;
    a = a.replace(/,/gm, " ");
    a = a.replace(k, "$1 $2");
    a = a.replace(k, "$1 $2");
    a = a.replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([^s])/gm, "$1 $2");
    a = a.replace(/([^s])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm, "$1 $2");
    a = a.replace(/([0-9])([+\-])/gm, "$1 $2");
    a = a.replace(/[\s\r\t\n]+/gm, " ");
    a = a.replace(/^\s+|\s+$/g, "");
    var l = a.split(" ");
    for (a = 0; a < l.length; a++) {
      var m = l[a];
      if (null !== m.match(/(\.[0-9]*)(\.)/gm)) {
        k = Ma();
        for (var n = "", p = !1, r = 0; r < m.length; r++) {
          var q = m[r];
          "." !== q || p
            ? "." === q
              ? (k.push(n), (n = "."))
              : (n += q)
            : ((p = !0), (n += q));
        }
        k.push(n);
        l.splice(a, 1);
        for (m = 0; m < k.length; m++) l.splice(a + m, 0, k[m]);
        a += k.length - 1;
        Pa(k);
      }
    }
    var u = -1,
      w = "",
      y = "";
    k = new K(0, 0);
    var z = new K(0, 0),
      B = new K(0, 0),
      C = l.length;
    a = Id(null);
    n = m = !1;
    p = !0;
    r = null;
    for (var E = /[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/; !(u >= C - 1); )
      if (((y = w), (w = d()), "" !== w))
        switch (w.toUpperCase()) {
          case "X":
            p = !0;
            n = m = !1;
            break;
          case "M":
            r = f();
            null === a.pc || !0 === p
              ? (Jd(a, r.x, r.y, m, !n), (p = !1))
              : a.moveTo(r.x, r.y);
            for (k.assign(B); !c(); ) (r = f()), a.lineTo(r.x, r.y);
            break;
          case "L":
            for (; !c(); ) (r = f()), a.lineTo(r.x, r.y);
            break;
          case "H":
            for (; !c(); )
              (B = new K(
                (w === w.toLowerCase() ? B.x : 0) + parseFloat(d()),
                B.y
              )),
                a.lineTo(B.x, B.y);
            break;
          case "V":
            for (; !c(); )
              (B = new K(
                B.x,
                (w === w.toLowerCase() ? B.y : 0) + parseFloat(d())
              )),
                a.lineTo(B.x, B.y);
            break;
          case "C":
            for (; !c(); ) {
              r = new K();
              e(r);
              q = g();
              var J = f();
              Kd(a, r.x, r.y, q.x, q.y, J.x, J.y);
            }
            break;
          case "S":
            for (; !c(); )
              (r = h()),
                (q = g()),
                (J = f()),
                Kd(a, r.x, r.y, q.x, q.y, J.x, J.y);
            break;
          case "Q":
            for (; !c(); ) (r = g()), (q = f()), Ld(a, r.x, r.y, q.x, q.y);
            break;
          case "T":
            for (; !c(); ) (z = r = h()), (q = f()), Ld(a, r.x, r.y, q.x, q.y);
            break;
          case "B":
            for (; !c(); ) {
              r = parseFloat(d());
              q = parseFloat(d());
              J = parseFloat(d());
              var S = parseFloat(d()),
                aa = parseFloat(d()),
                Y = aa,
                T = !1;
              c() ||
                ((Y = parseFloat(d())), c() || (T = 0 !== parseFloat(d())));
              w === w.toLowerCase() && ((J += B.x), (S += B.y));
              a.arcTo(r, q, J, S, aa, Y, T);
            }
            break;
          case "A":
            for (; !c(); )
              (r = Math.abs(parseFloat(d()))),
                (q = Math.abs(parseFloat(d()))),
                (J = parseFloat(d())),
                (aa = S = !1),
                (T = Y = 0),
                (Y = d()),
                1 === Y.length
                  ? ((S = !!parseFloat(Y)),
                    (aa = !!parseFloat(d())),
                    (Y = parseFloat(d())))
                  : 2 === Y.length
                  ? ((S = !!parseFloat(Y[0])),
                    (aa = !!parseFloat(Y[1])),
                    (Y = parseFloat(d())))
                  : ((S = !!parseFloat(Y[0])),
                    (aa = !!parseFloat(Y[1])),
                    (Y = parseFloat(Y.slice(2)))),
                (T = parseFloat(d())),
                w === w.toLowerCase() && ((Y = B.x + Y), (T = B.y + T)),
                B.h(Y, T),
                Md(a, r, q, J, S, aa, Y, T);
            break;
          case "Z":
            Nd(a);
            B.assign(k);
            break;
          case "F":
            r = "";
            for (q = 1; l[u + q]; )
              if (null !== l[u + q].match(/[Uu]/)) q++;
              else if (null === l[u + q].match(E)) q++;
              else {
                r = l[u + q];
                break;
              }
            r.match(/[Mm]/)
              ? (m = !0)
              : 0 < a.pc.segments.length && (a.pc.isFilled = !0);
            break;
          case "U":
            r = "";
            for (q = 1; l[u + q]; )
              if (null !== l[u + q].match(/[Ff]/)) q++;
              else if (null === l[u + q].match(E)) q++;
              else {
                r = l[u + q];
                break;
              }
            r.match(/[Mm]/) ? (n = !0) : a.Mm(!1);
        }
    k = a.Fs;
    Qd = a;
    if (b) for (b = k.figures.iterator; b.next(); ) b.value.isFilled = !0;
    return k;
  };
  N.Na = function (a, b) {
    for (var c = a.length, d = K.alloc(), e = 0; e < c; e++) {
      var f = a[e];
      d.x = f[0];
      d.y = f[1];
      b.Ha(d);
      f[0] = d.x;
      f[1] = d.y;
      d.x = f[2];
      d.y = f[3];
      b.Ha(d);
      f[2] = d.x;
      f[3] = d.y;
      d.x = f[4];
      d.y = f[5];
      b.Ha(d);
      f[4] = d.x;
      f[5] = d.y;
      d.x = f[6];
      d.y = f[7];
      b.Ha(d);
      f[6] = d.x;
      f[7] = d.y;
    }
    K.free(d);
  };
  N.prototype.Ev = function () {
    if (this.xa || this.lr !== this.figures.w) return !0;
    for (var a = this.figures.m, b = a.length, c = 0; c < b; c++)
      if (a[c].Ev()) return !0;
    return !1;
  };
  N.prototype.computeBounds = function () {
    this.xa = !1;
    this.an = this.Pk = null;
    this.bn = NaN;
    this.lr = this.figures.w;
    for (var a = this.figures.m, b = a.length, c = 0; c < b; c++) {
      var d = a[c];
      d.xa = !1;
      var e = d.segments;
      d.$r = e.w;
      d = e.m;
      e = d.length;
      for (var f = 0; f < e; f++) {
        var g = d[f];
        g.xa = !1;
        g.Xd = null;
      }
    }
    a = this.Xq;
    a.la();
    isNaN(this.rl) || isNaN(this.ql)
      ? a.h(0, 0, 0, 0)
      : a.h(0, 0, this.rl, this.ql);
    Rd(this, a, !1);
    mc(a, 0, 0, 0, 0);
    a.freeze();
  };
  N.prototype.Kx = function () {
    var a = new M();
    Rd(this, a, !0);
    return a;
  };
  function Rd(a, b, c) {
    switch (a.type) {
      case N.j:
      case N.B:
      case N.M:
        c ? b.h(a.jd, a.kd, 0, 0) : mc(b, a.jd, a.kd, 0, 0);
        mc(b, a.oc, a.xc, 0, 0);
        break;
      case N.o:
        var d = a.figures;
        a = d.m;
        d = d.length;
        for (var e = 0; e < d; e++) {
          var f = a[e];
          c && 0 === e
            ? b.h(f.startX, f.startY, 0, 0)
            : mc(b, f.startX, f.startY, 0, 0);
          for (
            var g = f.segments.m,
              h = g.length,
              k = f.startX,
              l = f.startY,
              m = 0;
            m < h;
            m++
          ) {
            var n = g[m];
            switch (n.type) {
              case Hd:
              case Sd:
                k = n.endX;
                l = n.endY;
                mc(b, k, l, 0, 0);
                break;
              case Td:
                L.em(
                  k,
                  l,
                  n.point1X,
                  n.point1Y,
                  n.point2X,
                  n.point2Y,
                  n.endX,
                  n.endY,
                  0.5,
                  b
                );
                k = n.endX;
                l = n.endY;
                break;
              case Ud:
                L.Lv(k, l, n.point1X, n.point1Y, n.endX, n.endY, 0.5, b);
                k = n.endX;
                l = n.endY;
                break;
              case Vd:
              case be:
                var p = n.type === Vd ? ce(n, f) : de(n, f, k, l),
                  r = p.length;
                if (0 === r) {
                  k = n.type === Vd ? n.centerX : n.endX;
                  l = n.type === Vd ? n.centerY : n.endY;
                  mc(b, k, l, 0, 0);
                  break;
                }
                n = null;
                for (var q = 0; q < r; q++)
                  (n = p[q]),
                    L.em(
                      n[0],
                      n[1],
                      n[2],
                      n[3],
                      n[4],
                      n[5],
                      n[6],
                      n[7],
                      0.5,
                      b
                    );
                null !== n && ((k = n[6]), (l = n[7]));
                break;
              default:
                v("Unknown Segment type: " + n.type);
            }
          }
        }
        break;
      default:
        v("Unknown Geometry type: " + a.type);
    }
  }
  N.prototype.normalize = function () {
    this.u && xa(this);
    var a = this.Kx();
    this.offset(-a.x, -a.y);
    return new K(-a.x, -a.y);
  };
  N.prototype.offset = function (a, b) {
    this.u && xa(this);
    G && (D(a, N, "offset"), D(b, N, "offset"));
    this.transform(1, 0, 0, 1, a, b);
    return this;
  };
  N.prototype.scale = function (a, b) {
    this.u && xa(this);
    G &&
      (D(a, N, "scale:x"),
      D(b, N, "scale:y"),
      0 === a && Aa(a, "scale must be non-zero", N, "scale:x"),
      0 === b && Aa(b, "scale must be non-zero", N, "scale:y"));
    this.transform(a, 0, 0, b, 0, 0);
    return this;
  };
  N.prototype.rotate = function (a, b, c) {
    this.u && xa(this);
    void 0 === b && (b = 0);
    void 0 === c && (c = 0);
    G && (D(a, N, "rotate:angle"), D(b, N, "rotate:x"), D(c, N, "rotate:y"));
    var d = Kb.alloc();
    d.reset();
    d.rotate(a, b, c);
    this.transform(d.m11, d.m12, d.m21, d.m22, d.dx, d.dy);
    Kb.free(d);
    return this;
  };
  t = N.prototype;
  t.transform = function (a, b, c, d, e, f) {
    switch (this.type) {
      case N.j:
      case N.B:
      case N.M:
        var g = this.jd;
        var h = this.kd;
        this.jd = g * a + h * c + e;
        this.kd = g * b + h * d + f;
        g = this.oc;
        h = this.xc;
        this.oc = g * a + h * c + e;
        this.xc = g * b + h * d + f;
        break;
      case N.o:
        for (var k = this.figures.m, l = k.length, m = 0; m < l; m++) {
          var n = k[m];
          g = n.startX;
          h = n.startY;
          n.startX = g * a + h * c + e;
          n.startY = g * b + h * d + f;
          n = n.segments.m;
          for (var p = n.length, r = 0; r < p; r++) {
            var q = n[r];
            switch (q.type) {
              case Hd:
              case Sd:
                g = q.endX;
                h = q.endY;
                q.endX = g * a + h * c + e;
                q.endY = g * b + h * d + f;
                break;
              case Td:
                g = q.point1X;
                h = q.point1Y;
                q.point1X = g * a + h * c + e;
                q.point1Y = g * b + h * d + f;
                g = q.point2X;
                h = q.point2Y;
                q.point2X = g * a + h * c + e;
                q.point2Y = g * b + h * d + f;
                g = q.endX;
                h = q.endY;
                q.endX = g * a + h * c + e;
                q.endY = g * b + h * d + f;
                break;
              case Ud:
                g = q.point1X;
                h = q.point1Y;
                q.point1X = g * a + h * c + e;
                q.point1Y = g * b + h * d + f;
                g = q.endX;
                h = q.endY;
                q.endX = g * a + h * c + e;
                q.endY = g * b + h * d + f;
                break;
              case Vd:
                g = q.centerX;
                h = q.centerY;
                q.centerX = g * a + h * c + e;
                q.centerY = g * b + h * d + f;
                0 !== b &&
                  ((g = (180 * Math.atan2(b, a)) / Math.PI),
                  0 > g && (g += 360),
                  (q.startAngle += g));
                0 > a &&
                  ((q.startAngle = 180 - q.startAngle),
                  (q.sweepAngle = -q.sweepAngle));
                0 > d &&
                  ((q.startAngle = -q.startAngle),
                  (q.sweepAngle = -q.sweepAngle));
                q.radiusX *= Math.sqrt(a * a + c * c);
                void 0 !== q.radiusY && (q.radiusY *= Math.sqrt(b * b + d * d));
                break;
              case be:
                g = q.endX;
                h = q.endY;
                q.endX = g * a + h * c + e;
                q.endY = g * b + h * d + f;
                if (0 === q.radiusX || 0 === q.radiusY) break;
                0 !== b &&
                  ((g = (180 * Math.atan2(b, a)) / Math.PI),
                  0 > g && (g += 360),
                  (q.xAxisRotation += g));
                0 > a &&
                  ((q.xAxisRotation = 180 - q.xAxisRotation),
                  (q.isClockwiseArc = !q.isClockwiseArc));
                0 > d &&
                  ((q.xAxisRotation = -q.xAxisRotation),
                  (q.isClockwiseArc = !q.isClockwiseArc));
                q.radiusX *= Math.sqrt(a * a + c * c);
                q.radiusY *= Math.sqrt(b * b + d * d);
                break;
              default:
                v("Unknown Segment type: " + q.type);
            }
          }
        }
    }
    this.xa = !0;
    return this;
  };
  t.ca = function (a, b) {
    void 0 === b && (b = 0);
    var c = this.jd,
      d = this.kd,
      e = this.oc,
      f = this.xc;
    switch (this.type) {
      case N.j:
        return L.Ub(c, d, e, f, b, a.x, a.y);
      case N.B:
        var g = M.allocAt(
          Math.min(c, e) - b,
          Math.min(d, f) - b,
          Math.abs(e - c) + 2 * b,
          Math.abs(f - d) + 2 * b
        );
        a = g.ca(a);
        M.free(g);
        return a;
      case N.M:
        g = Math.min(c, e) - b;
        var h = Math.min(d, f) - b;
        c = (Math.abs(e - c) + 2 * b) / 2;
        b = (Math.abs(f - d) + 2 * b) / 2;
        if (0 >= c || 0 >= b) return !1;
        g = a.x - (g + c);
        h = a.y - (h + b);
        return 1 >= (g * g) / (c * c) + (h * h) / (b * b);
      case N.o:
        return ee(this, a, b, !0, !1);
      default:
        return !1;
    }
  };
  function ee(a, b, c, d, e) {
    var f = b.x;
    b = b.y;
    for (
      var g = a.bounds.x - 20,
        h = 0,
        k,
        l,
        m,
        n,
        p = a.figures.m,
        r = p.length,
        q = 0;
      q < r;
      q++
    ) {
      var u = p[q];
      if (u.isFilled) {
        if (d && u.ca(f, b, c)) return !0;
        var w = u.segments;
        k = u.startX;
        l = u.startY;
        for (var y = k, z = l, B = w.m, C = 0; C <= w.length; C++) {
          var E = void 0;
          if (C !== w.length) {
            E = B[C];
            var J = E.type;
            a = E.endX;
            n = E.endY;
          } else (J = Hd), (a = y), (n = z);
          switch (J) {
            case Sd:
              y = fe(f, b, g, b, k, l, y, z);
              if (isNaN(y)) return !0;
              h += y;
              y = a;
              z = n;
              break;
            case Hd:
              k = fe(f, b, g, b, k, l, a, n);
              if (isNaN(k)) return !0;
              h += k;
              break;
            case Td:
              m = L.Xp(
                k,
                l,
                E.point1X,
                E.point1Y,
                E.point2X,
                E.point2Y,
                a,
                n,
                g,
                b,
                f,
                b,
                0.5
              );
              h += m;
              break;
            case Ud:
              m = L.Xp(
                k,
                l,
                (k + 2 * E.point1X) / 3,
                (l + 2 * E.point1Y) / 3,
                (2 * E.point1X + a) / 3,
                (2 * E.point1Y + n) / 3,
                a,
                n,
                g,
                b,
                f,
                b,
                0.5
              );
              h += m;
              break;
            case Vd:
            case be:
              J = E.type === Vd ? ce(E, u) : de(E, u, k, l);
              var S = J.length;
              if (0 === S) {
                k = fe(
                  f,
                  b,
                  g,
                  b,
                  k,
                  l,
                  E.type === Vd ? E.centerX : E.endX,
                  E.type === Vd ? E.centerY : E.endY
                );
                if (isNaN(k)) return !0;
                h += k;
                break;
              }
              E = null;
              for (var aa = 0; aa < S; aa++) {
                E = J[aa];
                if (0 === aa) {
                  m = fe(f, b, g, b, k, l, E[0], E[1]);
                  if (isNaN(m)) return !0;
                  h += m;
                }
                m = L.Xp(
                  E[0],
                  E[1],
                  E[2],
                  E[3],
                  E[4],
                  E[5],
                  E[6],
                  E[7],
                  g,
                  b,
                  f,
                  b,
                  0.5
                );
                h += m;
              }
              null !== E && ((a = E[6]), (n = E[7]));
              break;
            default:
              v("Unknown Segment type: " + E.type);
          }
          k = a;
          l = n;
        }
        if (0 !== h) return !0;
        h = 0;
      } else if (u.ca(f, b, e ? c : c + 2)) return !0;
    }
    return 0 !== h;
  }
  function fe(a, b, c, d, e, f, g, h) {
    if (L.Ub(e, f, g, h, 0.05, a, b)) return NaN;
    var k = (a - c) * (f - h);
    if (0 === k) return 0;
    var l = ((a * d - b * c) * (e - g) - (a - c) * (e * h - f * g)) / k;
    b = ((a * d - b * c) * (f - h)) / k;
    if (l >= a) return 0;
    if ((e > g ? e - g : g - e) < (f > h ? f - h : h - f))
      if (f < h) {
        if (b < f || b > h) return 0;
      } else {
        if (b < h || b > f) return 0;
      }
    else if (e < g) {
      if (l < e || l > g) return 0;
    } else if (l < g || l > e) return 0;
    return 0 < k ? 1 : -1;
  }
  function ge(a, b, c, d) {
    a = a.figures.m;
    for (var e = a.length, f = 0; f < e; f++) if (a[f].ca(b, c, d)) return !0;
    return !1;
  }
  t.vv = function (a, b) {
    0 > a ? (a = 0) : 1 < a && (a = 1);
    void 0 === b && (b = new K());
    if (this.type === N.j)
      return (
        b.h(
          this.startX + a * (this.endX - this.startX),
          this.startY + a * (this.endY - this.startY)
        ),
        b
      );
    for (
      var c = this.flattenedSegments,
        d = this.flattenedLengths,
        e = c.length,
        f = this.flattenedTotalLength * a,
        g = 0,
        h = 0;
      h < e;
      h++
    ) {
      var k = d[h],
        l = k.length;
      for (a = 0; a < l; a++) {
        var m = k[a];
        if (g + m >= f)
          return (
            (d = f - g),
            (d = 0 === m ? 0 : d / m),
            (c = c[h]),
            (h = c[2 * a]),
            (e = c[2 * a + 1]),
            b.h(h + (c[2 * a + 2] - h) * d, e + (c[2 * a + 3] - e) * d),
            b
          );
        g += m;
      }
    }
    return b;
  };
  t.Yx = function (a) {
    0 > a ? (a = 0) : 1 < a && (a = 1);
    if (this.type === N.j)
      return (
        (180 * Math.atan2(this.endY - this.startY, this.endX - this.startX)) /
        Math.PI
      );
    for (
      var b = this.flattenedSegments,
        c = this.flattenedLengths,
        d = b.length,
        e = this.flattenedTotalLength * a,
        f = 0,
        g = 0;
      g < d;
      g++
    ) {
      var h = c[g],
        k = h.length;
      for (a = 0; a < k; a++) {
        var l = h[a];
        if (f + l >= e)
          return (
            (e = b[g]),
            (b = e[2 * a]),
            (c = e[2 * a + 1]),
            (d = e[2 * a + 2]),
            (a = e[2 * a + 3]),
            1 > Math.abs(d - b) && 1 > Math.abs(a - c)
              ? 0
              : 1 > Math.abs(d - b)
              ? 0 <= a - c
                ? 90
                : 270
              : 1 > Math.abs(a - c)
              ? 0 <= d - b
                ? 0
                : 180
              : (180 * Math.atan2(a - c, d - b)) / Math.PI
          );
        f += l;
      }
    }
    return NaN;
  };
  t.wv = function (a, b) {
    0 > a ? (a = 0) : 1 < a && (a = 1);
    void 0 === b && (b = []);
    b.length = 3;
    if (this.type === N.j)
      return (
        (b[0] = this.startX + a * (this.endX - this.startX)),
        (b[1] = this.startY + a * (this.endY - this.startY)),
        (b[2] =
          (180 * Math.atan2(this.endY - this.startY, this.endX - this.startX)) /
          Math.PI),
        b
      );
    for (
      var c = this.flattenedSegments,
        d = this.flattenedLengths,
        e = c.length,
        f = this.flattenedTotalLength * a,
        g = 0,
        h = 0;
      h < e;
      h++
    ) {
      var k = d[h],
        l = k.length;
      for (a = 0; a < l; a++) {
        var m = k[a];
        if (g + m >= f)
          return (
            (d = f - g),
            (d = 0 === m ? 0 : d / m),
            (m = c[h]),
            (c = m[2 * a]),
            (h = m[2 * a + 1]),
            (e = m[2 * a + 2]),
            (a = m[2 * a + 3]),
            (b[0] = c + (e - c) * d),
            (b[1] = h + (a - h) * d),
            (b[2] =
              1 > Math.abs(e - c) && 1 > Math.abs(a - h)
                ? 0
                : 1 > Math.abs(e - c)
                ? 0 <= a - h
                  ? 90
                  : 270
                : 1 > Math.abs(a - h)
                ? 0 <= e - c
                  ? 0
                  : 180
                : (180 * Math.atan2(a - h, e - c)) / Math.PI),
            b
          );
        g += m;
      }
    }
    return b;
  };
  t.Zx = function (a) {
    if (this.type === N.j) {
      var b = this.startX,
        c = this.startY,
        d = this.endX,
        e = this.endY;
      if (b !== d || c !== e) {
        var f = a.x;
        a = a.y;
        if (b === d) {
          if (c < e) {
            var g = c;
            d = e;
          } else (g = e), (d = c);
          return a <= g
            ? g === c
              ? 0
              : 1
            : a >= d
            ? d === c
              ? 0
              : 1
            : Math.abs(a - c) / (d - g);
        }
        if (c === e)
          return (
            b < d ? (g = b) : ((g = d), (d = b)),
            f <= g
              ? g === b
                ? 0
                : 1
              : f >= d
              ? d === b
                ? 0
                : 1
              : Math.abs(f - b) / (d - g)
          );
        g = (d - b) * (d - b) + (e - c) * (e - c);
        var h = K.alloc();
        L.Nh(b, c, d, e, f, a, h);
        a = h.x;
        f = h.y;
        K.free(h);
        return Math.sqrt(((a - b) * (a - b) + (f - c) * (f - c)) / g);
      }
    } else if (this.type === N.B) {
      g = this.startX;
      h = this.startY;
      var k = this.endX;
      e = this.endY;
      if (g !== k || h !== e) {
        b = k - g;
        c = e - h;
        f = 2 * b + 2 * c;
        d = a.x;
        a = a.y;
        d = Math.min(Math.max(d, g), k);
        a = Math.min(Math.max(a, h), e);
        g = Math.abs(d - g);
        k = Math.abs(d - k);
        h = Math.abs(a - h);
        e = Math.abs(a - e);
        var l = Math.min(g, k, h, e);
        if (l === h) return d / f;
        if (l === k) return (b + a) / f;
        if (l === e) return (2 * b + c - d) / f;
        if (l === g) return (2 * b + 2 * c - a) / f;
      }
    } else {
      b = this.flattenedSegments;
      c = this.flattenedLengths;
      f = this.flattenedTotalLength;
      d = K.alloc();
      e = Infinity;
      h = g = 0;
      k = b.length;
      for (var m = (l = 0), n = 0; n < k; n++)
        for (var p = b[n], r = c[n], q = p.length, u = 0; u < q; u += 2) {
          var w = p[u],
            y = p[u + 1];
          if (0 !== u) {
            L.Nh(l, m, w, y, a.x, a.y, d);
            var z = (d.x - a.x) * (d.x - a.x) + (d.y - a.y) * (d.y - a.y);
            z < e &&
              ((e = z),
              (g = h),
              (g += Math.sqrt((d.x - l) * (d.x - l) + (d.y - m) * (d.y - m))));
            h += r[(u - 2) / 2];
          }
          l = w;
          m = y;
        }
      K.free(d);
      a = g / f;
      return 0 > a ? 0 : 1 < a ? 1 : a;
    }
    return 0;
  };
  function he(a) {
    if (null === a.Pk) {
      var b = (a.Pk = []),
        c = (a.an = []),
        d = [],
        e = [];
      if (a.type === N.j)
        d.push(a.startX),
          d.push(a.startY),
          d.push(a.endX),
          d.push(a.endY),
          b.push(d),
          e.push(
            Math.sqrt(
              (a.startX - a.endX) * (a.startX - a.endX) +
                (a.startY - a.endY) * (a.startY - a.endY)
            )
          ),
          c.push(e);
      else if (a.type === N.B)
        d.push(a.startX),
          d.push(a.startY),
          d.push(a.endX),
          d.push(a.startY),
          d.push(a.endX),
          d.push(a.endY),
          d.push(a.startX),
          d.push(a.endY),
          d.push(a.startX),
          d.push(a.startY),
          b.push(d),
          e.push(Math.abs(a.startX - a.endX)),
          e.push(Math.abs(a.startY - a.endY)),
          e.push(Math.abs(a.startX - a.endX)),
          e.push(Math.abs(a.startY - a.endY)),
          c.push(e);
      else if (a.type === N.M) {
        var f = new ie();
        f.startX = a.endX;
        f.startY = (a.startY + a.endY) / 2;
        var g = new je(Vd);
        g.startAngle = 0;
        g.sweepAngle = 360;
        g.centerX = (a.startX + a.endX) / 2;
        g.centerY = (a.startY + a.endY) / 2;
        g.radiusX = Math.abs(a.startX - a.endX) / 2;
        g.radiusY = Math.abs(a.startY - a.endY) / 2;
        f.add(g);
        a = ce(g, f);
        e = a.length;
        if (0 === e) d.push(g.centerX), d.push(g.centerY);
        else {
          g = f.startX;
          f = f.startY;
          for (var h = 0; h < e; h++) {
            var k = a[h];
            L.Pe(g, f, k[2], k[3], k[4], k[5], k[6], k[7], 0.5, d);
            g = k[6];
            f = k[7];
          }
        }
        b.push(d);
        c.push(ke(d));
      } else
        for (a = a.figures.iterator; a.next(); ) {
          e = a.value;
          d = [];
          d.push(e.startX);
          d.push(e.startY);
          g = e.startX;
          f = e.startY;
          h = g;
          k = f;
          for (var l = e.segments.m, m = l.length, n = 0; n < m; n++) {
            var p = l[n];
            switch (p.type) {
              case Sd:
                4 <= d.length && (b.push(d), c.push(ke(d)));
                d = [];
                d.push(p.endX);
                d.push(p.endY);
                g = p.endX;
                f = p.endY;
                h = g;
                k = f;
                break;
              case Hd:
                d.push(p.endX);
                d.push(p.endY);
                g = p.endX;
                f = p.endY;
                break;
              case Td:
                L.Pe(
                  g,
                  f,
                  p.point1X,
                  p.point1Y,
                  p.point2X,
                  p.point2Y,
                  p.endX,
                  p.endY,
                  0.5,
                  d
                );
                g = p.endX;
                f = p.endY;
                break;
              case Ud:
                L.vq(g, f, p.point1X, p.point1Y, p.endX, p.endY, 0.5, d);
                g = p.endX;
                f = p.endY;
                break;
              case Vd:
                var r = ce(p, e),
                  q = r.length;
                if (0 === q) {
                  d.push(p.centerX);
                  d.push(p.centerY);
                  g = p.centerX;
                  f = p.centerY;
                  break;
                }
                for (var u = 0; u < q; u++) {
                  var w = r[u];
                  L.Pe(g, f, w[2], w[3], w[4], w[5], w[6], w[7], 0.5, d);
                  g = w[6];
                  f = w[7];
                }
                break;
              case be:
                r = de(p, e, g, f);
                q = r.length;
                u = p.endX;
                w = p.endY;
                if (0 === q) {
                  d.push(u);
                  d.push(w);
                  g = u;
                  f = w;
                  break;
                }
                for (u = 0; u < q; u++)
                  (w = r[u]),
                    L.Pe(g, f, w[2], w[3], w[4], w[5], w[6], w[7], 0.5, d),
                    (g = w[6]),
                    (f = w[7]);
                break;
              default:
                v("Segment not of valid type: " + p.type);
            }
            p.isClosed && (d.push(h), d.push(k));
          }
          4 <= d.length && (b.push(d), c.push(ke(d)));
        }
    }
  }
  function ke(a) {
    for (var b = [], c = 0, d = 0, e = a.length, f = 0; f < e; f += 2) {
      var g = a[f],
        h = a[f + 1];
      0 !== f && ((c = Math.sqrt(Nb(c, d, g, h))), b.push(c));
      c = g;
      d = h;
    }
    return b;
  }
  t.add = function (a) {
    this.Aj.add(a);
    return this;
  };
  t.Nm = function (a, b, c, d, e, f, g, h) {
    this.u && xa(this);
    this.vf = new Ib(a, b, e, f).freeze();
    this.wf = new Ib(c, d, g, h).freeze();
    return this;
  };
  oa.Object.defineProperties(N.prototype, {
    flattenedSegments: {
      configurable: !0,
      get: function () {
        he(this);
        return this.Pk;
      },
    },
    flattenedLengths: {
      configurable: !0,
      get: function () {
        he(this);
        return this.an;
      },
    },
    flattenedTotalLength: {
      configurable: !0,
      get: function () {
        var a = this.bn;
        if (isNaN(a)) {
          if (this.type === N.j) {
            a = Math.abs(this.endX - this.startX);
            var b = Math.abs(this.endY - this.startY);
            a = Math.sqrt(a * a + b * b);
          } else if (this.type === N.B)
            a =
              2 * Math.abs(this.endX - this.startX) +
              2 * Math.abs(this.endY - this.startY);
          else {
            b = this.flattenedLengths;
            for (var c = b.length, d = (a = 0); d < c; d++)
              for (var e = b[d], f = e.length, g = 0; g < f; g++) a += e[g];
          }
          this.bn = a;
        }
        return a;
      },
    },
    type: {
      configurable: !0,
      get: function () {
        return this.pa;
      },
      set: function (a) {
        this.pa !== a &&
          (G && cb(a, N, N, "type"),
          this.u && xa(this, a),
          (this.pa = a),
          (this.xa = !0));
      },
    },
    startX: {
      configurable: !0,
      get: function () {
        return this.jd;
      },
      set: function (a) {
        this.jd !== a &&
          (G && D(a, N, "startX"),
          this.u && xa(this, a),
          (this.jd = a),
          (this.xa = !0));
      },
    },
    startY: {
      configurable: !0,
      get: function () {
        return this.kd;
      },
      set: function (a) {
        this.kd !== a &&
          (G && D(a, N, "startY"),
          this.u && xa(this, a),
          (this.kd = a),
          (this.xa = !0));
      },
    },
    endX: {
      configurable: !0,
      get: function () {
        return this.oc;
      },
      set: function (a) {
        this.oc !== a &&
          (G && D(a, N, "endX"),
          this.u && xa(this, a),
          (this.oc = a),
          (this.xa = !0));
      },
    },
    endY: {
      configurable: !0,
      get: function () {
        return this.xc;
      },
      set: function (a) {
        this.xc !== a &&
          (G && D(a, N, "endY"),
          this.u && xa(this, a),
          (this.xc = a),
          (this.xa = !0));
      },
    },
    figures: {
      configurable: !0,
      get: function () {
        return this.Aj;
      },
      set: function (a) {
        this.Aj !== a &&
          (G && x(a, H, N, "figures"),
          this.u && xa(this, a),
          (this.Aj = a),
          (this.xa = !0));
      },
    },
    spot1: {
      configurable: !0,
      get: function () {
        return this.vf;
      },
      set: function (a) {
        G && x(a, Ib, N, "spot1");
        this.u && xa(this, a);
        this.vf = a.L();
      },
    },
    spot2: {
      configurable: !0,
      get: function () {
        return this.wf;
      },
      set: function (a) {
        G && x(a, Ib, N, "spot2");
        this.u && xa(this, a);
        this.wf = a.L();
      },
    },
    defaultStretch: {
      configurable: !0,
      get: function () {
        return this.Wf;
      },
      set: function (a) {
        G && cb(a, O, N, "stretch");
        this.u && xa(this, a);
        this.Wf = a;
      },
    },
    bounds: {
      configurable: !0,
      get: function () {
        this.Ev() && this.computeBounds();
        return this.Xq;
      },
    },
  });
  N.prototype.setSpots = N.prototype.Nm;
  N.prototype.add = N.prototype.add;
  N.prototype.getFractionForPoint = N.prototype.Zx;
  N.prototype.getPointAndAngleAlongPath = N.prototype.wv;
  N.prototype.getAngleAlongPath = N.prototype.Yx;
  N.prototype.getPointAlongPath = N.prototype.vv;
  N.prototype.containsPoint = N.prototype.ca;
  N.prototype.transform = N.prototype.transform;
  N.prototype.rotate = N.prototype.rotate;
  N.prototype.scale = N.prototype.scale;
  N.prototype.offset = N.prototype.offset;
  N.prototype.normalize = N.prototype.normalize;
  N.prototype.computeBoundsWithoutOrigin = N.prototype.Kx;
  N.prototype.equalsApprox = N.prototype.$a;
  N.className = "Geometry";
  N.j = new F(N, "Line", 0);
  N.B = new F(N, "Rectangle", 1);
  N.M = new F(N, "Ellipse", 2);
  N.o = new F(N, "Path", 3);
  N.Yc = "UuBbMmZzLlHhVvCcSsQqTtAaFfXx";
  N.className = "Geometry";
  N.stringify = N.Ba;
  N.fillPath = N.eb;
  N.parse = N.parse;
  N.Line = N.j;
  N.Rectangle = N.B;
  N.Ellipse = N.M;
  N.Path = N.o;
  function ie(a, b, c, d) {
    ab(this);
    this.Gw = null;
    this.u = !1;
    void 0 === c && (c = !0);
    this.vr = c;
    void 0 === d && (d = !0);
    this.Ar = d;
    void 0 !== a ? (G && D(a, ie, "sx"), (this.jd = a)) : (this.jd = 0);
    void 0 !== b ? (G && D(b, ie, "sy"), (this.kd = b)) : (this.kd = 0);
    this.Rl = new H();
    this.$r = this.Rl.w;
    this.xa = !0;
  }
  ie.prototype.copy = function () {
    var a = new ie();
    a.vr = this.vr;
    a.Ar = this.Ar;
    a.jd = this.jd;
    a.kd = this.kd;
    for (var b = this.Rl.m, c = b.length, d = a.Rl, e = 0; e < c; e++) {
      var f = b[e].copy();
      d.add(f);
    }
    a.$r = this.$r;
    a.xa = this.xa;
    a.Gw = this.Gw;
    return a;
  };
  t = ie.prototype;
  t.$a = function (a) {
    if (
      !(
        a instanceof ie &&
        L.C(this.startX, a.startX) &&
        L.C(this.startY, a.startY)
      )
    )
      return !1;
    var b = this.segments.m;
    a = a.segments.m;
    var c = b.length;
    if (c !== a.length) return !1;
    for (var d = 0; d < c; d++) if (!b[d].$a(a[d])) return !1;
    return !0;
  };
  t.toString = function (a) {
    void 0 === a && (a = -1);
    var b =
      0 > a
        ? "M" + this.startX.toString() + " " + this.startY.toString()
        : "M" + this.startX.toFixed(a) + " " + this.startY.toFixed(a);
    for (var c = this.segments.m, d = c.length, e = 0; e < d; e++)
      b += " " + c[e].toString(a);
    return b;
  };
  t.freeze = function () {
    this.u = !0;
    var a = this.segments;
    a.freeze();
    var b = a.m;
    a = a.length;
    for (var c = 0; c < a; c++) b[c].freeze();
    return this;
  };
  t.la = function () {
    this.u = !1;
    var a = this.segments;
    a.la();
    a = a.m;
    for (var b = a.length, c = 0; c < b; c++) a[c].la();
    return this;
  };
  t.Ev = function () {
    if (this.xa) return !0;
    var a = this.segments;
    if (this.$r !== a.w) return !0;
    a = a.m;
    for (var b = a.length, c = 0; c < b; c++) if (a[c].xa) return !0;
    return !1;
  };
  t.add = function (a) {
    this.Rl.add(a);
    return this;
  };
  t.ca = function (a, b, c) {
    for (
      var d = this.startX,
        e = this.startY,
        f = d,
        g = e,
        h = this.segments.m,
        k = h.length,
        l = 0;
      l < k;
      l++
    ) {
      var m = h[l];
      switch (m.type) {
        case Sd:
          f = m.endX;
          g = m.endY;
          d = m.endX;
          e = m.endY;
          break;
        case Hd:
          if (L.Ub(d, e, m.endX, m.endY, c, a, b)) return !0;
          d = m.endX;
          e = m.endY;
          break;
        case Td:
          if (
            L.vs(
              d,
              e,
              m.point1X,
              m.point1Y,
              m.point2X,
              m.point2Y,
              m.endX,
              m.endY,
              0.5,
              a,
              b,
              c
            )
          )
            return !0;
          d = m.endX;
          e = m.endY;
          break;
        case Ud:
          if (L.Mv(d, e, m.point1X, m.point1Y, m.endX, m.endY, 0.5, a, b, c))
            return !0;
          d = m.endX;
          e = m.endY;
          break;
        case Vd:
        case be:
          var n = m.type === Vd ? ce(m, this) : de(m, this, d, e),
            p = n.length,
            r = m.type === Vd ? m.centerX : m.endX,
            q = m.type === Vd ? m.centerY : m.endY;
          if (0 === p) {
            if (L.Ub(d, e, r, q, c, a, b)) return !0;
            d = r;
            e = q;
            break;
          }
          r = null;
          for (q = 0; q < p; q++)
            if (
              ((r = n[q]),
              (0 === q && L.Ub(d, e, r[0], r[1], c, a, b)) ||
                L.vs(
                  r[0],
                  r[1],
                  r[2],
                  r[3],
                  r[4],
                  r[5],
                  r[6],
                  r[7],
                  0.5,
                  a,
                  b,
                  c
                ))
            )
              return !0;
          null !== r && ((d = r[6]), (e = r[7]));
          break;
        default:
          v("Unknown Segment type: " + m.type);
      }
      if (m.isClosed && (d !== f || e !== g) && L.Ub(d, e, f, g, c, a, b))
        return !0;
    }
    return !1;
  };
  oa.Object.defineProperties(ie.prototype, {
    isFilled: {
      configurable: !0,
      get: function () {
        return this.vr;
      },
      set: function (a) {
        G && A(a, "boolean", ie, "isFilled");
        this.u && xa(this, a);
        this.vr = a;
      },
    },
    isShadowed: {
      configurable: !0,
      get: function () {
        return this.Ar;
      },
      set: function (a) {
        G && A(a, "boolean", ie, "isShadowed");
        this.u && xa(this, a);
        this.Ar = a;
      },
    },
    startX: {
      configurable: !0,
      get: function () {
        return this.jd;
      },
      set: function (a) {
        G && D(a, ie, "startX");
        this.u && xa(this, a);
        this.jd = a;
        this.xa = !0;
      },
    },
    startY: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.kd;
      },
      set: function (a) {
        G && D(a, ie, "startY");
        this.u && xa(this, a);
        this.kd = a;
        this.xa = !0;
      },
    },
    segments: {
      configurable: !0,
      get: function () {
        return this.Rl;
      },
      set: function (a) {
        G && x(a, H, ie, "segments");
        this.u && xa(this, a);
        this.Rl = a;
        this.xa = !0;
      },
    },
  });
  ie.prototype.add = ie.prototype.add;
  ie.prototype.equalsApprox = ie.prototype.$a;
  ie.className = "PathFigure";
  function je(a, b, c, d, e, f, g, h) {
    ab(this);
    this.u = !1;
    void 0 === a ? (a = Hd) : G && cb(a, je, je, "constructor:type");
    this.pa = a;
    void 0 !== b ? (G && D(b, je, "ex"), (this.oc = b)) : (this.oc = 0);
    void 0 !== c ? (G && D(c, je, "ey"), (this.xc = c)) : (this.xc = 0);
    void 0 === d && (d = 0);
    void 0 === e && (e = 0);
    void 0 === f && (f = 0);
    void 0 === g && (g = 0);
    a === be
      ? ((a = f % 360),
        0 > a && (a += 360),
        (this.Ke = a),
        (this.yi = 0),
        G && D(d, je, "x1"),
        (this.zi = Math.max(d, 0)),
        G && D(e, je, "y1"),
        (this.lh = Math.max(e, 0)),
        (this.zl =
          "boolean" === typeof g ? g : "number" === typeof g ? !!g : !1),
        (this.Vk = !!h))
      : (G && D(d, je, "x1"),
        (this.Ke = d),
        G && D(e, je, "y1"),
        (this.yi = e),
        G && D(f, je, "x2"),
        a === Vd && (f = Math.max(f, 0)),
        (this.zi = f),
        "number" === typeof g
          ? (a === Vd && (g = Math.max(g, 0)), (this.lh = g))
          : (this.lh = 0),
        (this.Vk = this.zl = !1));
    this.Gj = !1;
    this.xa = !0;
    this.Xd = null;
  }
  je.prototype.copy = function () {
    var a = new je();
    a.pa = this.pa;
    a.oc = this.oc;
    a.xc = this.xc;
    a.Ke = this.Ke;
    a.yi = this.yi;
    a.zi = this.zi;
    a.lh = this.lh;
    a.zl = this.zl;
    a.Vk = this.Vk;
    a.Gj = this.Gj;
    a.xa = this.xa;
    return a;
  };
  t = je.prototype;
  t.$a = function (a) {
    if (
      !(a instanceof je) ||
      this.type !== a.type ||
      this.isClosed !== a.isClosed
    )
      return !1;
    switch (this.type) {
      case Sd:
      case Hd:
        return L.C(this.endX, a.endX) && L.C(this.endY, a.endY);
      case Td:
        return (
          L.C(this.endX, a.endX) &&
          L.C(this.endY, a.endY) &&
          L.C(this.point1X, a.point1X) &&
          L.C(this.point1Y, a.point1Y) &&
          L.C(this.point2X, a.point2X) &&
          L.C(this.point2Y, a.point2Y)
        );
      case Ud:
        return (
          L.C(this.endX, a.endX) &&
          L.C(this.endY, a.endY) &&
          L.C(this.point1X, a.point1X) &&
          L.C(this.point1Y, a.point1Y)
        );
      case Vd:
        return (
          L.C(this.startAngle, a.startAngle) &&
          L.C(this.sweepAngle, a.sweepAngle) &&
          L.C(this.centerX, a.centerX) &&
          L.C(this.centerY, a.centerY) &&
          L.C(this.radiusX, a.radiusX) &&
          L.C(this.radiusY, a.radiusY)
        );
      case be:
        return (
          this.isClockwiseArc === a.isClockwiseArc &&
          this.isLargeArc === a.isLargeArc &&
          L.C(this.xAxisRotation, a.xAxisRotation) &&
          L.C(this.endX, a.endX) &&
          L.C(this.endY, a.endY) &&
          L.C(this.radiusX, a.radiusX) &&
          L.C(this.radiusY, a.radiusY)
        );
      default:
        return !1;
    }
  };
  t.pb = function (a) {
    a.classType === je ? (this.type = a) : Ea(this, a);
  };
  t.toString = function (a) {
    void 0 === a && (a = -1);
    switch (this.type) {
      case Sd:
        a =
          0 > a
            ? "M" + this.endX.toString() + " " + this.endY.toString()
            : "M" + this.endX.toFixed(a) + " " + this.endY.toFixed(a);
        break;
      case Hd:
        a =
          0 > a
            ? "L" + this.endX.toString() + " " + this.endY.toString()
            : "L" + this.endX.toFixed(a) + " " + this.endY.toFixed(a);
        break;
      case Td:
        a =
          0 > a
            ? "C" +
              this.point1X.toString() +
              " " +
              this.point1Y.toString() +
              " " +
              this.point2X.toString() +
              " " +
              this.point2Y.toString() +
              " " +
              this.endX.toString() +
              " " +
              this.endY.toString()
            : "C" +
              this.point1X.toFixed(a) +
              " " +
              this.point1Y.toFixed(a) +
              " " +
              this.point2X.toFixed(a) +
              " " +
              this.point2Y.toFixed(a) +
              " " +
              this.endX.toFixed(a) +
              " " +
              this.endY.toFixed(a);
        break;
      case Ud:
        a =
          0 > a
            ? "Q" +
              this.point1X.toString() +
              " " +
              this.point1Y.toString() +
              " " +
              this.endX.toString() +
              " " +
              this.endY.toString()
            : "Q" +
              this.point1X.toFixed(a) +
              " " +
              this.point1Y.toFixed(a) +
              " " +
              this.endX.toFixed(a) +
              " " +
              this.endY.toFixed(a);
        break;
      case Vd:
        a =
          0 > a
            ? "B" +
              this.startAngle.toString() +
              " " +
              this.sweepAngle.toString() +
              " " +
              this.centerX.toString() +
              " " +
              this.centerY.toString() +
              " " +
              this.radiusX.toString() +
              " " +
              this.radiusY.toString()
            : "B" +
              this.startAngle.toFixed(a) +
              " " +
              this.sweepAngle.toFixed(a) +
              " " +
              this.centerX.toFixed(a) +
              " " +
              this.centerY.toFixed(a) +
              " " +
              this.radiusX.toFixed(a) +
              " " +
              this.radiusY.toFixed(a);
        break;
      case be:
        a =
          0 > a
            ? "A" +
              this.radiusX.toString() +
              " " +
              this.radiusY.toString() +
              " " +
              this.xAxisRotation.toString() +
              " " +
              (this.isLargeArc ? 1 : 0) +
              " " +
              (this.isClockwiseArc ? 1 : 0) +
              " " +
              this.endX.toString() +
              " " +
              this.endY.toString()
            : "A" +
              this.radiusX.toFixed(a) +
              " " +
              this.radiusY.toFixed(a) +
              " " +
              this.xAxisRotation.toFixed(a) +
              " " +
              (this.isLargeArc ? 1 : 0) +
              " " +
              (this.isClockwiseArc ? 1 : 0) +
              " " +
              this.endX.toFixed(a) +
              " " +
              this.endY.toFixed(a);
        break;
      default:
        a = this.type.toString();
    }
    return a + (this.Gj ? "z" : "");
  };
  t.freeze = function () {
    this.u = !0;
    return this;
  };
  t.la = function () {
    this.u = !1;
    return this;
  };
  t.close = function () {
    this.Gj = !0;
    return this;
  };
  function ce(a, b) {
    if (null !== a.Xd && !1 === b.xa) return a.Xd;
    var c = a.radiusX,
      d = a.radiusY;
    void 0 === d && (d = c);
    if (0 === c || 0 === d) return (a.Xd = []), a.Xd;
    b = a.Ke;
    var e = a.yi,
      f = L.Lx(
        0,
        0,
        c < d ? c : d,
        a.startAngle,
        a.startAngle + a.sweepAngle,
        !1
      );
    if (c !== d) {
      var g = Kb.alloc();
      g.reset();
      c < d ? g.scale(1, d / c) : g.scale(c / d, 1);
      N.Na(f, g);
      Kb.free(g);
    }
    c = f.length;
    for (d = 0; d < c; d++)
      (g = f[d]),
        (g[0] += b),
        (g[1] += e),
        (g[2] += b),
        (g[3] += e),
        (g[4] += b),
        (g[5] += e),
        (g[6] += b),
        (g[7] += e);
    a.Xd = f;
    return a.Xd;
  }
  function de(a, b, c, d) {
    function e(a, b, c, d) {
      return (
        (a * d < b * c ? -1 : 1) *
        Math.acos(
          (a * c + b * d) /
            (Math.sqrt(a * a + b * b) * Math.sqrt(c * c + d * d))
        )
      );
    }
    if (null !== a.Xd && !1 === b.xa) return a.Xd;
    if (0 === a.radiusX || 0 === a.radiusY) return (a.Xd = []), a.Xd;
    b = a.zi;
    var f = a.lh;
    0 === b && (b = 1e-4);
    0 === f && (f = 1e-4);
    var g = (Math.PI / 180) * a.Ke,
      h = a.zl,
      k = a.Vk,
      l = a.oc,
      m = a.xc,
      n = Math.cos(g),
      p = Math.sin(g),
      r = (n * (c - l)) / 2 + (p * (d - m)) / 2;
    g = (-p * (c - l)) / 2 + (n * (d - m)) / 2;
    var q = (r * r) / (b * b) + (g * g) / (f * f);
    1 < q && ((b *= Math.sqrt(q)), (f *= Math.sqrt(q)));
    q =
      (h === k ? -1 : 1) *
      Math.sqrt(
        (b * b * f * f - b * b * g * g - f * f * r * r) /
          (b * b * g * g + f * f * r * r)
      );
    isNaN(q) && (q = 0);
    h = (q * b * g) / f;
    q = (q * -f * r) / b;
    isNaN(h) && (h = 0);
    isNaN(q) && (q = 0);
    c = (c + l) / 2 + n * h - p * q;
    d = (d + m) / 2 + p * h + n * q;
    m = e(1, 0, (r - h) / b, (g - q) / f);
    n = (r - h) / b;
    l = (g - q) / f;
    r = (-r - h) / b;
    h = (-g - q) / f;
    g = e(n, l, r, h);
    r = (n * r + l * h) / (Math.sqrt(n * n + l * l) * Math.sqrt(r * r + h * h));
    -1 >= r ? (g = Math.PI) : 1 <= r && (g = 0);
    !k && 0 < g && (g -= 2 * Math.PI);
    k && 0 > g && (g += 2 * Math.PI);
    k = b > f ? 1 : b / f;
    r = b > f ? f / b : 1;
    b = L.Lx(0, 0, b > f ? b : f, m, m + g, !0);
    f = Kb.alloc();
    f.reset();
    f.translate(c, d);
    f.rotate(a.Ke, 0, 0);
    f.scale(k, r);
    N.Na(b, f);
    Kb.free(f);
    a.Xd = b;
    return a.Xd;
  }
  oa.Object.defineProperties(je.prototype, {
    isClosed: {
      configurable: !0,
      get: function () {
        return this.Gj;
      },
      set: function (a) {
        this.Gj !== a && ((this.Gj = a), (this.xa = !0));
      },
    },
    type: {
      configurable: !0,
      get: function () {
        return this.pa;
      },
      set: function (a) {
        G && cb(a, je, je, "type");
        this.u && xa(this, a);
        this.pa = a;
        this.xa = !0;
      },
    },
    endX: {
      configurable: !0,
      get: function () {
        return this.oc;
      },
      set: function (a) {
        G && D(a, je, "endX");
        this.u && xa(this, a);
        this.oc = a;
        this.xa = !0;
      },
    },
    endY: {
      configurable: !0,
      get: function () {
        return this.xc;
      },
      set: function (a) {
        G && D(a, je, "endY");
        this.u && xa(this, a);
        this.xc = a;
        this.xa = !0;
      },
    },
    point1X: {
      configurable: !0,
      get: function () {
        return this.Ke;
      },
      set: function (a) {
        G && D(a, je, "point1X");
        this.u && xa(this, a);
        this.Ke = a;
        this.xa = !0;
      },
    },
    point1Y: {
      configurable: !0,
      get: function () {
        return this.yi;
      },
      set: function (a) {
        G && D(a, je, "point1Y");
        this.u && xa(this, a);
        this.yi = a;
        this.xa = !0;
      },
    },
    point2X: {
      configurable: !0,
      get: function () {
        return this.zi;
      },
      set: function (a) {
        G && D(a, je, "point2X");
        this.u && xa(this, a);
        this.zi = a;
        this.xa = !0;
      },
    },
    point2Y: {
      configurable: !0,
      get: function () {
        return this.lh;
      },
      set: function (a) {
        G && D(a, je, "point2Y");
        this.u && xa(this, a);
        this.lh = a;
        this.xa = !0;
      },
    },
    centerX: {
      configurable: !0,
      get: function () {
        return this.Ke;
      },
      set: function (a) {
        G && D(a, je, "centerX");
        this.u && xa(this, a);
        this.Ke = a;
        this.xa = !0;
      },
    },
    centerY: {
      configurable: !0,
      get: function () {
        return this.yi;
      },
      set: function (a) {
        G && D(a, je, "centerY");
        this.u && xa(this, a);
        this.yi = a;
        this.xa = !0;
      },
    },
    radiusX: {
      configurable: !0,
      get: function () {
        return this.zi;
      },
      set: function (a) {
        G && D(a, je, "radiusX");
        0 > a && Aa(a, ">= zero", je, "radiusX");
        this.u && xa(this, a);
        this.zi = a;
        this.xa = !0;
      },
    },
    radiusY: {
      configurable: !0,
      get: function () {
        return this.lh;
      },
      set: function (a) {
        G && D(a, je, "radiusY");
        0 > a && Aa(a, ">= zero", je, "radiusY");
        this.u && xa(this, a);
        this.lh = a;
        this.xa = !0;
      },
    },
    startAngle: {
      configurable: !0,
      get: function () {
        return this.oc;
      },
      set: function (a) {
        this.oc !== a &&
          (this.u && xa(this, a),
          G && D(a, je, "startAngle"),
          (a %= 360),
          0 > a && (a += 360),
          (this.oc = a),
          (this.xa = !0));
      },
    },
    sweepAngle: {
      configurable: !0,
      get: function () {
        return this.xc;
      },
      set: function (a) {
        G && D(a, je, "sweepAngle");
        this.u && xa(this, a);
        360 < a && (a = 360);
        -360 > a && (a = -360);
        this.xc = a;
        this.xa = !0;
      },
    },
    isClockwiseArc: {
      configurable: !0,
      get: function () {
        return this.Vk;
      },
      set: function (a) {
        this.u && xa(this, a);
        this.Vk = a;
        this.xa = !0;
      },
    },
    isLargeArc: {
      configurable: !0,
      get: function () {
        return this.zl;
      },
      set: function (a) {
        this.u && xa(this, a);
        this.zl = a;
        this.xa = !0;
      },
    },
    xAxisRotation: {
      configurable: !0,
      get: function () {
        return this.Ke;
      },
      set: function (a) {
        G && D(a, je, "xAxisRotation");
        a %= 360;
        0 > a && (a += 360);
        this.u && xa(this, a);
        this.Ke = a;
        this.xa = !0;
      },
    },
  });
  je.prototype.equalsApprox = je.prototype.$a;
  var Sd = new F(je, "Move", 0),
    Hd = new F(je, "Line", 1),
    Td = new F(je, "Bezier", 2),
    Ud = new F(je, "QuadraticBezier", 3),
    Vd = new F(je, "Arc", 4),
    be = new F(je, "SvgArc", 4);
  je.className = "PathSegment";
  je.Move = Sd;
  je.Line = Hd;
  je.Bezier = Td;
  je.QuadraticBezier = Ud;
  je.Arc = Vd;
  je.SvgArc = be;
  function le() {
    this.G = null;
    this.Vu = new K(0, 0).freeze();
    this.Gt = new K(0, 0).freeze();
    this.Qq = this.Jr = 0;
    this.Rq = 1;
    this.ki = "";
    this.rs = this.fr = !1;
    this.dr = this.Tq = 0;
    this.Dg = this.sr = this.yr = !1;
    this.jr = null;
    this.ps = 0;
    this.wd = this.os = null;
  }
  le.prototype.copy = function () {
    var a = new le();
    return this.clone(a);
  };
  le.prototype.clone = function (a) {
    a.G = this.G;
    a.Vu.assign(this.viewPoint);
    a.Gt.assign(this.documentPoint);
    a.Jr = this.Jr;
    a.Qq = this.Qq;
    a.Rq = this.Rq;
    a.ki = this.ki;
    a.fr = this.fr;
    a.rs = this.rs;
    a.Tq = this.Tq;
    a.dr = this.dr;
    a.yr = this.yr;
    a.sr = this.sr;
    a.Dg = this.Dg;
    a.jr = this.jr;
    a.ps = this.ps;
    a.os = this.os;
    a.wd = this.wd;
    return a;
  };
  le.prototype.toString = function () {
    var a = "^";
    0 !== this.modifiers && (a += "M:" + this.modifiers);
    0 !== this.button && (a += "B:" + this.button);
    "" !== this.key && (a += "K:" + this.key);
    0 !== this.clickCount && (a += "C:" + this.clickCount);
    0 !== this.delta && (a += "D:" + this.delta);
    this.handled && (a += "h");
    this.bubbles && (a += "b");
    null !== this.documentPoint && (a += "@" + this.documentPoint.toString());
    return a;
  };
  le.prototype.jq = function (a, b) {
    var c = this.diagram;
    if (null === c) return b;
    me(c, this.event, a, b);
    return b;
  };
  le.prototype.kA = function (a, b) {
    var c = this.diagram;
    if (null === c) return b;
    me(c, this.event, a, b);
    b.assign(c.jt(b));
    return b;
  };
  oa.Object.defineProperties(le.prototype, {
    diagram: {
      configurable: !0,
      get: function () {
        return this.G;
      },
      set: function (a) {
        this.G = a;
      },
    },
    viewPoint: {
      configurable: !0,
      get: function () {
        return this.Vu;
      },
      set: function (a) {
        x(a, K, le, "viewPoint");
        this.Vu.assign(a);
      },
    },
    documentPoint: {
      configurable: !0,
      get: function () {
        return this.Gt;
      },
      set: function (a) {
        x(a, K, le, "documentPoint");
        this.Gt.assign(a);
      },
    },
    modifiers: {
      configurable: !0,
      get: function () {
        return this.Jr;
      },
      set: function (a) {
        this.Jr = a;
      },
    },
    button: {
      configurable: !0,
      get: function () {
        return this.Qq;
      },
      set: function (a) {
        this.Qq = a;
        if (null === this.event)
          switch (a) {
            case 0:
              this.buttons = 1;
              break;
            case 1:
              this.buttons = 4;
              break;
            case 2:
              this.buttons = 2;
          }
      },
    },
    buttons: {
      configurable: !0,
      get: function () {
        return this.Rq;
      },
      set: function (a) {
        this.Rq = a;
      },
    },
    key: {
      configurable: !0,
      get: function () {
        return this.ki;
      },
      set: function (a) {
        this.ki = a;
      },
    },
    down: {
      configurable: !0,
      get: function () {
        return this.fr;
      },
      set: function (a) {
        this.fr = a;
      },
    },
    up: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.rs;
      },
      set: function (a) {
        this.rs = a;
      },
    },
    clickCount: {
      configurable: !0,
      get: function () {
        return this.Tq;
      },
      set: function (a) {
        this.Tq = a;
      },
    },
    delta: {
      configurable: !0,
      get: function () {
        return this.dr;
      },
      set: function (a) {
        this.dr = a;
      },
    },
    isMultiTouch: {
      configurable: !0,
      get: function () {
        return this.yr;
      },
      set: function (a) {
        this.yr = a;
      },
    },
    handled: {
      configurable: !0,
      get: function () {
        return this.sr;
      },
      set: function (a) {
        this.sr = a;
      },
    },
    bubbles: {
      configurable: !0,
      get: function () {
        return this.Dg;
      },
      set: function (a) {
        this.Dg = a;
      },
    },
    event: {
      configurable: !0,
      get: function () {
        return this.jr;
      },
      set: function (a) {
        this.jr = a;
      },
    },
    isTouchEvent: {
      configurable: !0,
      get: function () {
        var a = sa.TouchEvent,
          b = this.event;
        return a && b instanceof a
          ? !0
          : (a = sa.PointerEvent) &&
              b instanceof a &&
              ("touch" === b.pointerType || "pen" === b.pointerType);
      },
    },
    timestamp: {
      configurable: !0,
      get: function () {
        return this.ps;
      },
      set: function (a) {
        this.ps = a;
      },
    },
    targetDiagram: {
      configurable: !0,
      get: function () {
        return this.os;
      },
      set: function (a) {
        this.os = a;
      },
    },
    targetObject: {
      configurable: !0,
      get: function () {
        return this.wd;
      },
      set: function (a) {
        this.wd = a;
      },
    },
    control: {
      configurable: !0,
      get: function () {
        return 0 !== (this.modifiers & 1);
      },
      set: function (a) {
        this.modifiers = a ? this.modifiers | 1 : this.modifiers & -2;
      },
    },
    shift: {
      configurable: !0,
      get: function () {
        return 0 !== (this.modifiers & 4);
      },
      set: function (a) {
        this.modifiers = a ? this.modifiers | 4 : this.modifiers & -5;
      },
    },
    alt: {
      configurable: !0,
      get: function () {
        return 0 !== (this.modifiers & 2);
      },
      set: function (a) {
        this.modifiers = a ? this.modifiers | 2 : this.modifiers & -3;
      },
    },
    meta: {
      configurable: !0,
      get: function () {
        return 0 !== (this.modifiers & 8);
      },
      set: function (a) {
        this.modifiers = a ? this.modifiers | 8 : this.modifiers & -9;
      },
    },
    left: {
      configurable: !0,
      get: function () {
        var a = this.event;
        return null === a ||
          ("mousedown" !== a.type &&
            "mouseup" !== a.type &&
            "pointerdown" !== a.type &&
            "pointerup" !== a.type)
          ? 0 !== (this.buttons & 1)
          : 0 === this.button;
      },
      set: function (a) {
        this.buttons = a ? this.buttons | 1 : this.buttons & -2;
      },
    },
    right: {
      configurable: !0,
      get: function () {
        var a = this.event;
        return null === a ||
          ("mousedown" !== a.type &&
            "mouseup" !== a.type &&
            "pointerdown" !== a.type &&
            "pointerup" !== a.type)
          ? 0 !== (this.buttons & 2)
          : 2 === this.button;
      },
      set: function (a) {
        this.buttons = a ? this.buttons | 2 : this.buttons & -3;
      },
    },
    middle: {
      configurable: !0,
      get: function () {
        var a = this.event;
        return null === a ||
          ("mousedown" !== a.type &&
            "mouseup" !== a.type &&
            "pointerdown" !== a.type &&
            "pointerup" !== a.type)
          ? 0 !== (this.buttons & 4)
          : 1 === this.button;
      },
      set: function (a) {
        this.buttons = a ? this.buttons | 4 : this.buttons & -5;
      },
    },
  });
  le.prototype.getMultiTouchDocumentPoint = le.prototype.kA;
  le.prototype.getMultiTouchViewPoint = le.prototype.jq;
  le.className = "InputEvent";
  function ne() {
    this.G = null;
    this.ua = "";
    this.Rr = this.ks = null;
  }
  ne.prototype.copy = function () {
    var a = new ne();
    a.G = this.G;
    a.ua = this.ua;
    a.ks = this.ks;
    a.Rr = this.Rr;
    return a;
  };
  ne.prototype.toString = function () {
    var a = "*" + this.name;
    null !== this.subject && (a += ":" + this.subject.toString());
    null !== this.parameter && (a += "(" + this.parameter.toString() + ")");
    return a;
  };
  oa.Object.defineProperties(ne.prototype, {
    diagram: {
      configurable: !0,
      get: function () {
        return this.G;
      },
      set: function (a) {
        this.G = a;
      },
    },
    name: {
      configurable: !0,
      get: function () {
        return this.ua;
      },
      set: function (a) {
        this.ua = a;
      },
    },
    subject: {
      configurable: !0,
      get: function () {
        return this.ks;
      },
      set: function (a) {
        this.ks = a;
      },
    },
    parameter: {
      configurable: !0,
      get: function () {
        return this.Rr;
      },
      set: function (a) {
        this.Rr = a;
      },
    },
  });
  ne.className = "DiagramEvent";
  function oe() {
    this.hn = pe;
    this.pf = this.Ir = "";
    this.Lo = this.Mo = this.Ro = this.So = this.Qo = this.G = this.ac = null;
  }
  oe.prototype.clear = function () {
    this.Lo = this.Mo = this.Ro = this.So = this.Qo = this.G = this.ac = null;
  };
  oe.prototype.copy = function () {
    var a = new oe();
    a.hn = this.hn;
    a.Ir = this.Ir;
    a.pf = this.pf;
    a.ac = this.ac;
    a.G = this.G;
    a.Qo = this.Qo;
    var b = this.So;
    a.So = Ga(b) && "function" === typeof b.L ? b.L() : b;
    b = this.Ro;
    a.Ro = Ga(b) && "function" === typeof b.L ? b.L() : b;
    b = this.Mo;
    a.Mo = Ga(b) && "function" === typeof b.L ? b.L() : b;
    b = this.Lo;
    a.Lo = Ga(b) && "function" === typeof b.L ? b.L() : b;
    return a;
  };
  oe.prototype.pb = function (a) {
    a.classType === oe ? (this.change = a) : Ea(this, a);
  };
  oe.prototype.toString = function () {
    var a = "";
    a =
      this.change === qe
        ? a + "* "
        : this.change === pe
        ? a + (null !== this.model ? "!m" : "!d")
        : a + ((null !== this.model ? "!m" : "!d") + this.change);
    this.propertyName &&
      "string" === typeof this.propertyName &&
      (a += " " + this.propertyName);
    this.modelChange &&
      this.modelChange !== this.propertyName &&
      (a += " " + this.modelChange);
    a += ": ";
    this.change === qe
      ? null !== this.oldValue && (a += " " + this.oldValue)
      : (null !== this.object && (a += Ra(this.object)),
        null !== this.oldValue && (a += "  old: " + Ra(this.oldValue)),
        null !== this.oldParam && (a += " " + this.oldParam),
        null !== this.newValue && (a += "  new: " + Ra(this.newValue)),
        null !== this.newParam && (a += " " + this.newParam));
    return a;
  };
  oe.prototype.K = function (a) {
    return a ? this.oldValue : this.newValue;
  };
  oe.prototype.mA = function (a) {
    return a ? this.oldParam : this.newParam;
  };
  oe.prototype.canUndo = function () {
    return null !== this.model || null !== this.diagram ? !0 : !1;
  };
  oe.prototype.undo = function () {
    this.canUndo() &&
      (null !== this.model
        ? this.model.changeState(this, !0)
        : null !== this.diagram && this.diagram.changeState(this, !0));
  };
  oe.prototype.canRedo = function () {
    return null !== this.model || null !== this.diagram ? !0 : !1;
  };
  oe.prototype.redo = function () {
    this.canRedo() &&
      (null !== this.model
        ? this.model.changeState(this, !1)
        : null !== this.diagram && this.diagram.changeState(this, !1));
  };
  oa.Object.defineProperties(oe.prototype, {
    model: {
      configurable: !0,
      get: function () {
        return this.ac;
      },
      set: function (a) {
        this.ac = a;
      },
    },
    diagram: {
      configurable: !0,
      get: function () {
        return this.G;
      },
      set: function (a) {
        this.G = a;
      },
    },
    change: {
      configurable: !0,
      get: function () {
        return this.hn;
      },
      set: function (a) {
        G && cb(a, oe, oe, "change");
        this.hn = a;
      },
    },
    modelChange: {
      configurable: !0,
      get: function () {
        return this.Ir;
      },
      set: function (a) {
        G && A(a, "string", oe, "modelChange");
        this.Ir = a;
      },
    },
    propertyName: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.pf;
      },
      set: function (a) {
        G && "string" !== typeof a && A(a, "function", oe, "propertyName");
        this.pf = a;
      },
    },
    isTransactionFinished: {
      configurable: !0,
      get: function () {
        return (
          this.hn === qe &&
          ("CommittedTransaction" === this.pf ||
            "FinishedUndo" === this.pf ||
            "FinishedRedo" === this.pf)
        );
      },
    },
    object: {
      configurable: !0,
      get: function () {
        return this.Qo;
      },
      set: function (a) {
        this.Qo = a;
      },
    },
    oldValue: {
      configurable: !0,
      get: function () {
        return this.So;
      },
      set: function (a) {
        this.So = a;
      },
    },
    oldParam: {
      configurable: !0,
      get: function () {
        return this.Ro;
      },
      set: function (a) {
        this.Ro = a;
      },
    },
    newValue: {
      configurable: !0,
      get: function () {
        return this.Mo;
      },
      set: function (a) {
        this.Mo = a;
      },
    },
    newParam: {
      configurable: !0,
      get: function () {
        return this.Lo;
      },
      set: function (a) {
        this.Lo = a;
      },
    },
  });
  oe.prototype.redo = oe.prototype.redo;
  oe.prototype.canRedo = oe.prototype.canRedo;
  oe.prototype.undo = oe.prototype.undo;
  oe.prototype.canUndo = oe.prototype.canUndo;
  oe.prototype.getParam = oe.prototype.mA;
  oe.prototype.getValue = oe.prototype.K;
  oe.prototype.clear = oe.prototype.clear;
  var qe = new F(oe, "Transaction", -1),
    pe = new F(oe, "Property", 0),
    re = new F(oe, "Insert", 1),
    se = new F(oe, "Remove", 2);
  oe.className = "ChangedEvent";
  oe.Transaction = qe;
  oe.Property = pe;
  oe.Insert = re;
  oe.Remove = se;
  function te() {
    this.o = new H().freeze();
    this.ua = "";
    this.j = !1;
  }
  te.prototype.toString = function (a) {
    var b =
      "Transaction: " +
      this.name +
      " " +
      this.changes.count.toString() +
      (this.isComplete ? "" : ", incomplete");
    if (void 0 !== a && 0 < a) {
      a = this.changes.count;
      for (var c = 0; c < a; c++) {
        var d = this.changes.N(c);
        null !== d && (b += "\n  " + d.toString());
      }
    }
    return b;
  };
  te.prototype.clear = function () {
    var a = this.changes;
    a.la();
    for (var b = a.count - 1; 0 <= b; b--) {
      var c = a.N(b);
      null !== c && c.clear();
    }
    a.clear();
    a.freeze();
  };
  te.prototype.canUndo = function () {
    return this.isComplete;
  };
  te.prototype.undo = function () {
    if (this.canUndo())
      for (var a = this.changes.count - 1; 0 <= a; a--) {
        var b = this.changes.N(a);
        null !== b && b.undo();
      }
  };
  te.prototype.canRedo = function () {
    return this.isComplete;
  };
  te.prototype.redo = function () {
    if (this.canRedo())
      for (var a = this.changes.count, b = 0; b < a; b++) {
        var c = this.changes.N(b);
        null !== c && c.redo();
      }
  };
  te.prototype.Ck = function () {
    if (this.isComplete) {
      var a = this.changes;
      a.la();
      for (var b = new xb(), c = 0; c < a.count; c++) {
        var d = a.N(c);
        if (null !== d && d.change === pe && d.object) {
          var e = b.get(d.object);
          e || ((e = new xb()), b.set(d.object, e));
          var f = e.get(d.propertyName);
          null === f
            ? e.set(d.propertyName, -1)
            : (0 < f && a.Vc(f, null), e.set(d.propertyName, c));
        }
      }
      for (c = b = 0; c < a.count; c++)
        (d = a.N(c)), null !== d && (c > b && a.Vc(b, d), b++);
      for (; a.length > b; ) a.pop();
      a.freeze();
    }
  };
  oa.Object.defineProperties(te.prototype, {
    changes: {
      configurable: !0,
      get: function () {
        return this.o;
      },
    },
    name: {
      configurable: !0,
      get: function () {
        return this.ua;
      },
      set: function (a) {
        this.ua = a;
      },
    },
    isComplete: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.j = a;
      },
    },
  });
  te.prototype.optimize = te.prototype.Ck;
  te.prototype.redo = te.prototype.redo;
  te.prototype.canRedo = te.prototype.canRedo;
  te.prototype.undo = te.prototype.undo;
  te.prototype.canUndo = te.prototype.canUndo;
  te.prototype.clear = te.prototype.clear;
  te.className = "Transaction";
  function ue() {
    this.mu = new I();
    this.Dd = !1;
    this.B = new H().freeze();
    this.ye = -1;
    this.o = 999;
    this.Ae = !1;
    this.ar = null;
    this.Gi = 0;
    this.j = !1;
    G && (this.j = !0);
    this.Ge = new H().freeze();
    this.Il = new H();
    this.Ot = !0;
    this.Yt = this.wr = this.au = this.$t = !1;
  }
  ue.prototype.toString = function (a) {
    var b =
      "UndoManager " +
      this.historyIndex +
      "<" +
      this.history.count +
      "<=" +
      this.maxHistoryLength;
    b += "[";
    for (var c = this.nestedTransactionNames.count, d = 0; d < c; d++)
      0 < d && (b += " "), (b += this.nestedTransactionNames.N(d));
    b += "]";
    if (void 0 !== a && 0 < a)
      for (c = this.history.count, d = 0; d < c; d++)
        b += "\n " + this.history.N(d).toString(a - 1);
    return b;
  };
  ue.prototype.clear = function () {
    var a = this.history;
    a.la();
    for (var b = a.count - 1; 0 <= b; b--) {
      var c = a.N(b);
      null !== c && c.clear();
    }
    a.clear();
    this.ye = -1;
    a.freeze();
    this.Ae = !1;
    this.ar = null;
    this.Gi = 0;
    this.Ge.la();
    this.Ge.clear();
    this.Ge.freeze();
    this.Il.clear();
    this.Yt = this.wr = this.au = this.$t = !1;
  };
  ue.prototype.copyProperties = function (a) {
    this.isEnabled = a.isEnabled;
    this.maxHistoryLength = a.maxHistoryLength;
    this.checksTransactionLevel = a.checksTransactionLevel;
  };
  t = ue.prototype;
  t.Ax = function (a) {
    this.mu.add(a);
  };
  t.zy = function (a) {
    this.mu.remove(a);
  };
  t.Fa = function (a) {
    void 0 === a && (a = "");
    null === a && (a = "");
    if (this.isUndoingRedoing) return !1;
    !0 === this.Ot &&
      ((this.Ot = !1),
      this.Gi++,
      this.isInternalTransaction ||
        this.Kb("StartingFirstTransaction", a, this.currentTransaction),
      0 < this.Gi && this.Gi--);
    this.isEnabled &&
      (this.Ge.la(),
      this.Ge.add(a),
      this.Ge.freeze(),
      null === this.currentTransaction
        ? this.Il.add(0)
        : this.Il.add(this.currentTransaction.changes.count));
    this.Gi++;
    var b = 1 === this.transactionLevel;
    b &&
      (this.isInternalTransaction ||
        this.Kb("StartedTransaction", a, this.currentTransaction));
    return b;
  };
  t.gb = function (a) {
    void 0 === a && (a = "");
    return ve(this, !0, a);
  };
  t.Pf = function () {
    return ve(this, !1, "");
  };
  function ve(a, b, c) {
    if (a.isUndoingRedoing) return !1;
    a.checksTransactionLevel &&
      1 > a.transactionLevel &&
      Fa("Ending transaction without having started a transaction: " + c);
    var d = 1 === a.transactionLevel,
      e = a.currentTransaction;
    d && b && (a.isInternalTransaction || a.Kb("CommittingTransaction", c, e));
    var f = 0;
    if (0 < a.transactionLevel && (a.Gi--, a.isEnabled)) {
      var g = a.Ge.count;
      0 < g &&
        ("" === c && (c = a.Ge.N(0)), a.Ge.la(), a.Ge.nb(g - 1), a.Ge.freeze());
      g = a.Il.count;
      0 < g && ((f = a.Il.N(g - 1)), a.Il.nb(g - 1));
    }
    if (d) {
      if (b) {
        a.wr = !1;
        null === e && "" !== c && (e = a.currentTransaction);
        if (a.isEnabled && null !== e) {
          e.isComplete || ((e.isComplete = !0), (e.name = c));
          b = a.history;
          b.la();
          for (d = b.count - 1; d > a.historyIndex; d--)
            (f = b.N(d)), null !== f && f.clear(), b.nb(d), (a.wr = !0);
          d = a.maxHistoryLength;
          0 <= d &&
            (0 === d
              ? b.clear()
              : b.count >= d &&
                ((f = b.N(0)), null !== f && f.clear(), b.nb(0), a.ye--));
          0 === d ||
            (0 !== b.count && b.get(b.count - 1) === e) ||
            (b.add(e), a.ye++);
          b.freeze();
        }
        a.isInternalTransaction || a.Kb("CommittedTransaction", c, e);
      } else {
        a.Ae = !0;
        try {
          a.isEnabled && null !== e && ((e.isComplete = !0), e.undo());
        } finally {
          a.isInternalTransaction || a.Kb("RolledBackTransaction", c, e),
            (a.Ae = !1);
        }
        null !== e && e.clear();
      }
      a.ar = null;
      a.isPendingClear && a.clear();
      a.isPendingClear = !1;
      a.isPendingUnmodified = !1;
      return !0;
    }
    if (a.isEnabled && !b && null !== e) {
      a = f;
      c = e.changes;
      for (e = c.count - 1; e >= a; e--)
        (b = c.N(e)), null !== b && b.undo(), c.la(), c.nb(e);
      c.freeze();
    }
    return !1;
  }
  ue.prototype.canUndo = function () {
    if (!this.isEnabled || 0 < this.transactionLevel) return !1;
    var a = this.transactionToUndo;
    return null !== a && a.canUndo() ? !0 : !1;
  };
  ue.prototype.undo = function () {
    if (this.canUndo()) {
      var a = this.transactionToUndo;
      try {
        (this.Ae = !0), this.Kb("StartingUndo", "Undo", a), this.ye--, a.undo();
      } catch (b) {
        Fa("undo error: " + b.toString());
      } finally {
        this.Kb("FinishedUndo", "Undo", a), (this.Ae = !1);
      }
    }
  };
  ue.prototype.canRedo = function () {
    if (!this.isEnabled || 0 < this.transactionLevel) return !1;
    var a = this.transactionToRedo;
    return null !== a && a.canRedo() ? !0 : !1;
  };
  ue.prototype.redo = function () {
    if (this.canRedo()) {
      var a = this.transactionToRedo;
      try {
        (this.Ae = !0), this.Kb("StartingRedo", "Redo", a), this.ye++, a.redo();
      } catch (b) {
        Fa("redo error: " + b.toString());
      } finally {
        this.Kb("FinishedRedo", "Redo", a), (this.Ae = !1);
      }
    }
  };
  ue.prototype.Kb = function (a, b, c) {
    void 0 === c && (c = null);
    var d = new oe();
    d.change = qe;
    d.propertyName = a;
    d.object = c;
    d.oldValue = b;
    for (a = this.models; a.next(); ) (b = a.value), (d.model = b), b.ws(d);
  };
  ue.prototype.zv = function (a) {
    if (this.isEnabled && !this.isUndoingRedoing && !this.skipsEvent(a)) {
      var b = this.currentTransaction;
      null === b && (this.ar = b = new te());
      var c = a.copy();
      b = b.changes;
      b.la();
      b.add(c);
      b.freeze();
      this.checksTransactionLevel &&
        0 >= this.transactionLevel &&
        !this.Ot &&
        ((a = a.diagram),
        (null !== a && !1 === a.Yi) ||
          Fa("Change not within a transaction: " + c.toString()));
    }
  };
  ue.prototype.skipsEvent = function (a) {
    if (null === a || 0 > a.change.value) return !0;
    a = a.object;
    if (null === a) return !1;
    if (void 0 !== a.layer) {
      if (((a = a.layer), null !== a && a.isTemporary)) return !0;
    } else if (a.isTemporary) return !0;
    return !1;
  };
  oa.Object.defineProperties(ue.prototype, {
    models: {
      configurable: !0,
      get: function () {
        return this.mu.iterator;
      },
    },
    isEnabled: {
      configurable: !0,
      get: function () {
        return this.Dd;
      },
      set: function (a) {
        this.Dd = a;
      },
    },
    transactionToUndo: {
      configurable: !0,
      get: function () {
        return 0 <= this.historyIndex &&
          this.historyIndex <= this.history.count - 1
          ? this.history.N(this.historyIndex)
          : null;
      },
    },
    transactionToRedo: {
      configurable: !0,
      get: function () {
        return this.historyIndex < this.history.count - 1
          ? this.history.N(this.historyIndex + 1)
          : null;
      },
    },
    isUndoingRedoing: {
      configurable: !0,
      get: function () {
        return this.Ae;
      },
    },
    history: {
      configurable: !0,
      get: function () {
        return this.B;
      },
    },
    maxHistoryLength: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        this.o = a;
      },
    },
    historyIndex: {
      configurable: !0,
      get: function () {
        return this.ye;
      },
    },
    currentTransaction: {
      configurable: !0,
      get: function () {
        return this.ar;
      },
    },
    transactionLevel: {
      configurable: !0,
      get: function () {
        return this.Gi;
      },
    },
    isInTransaction: {
      configurable: !0,
      get: function () {
        return 0 < this.Gi;
      },
    },
    checksTransactionLevel: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.j = a;
      },
    },
    nestedTransactionNames: {
      configurable: !0,
      get: function () {
        return this.Ge;
      },
    },
    isPendingClear: {
      configurable: !0,
      get: function () {
        return this.$t;
      },
      set: function (a) {
        this.$t = a;
      },
    },
    isPendingUnmodified: {
      configurable: !0,
      get: function () {
        return this.au;
      },
      set: function (a) {
        this.au = a;
      },
    },
    isInternalTransaction: {
      configurable: !0,
      get: function () {
        return this.Yt;
      },
      set: function (a) {
        this.Yt = a;
      },
    },
    isJustDiscarded: {
      configurable: !0,
      get: function () {
        return this.wr;
      },
    },
  });
  ue.prototype.handleChanged = ue.prototype.zv;
  ue.prototype.redo = ue.prototype.redo;
  ue.prototype.undo = ue.prototype.undo;
  ue.prototype.canUndo = ue.prototype.canUndo;
  ue.prototype.rollbackTransaction = ue.prototype.Pf;
  ue.prototype.commitTransaction = ue.prototype.gb;
  ue.prototype.startTransaction = ue.prototype.Fa;
  ue.prototype.removeModel = ue.prototype.zy;
  ue.prototype.addModel = ue.prototype.Ax;
  ue.prototype.clear = ue.prototype.clear;
  ue.className = "UndoManager";
  function we() {
    0 < arguments.length && Ca(we);
    ab(this);
    this.G = xe;
    this.ua = "";
    this.Dd = !0;
    this.Yc = !1;
    this.tw = null;
    this.ez = new le();
    this.ts = -1;
  }
  we.prototype.toString = function () {
    return "" !== this.name ? this.name + " Tool" : Qa(this.constructor);
  };
  we.prototype.updateAdornments = function () {};
  we.prototype.canStart = function () {
    return this.isEnabled;
  };
  we.prototype.doStart = function () {};
  we.prototype.doActivate = function () {
    this.isActive = !0;
  };
  we.prototype.doDeactivate = function () {
    this.isActive = !1;
  };
  we.prototype.doStop = function () {};
  we.prototype.doCancel = function () {
    this.transactionResult = null;
    this.stopTool();
  };
  we.prototype.stopTool = function () {
    var a = this.diagram;
    a.currentTool === this && ((a.currentTool = null), (a.currentCursor = ""));
  };
  we.prototype.doMouseDown = function () {
    !this.isActive && this.canStart() && this.doActivate();
  };
  we.prototype.doMouseMove = function () {};
  we.prototype.doMouseUp = function () {
    this.stopTool();
  };
  we.prototype.doMouseWheel = function () {};
  we.prototype.canStartMultiTouch = function () {
    return !0;
  };
  we.prototype.standardPinchZoomStart = function () {
    var a = this.diagram,
      b = a.lastInput,
      c = b.jq(0, K.allocAt(NaN, NaN)),
      d = b.jq(1, K.allocAt(NaN, NaN));
    if (c.s() && d.s() && (this.doCancel(), a.nm("hasGestureZoom"))) {
      a.bx = a.scale;
      var e = d.x - c.x,
        f = d.y - c.y;
      a.mx = Math.sqrt(e * e + f * f);
      b.bubbles = !1;
    }
    K.free(c);
    K.free(d);
  };
  we.prototype.standardPinchZoomMove = function () {
    var a = this.diagram,
      b = a.lastInput,
      c = b.jq(0, K.allocAt(NaN, NaN)),
      d = b.jq(1, K.allocAt(NaN, NaN));
    if (c.s() && d.s() && (this.doCancel(), a.nm("hasGestureZoom"))) {
      var e = d.x - c.x,
        f = d.y - c.y;
      f = Math.sqrt(e * e + f * f) / a.mx;
      e = new K(
        (Math.min(d.x, c.x) + Math.max(d.x, c.x)) / 2,
        (Math.min(d.y, c.y) + Math.max(d.y, c.y)) / 2
      );
      f *= a.bx;
      var g = a.commandHandler;
      if (f !== a.scale && g.canResetZoom(f)) {
        var h = a.zoomPoint;
        a.zoomPoint = e;
        g.resetZoom(f);
        a.zoomPoint = h;
      }
      b.bubbles = !1;
    }
    K.free(c);
    K.free(d);
  };
  we.prototype.doKeyDown = function () {
    "Esc" === this.diagram.lastInput.key && this.doCancel();
  };
  we.prototype.doKeyUp = function () {};
  we.prototype.Fa = function (a) {
    void 0 === a && (a = this.name);
    this.transactionResult = null;
    return this.diagram.Fa(a);
  };
  we.prototype.stopTransaction = function () {
    var a = this.diagram;
    return null === this.transactionResult
      ? a.Pf()
      : a.gb(this.transactionResult);
  };
  we.prototype.standardMouseSelect = function () {
    var a = this.diagram;
    if (a.allowSelect) {
      var b = a.lastInput,
        c = a.lm(b.documentPoint, !1);
      if (null !== c)
        if ($a ? b.meta : b.control) {
          a.V("ChangingSelection", a.selection);
          for (b = c; null !== b && !b.canSelect(); ) b = b.containingGroup;
          null !== b && (b.isSelected = !b.isSelected);
          a.V("ChangedSelection", a.selection);
        } else if (b.shift) {
          if (!c.isSelected) {
            a.V("ChangingSelection", a.selection);
            for (b = c; null !== b && !b.canSelect(); ) b = b.containingGroup;
            null !== b && (b.isSelected = !0);
            a.V("ChangedSelection", a.selection);
          }
        } else {
          if (!c.isSelected) {
            for (b = c; null !== b && !b.canSelect(); ) b = b.containingGroup;
            null !== b && a.select(b);
          }
        }
      else
        !b.left || ($a ? b.meta : b.control) || b.shift || a.clearSelection();
    }
  };
  we.prototype.standardMouseClick = function (a, b) {
    void 0 === a && (a = null);
    void 0 === b &&
      (b = function (a) {
        return !a.layer.isTemporary;
      });
    var c = this.diagram,
      d = c.lastInput;
    a = c.dc(d.documentPoint, a, b);
    d.targetObject = a;
    ye(a, d, c);
    return d.handled;
  };
  function ye(a, b, c) {
    b.handled = !1;
    if (null === a || a.Mf()) {
      var d = 0;
      b.left
        ? (d = 1 === b.clickCount ? 1 : 2 === b.clickCount ? 2 : 1)
        : b.right && 1 === b.clickCount && (d = 3);
      var e = "ObjectSingleClicked";
      if (null !== a) {
        switch (d) {
          case 1:
            e = "ObjectSingleClicked";
            break;
          case 2:
            e = "ObjectDoubleClicked";
            break;
          case 3:
            e = "ObjectContextClicked";
        }
        0 !== d && c.V(e, a);
      } else {
        switch (d) {
          case 1:
            e = "BackgroundSingleClicked";
            break;
          case 2:
            e = "BackgroundDoubleClicked";
            break;
          case 3:
            e = "BackgroundContextClicked";
        }
        0 !== d && c.V(e);
      }
      if (null !== a)
        for (; null !== a; ) {
          c = null;
          switch (d) {
            case 1:
              c = a.click;
              break;
            case 2:
              c = a.doubleClick ? a.doubleClick : a.click;
              break;
            case 3:
              c = a.contextClick;
          }
          if (null !== c && (c(b, a), b.handled)) break;
          a = a.panel;
        }
      else {
        a = null;
        switch (d) {
          case 1:
            a = c.click;
            break;
          case 2:
            a = c.doubleClick ? c.doubleClick : c.click;
            break;
          case 3:
            a = c.contextClick;
        }
        null !== a && a(b);
      }
    }
  }
  we.prototype.standardMouseOver = function () {
    var a = this.diagram,
      b = a.lastInput;
    if (!0 !== a.animationManager.zb) {
      var c = a.skipsUndoManager;
      a.skipsUndoManager = !0;
      var d = a.viewportBounds.ca(b.documentPoint)
        ? a.dc(b.documentPoint, null, null)
        : null;
      b.targetObject = d;
      var e = !1;
      if (d !== a.al) {
        var f = a.al,
          g = f;
        a.al = d;
        this.doCurrentObjectChanged(f, d);
        for (b.handled = !1; null !== f; ) {
          var h = f.mouseLeave;
          if (null !== h) {
            if (d === f) break;
            if (null !== d && d.xg(f)) break;
            h(b, f, d);
            e = !0;
            if (b.handled) break;
          }
          f = f.panel;
        }
        f = g;
        for (b.handled = !1; null !== d; ) {
          g = d.mouseEnter;
          if (null !== g) {
            if (f === d) break;
            if (null !== f && f.xg(d)) break;
            g(b, d, f);
            e = !0;
            if (b.handled) break;
          }
          d = d.panel;
        }
        d = a.al;
      }
      if (null !== d) {
        f = d;
        for (g = ""; null !== f; ) {
          g = f.cursor;
          if ("" !== g) break;
          f = f.panel;
        }
        a.currentCursor = g;
        b.handled = !1;
        for (f = d; null !== f; ) {
          d = f.mouseOver;
          if (null !== d && (d(b, f), (e = !0), b.handled)) break;
          f = f.panel;
        }
      } else
        (a.currentCursor = ""),
          (d = a.mouseOver),
          null !== d && (d(b), (e = !0));
      e && a.Ob();
      a.skipsUndoManager = c;
    }
  };
  we.prototype.doCurrentObjectChanged = function () {};
  we.prototype.standardMouseWheel = function () {
    var a = this.diagram,
      b = a.lastInput,
      c = b.delta;
    if (0 !== c && a.documentBounds.s()) {
      var d = a.commandHandler,
        e = a.toolManager.mouseWheelBehavior;
      if (null !== d && ((e === He && !b.shift) || (e === Ie && b.control))) {
        if (0 < c ? d.canIncreaseZoom() : d.canDecreaseZoom())
          (e = a.zoomPoint),
            (a.zoomPoint = b.viewPoint),
            0 < c ? d.increaseZoom() : d.decreaseZoom(),
            (a.zoomPoint = e);
        b.bubbles = !1;
      } else if ((e === He && b.shift) || (e === Ie && !b.control)) {
        d = a.position.copy();
        var f = 0 < c ? c : -c,
          g = b.event,
          h = g.deltaMode;
        e = g.deltaX;
        g = g.deltaY;
        if (Wa || Ya)
          (h = 1),
            0 < e && (e = 3),
            0 > e && (e = -3),
            0 < g && (g = 3),
            0 > g && (g = -3);
        if (
          void 0 === h ||
          void 0 === e ||
          void 0 === g ||
          (0 === e && 0 === g) ||
          b.shift
        )
          !b.shift && a.allowVerticalScroll
            ? ((f = 3 * f * a.scrollVerticalLineChange),
              0 < c ? a.scroll("pixel", "up", f) : a.scroll("pixel", "down", f))
            : b.shift &&
              a.allowHorizontalScroll &&
              ((f = 3 * f * a.scrollHorizontalLineChange),
              0 < c
                ? a.scroll("pixel", "left", f)
                : a.scroll("pixel", "right", f));
        else {
          switch (h) {
            case 0:
              c = "pixel";
              break;
            case 1:
              c = "line";
              break;
            case 2:
              c = "page";
              break;
            default:
              c = "pixel";
          }
          0 !== e &&
            a.allowHorizontalScroll &&
            ((e *= a.scrollHorizontalLineChange / 16),
            0 < e ? a.scroll(c, "left", -e) : a.scroll(c, "right", e));
          0 !== g &&
            a.allowVerticalScroll &&
            ((g *= a.scrollVerticalLineChange / 16),
            0 < g ? a.scroll(c, "up", -g) : a.scroll(c, "down", g));
        }
        a.position.D(d) || (b.bubbles = !1);
      }
    }
  };
  we.prototype.standardWaitAfter = function (a, b) {
    G && A(a, "number", we, "standardWaitAfter:delay");
    void 0 === b && (b = this.diagram.lastInput);
    this.cancelWaitAfter();
    var c = this,
      d = b.clone(this.ez);
    this.ts = va(function () {
      c.doWaitAfter(d);
    }, a);
  };
  we.prototype.cancelWaitAfter = function () {
    -1 !== this.ts && sa.clearTimeout(this.ts);
    this.ts = -1;
  };
  we.prototype.doWaitAfter = function () {};
  we.prototype.findToolHandleAt = function (a, b) {
    a = this.diagram.dc(a, function (a) {
      for (; null !== a && !(a.panel instanceof Je); ) a = a.panel;
      return a;
    });
    return null === a ? null : a.part.category === b ? a : null;
  };
  we.prototype.isBeyondDragSize = function (a, b) {
    var c = this.diagram;
    void 0 === a && (a = c.firstInput.viewPoint);
    void 0 === b && (b = c.lastInput.viewPoint);
    var d = c.toolManager.dragSize,
      e = d.width;
    d = d.height;
    c.firstInput.isTouchEvent && ((e += 6), (d += 6));
    return Math.abs(b.x - a.x) > e || Math.abs(b.y - a.y) > d;
  };
  oa.Object.defineProperties(we.prototype, {
    diagram: {
      configurable: !0,
      get: function () {
        return this.G;
      },
      set: function (a) {
        a instanceof Q && (this.G = a);
      },
    },
    name: {
      configurable: !0,
      get: function () {
        return this.ua;
      },
      set: function (a) {
        A(a, "string", we, "name");
        this.ua = a;
      },
    },
    isEnabled: {
      configurable: !0,
      get: function () {
        return this.Dd;
      },
      set: function (a) {
        A(a, "boolean", we, "isEnabled");
        this.Dd = a;
      },
    },
    isActive: {
      configurable: !0,
      get: function () {
        return this.Yc;
      },
      set: function (a) {
        A(a, "boolean", we, "isActive");
        this.Yc = a;
      },
    },
    transactionResult: {
      configurable: !0,
      get: function () {
        return this.tw;
      },
      set: function (a) {
        null !== a && A(a, "string", we, "transactionResult");
        this.tw = a;
      },
    },
  });
  we.prototype.startTransaction = we.prototype.Fa;
  we.className = "Tool";
  function Ua() {
    we.call(this);
    this.name = "ToolManager";
    this.Hc = new H();
    this.Zc = new H();
    this.Td = new H();
    this.M = this.Ba = 850;
    this.o = new Gb(2, 2).ia();
    this.eb = 5e3;
    this.Na = Ie;
    this.B = Ke;
    this.$q = this.j = null;
    this.bk = -1;
  }
  na(Ua, we);
  Ua.prototype.initializeStandardTools = function () {};
  Ua.prototype.updateAdornments = function (a) {
    var b = this.currentToolTip;
    if (b instanceof Je && this.$q === a) {
      var c = b.adornedObject;
      (null !== a ? c.part === a : null === c)
        ? this.showToolTip(b, c)
        : this.hideToolTip();
    }
  };
  Ua.prototype.doMouseDown = function () {
    var a = this.diagram,
      b = a.lastInput;
    b.isTouchEvent && this.gestureBehavior === Le && (b.bubbles = !1);
    if (b.isMultiTouch) {
      this.cancelWaitAfter();
      if (this.gestureBehavior === Me) {
        b.bubbles = !0;
        return;
      }
      if (this.gestureBehavior === Le) return;
      if (a.currentTool.canStartMultiTouch()) {
        a.currentTool.standardPinchZoomStart();
        return;
      }
    }
    var c = a.undoManager;
    G &&
      c.checksTransactionLevel &&
      0 !== c.transactionLevel &&
      Fa(
        "WARNING: In ToolManager.doMouseDown: UndoManager.transactionLevel is not zero"
      );
    c = this.mouseDownTools.length;
    for (var d = 0; d < c; d++) {
      var e = this.mouseDownTools.N(d);
      e.diagram = this.diagram;
      if (e.canStart()) {
        a.doFocus();
        a.currentTool = e;
        a.currentTool === e && (e.isActive || e.doActivate(), e.doMouseDown());
        return;
      }
    }
    1 === a.lastInput.button &&
      (this.mouseWheelBehavior === Ie
        ? (this.mouseWheelBehavior = He)
        : this.mouseWheelBehavior === He && (this.mouseWheelBehavior = Ie));
    this.doActivate();
    this.standardWaitAfter(this.holdDelay, b);
  };
  Ua.prototype.doMouseMove = function () {
    var a = this.diagram,
      b = a.lastInput;
    if (b.isMultiTouch) {
      if (this.gestureBehavior === Me) {
        b.bubbles = !0;
        return;
      }
      if (this.gestureBehavior === Le) return;
      if (a.currentTool.canStartMultiTouch()) {
        a.currentTool.standardPinchZoomMove();
        return;
      }
    }
    if (this.isActive)
      for (var c = this.mouseMoveTools.length, d = 0; d < c; d++) {
        var e = this.mouseMoveTools.N(d);
        e.diagram = this.diagram;
        if (e.canStart()) {
          a.doFocus();
          a.currentTool = e;
          a.currentTool === e &&
            (e.isActive || e.doActivate(), e.doMouseMove());
          return;
        }
      }
    Ne(this, a);
    a = b.event;
    null === a ||
      ("pointermove" !== a.type && a.cancelable) ||
      (b.bubbles = !0);
  };
  function Ne(a, b) {
    a.standardMouseOver();
    a.isBeyondDragSize() &&
      a.standardWaitAfter(a.isActive ? a.holdDelay : a.hoverDelay, b.lastInput);
  }
  Ua.prototype.doCurrentObjectChanged = function (a, b) {
    a = this.currentToolTip;
    null === a ||
      (null !== b && a instanceof Je && (b === a || b.xg(a))) ||
      this.hideToolTip();
  };
  Ua.prototype.doWaitAfter = function (a) {
    var b = this.diagram;
    b.Ia &&
      (this.doMouseHover(),
      this.isActive || this.doToolTip(),
      a.isTouchEvent &&
        !b.lastInput.handled &&
        ((a = a.copy()),
        (a.button = 2),
        (a.buttons = 2),
        (b.lastInput = a),
        (b.Ou = !0),
        b.doMouseUp()));
  };
  Ua.prototype.doMouseHover = function () {
    var a = this.diagram,
      b = a.lastInput;
    null === b.targetObject &&
      (b.targetObject = a.dc(b.documentPoint, null, null));
    var c = b.targetObject;
    if (null !== c)
      for (b.handled = !1; null !== c; ) {
        a = this.isActive ? c.mouseHold : c.mouseHover;
        if (null !== a && (a(b, c), b.handled)) break;
        c = c.panel;
      }
    else (c = this.isActive ? a.mouseHold : a.mouseHover), null !== c && c(b);
  };
  Ua.prototype.doToolTip = function () {
    var a = this.diagram,
      b = a.lastInput;
    null === b.targetObject &&
      (b.targetObject = a.dc(b.documentPoint, null, null));
    b = b.targetObject;
    if (null !== b) {
      if (
        ((a = this.currentToolTip), !(a instanceof Je) || (b !== a && !b.xg(a)))
      ) {
        for (; null !== b; ) {
          a = b.toolTip;
          if (null !== a) {
            this.showToolTip(a, b);
            return;
          }
          b = b.panel;
        }
        this.hideToolTip();
      }
    } else
      (b = a.toolTip),
        null !== b ? this.showToolTip(b, null) : this.hideToolTip();
  };
  Ua.prototype.showToolTip = function (a, b) {
    !G ||
      a instanceof Je ||
      a instanceof Oe ||
      v("showToolTip:tooltip must be an Adornment or HTMLInfo.");
    null !== b && x(b, O, Ua, "showToolTip:obj");
    var c = this.diagram;
    a !== this.currentToolTip && this.hideToolTip();
    if (a instanceof Je) {
      a.layerName = "Tool";
      a.selectable = !1;
      a.scale = 1 / c.scale;
      a.category = "ToolTip";
      null !== a.placeholder && (a.placeholder.scale = c.scale);
      var d = a.diagram;
      null !== d && d !== c && d.remove(a);
      c.add(a);
      null !== b ? (a.adornedObject = b) : (a.data = c.model);
      a.Za();
      this.positionToolTip(a, b);
    } else a instanceof Oe && a !== this.currentToolTip && a.show(b, c, this);
    this.currentToolTip = a;
    -1 !== this.bk && (sa.clearTimeout(this.bk), (this.bk = -1));
    a = this.toolTipDuration;
    if (0 < a && Infinity !== a) {
      var e = this;
      this.bk = va(function () {
        e.hideToolTip();
      }, a);
    }
  };
  Ua.prototype.positionToolTip = function (a) {
    if (null === a.placeholder) {
      var b = this.diagram,
        c = b.lastInput.documentPoint.copy(),
        d = a.measuredBounds,
        e = b.viewportBounds;
      b.lastInput.isTouchEvent && (c.x -= d.width);
      c.x + d.width > e.right && (c.x -= d.width + 5 / b.scale);
      c.x < e.x && (c.x = e.x);
      c.y =
        c.y + 20 / b.scale + d.height > e.bottom
          ? c.y - (d.height + 5 / b.scale)
          : c.y + 20 / b.scale;
      c.y < e.y && (c.y = e.y);
      a.position = c;
    }
  };
  Ua.prototype.hideToolTip = function () {
    -1 !== this.bk && (sa.clearTimeout(this.bk), (this.bk = -1));
    var a = this.diagram,
      b = this.currentToolTip;
    null !== b &&
      (b instanceof Je
        ? (a.remove(b),
          null !== this.$q && this.$q.Of(b.category),
          (b.data = null),
          (b.adornedObject = null))
        : b instanceof Oe && null !== b.hide && b.hide(a, this),
      (this.currentToolTip = null));
  };
  Ua.prototype.doMouseUp = function () {
    this.cancelWaitAfter();
    var a = this.diagram;
    if (this.isActive)
      for (var b = this.mouseUpTools.length, c = 0; c < b; c++) {
        var d = this.mouseUpTools.N(c);
        d.diagram = this.diagram;
        if (d.canStart()) {
          a.doFocus();
          a.currentTool = d;
          a.currentTool === d && (d.isActive || d.doActivate(), d.doMouseUp());
          return;
        }
      }
    a.doFocus();
    this.doDeactivate();
  };
  Ua.prototype.doMouseWheel = function () {
    this.standardMouseWheel();
  };
  Ua.prototype.doKeyDown = function () {
    var a = this.diagram;
    null !== a.commandHandler && a.commandHandler.doKeyDown();
  };
  Ua.prototype.doKeyUp = function () {
    var a = this.diagram;
    null !== a.commandHandler && a.commandHandler.doKeyUp();
  };
  Ua.prototype.findTool = function (a) {
    A(a, "string", Ua, "findTool:name");
    for (var b = this.mouseDownTools.length, c = 0; c < b; c++) {
      var d = this.mouseDownTools.N(c);
      if (d.name === a) return d;
    }
    b = this.mouseMoveTools.length;
    for (c = 0; c < b; c++)
      if (((d = this.mouseMoveTools.N(c)), d.name === a)) return d;
    b = this.mouseUpTools.length;
    for (c = 0; c < b; c++)
      if (((d = this.mouseUpTools.N(c)), d.name === a)) return d;
    return null;
  };
  Ua.prototype.replaceTool = function (a, b) {
    A(a, "string", Ua, "replaceTool:name");
    null !== b &&
      (x(b, we, Ua, "replaceTool:newtool"), (b.diagram = this.diagram));
    for (var c = this.mouseDownTools.length, d = 0; d < c; d++) {
      var e = this.mouseDownTools.N(d);
      if (e.name === a)
        return (
          null !== b ? this.mouseDownTools.Vc(d, b) : this.mouseDownTools.nb(d),
          e
        );
    }
    c = this.mouseMoveTools.length;
    for (d = 0; d < c; d++)
      if (((e = this.mouseMoveTools.N(d)), e.name === a))
        return (
          null !== b ? this.mouseMoveTools.Vc(d, b) : this.mouseMoveTools.nb(d),
          e
        );
    c = this.mouseUpTools.length;
    for (d = 0; d < c; d++)
      if (((e = this.mouseUpTools.N(d)), e.name === a))
        return (
          null !== b ? this.mouseUpTools.Vc(d, b) : this.mouseUpTools.nb(d), e
        );
    return null;
  };
  Ua.prototype.jb = function (a, b, c) {
    A(a, "string", Ua, "replaceStandardTool:name");
    x(c, H, Ua, "replaceStandardTool:list");
    null !== b &&
      (x(b, we, Ua, "replaceStandardTool:newtool"),
      (b.name = a),
      (b.diagram = this.diagram));
    this.findTool(a) ? this.replaceTool(a, b) : null !== b && c.add(b);
  };
  oa.Object.defineProperties(Ua.prototype, {
    mouseWheelBehavior: {
      configurable: !0,
      get: function () {
        return this.Na;
      },
      set: function (a) {
        cb(a, Ua, Ua, "mouseWheelBehavior");
        this.Na = a;
      },
    },
    gestureBehavior: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        cb(a, Ua, Ua, "gestureBehavior");
        this.B = a;
      },
    },
    currentToolTip: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        !G ||
          null === a ||
          a instanceof Je ||
          a instanceof Oe ||
          v("ToolManager.currentToolTip must be an Adornment or HTMLInfo.");
        this.j = a;
        this.$q = null !== a && a instanceof Je ? a.adornedPart : null;
      },
    },
    mouseDownTools: {
      configurable: !0,
      get: function () {
        return this.Hc;
      },
    },
    mouseMoveTools: {
      configurable: !0,
      get: function () {
        return this.Zc;
      },
    },
    mouseUpTools: {
      configurable: !0,
      get: function () {
        return this.Td;
      },
    },
    hoverDelay: {
      configurable: !0,
      get: function () {
        return this.Ba;
      },
      set: function (a) {
        A(a, "number", Ua, "hoverDelay");
        this.Ba = a;
      },
    },
    holdDelay: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        A(a, "number", Ua, "holdDelay");
        this.M = a;
      },
    },
    dragSize: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        x(a, Gb, Ua, "dragSize");
        this.o = a.L();
      },
    },
    toolTipDuration: {
      configurable: !0,
      get: function () {
        return this.eb;
      },
      set: function (a) {
        A(a, "number", Ua, "toolTipDuration");
        this.eb = a;
      },
    },
  });
  Ua.prototype.replaceStandardTool = Ua.prototype.jb;
  var Ie = new F(Ua, "WheelScroll", 0),
    He = new F(Ua, "WheelZoom", 1),
    Pe = new F(Ua, "WheelNone", 2),
    Ke = new F(Ua, "GestureZoom", 3),
    Le = new F(Ua, "GestureCancel", 4),
    Me = new F(Ua, "GestureNone", 5);
  Ua.className = "ToolManager";
  Ua.WheelScroll = Ie;
  Ua.WheelZoom = He;
  Ua.WheelNone = Pe;
  Ua.GestureZoom = Ke;
  Ua.GestureCancel = Le;
  Ua.GestureNone = Me;
  function Qe() {
    we.call(this);
    0 < arguments.length && Ca(Qe);
    this.name = "Dragging";
    this.B = this.Zc = !0;
    this.o = this.eb = this.Ba = this.Le = null;
    this.En = this.Td = !1;
    this.Xl = new K(NaN, NaN);
    this.gs = new K();
    this.Hc = !0;
    this.gl = 100;
    this.Pg = [];
    this.hj = new I().freeze();
    this.Na = new Re();
    this.po = null;
    this.M = "copy";
    this.Rh = "";
    this.Sh = "no-drop";
  }
  var Se;
  na(Qe, we);
  Qe.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    if (
      (a.isReadOnly && !a.allowDragOut) ||
      (!a.allowMove && !a.allowCopy && !a.allowDragOut) ||
      !a.allowSelect
    )
      return !1;
    var b = a.lastInput;
    return !b.left ||
      (a.currentTool !== this &&
        (!this.isBeyondDragSize() ||
          (b.isTouchEvent && b.timestamp - a.firstInput.timestamp < this.gl)))
      ? !1
      : null !== this.findDraggablePart();
  };
  Qe.prototype.findDraggablePart = function () {
    var a = this.diagram;
    a = a.lm(a.firstInput.documentPoint, !1);
    if (null === a) return null;
    for (; null !== a && !a.canSelect(); ) a = a.containingGroup;
    return null !== a && (a.canMove() || a.canCopy()) ? a : null;
  };
  Qe.prototype.standardMouseSelect = function () {
    var a = this.diagram;
    if (a.allowSelect) {
      var b = a.lm(a.firstInput.documentPoint, !1);
      if (null !== b) {
        for (; null !== b && !b.canSelect(); ) b = b.containingGroup;
        this.currentPart = b;
        null === this.currentPart ||
          this.currentPart.isSelected ||
          (a.V("ChangingSelection", a.selection),
          (b = a.lastInput),
          ($a ? b.meta : b.control) || b.shift || a.clearSelection(!0),
          (this.currentPart.isSelected = !0),
          a.V("ChangedSelection", a.selection));
      }
    }
  };
  Qe.prototype.doActivate = function () {
    var a = this.diagram;
    this.po = null;
    null === this.currentPart && this.standardMouseSelect();
    var b = this.currentPart;
    null !== b &&
      (b.canMove() || b.canCopy()) &&
      (a.dv(!0),
      (Te = null),
      (this.isActive = !0),
      this.Xl.set(a.position),
      Ue(this, a.selection),
      (this.Pg.length = 0),
      a.animationManager.wc(),
      (this.draggedParts = this.computeEffectiveCollection(
        a.selection,
        this.dragOptions
      )),
      (a.gt = !0),
      !0 === a.Se("temporaryPixelRatio") && 30 < a.Ex && Xe(a),
      Ye(a, this.draggedParts),
      this.Fa("Drag"),
      (this.startPoint = a.firstInput.documentPoint),
      (a.isMouseCaptured = !0),
      a.allowDragOut &&
        ((this.isDragOutStarted = !0),
        (this.En = !1),
        (Te = this),
        (Ze = this.diagram),
        this.doSimulatedDragOut()));
  };
  function Ue(a, b) {
    if (a.dragsLink) {
      var c = a.diagram;
      c.allowRelink &&
        (c.model.vk() && 1 === b.count && b.first() instanceof R
          ? ((a.draggedLink = b.first()),
            a.draggedLink.canRelinkFrom() &&
              a.draggedLink.canRelinkTo() &&
              a.draggedLink.gk(),
            (a.Le = c.toolManager.findTool("Relinking")),
            null === a.Le && ((a.Le = new $e()), (a.Le.diagram = c)),
            (a.Le.originalLink = a.draggedLink))
          : ((a.draggedLink = null), (a.Le = null)));
    }
  }
  Qe.prototype.computeEffectiveCollection = function (a, b) {
    return this.diagram.commandHandler.computeEffectiveCollection(a, b);
  };
  Qe.prototype.Jd = function (a) {
    return void 0 === a
      ? new af(yb)
      : this.isGridSnapEnabled
      ? new af(new K(Math.round(1e3 * a.x) / 1e3, Math.round(1e3 * a.y) / 1e3))
      : new af(a.copy());
  };
  Qe.prototype.doDeactivate = function () {
    this.isActive = !1;
    var a = this.diagram;
    a.dv(!1);
    a.zg();
    bf(this);
    cf(a, this.draggedParts);
    this.draggedParts = this.currentPart = this.po = null;
    this.En = this.isDragOutStarted = !1;
    if (0 < Se.count) {
      for (var b = Se, c = b.length, d = 0; d < c; d++) {
        var e = b.N(d);
        df(e);
        ef(e);
        bf(e);
        e.diagram.zg();
      }
      b.clear();
    }
    df(this);
    this.Xl.h(NaN, NaN);
    null !== Ze && (Ze.currentCursor = "");
    Te = Ze = null;
    ef(this);
    a.isMouseCaptured = !1;
    a.currentCursor = "";
    a.gt = !1;
    this.stopTransaction();
    ff(a, !0);
  };
  Qe.prototype.stopTransaction = function () {
    var a = this.diagram,
      b = we.prototype.stopTransaction.call(this);
    b &&
      null !== a.undoManager.transactionToUndo &&
      a.undoManager.transactionToUndo.Ck();
    return b;
  };
  function bf(a) {
    var b = a.diagram,
      c = b.skipsUndoManager;
    b.skipsUndoManager = !0;
    gf(a, b.lastInput, null);
    b.skipsUndoManager = c;
    a.Pg.length = 0;
  }
  function hf() {
    var a = Te;
    ef(a);
    jf(a);
    var b = a.diagram;
    a.Xl.s() && (b.position = a.Xl);
    b.zg();
  }
  Qe.prototype.doCancel = function () {
    ef(this);
    jf(this);
    var a = this.diagram;
    this.Xl.s() && (a.position = this.Xl);
    this.stopTool();
  };
  Qe.prototype.doKeyDown = function () {
    var a = this.diagram,
      b = a.lastInput;
    this.isActive &&
      ("Esc" === b.key
        ? this.doCancel()
        : b.key !== a.previousInput.key && this.doMouseMove());
  };
  Qe.prototype.doKeyUp = function () {
    this.isActive && this.doMouseMove();
  };
  function kf(a, b) {
    if (null === a.copiedParts) {
      var c = a.diagram;
      if (
        (!b || (!c.isReadOnly && !c.isModelReadOnly)) &&
        null !== a.draggedParts
      ) {
        var d = c.undoManager;
        d.isEnabled && d.isInTransaction
          ? null !== d.currentTransaction &&
            0 < d.currentTransaction.changes.count &&
            (c.undoManager.Pf(), c.Fa("Drag"))
          : jf(a);
        c.skipsUndoManager = !b;
        c.partManager.addsToTemporaryLayer = !b;
        a.startPoint = c.firstInput.documentPoint;
        b = a.copiesEffectiveCollection ? a.draggedParts.Qf() : c.selection;
        b = c.lk(b, c, !0);
        c = new xb();
        for (d = a.draggedParts.iterator; d.next(); ) {
          var e = d.key;
          if (e.Tc() && e.canCopy()) {
            var f = b.K(e);
            null !== f &&
              ((f.location = e.location), f.Za(), c.add(f, a.Jd(f.location)));
          }
        }
        for (b = b.iterator; b.next(); )
          (d = b.value), d instanceof R && d.canCopy() && c.add(d, a.Jd());
        a.copiedParts = c;
        Ue(a, c.Qf());
        null !== a.draggedLink &&
          ((c = a.draggedLink),
          (b = c.routeBounds),
          lf(
            c,
            a.startPoint.x - (b.x + b.width / 2),
            a.startPoint.y - (b.y + b.height / 2)
          ));
        a.doUpdateCursor(null, !0);
      }
    }
  }
  function ef(a) {
    var b = a.diagram;
    if (null !== a.copiedParts) {
      b.at(a.copiedParts.Qf(), !1);
      a.copiedParts = null;
      if (null !== a.draggedParts)
        for (var c = a.draggedParts.iterator; c.next(); )
          c.key instanceof R && (c.value.point = new K(0, 0));
      a.doUpdateCursor(null, !0);
    }
    b.skipsUndoManager = !1;
    b.partManager.addsToTemporaryLayer = !1;
    a.startPoint = b.firstInput.documentPoint;
  }
  function df(a) {
    if (null !== a.draggedLink) {
      if (a.dragsLink && null !== a.Le) {
        var b = a.Le;
        b.diagram.remove(b.temporaryFromNode);
        b.diagram.remove(b.temporaryToNode);
        a.Le.originalLink = null;
      }
      a.draggedLink = null;
      a.Le = null;
    }
  }
  function mf(a, b, c) {
    var d = a.diagram,
      e = a.startPoint,
      f = K.alloc();
    f.assign(d.lastInput.documentPoint);
    a.moveParts(b, f.ne(e), c);
    K.free(f);
    !0 === d.Se("temporaryPixelRatio") &&
      null === d.Bi &&
      30 < d.Ex &&
      (Xe(d), d.yq());
  }
  Qe.prototype.moveParts = function (a, b, c) {
    void 0 === c && (c = !1);
    var d = this.diagram;
    null !== d && nf(d, a, b, this.dragOptions, c);
  };
  function jf(a) {
    if (null !== a.draggedParts) {
      for (var b = a.diagram, c = a.draggedParts.iterator; c.next(); ) {
        var d = c.key;
        d.Tc() && (d.location = c.value.point);
      }
      for (c = a.draggedParts.iterator; c.next(); )
        if (((d = c.key), d instanceof R && d.suspendsRouting)) {
          var e = c.value.point;
          a.draggedParts.add(d, a.Jd());
          lf(d, -e.x, -e.y);
        }
      b.pd();
    }
  }
  function tf(a, b) {
    var c = a.diagram;
    a.dragsLink &&
      (null !== a.draggedLink &&
        ((a.draggedLink.fromNode = null), (a.draggedLink.toNode = null)),
      uf(a, !1));
    var d = a.findDragOverObject(b),
      e = c.lastInput;
    e.targetObject = d;
    a.doUpdateCursor(d, !1);
    var f = c.skipsUndoManager,
      g = !1;
    try {
      c.skipsUndoManager = !0;
      g = gf(a, e, d);
      if (!a.isActive && null === Te) return;
      var h = null !== d ? d.part : null;
      if (
        null === h ||
        (c.handlesDragDropForTopLevelParts &&
          h.isTopLevel &&
          !(h instanceof vf))
      ) {
        var k = c.mouseDragOver;
        null !== k && (k(e), (g = !0));
      }
      if (!a.isActive && null === Te) return;
      a.doDragOver(b, d);
      if (!a.isActive && null === Te) return;
    } finally {
      (c.skipsUndoManager = f), g && c.pd();
    }
    a.po = d;
    c.isReadOnly ||
      (!c.allowMove && !c.allowCopy) ||
      (!c.allowHorizontalScroll && !c.allowVerticalScroll) ||
      c.zs(e.viewPoint);
  }
  Qe.prototype.findDragOverObject = function (a) {
    var b = this;
    return wf(this.diagram, a, null, function (a) {
      null === a
        ? (a = !0)
        : ((a = a.part),
          (a =
            null === a ||
            a instanceof Je ||
            a.layer.isTemporary ||
            (b.draggedParts && b.draggedParts.contains(a)) ||
            (b.copiedParts && b.copiedParts.contains(a))
              ? !0
              : !1));
      return !a;
    });
  };
  Qe.prototype.doUpdateCursor = function (a, b) {
    var c = this.diagram;
    if (b || this.po !== a)
      !this.diagram.currentTool.isActive || this.mayCopy()
        ? (c.currentCursor = this.copyCursor)
        : this.mayMove()
        ? (c.currentCursor = this.moveCursor)
        : this.mayDragOut() && (c.currentCursor = this.nodropCursor);
  };
  function gf(a, b, c) {
    var d = !1,
      e = a.Pg.length,
      f = 0 < e ? a.Pg[0] : null;
    if (c === f) return !1;
    b.handled = !1;
    for (var g = 0; g < e; g++) {
      var h = a.Pg[g],
        k = h.mouseDragLeave;
      if (null !== k && (k(b, h, c), (d = !0), b.handled)) break;
    }
    a.Pg.length = 0;
    if ((!a.isActive && null === Te) || null === c) return d;
    b.handled = !1;
    for (e = c; null !== e; ) a.Pg.push(e), (e = xf(e));
    e = a.Pg.length;
    for (
      c = 0;
      c < e &&
      ((g = a.Pg[c]),
      (h = g.mouseDragEnter),
      null === h || (h(b, g, f), (d = !0), !b.handled));
      c++
    );
    return d;
  }
  function xf(a) {
    var b = a.panel;
    return null !== b
      ? b
      : a instanceof U &&
        !(a instanceof vf) &&
        ((a = a.containingGroup), null !== a && a.handlesDragDropForMembers)
      ? a
      : null;
  }
  function yf(a, b, c) {
    var d = a.Le;
    if (null === d) return null;
    var e = a.diagram.vg(b, d.portGravity, function (a) {
      return d.findValidLinkablePort(a, c);
    });
    a = K.alloc();
    var f = Infinity,
      g = null;
    for (e = e.iterator; e.next(); ) {
      var h = e.value;
      if (null !== h.part) {
        var k = h.ka(Kc, a);
        k = b.Ff(k);
        k < f && ((g = h), (f = k));
      }
    }
    K.free(a);
    return g;
  }
  function uf(a, b) {
    var c = a.draggedLink;
    if (null !== c && !(2 > c.pointsCount)) {
      var d = a.diagram;
      if (!d.isReadOnly) {
        var e = a.Le;
        if (null !== e) {
          var f = null,
            g = null;
          null === c.fromNode &&
            ((f = yf(a, c.i(0), !1)), null !== f && (g = f.part));
          var h = null,
            k = null;
          null === c.toNode &&
            ((h = yf(a, c.i(c.pointsCount - 1), !0)),
            null !== h && (k = h.part));
          e.isValidLink(g, f, k, h)
            ? b
              ? ((c.defaultFromPoint = c.i(0)),
                (c.defaultToPoint = c.i(c.pointsCount - 1)),
                (c.suspendsRouting = !1),
                (c.fromNode = g),
                null !== f && (c.fromPortId = f.portId),
                (c.toNode = k),
                null !== h && (c.toPortId = h.portId),
                c.fromPort !== d.uy && d.V("LinkRelinked", c, d.uy),
                c.toPort !== d.vy && d.V("LinkRelinked", c, d.vy))
              : zf(e, g, f, k, h)
            : zf(e, null, null, null, null);
        }
      }
    }
  }
  Qe.prototype.doDragOver = function () {};
  function Af(a, b) {
    var c = a.diagram;
    a.dragsLink && uf(a, !0);
    bf(a);
    var d = a.findDragOverObject(b),
      e = c.lastInput;
    e.targetObject = d;
    if (null !== d) {
      e.handled = !1;
      for (var f = d; null !== f; ) {
        var g = f.mouseDrop;
        if (null !== g && (g(e, f), e.handled)) break;
        Bf(a, e, f);
        f = xf(f);
      }
    } else (f = c.mouseDrop), null !== f && f(e);
    if (a.isActive || null !== Te) {
      for (e = (a.copiedParts || a.draggedParts).iterator; e.next(); )
        (f = e.key),
          f instanceof V &&
            f.linksConnected.each(function (a) {
              a.suspendsRouting = !1;
            });
      a.doDropOnto(b, d);
      if (a.isActive || null !== Te) {
        a = M.alloc();
        for (b = c.selection.iterator; b.next(); )
          (d = b.value), d instanceof V && Cf(c, d, a);
        M.free(a);
      }
    }
  }
  function Bf(a, b, c) {
    a = a.diagram;
    c = c.part;
    !a.handlesDragDropForTopLevelParts ||
      !c.isTopLevel ||
      c instanceof vf ||
      ((c = a.mouseDrop), null !== c && c(b));
  }
  function Cf(a, b, c) {
    var d = !1;
    b.getAvoidableRect(c);
    a.viewportBounds.Qe(c) && (d = !0);
    a = a.tv(
      c,
      function (a) {
        return a.part;
      },
      function (a) {
        return a instanceof R;
      },
      !0,
      function (a) {
        return a instanceof R;
      },
      d
    );
    if (0 !== a.count)
      for (a = a.iterator; a.next(); )
        (c = a.value), !c.Pd(b) && c.isAvoiding && c.ab();
  }
  Qe.prototype.doDropOnto = function () {};
  Qe.prototype.doMouseMove = function () {
    if (this.isActive) {
      var a = this.diagram,
        b = a.lastInput;
      this.simulatedMouseMove(b.event, b.documentPoint, b.targetDiagram) ||
        null === this.currentPart ||
        null === this.draggedParts ||
        (this.mayCopy()
          ? (kf(this, !1),
            Ye(a, this.copiedParts),
            mf(this, this.copiedParts, !1),
            cf(a, this.copiedParts))
          : this.mayMove()
          ? (ef(this), mf(this, this.draggedParts, !0))
          : this.mayDragOut()
          ? (kf(this, !1), mf(this, this.copiedParts, !1))
          : ef(this),
        tf(this, a.lastInput.documentPoint));
    }
  };
  Qe.prototype.doMouseUp = function () {
    if (this.isActive) {
      var a = this.diagram,
        b = a.lastInput;
      if (!this.simulatedMouseUp(b.event, b.documentPoint, b.targetDiagram)) {
        b = !1;
        var c = this.mayCopy();
        c && null !== this.copiedParts
          ? (ef(this),
            kf(this, !0),
            Ye(a, this.copiedParts),
            mf(this, this.copiedParts, !1),
            cf(a, this.copiedParts),
            null !== this.copiedParts &&
              (a.V("ChangingSelection", a.selection),
              a.clearSelection(!0),
              this.copiedParts.iteratorKeys.each(function (a) {
                a.isSelected = !0;
              })))
          : ((b = !0),
            ef(this),
            this.mayMove() &&
              (mf(this, this.draggedParts, !0),
              tf(this, a.lastInput.documentPoint)));
        this.En = !0;
        Af(this, a.lastInput.documentPoint);
        if (this.isActive) {
          var d = c ? this.copiedParts.Qf() : this.draggedParts.Qf();
          this.copiedParts = null;
          b && Df(this);
          a.Wa();
          cf(a, this.draggedParts);
          this.transactionResult = c ? "Copy" : "Move";
          a.V(c ? "SelectionCopied" : "SelectionMoved", d);
        }
        this.stopTool();
        c && a.V("ChangedSelection", a.selection);
      }
    }
  };
  Qe.prototype.simulatedMouseMove = function (a, b, c) {
    if (null === Te) return !1;
    var d = Te.diagram;
    c instanceof Q || (c = null);
    var e = Ze;
    c !== e &&
      (null !== e &&
        e !== d &&
        (e.zg(),
        (Te.isDragOutStarted = !1),
        (e = e.toolManager.findTool("Dragging")),
        null !== e && e.doSimulatedDragLeave()),
      (Ze = c),
      null !== c &&
        c !== d &&
        (hf(),
        (e = c.toolManager.findTool("Dragging")),
        null !== e && (Se.contains(e) || Se.add(e), e.doSimulatedDragEnter())),
      this.doUpdateCursor(null, !0));
    if (null === c || c === d || !c.allowDrop || c.isReadOnly || !c.allowInsert)
      return !1;
    d = c.toolManager.findTool("Dragging");
    null !== d &&
      (null !== a &&
        (void 0 !== a.targetTouches &&
          (0 < a.targetTouches.length
            ? (a = a.targetTouches[0])
            : 0 < a.changedTouches.length && (a = a.changedTouches[0])),
        (b = c.getMouse(a))),
      (c.lastInput.documentPoint = b),
      (c.lastInput.viewPoint = c.Gq(b)),
      (c.lastInput.down = !1),
      (c.lastInput.up = !1),
      d.doSimulatedDragOver());
    return !0;
  };
  Qe.prototype.simulatedMouseUp = function (a, b, c) {
    if (null === Te) return !1;
    var d = Ze,
      e = Te.diagram;
    if (null === c) return Te.doCancel(), !0;
    if (c !== d) {
      var f = d.toolManager.findTool("Dragging");
      if (null !== d && d !== e && null !== f)
        return d.zg(), (Te.isDragOutStarted = !1), f.doSimulatedDragLeave(), !1;
      Ze = c;
      d = c.toolManager.findTool("Dragging");
      null !== d &&
        (hf(), Se.contains(d) || Se.add(d), d.doSimulatedDragEnter());
    }
    return c !== this.diagram
      ? (null !== a
          ? (void 0 !== a.targetTouches &&
              (0 < a.targetTouches.length
                ? (a = a.targetTouches[0])
                : 0 < a.changedTouches.length && (a = a.changedTouches[0])),
            (b = c.getMouse(a)))
          : null === b && (b = new K()),
        (c.lastInput.documentPoint = b),
        (c.lastInput.viewPoint = c.Gq(b)),
        (c.lastInput.down = !1),
        (c.lastInput.up = !0),
        (a = c.toolManager.findTool("Dragging")),
        null !== a && a.doSimulatedDrop(),
        (a = Te),
        null !== a &&
          ((c = a.mayCopy()),
          (a.transactionResult = c ? "Copy" : "Move"),
          a.stopTool()),
        !0)
      : !1;
  };
  function Df(a) {
    if (null !== a.draggedParts)
      for (var b = a.draggedParts.iterator; b.next(); ) {
        var c = b.key;
        c instanceof V &&
          ((c = c.containingGroup),
          null === c ||
            null === c.placeholder ||
            a.draggedParts.contains(c) ||
            c.placeholder.v());
      }
  }
  Qe.prototype.mayCopy = function () {
    if (!this.isCopyEnabled) return !1;
    var a = this.diagram;
    if (
      a.isReadOnly ||
      a.isModelReadOnly ||
      !a.allowInsert ||
      !a.allowCopy ||
      ($a ? !a.lastInput.alt : !a.lastInput.control)
    )
      return !1;
    for (a = a.selection.iterator; a.next(); ) if (a.value.canCopy()) return !0;
    return null !== this.draggedLink &&
      this.dragsLink &&
      this.draggedLink.canCopy()
      ? !0
      : !1;
  };
  Qe.prototype.mayDragOut = function () {
    if (!this.isCopyEnabled) return !1;
    var a = this.diagram;
    if (!a.allowDragOut || !a.allowCopy || a.allowMove) return !1;
    for (a = a.selection.iterator; a.next(); ) if (a.value.canCopy()) return !0;
    return null !== this.draggedLink &&
      this.dragsLink &&
      this.draggedLink.canCopy()
      ? !0
      : !1;
  };
  Qe.prototype.mayMove = function () {
    var a = this.diagram;
    if (a.isReadOnly || !a.allowMove) return !1;
    for (a = a.selection.iterator; a.next(); ) if (a.value.canMove()) return !0;
    return null !== this.draggedLink &&
      this.dragsLink &&
      this.draggedLink.canMove()
      ? !0
      : !1;
  };
  Qe.prototype.computeBorder = function (a, b, c) {
    return this.En ||
      null === this.draggedParts ||
      this.draggedParts.contains(a)
      ? null
      : c.assign(b);
  };
  Qe.prototype.jA = function () {
    return Te;
  };
  Qe.prototype.mayDragIn = function () {
    var a = this.diagram;
    if (!a.allowDrop || a.isReadOnly || a.isModelReadOnly || !a.allowInsert)
      return !1;
    var b = Te;
    return null === b || b.diagram.model.dataFormat !== a.model.dataFormat
      ? !1
      : !0;
  };
  Qe.prototype.doSimulatedDragEnter = function () {
    if (this.mayDragIn()) {
      var a = this.diagram;
      a.animationManager.wc();
      Ef(a);
      a.animationManager.wc();
      a = Te;
      null !== a && (a.diagram.gt = !1);
      this.doUpdateCursor(null, !0);
    }
  };
  Qe.prototype.doSimulatedDragLeave = function () {
    var a = Te;
    null !== a && a.doSimulatedDragOut();
    this.doCancel();
  };
  Qe.prototype.doSimulatedDragOver = function () {
    var a = this.diagram;
    a.animationManager.fn = !0;
    var b = Te;
    if (null !== b && null !== b.draggedParts) {
      if (!this.mayDragIn()) return;
      Ff(this, b.draggedParts.Qf(), !1, a.firstInput);
      mf(this, this.copiedParts, !1);
      tf(this, a.lastInput.documentPoint);
    }
    a.animationManager.fn = !1;
  };
  Qe.prototype.doSimulatedDrop = function () {
    var a = this.diagram,
      b = Te;
    if (null !== b) {
      var c = b.diagram;
      b.En = !0;
      ef(this);
      if (!this.mayDragIn()) return;
      a.animationManager.fn = !0;
      a.V("ChangingSelection", a.selection);
      this.Fa("Drop");
      Ff(this, b.draggedParts.Qf(), !0, a.lastInput);
      mf(this, this.copiedParts, !1);
      null !== this.copiedParts &&
        (a.clearSelection(!0),
        this.copiedParts.iteratorKeys.each(function (a) {
          a.isSelected = !0;
        }));
      Af(this, a.lastInput.documentPoint);
      a.Wa();
      b = a.selection;
      null !== this.copiedParts
        ? (this.transactionResult = "ExternalCopy")
        : (b = new I());
      this.copiedParts = null;
      a.doFocus();
      a.V("ExternalObjectsDropped", b, c);
      this.stopTransaction();
      a.V("ChangedSelection", a.selection);
    }
    a.animationManager.fn = !1;
  };
  function Ff(a, b, c, d) {
    if (null === a.copiedParts) {
      var e = a.diagram;
      if (!e.isReadOnly && !e.isModelReadOnly) {
        e.skipsUndoManager = !c;
        e.partManager.addsToTemporaryLayer = !c;
        a.startPoint = d.documentPoint;
        c = e.lk(b, e, !0);
        var f = M.alloc();
        e = d = Infinity;
        for (var g = -Infinity, h = -Infinity, k = b.iterator; k.next(); ) {
          var l = k.value;
          if (l.isVisible()) {
            var m = l.location;
            l = m.x;
            m = m.y;
            isNaN(l) ||
              isNaN(m) ||
              (l < d && (d = l),
              m < e && (e = m),
              l > g && (g = l),
              m > h && (h = m));
          }
        }
        Infinity === d ? f.h(0, 0, 0, 0) : f.h(d, e, g - d, h - e);
        d = f.x + f.width / 2;
        e = f.y + f.height / 2;
        M.free(f);
        f = a.gs;
        g = new xb();
        h = K.alloc();
        for (k = b.iterator; k.next(); )
          (l = k.value),
            l instanceof R &&
              l.canCopy() &&
              ((m = c.K(l)),
              null !== m &&
                ((m.points = l.points),
                lf(m, f.x - d, f.y - e),
                (m.suspendsRouting = !0),
                g.add(m, a.Jd())));
        for (b = b.iterator; b.next(); )
          (l = b.value),
            l.Tc() &&
              l.canCopy() &&
              ((k = c.K(l)),
              null !== k &&
                ((l = l.location),
                h.h(f.x - (d - l.x), f.y - (e - l.y)),
                (k.location = h),
                k.Za(),
                g.add(k, a.Jd(h))));
        K.free(h);
        a.copiedParts = g;
        Ue(a, g.Qf());
        null !== a.draggedLink &&
          ((c = a.draggedLink),
          (b = c.routeBounds),
          lf(
            c,
            a.startPoint.x - (b.x + b.width / 2),
            a.startPoint.y - (b.y + b.height / 2)
          ));
        a.doUpdateCursor(null, !0);
      }
    }
  }
  Qe.prototype.doSimulatedDragOut = function () {
    var a = this.diagram;
    a.gt = !1;
    this.mayCopy() || this.mayMove()
      ? (a.currentCursor = "")
      : (a.currentCursor = this.nodropCursor);
    this.po = null;
  };
  Qe.prototype.computeMove = function (a, b, c, d) {
    c = this.diagram;
    return null !== c ? c.computeMove(a, b, this.dragOptions, d) : new K();
  };
  oa.Object.defineProperties(Qe.prototype, {
    isCopyEnabled: {
      configurable: !0,
      get: function () {
        return this.Zc;
      },
      set: function (a) {
        A(a, "boolean", Qe, "isCopyEnabled");
        this.Zc = a;
      },
    },
    copiesEffectiveCollection: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        A(a, "boolean", Qe, "copiesEffectiveCollection");
        this.B = a;
      },
    },
    dragOptions: {
      configurable: !0,
      get: function () {
        return this.Na;
      },
      set: function (a) {
        x(a, Re, Qe, "dragOptions");
        this.Na = a;
      },
    },
    isGridSnapEnabled: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.dragOptions.isGridSnapEnabled;
      },
      set: function (a) {
        A(a, "boolean", Qe, "isGridSnapEnabled");
        this.dragOptions.isGridSnapEnabled = a;
      },
    },
    isComplexRoutingRealtime: {
      configurable: !0,
      get: function () {
        return this.Hc;
      },
      set: function (a) {
        A(a, "boolean", Qe, "isComplexRoutingRealtime");
        this.Hc = a;
      },
    },
    isGridSnapRealtime: {
      configurable: !0,
      get: function () {
        return this.dragOptions.isGridSnapRealtime;
      },
      set: function (a) {
        A(a, "boolean", Qe, "isGridSnapRealtime");
        this.dragOptions.isGridSnapRealtime = a;
      },
    },
    gridSnapCellSize: {
      configurable: !0,
      get: function () {
        return this.dragOptions.gridSnapCellSize;
      },
      set: function (a) {
        x(a, Gb, Qe, "gridSnapCellSize");
        this.dragOptions.gridSnapCellSize.D(a) ||
          ((a = a.L()), (this.dragOptions.gridSnapCellSize = a));
      },
    },
    gridSnapCellSpot: {
      configurable: !0,
      get: function () {
        return this.dragOptions.gridSnapCellSpot;
      },
      set: function (a) {
        x(a, Ib, Qe, "gridSnapCellSpot");
        this.dragOptions.gridSnapCellSpot.D(a) ||
          ((a = a.L()), (this.dragOptions.gridSnapCellSpot = a));
      },
    },
    gridSnapOrigin: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.dragOptions.gridSnapOrigin;
      },
      set: function (a) {
        x(a, K, Qe, "gridSnapOrigin");
        this.dragOptions.gridSnapOrigin.D(a) ||
          ((a = a.L()), (this.dragOptions.gridSnapOrigin = a));
      },
    },
    dragsLink: {
      configurable: !0,
      get: function () {
        return this.dragOptions.dragsLink;
      },
      set: function (a) {
        A(a, "boolean", Qe, "dragsLink");
        this.dragOptions.dragsLink = a;
      },
    },
    dragsTree: {
      configurable: !0,
      get: function () {
        return this.dragOptions.dragsTree;
      },
      set: function (a) {
        A(a, "boolean", Qe, "dragsTree");
        this.dragOptions.dragsTree = a;
      },
    },
    copyCursor: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        this.M = a;
      },
    },
    moveCursor: {
      configurable: !0,
      get: function () {
        return this.Rh;
      },
      set: function (a) {
        this.Rh = a;
      },
    },
    nodropCursor: {
      configurable: !0,
      get: function () {
        return this.Sh;
      },
      set: function (a) {
        this.Sh = a;
      },
    },
    currentPart: {
      configurable: !0,
      get: function () {
        return this.Ba;
      },
      set: function (a) {
        null !== a && x(a, U, Qe, "currentPart");
        this.Ba = a;
      },
    },
    copiedParts: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        this.o = a;
      },
    },
    draggedParts: {
      configurable: !0,
      get: function () {
        return this.eb;
      },
      set: function (a) {
        this.eb = a;
      },
    },
    draggingParts: {
      configurable: !0,
      get: function () {
        return null !== this.copiedParts
          ? this.copiedParts.Qf()
          : null !== this.draggedParts
          ? this.draggedParts.Qf()
          : this.hj;
      },
    },
    draggedLink: {
      configurable: !0,
      get: function () {
        return this.diagram.draggedLink;
      },
      set: function (a) {
        null !== a && x(a, R, Qe, "draggedLink");
        this.diagram.draggedLink = a;
      },
    },
    isDragOutStarted: {
      configurable: !0,
      get: function () {
        return this.Td;
      },
      set: function (a) {
        this.Td = a;
      },
    },
    startPoint: {
      configurable: !0,
      get: function () {
        return this.gs;
      },
      set: function (a) {
        x(a, K, Qe, "startPoint");
        this.gs.D(a) || this.gs.assign(a);
      },
    },
    delay: {
      configurable: !0,
      get: function () {
        return this.gl;
      },
      set: function (a) {
        A(a, "number", Qe, "delay");
        this.gl = a;
      },
    },
  });
  Qe.prototype.getDraggingSource = Qe.prototype.jA;
  var Te = null,
    Ze = null;
  Qe.className = "DraggingTool";
  Se = new H();
  Ta(
    "draggingTool",
    function () {
      return this.findTool("Dragging");
    },
    function (a) {
      this.jb("Dragging", a, this.mouseMoveTools);
    }
  );
  Ua.prototype.doCancel = function () {
    null !== Te && Te.doCancel();
    we.prototype.doCancel.call(this);
  };
  function Gf() {
    0 < arguments.length && Ca(Gf);
    we.call(this);
    this.Sh = 100;
    this.Na = !1;
    this.ai = "pointer";
    var a = new R(),
      b = new Hf();
    b.isPanelMain = !0;
    b.stroke = "blue";
    a.add(b);
    b = new Hf();
    b.toArrow = "Standard";
    b.fill = "blue";
    b.stroke = "blue";
    a.add(b);
    a.layerName = "Tool";
    this.rw = a;
    a = new V();
    b = new Hf();
    b.portId = "";
    b.figure = "Rectangle";
    b.fill = null;
    b.stroke = "magenta";
    b.strokeWidth = 2;
    b.desiredSize = Sb;
    a.add(b);
    a.selectable = !1;
    a.layerName = "Tool";
    this.Vm = a;
    this.j = b;
    a = new V();
    b = new Hf();
    b.portId = "";
    b.figure = "Rectangle";
    b.fill = null;
    b.stroke = "magenta";
    b.strokeWidth = 2;
    b.desiredSize = Sb;
    a.add(b);
    a.selectable = !1;
    a.layerName = "Tool";
    this.sw = a;
    this.o = b;
    this.Rh = this.Td = this.Hc = this.eb = this.Zc = null;
    this.Ba = !0;
    this.Oy = new xb();
    this.hj = this.ri = this.Um = null;
  }
  na(Gf, we);
  Gf.prototype.doStop = function () {
    this.diagram.zg();
    this.originalToPort =
      this.originalToNode =
      this.originalFromPort =
      this.originalFromNode =
      this.originalLink =
        null;
    this.validPortsCache.clear();
    this.targetPort = null;
  };
  Gf.prototype.copyPortProperties = function (a, b, c, d, e) {
    if (null !== a && null !== b && null !== c && null !== d) {
      var f = b.If(),
        g = Gb.alloc();
      g.width = b.naturalBounds.width * f;
      g.height = b.naturalBounds.height * f;
      d.desiredSize = g;
      Gb.free(g);
      e
        ? ((d.toSpot = b.toSpot), (d.toEndSegmentLength = b.toEndSegmentLength))
        : ((d.fromSpot = b.fromSpot),
          (d.fromEndSegmentLength = b.fromEndSegmentLength));
      c.locationSpot = Kc;
      f = K.alloc();
      c.location = b.ka(Kc, f);
      K.free(f);
      d.angle = b.Ti();
      null !== this.portTargeted && this.portTargeted(a, b, c, d, e);
    }
  };
  Gf.prototype.setNoTargetPortProperties = function (a, b, c) {
    null !== b && ((b.desiredSize = Sb), (b.fromSpot = Ec), (b.toSpot = Ec));
    null !== a && (a.location = this.diagram.lastInput.documentPoint);
    null !== this.portTargeted && this.portTargeted(null, null, a, b, c);
  };
  Gf.prototype.doMouseDown = function () {
    this.isActive && this.doMouseMove();
  };
  Gf.prototype.doMouseMove = function () {
    if (this.isActive) {
      var a = this.diagram;
      this.targetPort = this.findTargetPort(this.isForwards);
      if (null !== this.targetPort && this.targetPort.part instanceof V) {
        var b = this.targetPort.part;
        this.isForwards
          ? this.copyPortProperties(
              b,
              this.targetPort,
              this.temporaryToNode,
              this.temporaryToPort,
              !0
            )
          : this.copyPortProperties(
              b,
              this.targetPort,
              this.temporaryFromNode,
              this.temporaryFromPort,
              !1
            );
      } else
        this.isForwards
          ? this.setNoTargetPortProperties(
              this.temporaryToNode,
              this.temporaryToPort,
              !0
            )
          : this.setNoTargetPortProperties(
              this.temporaryFromNode,
              this.temporaryFromPort,
              !1
            );
      (a.allowHorizontalScroll || a.allowVerticalScroll) &&
        a.zs(a.lastInput.viewPoint);
    }
  };
  Gf.prototype.findValidLinkablePort = function (a, b) {
    if (null === a) return null;
    var c = a.part;
    if (!(c instanceof V)) return null;
    for (; null !== a; ) {
      var d = b ? a.toLinkable : a.fromLinkable;
      if (
        !0 === d &&
        (null !== a.portId || a instanceof V) &&
        (b ? this.isValidTo(c, a) : this.isValidFrom(c, a))
      )
        return a;
      if (!1 === d) break;
      a = a.panel;
    }
    return null;
  };
  Gf.prototype.findTargetPort = function (a) {
    var b = this.diagram,
      c = b.lastInput.documentPoint,
      d = this.portGravity;
    0 >= d && (d = 0.1);
    var e = this,
      f = b.vg(
        c,
        d,
        function (b) {
          return e.findValidLinkablePort(b, a);
        },
        null,
        !0
      );
    d = Infinity;
    b = null;
    for (f = f.iterator; f.next(); ) {
      var g = f.value,
        h = g.part;
      if (h instanceof V) {
        var k = g.ka(Kc, K.alloc()),
          l = c.x - k.x,
          m = c.y - k.y;
        K.free(k);
        k = l * l + m * m;
        k < d &&
          ((l = this.validPortsCache.K(g)),
          null !== l
            ? l && ((b = g), (d = k))
            : (a &&
                this.isValidLink(
                  this.originalFromNode,
                  this.originalFromPort,
                  h,
                  g
                )) ||
              (!a &&
                this.isValidLink(
                  h,
                  g,
                  this.originalToNode,
                  this.originalToPort
                ))
            ? (this.validPortsCache.add(g, !0), (b = g), (d = k))
            : this.validPortsCache.add(g, !1));
      }
    }
    return null !== b &&
      ((c = b.part), c instanceof V && (null === c.layer || c.layer.allowLink))
      ? b
      : null;
  };
  Gf.prototype.isValidFrom = function (a, b) {
    if (null === a || null === b) return this.isUnconnectedLinkValid;
    if (
      this.diagram.currentTool === this &&
      ((null !== a.layer && !a.layer.allowLink) || !0 !== b.fromLinkable)
    )
      return !1;
    var c = b.fromMaxLinks;
    if (Infinity > c) {
      if (
        null !== this.originalLink &&
        a === this.originalFromNode &&
        b === this.originalFromPort
      )
        return !0;
      b = b.portId;
      null === b && (b = "");
      if (a.fq(b).count >= c) return !1;
    }
    return !0;
  };
  Gf.prototype.isValidTo = function (a, b) {
    if (null === a || null === b) return this.isUnconnectedLinkValid;
    if (
      this.diagram.currentTool === this &&
      ((null !== a.layer && !a.layer.allowLink) || !0 !== b.toLinkable)
    )
      return !1;
    var c = b.toMaxLinks;
    if (Infinity > c) {
      if (
        null !== this.originalLink &&
        a === this.originalToNode &&
        b === this.originalToPort
      )
        return !0;
      b = b.portId;
      null === b && (b = "");
      if (a.Nd(b).count >= c) return !1;
    }
    return !0;
  };
  Gf.prototype.isInSameNode = function (a, b) {
    if (null === a || null === b) return !1;
    if (a === b) return !0;
    a = a.part;
    b = b.part;
    return null !== a && a === b;
  };
  Gf.prototype.isLinked = function (a, b) {
    if (null === a || null === b) return !1;
    var c = a.part;
    if (!(c instanceof V)) return !1;
    a = a.portId;
    null === a && (a = "");
    var d = b.part;
    if (!(d instanceof V)) return !1;
    b = b.portId;
    null === b && (b = "");
    for (b = d.Nd(b); b.next(); )
      if (((d = b.value), d.fromNode === c && d.fromPortId === a)) return !0;
    return !1;
  };
  Gf.prototype.isValidLink = function (a, b, c, d) {
    if (
      !this.isValidFrom(a, b) ||
      !this.isValidTo(c, d) ||
      !(
        null === b ||
        null === d ||
        (((b.fromLinkableSelfNode && d.toLinkableSelfNode) ||
          !this.isInSameNode(b, d)) &&
          ((b.fromLinkableDuplicates && d.toLinkableDuplicates) ||
            !this.isLinked(b, d)))
      ) ||
      (null !== this.originalLink &&
        ((null !== a && this.isLabelDependentOnLink(a, this.originalLink)) ||
          (null !== c && this.isLabelDependentOnLink(c, this.originalLink)))) ||
      (null !== a &&
        null !== c &&
        ((null === a.data && null !== c.data) ||
          (null !== a.data && null === c.data))) ||
      !this.isValidCycle(a, c, this.originalLink)
    )
      return !1;
    if (null !== a) {
      var e = a.linkValidation;
      if (null !== e && !e(a, b, c, d, this.originalLink)) return !1;
    }
    if (
      null !== c &&
      ((e = c.linkValidation), null !== e && !e(a, b, c, d, this.originalLink))
    )
      return !1;
    e = this.linkValidation;
    return null !== e ? e(a, b, c, d, this.originalLink) : !0;
  };
  Gf.prototype.isLabelDependentOnLink = function (a, b) {
    if (null === a) return !1;
    var c = a.labeledLink;
    if (null === c) return !1;
    if (c === b) return !0;
    var d = new I();
    d.add(a);
    return If(this, c, b, d);
  };
  function If(a, b, c, d) {
    if (b === c) return !0;
    var e = b.fromNode;
    if (null !== e && e.isLinkLabel && (d.add(e), If(a, e.labeledLink, c, d)))
      return !0;
    b = b.toNode;
    return null !== b && b.isLinkLabel && (d.add(b), If(a, b.labeledLink, c, d))
      ? !0
      : !1;
  }
  Gf.prototype.isValidCycle = function (a, b, c) {
    void 0 === c && (c = null);
    if (null === a || null === b) return this.isUnconnectedLinkValid;
    var d = this.diagram.validCycle;
    if (d !== Jf) {
      if (d === Kf) {
        d = c || this.temporaryLink;
        if (null !== d && !d.isTreeLink) return !0;
        for (d = b.linksConnected; d.next(); ) {
          var e = d.value;
          if (e !== c && e.isTreeLink && e.toNode === b) return !1;
        }
        return !Lf(this, a, b, c, !0);
      }
      if (d === Mf) {
        d = c || this.temporaryLink;
        if (null !== d && !d.isTreeLink) return !0;
        for (d = a.linksConnected; d.next(); )
          if (((e = d.value), e !== c && e.isTreeLink && e.fromNode === a))
            return !1;
        return !Lf(this, a, b, c, !0);
      }
      if (d === Nf)
        return (
          a === b
            ? (a = !0)
            : ((d = new I()), d.add(b), (a = Of(this, d, a, b, c))),
          !a
        );
      if (d === Zf) return !Lf(this, a, b, c, !1);
      if (d === $f)
        return (
          a === b
            ? (a = !0)
            : ((d = new I()), d.add(b), (a = ag(this, d, a, b, c))),
          !a
        );
    }
    return !0;
  };
  function Lf(a, b, c, d, e) {
    if (b === c) return !0;
    if (null === b || null === c) return !1;
    for (var f = b.linksConnected; f.next(); ) {
      var g = f.value;
      if (
        g !== d &&
        (!e || g.isTreeLink) &&
        g.toNode === b &&
        ((g = g.fromNode), g !== b && Lf(a, g, c, d, e))
      )
        return !0;
    }
    return !1;
  }
  function Of(a, b, c, d, e) {
    if (c === d) return !0;
    if (null === c || null === d || b.contains(c)) return !1;
    b.add(c);
    for (var f = c.linksConnected; f.next(); ) {
      var g = f.value;
      if (
        g !== e &&
        g.toNode === c &&
        ((g = g.fromNode), g !== c && Of(a, b, g, d, e))
      )
        return !0;
    }
    return !1;
  }
  function ag(a, b, c, d, e) {
    if (c === d) return !0;
    if (null === c || null === d || b.contains(c)) return !1;
    b.add(c);
    for (var f = c.linksConnected; f.next(); ) {
      var g = f.value;
      if (g !== e) {
        var h = g.fromNode;
        g = g.toNode;
        h = h === c ? g : h;
        if (h !== c && ag(a, b, h, d, e)) return !0;
      }
    }
    return !1;
  }
  oa.Object.defineProperties(Gf.prototype, {
    portGravity: {
      configurable: !0,
      get: function () {
        return this.Sh;
      },
      set: function (a) {
        A(a, "number", Gf, "portGravity");
        0 <= a && (this.Sh = a);
      },
    },
    isUnconnectedLinkValid: {
      configurable: !0,
      get: function () {
        return this.Na;
      },
      set: function (a) {
        A(a, "boolean", Gf, "isUnconnectedLinkValid");
        this.Na = a;
      },
    },
    linkingCursor: {
      configurable: !0,
      get: function () {
        return this.ai;
      },
      set: function (a) {
        this.ai = a;
      },
    },
    temporaryLink: {
      configurable: !0,
      get: function () {
        return this.rw;
      },
      set: function (a) {
        x(a, R, Gf, "temporaryLink");
        this.rw = a;
      },
    },
    temporaryFromNode: {
      configurable: !0,
      get: function () {
        return this.Vm;
      },
      set: function (a) {
        x(a, V, Gf, "temporaryFromNode");
        if ((this.Vm = a)) this.j = a.port;
      },
    },
    temporaryFromPort: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        x(a, O, Gf, "temporaryFromPort");
        if (null !== this.j) {
          var b = this.j.panel;
          if (null !== b) {
            var c = b.W.indexOf(this.j);
            b.nb(c);
            b.Cb(c, a);
          }
        }
        this.j = a;
      },
    },
    temporaryToNode: {
      configurable: !0,
      get: function () {
        return this.sw;
      },
      set: function (a) {
        x(a, V, Gf, "temporaryToNode");
        if ((this.sw = a)) this.o = a.port;
      },
    },
    temporaryToPort: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        x(a, O, Gf, "temporaryToPort");
        if (null !== this.o) {
          var b = this.o.panel;
          if (null !== b) {
            var c = b.W.indexOf(this.o);
            b.nb(c);
            b.Cb(c, a);
          }
        }
        this.o = a;
      },
    },
    originalLink: {
      configurable: !0,
      get: function () {
        return this.Zc;
      },
      set: function (a) {
        null !== a && x(a, R, Gf, "originalLink");
        this.Zc = a;
      },
    },
    originalFromNode: {
      configurable: !0,
      get: function () {
        return this.eb;
      },
      set: function (a) {
        null !== a && x(a, V, Gf, "originalFromNode");
        this.eb = a;
      },
    },
    originalFromPort: {
      configurable: !0,
      get: function () {
        return this.Hc;
      },
      set: function (a) {
        null !== a && x(a, O, Gf, "originalFromPort");
        this.Hc = a;
      },
    },
    originalToNode: {
      configurable: !0,
      get: function () {
        return this.Td;
      },
      set: function (a) {
        null !== a && x(a, V, Gf, "originalToNode");
        this.Td = a;
      },
    },
    originalToPort: {
      configurable: !0,
      get: function () {
        return this.Rh;
      },
      set: function (a) {
        null !== a && x(a, O, Gf, "originalToPort");
        this.Rh = a;
      },
    },
    isForwards: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Ba;
      },
      set: function (a) {
        A(a, "boolean", Gf, "isForwards");
        this.Ba = a;
      },
    },
    validPortsCache: {
      configurable: !0,
      get: function () {
        return this.Oy;
      },
    },
    targetPort: {
      configurable: !0,
      get: function () {
        return this.Um;
      },
      set: function (a) {
        null !== a && x(a, O, Gf, "targetPort");
        this.Um = a;
      },
    },
    linkValidation: {
      configurable: !0,
      get: function () {
        return this.ri;
      },
      set: function (a) {
        null !== a && A(a, "function", Gf, "linkValidation");
        this.ri = a;
      },
    },
    portTargeted: {
      configurable: !0,
      get: function () {
        return this.hj;
      },
      set: function (a) {
        null !== a && A(a, "function", Gf, "portTargeted");
        this.hj = a;
      },
    },
  });
  Gf.className = "LinkingBaseTool";
  function bg() {
    0 < arguments.length && Ca(bg);
    Gf.call(this);
    this.name = "Linking";
    this.M = {};
    this.B = null;
    this.O = cg;
    this.Th = null;
  }
  na(bg, Gf);
  bg.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    return a.isReadOnly ||
      a.isModelReadOnly ||
      !a.allowLink ||
      !a.model.Qs() ||
      !a.lastInput.left ||
      (a.currentTool !== this && !this.isBeyondDragSize())
      ? !1
      : null !== this.findLinkablePort();
  };
  bg.prototype.findLinkablePort = function () {
    var a = this.diagram,
      b = this.startObject;
    null === b && (b = a.dc(a.firstInput.documentPoint, null, null));
    if (null === b) return null;
    a = b.part;
    if (!(a instanceof V)) return null;
    var c = this.direction;
    if (c === cg || c === dg) {
      var d = this.findValidLinkablePort(b, !1);
      if (
        null !== d ||
        (this.startObject === a &&
          ((d = a.port), this.findValidLinkablePort(d, !1)))
      )
        return (this.isForwards = !0), d;
    }
    if (c === cg || c === eg)
      if (
        ((b = this.findValidLinkablePort(b, !0)),
        null !== b ||
          (this.startObject === a &&
            ((b = a.port), this.findValidLinkablePort(b, !0))))
      )
        return (this.isForwards = !1), b;
    return null;
  };
  bg.prototype.doActivate = function () {
    var a = this.diagram,
      b = this.findLinkablePort();
    null === b
      ? this.stopTool()
      : (this.Fa(this.name),
        (a.isMouseCaptured = !0),
        (a.currentCursor = this.linkingCursor),
        this.isForwards
          ? (null === this.temporaryToNode ||
              this.temporaryToNode.location.s() ||
              (this.temporaryToNode.location = a.lastInput.documentPoint),
            (this.originalFromPort = b),
            (b = this.originalFromPort.part),
            b instanceof V && (this.originalFromNode = b),
            this.copyPortProperties(
              this.originalFromNode,
              this.originalFromPort,
              this.temporaryFromNode,
              this.temporaryFromPort,
              !1
            ))
          : (null === this.temporaryFromNode ||
              this.temporaryFromNode.location.s() ||
              (this.temporaryFromNode.location = a.lastInput.documentPoint),
            (this.originalToPort = b),
            (b = this.originalToPort.part),
            b instanceof V && (this.originalToNode = b),
            this.copyPortProperties(
              this.originalToNode,
              this.originalToPort,
              this.temporaryToNode,
              this.temporaryToPort,
              !0
            )),
        a.add(this.temporaryFromNode),
        a.add(this.temporaryToNode),
        null !== this.temporaryLink &&
          (null !== this.temporaryFromNode &&
            (this.temporaryLink.fromNode = this.temporaryFromNode),
          null !== this.temporaryToNode &&
            (this.temporaryLink.toNode = this.temporaryToNode),
          (this.temporaryLink.isTreeLink = this.isNewTreeLink()),
          this.temporaryLink.ab(),
          a.add(this.temporaryLink)),
        (this.isActive = !0));
  };
  bg.prototype.doDeactivate = function () {
    this.isActive = !1;
    var a = this.diagram;
    a.remove(this.temporaryLink);
    a.remove(this.temporaryFromNode);
    a.remove(this.temporaryToNode);
    a.isMouseCaptured = !1;
    a.currentCursor = "";
    this.stopTransaction();
  };
  bg.prototype.doStop = function () {
    Gf.prototype.doStop.call(this);
    this.startObject = null;
  };
  bg.prototype.doMouseUp = function () {
    if (this.isActive) {
      var a = this.diagram,
        b = (this.transactionResult = null),
        c = null,
        d = null,
        e = null,
        f = null;
      try {
        var g = (this.targetPort = this.findTargetPort(this.isForwards));
        if (null !== g) {
          var h = g.part;
          h instanceof V &&
            (this.isForwards
              ? (null !== this.originalFromNode &&
                  ((b = this.originalFromNode), (c = this.originalFromPort)),
                (d = h),
                (e = g))
              : ((b = h),
                (c = g),
                null !== this.originalToNode &&
                  ((d = this.originalToNode), (e = this.originalToPort))));
        } else
          this.isForwards
            ? null !== this.originalFromNode &&
              this.isUnconnectedLinkValid &&
              ((b = this.originalFromNode), (c = this.originalFromPort))
            : null !== this.originalToNode &&
              this.isUnconnectedLinkValid &&
              ((d = this.originalToNode), (e = this.originalToPort));
        null !== b || null !== d
          ? ((f = this.insertLink(b, c, d, e)),
            null !== f
              ? (null === g &&
                  (this.isForwards
                    ? (f.defaultToPoint = a.lastInput.documentPoint)
                    : (f.defaultFromPoint = a.lastInput.documentPoint)),
                a.allowSelect &&
                  (a.V("ChangingSelection", a.selection),
                  a.clearSelection(!0),
                  (f.isSelected = !0)),
                (this.transactionResult = this.name),
                a.V("LinkDrawn", f))
              : this.doNoLink(b, c, d, e))
          : this.isForwards
          ? this.doNoLink(
              this.originalFromNode,
              this.originalFromPort,
              null,
              null
            )
          : this.doNoLink(null, null, this.originalToNode, this.originalToPort);
      } finally {
        this.stopTool(),
          f && a.allowSelect && a.V("ChangedSelection", a.selection);
      }
    }
  };
  bg.prototype.isNewTreeLink = function () {
    var a = this.archetypeLinkData;
    if (null === a) return !0;
    if (a instanceof R) return a.isTreeLink;
    var b = this.diagram;
    if (null === b) return !0;
    a = b.partManager.getLinkCategoryForData(a);
    b = b.partManager.findLinkTemplateForCategory(a);
    return null !== b ? b.isTreeLink : !0;
  };
  bg.prototype.insertLink = function (a, b, c, d) {
    return this.diagram.partManager.insertLink(a, b, c, d);
  };
  bg.prototype.doNoLink = function () {};
  oa.Object.defineProperties(bg.prototype, {
    archetypeLinkData: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        null !== a && A(a, "object", bg, "archetypeLinkData");
        a instanceof O && x(a, R, bg, "archetypeLinkData");
        this.M = a;
      },
    },
    archetypeLabelNodeData: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        null !== a && A(a, "object", bg, "archetypeLabelNodeData");
        a instanceof O && x(a, V, bg, "archetypeLabelNodeData");
        this.B = a;
      },
    },
    direction: {
      configurable: !0,
      get: function () {
        return this.O;
      },
      set: function (a) {
        cb(a, bg, bg, "direction");
        this.O = a;
      },
    },
    startObject: {
      configurable: !0,
      get: function () {
        return this.Th;
      },
      set: function (a) {
        null !== a && x(a, O, bg, "startObject");
        this.Th = a;
      },
    },
  });
  var cg = new F(bg, "Either", 0),
    dg = new F(bg, "ForwardsOnly", 0),
    eg = new F(bg, "BackwardsOnly", 0);
  bg.className = "LinkingTool";
  bg.Either = cg;
  bg.ForwardsOnly = dg;
  bg.BackwardsOnly = eg;
  function $e() {
    0 < arguments.length && Ca($e);
    Gf.call(this);
    this.name = "Relinking";
    var a = new Hf();
    a.figure = "Diamond";
    a.desiredSize = Xb;
    a.fill = "lightblue";
    a.stroke = "dodgerblue";
    a.cursor = this.linkingCursor;
    a.segmentIndex = 0;
    this.M = a;
    a = new Hf();
    a.figure = "Diamond";
    a.desiredSize = Xb;
    a.fill = "lightblue";
    a.stroke = "dodgerblue";
    a.cursor = this.linkingCursor;
    a.segmentIndex = -1;
    this.Th = a;
    this.B = null;
    this.hx = new M();
  }
  na($e, Gf);
  $e.prototype.updateAdornments = function (a) {
    if (null !== a && a instanceof R) {
      var b = "RelinkFrom",
        c = null;
      if (a.isSelected && !this.diagram.isReadOnly) {
        var d = a.selectionObject;
        null !== d &&
          a.canRelinkFrom() &&
          a.actualBounds.s() &&
          a.isVisible() &&
          d.actualBounds.s() &&
          d.Nf() &&
          ((c = a.pk(b)),
          null === c && ((c = this.makeAdornment(d, !1)), a.Ch(b, c)));
      }
      null === c && a.Of(b);
      b = "RelinkTo";
      c = null;
      a.isSelected &&
        !this.diagram.isReadOnly &&
        ((d = a.selectionObject),
        null !== d &&
          a.canRelinkTo() &&
          a.actualBounds.s() &&
          a.isVisible() &&
          d.actualBounds.s() &&
          d.Nf() &&
          ((c = a.pk(b)),
          null === c ? ((c = this.makeAdornment(d, !0)), a.Ch(b, c)) : c.v()));
      null === c && a.Of(b);
    }
  };
  $e.prototype.makeAdornment = function (a, b) {
    var c = new Je();
    c.type = W.Link;
    b = b ? this.toHandleArchetype : this.fromHandleArchetype;
    null !== b && c.add(b.copy());
    c.adornedObject = a;
    return c;
  };
  $e.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    if (
      a.isReadOnly ||
      a.isModelReadOnly ||
      !a.allowRelink ||
      !a.model.Qs() ||
      !a.lastInput.left
    )
      return !1;
    var b = this.findToolHandleAt(a.firstInput.documentPoint, "RelinkFrom");
    null === b &&
      (b = this.findToolHandleAt(a.firstInput.documentPoint, "RelinkTo"));
    return null !== b;
  };
  $e.prototype.doActivate = function () {
    var a = this.diagram;
    if (null === this.originalLink) {
      var b = this.handle;
      null === b &&
        ((b = this.findToolHandleAt(a.firstInput.documentPoint, "RelinkFrom")),
        null === b &&
          (b = this.findToolHandleAt(a.firstInput.documentPoint, "RelinkTo")));
      if (null === b) return;
      var c = b.part;
      if (!(c instanceof Je && c.adornedPart instanceof R)) return;
      this.handle = b;
      this.isForwards = null === c || "RelinkTo" === c.category;
      this.originalLink = c.adornedPart;
    }
    this.Fa(this.name);
    a.isMouseCaptured = !0;
    a.currentCursor = this.linkingCursor;
    this.originalFromPort = this.originalLink.fromPort;
    this.originalFromNode = this.originalLink.fromNode;
    this.originalToPort = this.originalLink.toPort;
    this.originalToNode = this.originalLink.toNode;
    this.hx.set(this.originalLink.actualBounds);
    null !== this.originalLink &&
      0 < this.originalLink.pointsCount &&
      (null === this.originalLink.fromNode &&
        (null !== this.temporaryFromPort &&
          (this.temporaryFromPort.desiredSize = Rb),
        null !== this.temporaryFromNode &&
          (this.temporaryFromNode.location = this.originalLink.i(0))),
      null === this.originalLink.toNode &&
        (null !== this.temporaryToPort &&
          (this.temporaryToPort.desiredSize = Rb),
        null !== this.temporaryToNode &&
          (this.temporaryToNode.location = this.originalLink.i(
            this.originalLink.pointsCount - 1
          ))));
    this.copyPortProperties(
      this.originalFromNode,
      this.originalFromPort,
      this.temporaryFromNode,
      this.temporaryFromPort,
      !1
    );
    this.copyPortProperties(
      this.originalToNode,
      this.originalToPort,
      this.temporaryToNode,
      this.temporaryToPort,
      !0
    );
    a.add(this.temporaryFromNode);
    a.add(this.temporaryToNode);
    null !== this.temporaryLink &&
      (null !== this.temporaryFromNode &&
        (this.temporaryLink.fromNode = this.temporaryFromNode),
      null !== this.temporaryToNode &&
        (this.temporaryLink.toNode = this.temporaryToNode),
      this.copyLinkProperties(this.originalLink, this.temporaryLink),
      this.temporaryLink.ab(),
      a.add(this.temporaryLink));
    this.isActive = !0;
  };
  $e.prototype.copyLinkProperties = function (a, b) {
    if (null !== a && null !== b) {
      b.adjusting = a.adjusting;
      b.corner = a.corner;
      var c = a.curve;
      if (c === fg || c === gg) c = hg;
      b.curve = c;
      b.curviness = a.curviness;
      b.isTreeLink = a.isTreeLink;
      b.points = a.points;
      b.routing = a.routing;
      b.smoothness = a.smoothness;
      b.fromSpot = a.fromSpot;
      b.fromEndSegmentLength = a.fromEndSegmentLength;
      b.fromShortLength = a.fromShortLength;
      b.toSpot = a.toSpot;
      b.toEndSegmentLength = a.toEndSegmentLength;
      b.toShortLength = a.toShortLength;
    }
  };
  $e.prototype.doDeactivate = function () {
    this.isActive = !1;
    var a = this.diagram;
    a.remove(this.temporaryLink);
    a.remove(this.temporaryFromNode);
    a.remove(this.temporaryToNode);
    a.isMouseCaptured = !1;
    a.currentCursor = "";
    this.stopTransaction();
  };
  $e.prototype.doStop = function () {
    Gf.prototype.doStop.call(this);
    this.handle = null;
  };
  $e.prototype.doMouseUp = function () {
    if (this.isActive) {
      var a = this.diagram;
      this.transactionResult = null;
      var b = this.originalFromNode,
        c = this.originalFromPort,
        d = this.originalToNode,
        e = this.originalToPort,
        f = this.originalLink;
      try {
        this.targetPort = this.findTargetPort(this.isForwards);
        if (null !== this.targetPort) {
          var g = this.targetPort.part;
          g instanceof V &&
            (this.isForwards
              ? ((d = g), (e = this.targetPort))
              : ((b = g), (c = this.targetPort)));
        } else
          this.isUnconnectedLinkValid
            ? this.isForwards
              ? (e = d = null)
              : (c = b = null)
            : (f = null);
        null !== f
          ? (this.reconnectLink(
              f,
              this.isForwards ? d : b,
              this.isForwards ? e : c,
              this.isForwards
            ),
            null === this.targetPort &&
              (this.isForwards
                ? (f.defaultToPoint = a.lastInput.documentPoint)
                : (f.defaultFromPoint = a.lastInput.documentPoint),
              f.ab()),
            (this.transactionResult = this.name),
            a.V(
              "LinkRelinked",
              f,
              this.isForwards ? this.originalToPort : this.originalFromPort
            ))
          : this.doNoRelink(this.originalLink, this.isForwards);
        this.originalLink.oq(this.hx);
      } finally {
        this.stopTool();
      }
    }
  };
  $e.prototype.reconnectLink = function (a, b, c, d) {
    c = null !== c && null !== c.portId ? c.portId : "";
    d
      ? ((a.toNode = b), (a.toPortId = c))
      : ((a.fromNode = b), (a.fromPortId = c));
    return !0;
  };
  $e.prototype.doNoRelink = function () {};
  function zf(a, b, c, d, e) {
    null !== b
      ? (a.copyPortProperties(
          b,
          c,
          a.temporaryFromNode,
          a.temporaryFromPort,
          !1
        ),
        a.diagram.add(a.temporaryFromNode))
      : a.diagram.remove(a.temporaryFromNode);
    null !== d
      ? (a.copyPortProperties(d, e, a.temporaryToNode, a.temporaryToPort, !0),
        a.diagram.add(a.temporaryToNode))
      : a.diagram.remove(a.temporaryToNode);
  }
  oa.Object.defineProperties($e.prototype, {
    fromHandleArchetype: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        null !== a && x(a, O, $e, "fromHandleArchetype");
        this.M = a;
      },
    },
    toHandleArchetype: {
      configurable: !0,
      get: function () {
        return this.Th;
      },
      set: function (a) {
        null !== a && x(a, O, $e, "toHandleArchetype");
        this.Th = a;
      },
    },
    handle: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        if (null !== a && (x(a, O, $e, "handle"), !(a.part instanceof Je)))
          throw Error("new handle is not in an Adornment: " + a);
        this.B = a;
      },
    },
  });
  $e.className = "RelinkingTool";
  Ta(
    "linkingTool",
    function () {
      return this.findTool("Linking");
    },
    function (a) {
      this.jb("Linking", a, this.mouseMoveTools);
    }
  );
  Ta(
    "relinkingTool",
    function () {
      return this.findTool("Relinking");
    },
    function (a) {
      this.jb("Relinking", a, this.mouseDownTools);
    }
  );
  function ig() {
    0 < arguments.length && Ca(ig);
    we.call(this);
    this.name = "LinkReshaping";
    var a = new Hf();
    a.figure = "Rectangle";
    a.desiredSize = Tb;
    a.fill = "lightblue";
    a.stroke = "dodgerblue";
    this.o = a;
    a = new Hf();
    a.figure = "Diamond";
    a.desiredSize = Xb;
    a.fill = "lightblue";
    a.stroke = "dodgerblue";
    a.cursor = "move";
    this.B = a;
    this.M = 3;
    this.nt = this.j = null;
    this.ix = new K();
    this.Qr = new H();
  }
  na(ig, we);
  ig.prototype.xv = function (a) {
    return a && a.Ur && 0 !== a.Ur.value ? a.Ur : jg;
  };
  ig.prototype.Lm = function (a, b) {
    x(a, O, ig, "setReshapingBehavior:obj");
    cb(b, ig, ig, "setReshapingBehavior:behavior");
    a.Ur = b;
  };
  ig.prototype.updateAdornments = function (a) {
    if (null !== a && a instanceof R) {
      var b = null;
      if (a.isSelected && !this.diagram.isReadOnly) {
        var c = a.path;
        null !== c &&
          a.canReshape() &&
          a.actualBounds.s() &&
          a.isVisible() &&
          c.actualBounds.s() &&
          c.Nf() &&
          ((b = a.pk(this.name)),
          null === b || b.ax !== a.pointsCount || b.xx !== a.resegmentable) &&
          ((b = this.makeAdornment(c)),
          null !== b &&
            ((b.ax = a.pointsCount),
            (b.xx = a.resegmentable),
            a.Ch(this.name, b)));
      }
      null === b && a.Of(this.name);
    }
  };
  ig.prototype.makeAdornment = function (a) {
    var b = a.part,
      c = b.pointsCount,
      d = b.isOrthogonal,
      e = null;
    if (null !== b.points && 1 < c) {
      e = new Je();
      e.type = W.Link;
      c = b.firstPickIndex;
      var f = b.lastPickIndex,
        g = d ? 1 : 0;
      if (b.resegmentable && b.computeCurve() !== kg)
        for (var h = c + g; h < f - g; h++) {
          var k = this.makeResegmentHandle(a, h);
          null !== k &&
            ((k.segmentIndex = h),
            (k.segmentFraction = 0.5),
            (k.fromMaxLinks = 999),
            e.add(k));
        }
      for (g = c + 1; g < f; g++)
        if (((h = this.makeHandle(a, g)), null !== h)) {
          h.segmentIndex = g;
          if (g !== c)
            if (g === c + 1 && d) {
              k = b.i(c);
              var l = b.i(c + 1);
              L.C(k.x, l.x) && L.C(k.y, l.y) && (l = b.i(c - 1));
              L.C(k.x, l.x)
                ? (this.Lm(h, lg), (h.cursor = "n-resize"))
                : L.C(k.y, l.y) && (this.Lm(h, mg), (h.cursor = "w-resize"));
            } else
              g === f - 1 && d
                ? ((k = b.i(f - 1)),
                  (l = b.i(f)),
                  L.C(k.x, l.x) && L.C(k.y, l.y) && (k = b.i(f + 1)),
                  L.C(k.x, l.x)
                    ? (this.Lm(h, lg), (h.cursor = "n-resize"))
                    : L.C(k.y, l.y) &&
                      (this.Lm(h, mg), (h.cursor = "w-resize")))
                : g !== f && (this.Lm(h, ng), (h.cursor = "move"));
          e.add(h);
        }
      e.adornedObject = a;
    }
    return e;
  };
  ig.prototype.makeHandle = function () {
    var a = this.handleArchetype;
    return null === a ? null : a.copy();
  };
  ig.prototype.makeResegmentHandle = function () {
    var a = this.midHandleArchetype;
    return null === a ? null : a.copy();
  };
  ig.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    return !a.isReadOnly && a.allowReshape && a.lastInput.left
      ? null !== this.findToolHandleAt(a.firstInput.documentPoint, this.name)
      : !1;
  };
  ig.prototype.doActivate = function () {
    var a = this.diagram;
    null === this.handle &&
      (this.handle = this.findToolHandleAt(
        a.firstInput.documentPoint,
        this.name
      ));
    if (null !== this.handle) {
      var b = this.handle.part.adornedPart;
      if (b instanceof R) {
        this.nt = b;
        a.isMouseCaptured = !0;
        this.Fa(this.name);
        if (b.resegmentable && 999 === this.handle.fromMaxLinks) {
          var c = b.points.copy(),
            d = this.getResegmentingPoint();
          c.Cb(this.handle.segmentIndex + 1, d);
          b.isOrthogonal && c.Cb(this.handle.segmentIndex + 1, d);
          b.points = c;
          b.Tb();
          b.updateAdornments();
          this.handle = this.findToolHandleAt(
            a.firstInput.documentPoint,
            this.name
          );
          if (null === this.handle) {
            this.doDeactivate();
            return;
          }
        }
        this.ix = b.i(this.handle.segmentIndex);
        this.Qr = b.points.copy();
        this.isActive = !0;
      }
    }
  };
  ig.prototype.doDeactivate = function () {
    this.stopTransaction();
    this.nt = this.handle = null;
    this.isActive = this.diagram.isMouseCaptured = !1;
  };
  ig.prototype.stopTransaction = function () {
    var a = this.diagram,
      b = we.prototype.stopTransaction.call(this);
    b &&
      null !== a.undoManager.transactionToUndo &&
      a.undoManager.transactionToUndo.Ck();
    return b;
  };
  ig.prototype.doCancel = function () {
    var a = this.adornedLink;
    null !== a && (a.points = this.Qr);
    this.stopTool();
  };
  ig.prototype.getResegmentingPoint = function () {
    return this.handle.ka(Kc);
  };
  ig.prototype.doMouseMove = function () {
    var a = this.diagram;
    this.isActive &&
      ((a = this.computeReshape(a.lastInput.documentPoint)), this.reshape(a));
  };
  ig.prototype.doMouseUp = function () {
    var a = this.diagram;
    if (this.isActive) {
      var b = this.computeReshape(a.lastInput.documentPoint);
      this.reshape(b);
      b = this.adornedLink;
      if (null !== b && b.resegmentable) {
        var c = this.handle.segmentIndex,
          d = b.i(c - 1),
          e = b.i(c),
          f = b.i(c + 1);
        if (b.isOrthogonal) {
          if (c > b.firstPickIndex + 1 && c < b.lastPickIndex - 1) {
            var g = b.i(c - 2);
            if (
              Math.abs(d.x - e.x) < this.resegmentingDistance &&
              Math.abs(d.y - e.y) < this.resegmentingDistance &&
              (og(this, g, d, e, f, !0) || og(this, g, d, e, f, !1))
            ) {
              var h = b.points.copy();
              og(this, g, d, e, f, !0)
                ? (h.Vc(c - 2, new K(g.x, (f.y + g.y) / 2)),
                  h.Vc(c + 1, new K(f.x, (f.y + g.y) / 2)))
                : (h.Vc(c - 2, new K((f.x + g.x) / 2, g.y)),
                  h.Vc(c + 1, new K((f.x + g.x) / 2, f.y)));
              h.nb(c);
              h.nb(c - 1);
              b.points = h;
              b.Tb();
            } else
              (g = b.i(c + 2)),
                Math.abs(e.x - f.x) < this.resegmentingDistance &&
                  Math.abs(e.y - f.y) < this.resegmentingDistance &&
                  (og(this, d, e, f, g, !0) || og(this, d, e, f, g, !1)) &&
                  ((h = b.points.copy()),
                  og(this, d, e, f, g, !0)
                    ? (h.Vc(c - 1, new K(d.x, (d.y + g.y) / 2)),
                      h.Vc(c + 2, new K(g.x, (d.y + g.y) / 2)))
                    : (h.Vc(c - 1, new K((d.x + g.x) / 2, d.y)),
                      h.Vc(c + 2, new K((d.x + g.x) / 2, g.y))),
                  h.nb(c + 1),
                  h.nb(c),
                  (b.points = h),
                  b.Tb());
          }
        } else
          (g = K.alloc()),
            L.Nh(d.x, d.y, f.x, f.y, e.x, e.y, g) &&
              g.Ff(e) < this.resegmentingDistance * this.resegmentingDistance &&
              ((d = b.points.copy()), d.nb(c), (b.points = d), b.Tb()),
            K.free(g);
      }
      a.Wa();
      this.transactionResult = this.name;
      a.V("LinkReshaped", this.adornedLink, this.Qr);
    }
    this.stopTool();
  };
  function og(a, b, c, d, e, f) {
    return f
      ? Math.abs(b.y - c.y) < a.resegmentingDistance &&
          Math.abs(c.y - d.y) < a.resegmentingDistance &&
          Math.abs(d.y - e.y) < a.resegmentingDistance
      : Math.abs(b.x - c.x) < a.resegmentingDistance &&
          Math.abs(c.x - d.x) < a.resegmentingDistance &&
          Math.abs(d.x - e.x) < a.resegmentingDistance;
  }
  ig.prototype.reshape = function (a) {
    var b = this.adornedLink;
    b.Qh();
    var c = this.handle.segmentIndex,
      d = this.xv(this.handle);
    if (b.isOrthogonal)
      if (c === b.firstPickIndex + 1)
        (c = b.firstPickIndex + 1),
          d === lg
            ? (b.P(c, b.i(c - 1).x, a.y), b.P(c + 1, b.i(c + 2).x, a.y))
            : d === mg &&
              (b.P(c, a.x, b.i(c - 1).y), b.P(c + 1, a.x, b.i(c + 2).y));
      else if (c === b.lastPickIndex - 1)
        (c = b.lastPickIndex - 1),
          d === lg
            ? (b.P(c - 1, b.i(c - 2).x, a.y), b.P(c, b.i(c + 1).x, a.y))
            : d === mg &&
              (b.P(c - 1, a.x, b.i(c - 2).y), b.P(c, a.x, b.i(c + 1).y));
      else {
        d = c;
        var e = b.i(d),
          f = b.i(d - 1),
          g = b.i(d + 1);
        L.C(f.x, e.x) && L.C(e.y, g.y)
          ? (L.C(f.x, b.i(d - 2).x) && !L.C(f.y, b.i(d - 2).y)
              ? (b.l(d, a.x, f.y), c++, d++)
              : b.P(d - 1, a.x, f.y),
            L.C(g.y, b.i(d + 2).y) && !L.C(g.x, b.i(d + 2).x)
              ? b.l(d + 1, g.x, a.y)
              : b.P(d + 1, g.x, a.y))
          : L.C(f.y, e.y) && L.C(e.x, g.x)
          ? (L.C(f.y, b.i(d - 2).y) && !L.C(f.x, b.i(d - 2).x)
              ? (b.l(d, f.x, a.y), c++, d++)
              : b.P(d - 1, f.x, a.y),
            L.C(g.x, b.i(d + 2).x) && !L.C(g.y, b.i(d + 2).y)
              ? b.l(d + 1, a.x, g.y)
              : b.P(d + 1, a.x, g.y))
          : L.C(f.x, e.x) && L.C(e.x, g.x)
          ? (L.C(f.x, b.i(d - 2).x) && !L.C(f.y, b.i(d - 2).y)
              ? (b.l(d, a.x, f.y), c++, d++)
              : b.P(d - 1, a.x, f.y),
            L.C(g.x, b.i(d + 2).x) && !L.C(g.y, b.i(d + 2).y)
              ? b.l(d + 1, a.x, g.y)
              : b.P(d + 1, a.x, g.y))
          : L.C(f.y, e.y) &&
            L.C(e.y, g.y) &&
            (L.C(f.y, b.i(d - 2).y) && !L.C(f.x, b.i(d - 2).x)
              ? (b.l(d, f.x, a.y), c++, d++)
              : b.P(d - 1, f.x, a.y),
            L.C(g.y, b.i(d + 2).y) && !L.C(g.x, b.i(d + 2).x)
              ? b.l(d + 1, g.x, a.y)
              : b.P(d + 1, g.x, a.y));
        b.P(c, a.x, a.y);
      }
    else
      b.P(c, a.x, a.y),
        (d = b.fromNode),
        (e = b.fromPort),
        null !== d &&
          ((f = d.findVisibleNode()),
          null !== f && f !== d && ((d = f), (e = d.port))),
        1 === c &&
          b.computeSpot(!0, e).ec() &&
          ((f = e.ka(Kc, K.alloc())),
          (d = b.getLinkPointFromPoint(d, e, f, a, !0, K.alloc())),
          b.P(0, d.x, d.y),
          K.free(f),
          K.free(d)),
        (d = b.toNode),
        (e = b.toPort),
        null !== d &&
          ((f = d.findVisibleNode()),
          null !== f && f !== d && ((d = f), (e = d.port))),
        c === b.pointsCount - 2 &&
          b.computeSpot(!1, e).ec() &&
          ((c = e.ka(Kc, K.alloc())),
          (a = b.getLinkPointFromPoint(d, e, c, a, !1, K.alloc())),
          b.P(b.pointsCount - 1, a.x, a.y),
          K.free(c),
          K.free(a));
    b.Df();
  };
  ig.prototype.computeReshape = function (a) {
    var b = this.adornedLink,
      c = this.handle.segmentIndex;
    switch (this.xv(this.handle)) {
      case ng:
        return a;
      case lg:
        return new K(b.i(c).x, a.y);
      case mg:
        return new K(a.x, b.i(c).y);
      default:
      case jg:
        return b.i(c);
    }
  };
  oa.Object.defineProperties(ig.prototype, {
    handleArchetype: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        null !== a && x(a, O, ig, "handleArchetype");
        this.o = a;
      },
    },
    midHandleArchetype: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        null !== a && x(a, O, ig, "midHandleArchetype");
        this.B = a;
      },
    },
    handle: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        if (null !== a && (x(a, O, ig, "handle"), !(a.part instanceof Je)))
          throw Error("new handle is not in an Adornment: " + a);
        this.j = a;
      },
    },
    adornedLink: {
      configurable: !0,
      get: function () {
        return this.nt;
      },
    },
    resegmentingDistance: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        A(a, "number", ig, "resegmentingDistance");
        this.M = a;
      },
    },
    originalPoint: {
      configurable: !0,
      get: function () {
        return this.ix;
      },
    },
    originalPoints: {
      configurable: !0,
      get: function () {
        return this.Qr;
      },
    },
  });
  ig.prototype.setReshapingBehavior = ig.prototype.Lm;
  ig.prototype.getReshapingBehavior = ig.prototype.xv;
  var jg = new F(ig, "None", 0),
    mg = new F(ig, "Horizontal", 1),
    lg = new F(ig, "Vertical", 2),
    ng = new F(ig, "All", 3);
  ig.className = "LinkReshapingTool";
  ig.None = jg;
  ig.Horizontal = mg;
  ig.Vertical = lg;
  ig.All = ng;
  Ta(
    "linkReshapingTool",
    function () {
      return this.findTool("LinkReshaping");
    },
    function (a) {
      this.jb("LinkReshaping", a, this.mouseDownTools);
    }
  );
  function pg() {
    0 < arguments.length && Ca(pg);
    we.call(this);
    this.name = "Resizing";
    this.fg = new Gb(1, 1).freeze();
    this.eg = new Gb(9999, 9999).freeze();
    this.Eg = new Gb(NaN, NaN).freeze();
    this.B = !1;
    this.M = !0;
    this.qe = null;
    var a = new Hf();
    a.alignmentFocus = Kc;
    a.figure = "Rectangle";
    a.desiredSize = Tb;
    a.fill = "lightblue";
    a.stroke = "dodgerblue";
    a.strokeWidth = 1;
    a.cursor = "pointer";
    this.o = a;
    this.j = null;
    this.Pr = new K();
    this.gx = new Gb();
    this.To = new K();
    this.Mt = new Gb(0, 0);
    this.Lt = new Gb(Infinity, Infinity);
    this.Kt = new Gb(1, 1);
  }
  na(pg, we);
  pg.prototype.updateAdornments = function (a) {
    if (!(null === a || a instanceof R)) {
      if (a.isSelected && !this.diagram.isReadOnly) {
        var b = a.resizeObject,
          c = a.pk(this.name);
        if (
          null !== b &&
          a.canResize() &&
          a.actualBounds.s() &&
          a.isVisible() &&
          b.actualBounds.s() &&
          b.Nf()
        ) {
          if (null === c || c.adornedObject !== b) c = this.makeAdornment(b);
          if (null !== c) {
            b = b.Ti();
            qg(a) && this.updateResizeHandles(c, b);
            a.Ch(this.name, c);
            return;
          }
        }
      }
      a.Of(this.name);
    }
  };
  pg.prototype.makeAdornment = function (a) {
    var b = a.part.resizeAdornmentTemplate;
    if (null === b) {
      b = new Je();
      b.type = W.Spot;
      b.locationSpot = Kc;
      var c = new rg();
      c.isPanelMain = !0;
      b.add(c);
      b.add(this.makeHandle(a, Fc));
      b.add(this.makeHandle(a, Ic));
      b.add(this.makeHandle(a, Pc));
      b.add(this.makeHandle(a, Mc));
      b.add(this.makeHandle(a, od));
      b.add(this.makeHandle(a, qd));
      b.add(this.makeHandle(a, rd));
      b.add(this.makeHandle(a, pd));
    } else if ((sg(b), (b = b.copy()), null === b)) return null;
    b.adornedObject = a;
    return b;
  };
  pg.prototype.makeHandle = function (a, b) {
    a = this.handleArchetype;
    if (null === a) return null;
    a = a.copy();
    a.alignment = b;
    return a;
  };
  pg.prototype.updateResizeHandles = function (a, b) {
    if (null !== a)
      if (
        !a.alignment.Nb() &&
        ("pointer" === a.cursor || 0 < a.cursor.indexOf("resize"))
      )
        a: {
          var c = a.alignment;
          c.ec() && (c = Kc);
          if (0 >= c.x) b = 0 >= c.y ? b + 225 : 1 <= c.y ? b + 135 : b + 180;
          else if (1 <= c.x) 0 >= c.y ? (b += 315) : 1 <= c.y && (b += 45);
          else if (0 >= c.y) b += 270;
          else if (1 <= c.y) b += 90;
          else break a;
          0 > b ? (b += 360) : 360 <= b && (b -= 360);
          a.cursor =
            22.5 > b
              ? "e-resize"
              : 67.5 > b
              ? "se-resize"
              : 112.5 > b
              ? "s-resize"
              : 157.5 > b
              ? "sw-resize"
              : 202.5 > b
              ? "w-resize"
              : 247.5 > b
              ? "nw-resize"
              : 292.5 > b
              ? "n-resize"
              : 337.5 > b
              ? "ne-resize"
              : "e-resize";
        }
      else if (a instanceof W)
        for (a = a.elements; a.next(); ) this.updateResizeHandles(a.value, b);
  };
  pg.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    return !a.isReadOnly && a.allowResize && a.lastInput.left
      ? null !== this.findToolHandleAt(a.firstInput.documentPoint, this.name)
      : !1;
  };
  pg.prototype.doActivate = function () {
    var a = this.diagram;
    null === this.handle &&
      (this.handle = this.findToolHandleAt(
        a.firstInput.documentPoint,
        this.name
      ));
    null !== this.handle &&
      ((this.adornedObject = this.handle.part.adornedObject),
      null !== this.adornedObject &&
        ((a.isMouseCaptured = !0),
        a.animationManager.wc(),
        this.Fa(this.name),
        this.Pr.set(this.adornedObject.ka(this.handle.alignment.Jv())),
        this.To.set(this.adornedObject.part.location),
        this.gx.set(this.adornedObject.desiredSize),
        (this.Kt = this.computeCellSize()),
        (this.Mt = this.computeMinSize()),
        (this.Lt = this.computeMaxSize()),
        (this.isActive = !0)));
  };
  pg.prototype.doDeactivate = function () {
    var a = this.diagram;
    this.stopTransaction();
    this.qe = this.handle = null;
    this.isActive = a.isMouseCaptured = !1;
  };
  pg.prototype.stopTransaction = function () {
    var a = this.diagram,
      b = we.prototype.stopTransaction.call(this);
    b &&
      null !== a.undoManager.transactionToUndo &&
      a.undoManager.transactionToUndo.Ck();
    return b;
  };
  pg.prototype.doCancel = function () {
    null !== this.adornedObject &&
      ((this.adornedObject.desiredSize = this.originalDesiredSize),
      (this.adornedObject.part.location = this.originalLocation));
    this.stopTool();
  };
  pg.prototype.doMouseMove = function () {
    var a = this.diagram;
    if (this.isActive) {
      var b = this.Mt,
        c = this.Lt,
        d = this.Kt,
        e = this.adornedObject.Hs(a.lastInput.documentPoint, K.alloc()),
        f = this.computeReshape();
      b = this.computeResize(e, this.handle.alignment, b, c, d, f);
      this.resize(b);
      a.pd();
      K.free(e);
    }
  };
  pg.prototype.doMouseUp = function () {
    var a = this.diagram;
    if (this.isActive) {
      var b = this.Mt,
        c = this.Lt,
        d = this.Kt,
        e = this.adornedObject.Hs(a.lastInput.documentPoint, K.alloc()),
        f = this.computeReshape();
      b = this.computeResize(e, this.handle.alignment, b, c, d, f);
      this.resize(b);
      K.free(e);
      a.Wa();
      this.transactionResult = this.name;
      a.V("PartResized", this.adornedObject, this.originalDesiredSize);
    }
    this.stopTool();
  };
  pg.prototype.resize = function (a) {
    var b = this.diagram,
      c = this.adornedObject;
    if (null !== c) {
      c.desiredSize = a.size;
      a = c.part;
      a.Za();
      c = c.ka(this.handle.alignment.Jv());
      if (a instanceof vf) {
        var d = new H();
        d.add(a);
        if (!this.dragsMembers && null === a.placeholder) {
          var e = new Re();
          e.dragsMembers = !1;
        }
        b.moveParts(d, this.oppositePoint.copy().ne(c), !0, e);
      } else a.location = a.location.copy().ne(c).add(this.oppositePoint);
      b.pd();
    }
  };
  pg.prototype.computeResize = function (a, b, c, d, e, f) {
    b.ec() && (b = Kc);
    var g = this.adornedObject.naturalBounds,
      h = g.x,
      k = g.y,
      l = g.x + g.width,
      m = g.y + g.height,
      n = 1;
    if (!f) {
      n = g.width;
      var p = g.height;
      0 >= n && (n = 1);
      0 >= p && (p = 1);
      n = p / n;
    }
    p = K.alloc();
    L.gq(a.x, a.y, h, k, e.width, e.height, p);
    a = g.copy();
    0 >= b.x
      ? 0 >= b.y
        ? ((a.x = Math.max(p.x, l - d.width)),
          (a.x = Math.min(a.x, l - c.width)),
          (a.width = Math.max(l - a.x, c.width)),
          (a.y = Math.max(p.y, m - d.height)),
          (a.y = Math.min(a.y, m - c.height)),
          (a.height = Math.max(m - a.y, c.height)),
          f ||
            (1 <= a.height / a.width
              ? ((a.height = Math.max(
                  Math.min(n * a.width, d.height),
                  c.height
                )),
                (a.width = a.height / n))
              : ((a.width = Math.max(Math.min(a.height / n, d.width), c.width)),
                (a.height = n * a.width)),
            (a.x = l - a.width),
            (a.y = m - a.height)))
        : 1 <= b.y
        ? ((a.x = Math.max(p.x, l - d.width)),
          (a.x = Math.min(a.x, l - c.width)),
          (a.width = Math.max(l - a.x, c.width)),
          (a.height = Math.max(Math.min(p.y - k, d.height), c.height)),
          f ||
            (1 <= a.height / a.width
              ? ((a.height = Math.max(
                  Math.min(n * a.width, d.height),
                  c.height
                )),
                (a.width = a.height / n))
              : ((a.width = Math.max(Math.min(a.height / n, d.width), c.width)),
                (a.height = n * a.width)),
            (a.x = l - a.width)))
        : ((a.x = Math.max(p.x, l - d.width)),
          (a.x = Math.min(a.x, l - c.width)),
          (a.width = l - a.x),
          f ||
            ((a.height = Math.max(Math.min(n * a.width, d.height), c.height)),
            (a.width = a.height / n),
            (a.y = k + 0.5 * (m - k - a.height))))
      : 1 <= b.x
      ? 0 >= b.y
        ? ((a.width = Math.max(Math.min(p.x - h, d.width), c.width)),
          (a.y = Math.max(p.y, m - d.height)),
          (a.y = Math.min(a.y, m - c.height)),
          (a.height = Math.max(m - a.y, c.height)),
          f ||
            (1 <= a.height / a.width
              ? ((a.height = Math.max(
                  Math.min(n * a.width, d.height),
                  c.height
                )),
                (a.width = a.height / n))
              : ((a.width = Math.max(Math.min(a.height / n, d.width), c.width)),
                (a.height = n * a.width)),
            (a.y = m - a.height)))
        : 1 <= b.y
        ? ((a.width = Math.max(Math.min(p.x - h, d.width), c.width)),
          (a.height = Math.max(Math.min(p.y - k, d.height), c.height)),
          f ||
            (1 <= a.height / a.width
              ? ((a.height = Math.max(
                  Math.min(n * a.width, d.height),
                  c.height
                )),
                (a.width = a.height / n))
              : ((a.width = Math.max(Math.min(a.height / n, d.width), c.width)),
                (a.height = n * a.width))))
        : ((a.width = Math.max(Math.min(p.x - h, d.width), c.width)),
          f ||
            ((a.height = Math.max(Math.min(n * a.width, d.height), c.height)),
            (a.width = a.height / n),
            (a.y = k + 0.5 * (m - k - a.height))))
      : 0 >= b.y
      ? ((a.y = Math.max(p.y, m - d.height)),
        (a.y = Math.min(a.y, m - c.height)),
        (a.height = m - a.y),
        f ||
          ((a.width = Math.max(Math.min(a.height / n, d.width), c.width)),
          (a.height = n * a.width),
          (a.x = h + 0.5 * (l - h - a.width))))
      : 1 <= b.y &&
        ((a.height = Math.max(Math.min(p.y - k, d.height), c.height)),
        f ||
          ((a.width = Math.max(Math.min(a.height / n, d.width), c.width)),
          (a.height = n * a.width),
          (a.x = h + 0.5 * (l - h - a.width))));
    K.free(p);
    return a;
  };
  pg.prototype.computeReshape = function () {
    var a = tg;
    this.adornedObject instanceof Hf && (a = ug(this.adornedObject));
    return !(a === vg || this.diagram.lastInput.shift);
  };
  pg.prototype.computeMinSize = function () {
    var a = this.adornedObject.minSize.copy(),
      b = this.minSize;
    !isNaN(b.width) && b.width > a.width && (a.width = b.width);
    !isNaN(b.height) && b.height > a.height && (a.height = b.height);
    return a;
  };
  pg.prototype.computeMaxSize = function () {
    var a = this.adornedObject.maxSize.copy(),
      b = this.maxSize;
    !isNaN(b.width) && b.width < a.width && (a.width = b.width);
    !isNaN(b.height) && b.height < a.height && (a.height = b.height);
    return a;
  };
  pg.prototype.computeCellSize = function () {
    var a = new Gb(NaN, NaN),
      b = this.adornedObject.part;
    null !== b &&
      ((b = b.resizeCellSize),
      !isNaN(b.width) && 0 < b.width && (a.width = b.width),
      !isNaN(b.height) && 0 < b.height && (a.height = b.height));
    b = this.cellSize;
    isNaN(a.width) && !isNaN(b.width) && 0 < b.width && (a.width = b.width);
    isNaN(a.height) &&
      !isNaN(b.height) &&
      0 < b.height &&
      (a.height = b.height);
    b = this.diagram;
    (isNaN(a.width) || isNaN(a.height)) &&
      b &&
      ((b = b.grid),
      null !== b &&
        b.visible &&
        this.isGridSnapEnabled &&
        ((b = b.gridCellSize),
        isNaN(a.width) && !isNaN(b.width) && 0 < b.width && (a.width = b.width),
        isNaN(a.height) &&
          !isNaN(b.height) &&
          0 < b.height &&
          (a.height = b.height)));
    if (isNaN(a.width) || 0 === a.width || Infinity === a.width) a.width = 1;
    if (isNaN(a.height) || 0 === a.height || Infinity === a.height)
      a.height = 1;
    return a;
  };
  oa.Object.defineProperties(pg.prototype, {
    handleArchetype: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        null !== a && x(a, O, pg, "handleArchetype");
        this.o = a;
      },
    },
    handle: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        if (null !== a && (x(a, O, pg, "handle"), !(a.part instanceof Je)))
          throw Error("new handle is not in an Adornment: " + a);
        this.j = a;
      },
    },
    adornedObject: {
      configurable: !0,
      get: function () {
        return this.qe;
      },
      set: function (a) {
        if (null !== a && (x(a, O, pg, "handle"), a.part instanceof Je))
          throw Error("new handle must not be in an Adornment: " + a);
        this.qe = a;
      },
    },
    minSize: {
      configurable: !0,
      get: function () {
        return this.fg;
      },
      set: function (a) {
        x(a, Gb, pg, "minSize");
        if (!this.fg.D(a)) {
          var b = a.width;
          isNaN(b) && (b = 0);
          a = a.height;
          isNaN(a) && (a = 0);
          this.fg.h(b, a);
        }
      },
    },
    maxSize: {
      configurable: !0,
      get: function () {
        return this.eg;
      },
      set: function (a) {
        x(a, Gb, pg, "maxSize");
        if (!this.eg.D(a)) {
          var b = a.width;
          isNaN(b) && (b = Infinity);
          a = a.height;
          isNaN(a) && (a = Infinity);
          this.eg.h(b, a);
        }
      },
    },
    cellSize: {
      configurable: !0,
      get: function () {
        return this.Eg;
      },
      set: function (a) {
        x(a, Gb, pg, "cellSize");
        this.Eg.D(a) || this.Eg.assign(a);
      },
    },
    isGridSnapEnabled: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        A(a, "boolean", pg, "isGridSnapEnabled");
        this.B = a;
      },
    },
    dragsMembers: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        A(a, "boolean", pg, "dragsMembers");
        this.M = a;
      },
    },
    oppositePoint: {
      configurable: !0,
      get: function () {
        return this.Pr;
      },
      set: function (a) {
        x(a, K, pg, "oppositePoint");
        this.Pr.D(a) || this.Pr.assign(a);
      },
    },
    originalDesiredSize: {
      configurable: !0,
      get: function () {
        return this.gx;
      },
    },
    originalLocation: {
      configurable: !0,
      get: function () {
        return this.To;
      },
    },
  });
  pg.className = "ResizingTool";
  Ta(
    "resizingTool",
    function () {
      return this.findTool("Resizing");
    },
    function (a) {
      this.jb("Resizing", a, this.mouseDownTools);
    }
  );
  function wg() {
    0 < arguments.length && Ca(wg);
    we.call(this);
    this.name = "Rotating";
    this.Na = 45;
    this.Ba = 2;
    this.To = new K();
    this.qe = null;
    var a = new Hf();
    a.figure = "Ellipse";
    a.desiredSize = Xb;
    a.fill = "lightblue";
    a.stroke = "dodgerblue";
    a.strokeWidth = 1;
    a.cursor = "pointer";
    this.o = a;
    this.j = null;
    this.ex = 0;
    this.Vr = new K(NaN, NaN);
    this.B = 0;
    this.M = 50;
  }
  na(wg, we);
  wg.prototype.updateAdornments = function (a) {
    if (null !== a) {
      if (a.Mh()) {
        var b = a.rotateObject;
        if (b === a || b === a.path || b.isPanelMain) return;
      }
      if (
        a.isSelected &&
        !this.diagram.isReadOnly &&
        ((b = a.rotateObject),
        null !== b &&
          a.canRotate() &&
          a.actualBounds.s() &&
          a.isVisible() &&
          b.actualBounds.s() &&
          b.Nf())
      ) {
        var c = a.pk(this.name);
        if (null === c || c.adornedObject !== b) c = this.makeAdornment(b);
        if (null !== c) {
          c.angle = b.Ti();
          null === c.placeholder &&
            (c.location = this.computeAdornmentLocation(b));
          a.Ch(this.name, c);
          return;
        }
      }
      a.Of(this.name);
    }
  };
  wg.prototype.makeAdornment = function (a) {
    var b = a.part.rotateAdornmentTemplate;
    if (null === b) {
      b = new Je();
      b.type = W.Position;
      b.locationSpot = Kc;
      var c = this.handleArchetype;
      null !== c && b.add(c.copy());
    } else if ((sg(b), (b = b.copy()), null === b)) return null;
    b.adornedObject = a;
    return b;
  };
  wg.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    return !a.isReadOnly && a.allowRotate && a.lastInput.left
      ? null !== this.findToolHandleAt(a.firstInput.documentPoint, this.name)
      : !1;
  };
  wg.prototype.doActivate = function () {
    var a = this.diagram;
    if (null === this.adornedObject) {
      null === this.handle &&
        (this.handle = this.findToolHandleAt(
          a.firstInput.documentPoint,
          this.name
        ));
      if (null === this.handle) return;
      this.adornedObject = this.handle.part.adornedObject;
    }
    null !== this.adornedObject &&
      ((a.isMouseCaptured = !0),
      (a.delaysLayout = !0),
      this.Fa(this.name),
      (this.ex = this.adornedObject.angle),
      (this.Vr = this.computeRotationPoint(this.adornedObject)),
      (this.To = this.adornedObject.part.location.copy()),
      (this.isActive = !0));
  };
  wg.prototype.computeRotationPoint = function (a) {
    var b = a.part,
      c = b.locationObject;
    return b.rotationSpot.ib()
      ? a.ka(b.rotationSpot)
      : a === b || a === c
      ? c.ka(b.locationSpot)
      : a.ka(Kc);
  };
  wg.prototype.computeAdornmentLocation = function (a) {
    var b = this.rotationPoint;
    b.s() || (b = this.computeRotationPoint(a));
    b = a.Hs(b);
    var c = this.handleAngle;
    0 > c ? (c += 360) : 360 <= c && (c -= 360);
    c = Math.round(45 * Math.round(c / 45));
    var d = this.handleDistance;
    0 === c
      ? (b.x = a.naturalBounds.width + d)
      : 45 === c
      ? ((b.x = a.naturalBounds.width + d), (b.y = a.naturalBounds.height + d))
      : 90 === c
      ? (b.y = a.naturalBounds.height + d)
      : 135 === c
      ? ((b.x = -d), (b.y = a.naturalBounds.height + d))
      : 180 === c
      ? (b.x = -d)
      : 225 === c
      ? ((b.x = -d), (b.y = -d))
      : 270 === c
      ? (b.y = -d)
      : 315 === c && ((b.x = a.naturalBounds.width + d), (b.y = -d));
    return a.ka(b);
  };
  wg.prototype.doDeactivate = function () {
    var a = this.diagram;
    this.stopTransaction();
    this.qe = this.handle = null;
    this.Vr = new K(NaN, NaN);
    this.isActive = a.isMouseCaptured = !1;
  };
  wg.prototype.stopTransaction = function () {
    var a = this.diagram,
      b = we.prototype.stopTransaction.call(this);
    b &&
      null !== a.undoManager.transactionToUndo &&
      a.undoManager.transactionToUndo.Ck();
    return b;
  };
  wg.prototype.doCancel = function () {
    this.diagram.delaysLayout = !1;
    this.rotate(this.originalAngle);
    this.stopTool();
  };
  wg.prototype.doMouseMove = function () {
    var a = this.diagram;
    this.isActive &&
      ((a = this.computeRotate(a.lastInput.documentPoint)), this.rotate(a));
  };
  wg.prototype.doMouseUp = function () {
    var a = this.diagram;
    if (this.isActive) {
      a.delaysLayout = !1;
      var b = this.computeRotate(a.lastInput.documentPoint);
      this.rotate(b);
      a.Wa();
      this.transactionResult = this.name;
      a.V("PartRotated", this.adornedObject, this.originalAngle);
    }
    this.stopTool();
  };
  wg.prototype.rotate = function (a) {
    G && D(a, wg, "rotate:newangle");
    var b = this.adornedObject;
    if (null !== b) {
      b.angle = a;
      b = b.part;
      b.Za();
      var c = b.locationObject,
        d = b.rotateObject;
      if (c === d || c.xg(d))
        (c = this.To.copy()),
          (b.location = c
            .ne(this.rotationPoint)
            .rotate(a - this.originalAngle)
            .add(this.rotationPoint));
      this.diagram.pd();
    }
  };
  wg.prototype.computeRotate = function (a) {
    a = this.rotationPoint.Ya(a) - this.handleAngle;
    var b = this.adornedObject.panel;
    null !== b && (a -= b.Ti());
    360 <= a ? (a -= 360) : 0 > a && (a += 360);
    b = Math.min(Math.abs(this.snapAngleMultiple), 180);
    var c = Math.min(Math.abs(this.snapAngleEpsilon), b / 2);
    !this.diagram.lastInput.shift &&
      0 < b &&
      0 < c &&
      (a % b < c
        ? (a = Math.floor(a / b) * b)
        : a % b > b - c && (a = (Math.floor(a / b) + 1) * b));
    360 <= a ? (a -= 360) : 0 > a && (a += 360);
    return a;
  };
  oa.Object.defineProperties(wg.prototype, {
    handleArchetype: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        null !== a && x(a, O, wg, "handleArchetype");
        this.o = a;
      },
    },
    handle: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        if (null !== a && (x(a, O, wg, "handle"), !(a.part instanceof Je)))
          throw Error("new handle is not in an Adornment: " + a);
        this.j = a;
      },
    },
    adornedObject: {
      configurable: !0,
      get: function () {
        return this.qe;
      },
      set: function (a) {
        if (null !== a && (x(a, O, wg, "handle"), a.part instanceof Je))
          throw Error("new handle must not be in an Adornment: " + a);
        this.qe = a;
      },
    },
    snapAngleMultiple: {
      configurable: !0,
      get: function () {
        return this.Na;
      },
      set: function (a) {
        A(a, "number", wg, "snapAngleMultiple");
        this.Na = a;
      },
    },
    snapAngleEpsilon: {
      configurable: !0,
      get: function () {
        return this.Ba;
      },
      set: function (a) {
        A(a, "number", wg, "snapAngleEpsilon");
        this.Ba = a;
      },
    },
    originalAngle: {
      configurable: !0,
      get: function () {
        return this.ex;
      },
    },
    rotationPoint: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Vr;
      },
      set: function (a) {
        this.Vr = a.copy();
      },
    },
    handleAngle: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        A(a, "number", wg, "handleAngle");
        this.B = a;
      },
    },
    handleDistance: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        A(a, "number", wg, "handleDistance");
        this.M = a;
      },
    },
  });
  wg.className = "RotatingTool";
  Ta(
    "rotatingTool",
    function () {
      return this.findTool("Rotating");
    },
    function (a) {
      this.jb("Rotating", a, this.mouseDownTools);
    }
  );
  function xg() {
    we.call(this);
    0 < arguments.length && Ca(xg);
    this.name = "ClickSelecting";
  }
  na(xg, we);
  xg.prototype.canStart = function () {
    return !this.isEnabled || this.isBeyondDragSize() ? !1 : !0;
  };
  xg.prototype.doMouseUp = function () {
    this.isActive &&
      (this.standardMouseSelect(),
      !this.standardMouseClick() &&
        this.diagram.lastInput.isTouchEvent &&
        this.diagram.toolManager.doToolTip());
    this.stopTool();
  };
  xg.className = "ClickSelectingTool";
  function yg() {
    we.call(this);
    0 < arguments.length && Ca(yg);
    this.name = "Action";
    this.Lk = null;
  }
  na(yg, we);
  yg.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram,
      b = a.lastInput,
      c = a.dc(b.documentPoint, function (a) {
        for (; null !== a.panel && !a.isActionable; ) a = a.panel;
        return a;
      });
    if (null !== c) {
      if (!c.isActionable) return !1;
      this.Lk = c;
      a.al = a.dc(b.documentPoint, null, null);
      return !0;
    }
    return !1;
  };
  yg.prototype.doMouseDown = function () {
    if (this.isActive) {
      var a = this.diagram.lastInput,
        b = this.Lk;
      null !== b &&
        ((a.targetObject = b), null !== b.actionDown && b.actionDown(a, b));
    } else this.canStart() && this.doActivate();
  };
  yg.prototype.doMouseMove = function () {
    if (this.isActive) {
      var a = this.diagram.lastInput,
        b = this.Lk;
      null !== b &&
        ((a.targetObject = b), null !== b.actionMove && b.actionMove(a, b));
    }
  };
  yg.prototype.doMouseUp = function () {
    if (this.isActive) {
      var a = this.diagram.lastInput,
        b = this.Lk;
      if (null === b) return;
      a.targetObject = b;
      null !== b.actionUp && b.actionUp(a, b);
      this.standardMouseClick(
        function (a) {
          for (; null !== a.panel && (!a.isActionable || a !== b); )
            a = a.panel;
          return a;
        },
        function (a) {
          return a === b;
        }
      );
    }
    this.stopTool();
  };
  yg.prototype.doCancel = function () {
    var a = this.diagram.lastInput,
      b = this.Lk;
    null !== b &&
      ((a.targetObject = b),
      null !== b.actionCancel && b.actionCancel(a, b),
      this.stopTool());
  };
  yg.prototype.doStop = function () {
    this.Lk = null;
  };
  yg.className = "ActionTool";
  function zg() {
    we.call(this);
    0 < arguments.length && Ca(zg);
    this.name = "ClickCreating";
    this.vj = null;
    this.o = !0;
    this.j = !1;
    this.Nw = new K(0, 0);
  }
  na(zg, we);
  zg.prototype.canStart = function () {
    if (!this.isEnabled || null === this.archetypeNodeData) return !1;
    var a = this.diagram;
    if (
      a.isReadOnly ||
      a.isModelReadOnly ||
      !a.allowInsert ||
      !a.lastInput.left ||
      this.isBeyondDragSize()
    )
      return !1;
    if (this.isDoubleClick) {
      if (
        (1 === a.lastInput.clickCount &&
          (this.Nw = a.lastInput.viewPoint.copy()),
        2 !== a.lastInput.clickCount || this.isBeyondDragSize(this.Nw))
      )
        return !1;
    } else if (1 !== a.lastInput.clickCount) return !1;
    return a.currentTool !== this &&
      null !== a.lm(a.lastInput.documentPoint, !0)
      ? !1
      : !0;
  };
  zg.prototype.doMouseUp = function () {
    var a = this.diagram;
    this.isActive && this.insertPart(a.lastInput.documentPoint);
    this.stopTool();
  };
  zg.prototype.insertPart = function (a) {
    var b = this.diagram,
      c = this.archetypeNodeData;
    if (null === c) return null;
    var d = null;
    try {
      b.V("ChangingSelection", b.selection);
      this.Fa(this.name);
      if (c instanceof U)
        c.Tc() && (sg(c), (d = c.copy()), null !== d && b.add(d));
      else if (null !== c) {
        var e = b.model.copyNodeData(c);
        Ga(e) && (b.model.Af(e), (d = b.Fc(e)));
      }
      if (null !== d) {
        var f = K.allocAt(a.x, a.y);
        this.isGridSnapEnabled && Ag(this.diagram, d, a, f);
        d.location = f;
        b.allowSelect && (b.clearSelection(!0), (d.isSelected = !0));
        K.free(f);
      }
      b.Wa();
      this.transactionResult = this.name;
      b.V("PartCreated", d);
    } finally {
      this.stopTransaction(), b.V("ChangedSelection", b.selection);
    }
    return d;
  };
  oa.Object.defineProperties(zg.prototype, {
    archetypeNodeData: {
      configurable: !0,
      get: function () {
        return this.vj;
      },
      set: function (a) {
        null !== a && A(a, "object", zg, "archetypeNodeData");
        this.vj = a;
      },
    },
    isDoubleClick: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        A(a, "boolean", zg, "isDoubleClick");
        this.o = a;
      },
    },
    isGridSnapEnabled: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        A(a, "boolean", zg, "isGridSnapEnabled");
        this.j = a;
      },
    },
  });
  zg.className = "ClickCreatingTool";
  function Jg() {
    we.call(this);
    0 < arguments.length && Ca(Jg);
    this.name = "DragSelecting";
    this.gl = 175;
    this.o = !1;
    var a = new U();
    a.layerName = "Tool";
    a.selectable = !1;
    var b = new Hf();
    b.name = "SHAPE";
    b.figure = "Rectangle";
    b.fill = null;
    b.stroke = "magenta";
    a.add(b);
    this.j = a;
  }
  na(Jg, we);
  Jg.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    if (!a.allowSelect) return !1;
    var b = a.lastInput;
    return !b.left ||
      (a.currentTool !== this &&
        (!this.isBeyondDragSize() ||
          b.timestamp - a.firstInput.timestamp < this.delay ||
          null !== a.lm(b.documentPoint, !0)))
      ? !1
      : !0;
  };
  Jg.prototype.doActivate = function () {
    var a = this.diagram;
    this.isActive = !0;
    a.isMouseCaptured = !0;
    a.skipsUndoManager = !0;
    a.add(this.box);
    this.doMouseMove();
  };
  Jg.prototype.doDeactivate = function () {
    var a = this.diagram;
    a.zg();
    a.remove(this.box);
    a.skipsUndoManager = !1;
    this.isActive = a.isMouseCaptured = !1;
  };
  Jg.prototype.doMouseMove = function () {
    var a = this.diagram;
    if (this.isActive && null !== this.box) {
      var b = this.computeBoxBounds(),
        c = this.box.hb("SHAPE");
      null === c && (c = this.box.vb());
      var d = Gb.alloc().h(b.width, b.height);
      c.desiredSize = d;
      this.box.Jm(b.x, b.y, !1);
      Gb.free(d);
      (a.allowHorizontalScroll || a.allowVerticalScroll) &&
        a.zs(a.lastInput.viewPoint);
    }
  };
  Jg.prototype.doMouseUp = function () {
    if (this.isActive) {
      var a = this.diagram;
      a.remove(this.box);
      try {
        (a.currentCursor = "wait"),
          a.V("ChangingSelection", a.selection),
          this.selectInRect(this.computeBoxBounds()),
          a.V("ChangedSelection", a.selection);
      } finally {
        a.currentCursor = "";
      }
    }
    this.stopTool();
  };
  Jg.prototype.computeBoxBounds = function () {
    var a = this.diagram;
    return new M(a.firstInput.documentPoint, a.lastInput.documentPoint);
  };
  Jg.prototype.selectInRect = function (a) {
    var b = this.diagram,
      c = b.lastInput;
    a = b.Wx(a, this.isPartialInclusion);
    if ($a ? c.meta : c.control)
      if (c.shift)
        for (a = a.iterator; a.next(); )
          (b = a.value), b.isSelected && (b.isSelected = !1);
      else
        for (a = a.iterator; a.next(); )
          (b = a.value), (b.isSelected = !b.isSelected);
    else if (c.shift)
      for (a = a.iterator; a.next(); )
        (b = a.value), b.isSelected || (b.isSelected = !0);
    else {
      c = new H();
      for (b = b.selection.iterator; b.next(); ) {
        var d = b.value;
        a.contains(d) || c.add(d);
      }
      for (b = c.iterator; b.next(); ) b.value.isSelected = !1;
      for (a = a.iterator; a.next(); )
        (b = a.value), b.isSelected || (b.isSelected = !0);
    }
  };
  oa.Object.defineProperties(Jg.prototype, {
    delay: {
      configurable: !0,
      get: function () {
        return this.gl;
      },
      set: function (a) {
        A(a, "number", Jg, "delay");
        this.gl = a;
      },
    },
    isPartialInclusion: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        A(a, "boolean", Jg, "isPartialInclusion");
        this.o = a;
      },
    },
    box: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        null !== a && x(a, U, Jg, "box");
        this.j = a;
      },
    },
  });
  Jg.className = "DragSelectingTool";
  function Kg() {
    we.call(this);
    0 < arguments.length && Ca(Kg);
    this.name = "Panning";
    this.uu = new K();
    this.dz = new K();
    this.Dg = !1;
    var a = this;
    this.nx = function () {
      var b = a.diagram;
      null !== b && b.removeEventListener(sa.document, "scroll", a.nx, !1);
      a.stopTool();
    };
  }
  na(Kg, we);
  Kg.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    return (!a.allowHorizontalScroll && !a.allowVerticalScroll) ||
      !a.lastInput.left ||
      (a.currentTool !== this && !this.isBeyondDragSize())
      ? !1
      : !0;
  };
  Kg.prototype.doActivate = function () {
    var a = this.diagram;
    this.Dg
      ? ((a.lastInput.bubbles = !0),
        a.addEventListener(sa.document, "scroll", this.nx, !1))
      : ((a.currentCursor = "move"),
        (a.isMouseCaptured = !0),
        this.uu.assign(a.position));
    this.isActive = !0;
  };
  Kg.prototype.doDeactivate = function () {
    var a = this.diagram;
    a.currentCursor = "";
    this.isActive = a.isMouseCaptured = !1;
  };
  Kg.prototype.doCancel = function () {
    var a = this.diagram;
    a.position = this.uu;
    a.isMouseCaptured = !1;
    this.stopTool();
  };
  Kg.prototype.doMouseMove = function () {
    this.move();
  };
  Kg.prototype.doMouseUp = function () {
    this.move();
    this.stopTool();
  };
  Kg.prototype.move = function () {
    var a = this.diagram;
    if (this.isActive && a)
      if (this.Dg) a.lastInput.bubbles = !0;
      else {
        var b = a.position,
          c = a.firstInput.documentPoint,
          d = a.lastInput.documentPoint,
          e = b.x + c.x - d.x;
        c = b.y + c.y - d.y;
        a.allowHorizontalScroll || (e = b.x);
        a.allowVerticalScroll || (c = b.y);
        a.position = this.dz.h(e, c);
      }
  };
  oa.Object.defineProperties(Kg.prototype, {
    bubbles: {
      configurable: !0,
      get: function () {
        return this.Dg;
      },
      set: function (a) {
        A(a, "boolean", Kg, "bubbles");
        this.Dg = a;
      },
    },
    originalPosition: {
      configurable: !0,
      get: function () {
        return this.uu;
      },
    },
  });
  Kg.className = "PanningTool";
  Ta(
    "clickCreatingTool",
    function () {
      return this.findTool("ClickCreating");
    },
    function (a) {
      this.jb("ClickCreating", a, this.mouseUpTools);
    }
  );
  Ta(
    "clickSelectingTool",
    function () {
      return this.findTool("ClickSelecting");
    },
    function (a) {
      this.jb("ClickSelecting", a, this.mouseUpTools);
    }
  );
  Ta(
    "panningTool",
    function () {
      return this.findTool("Panning");
    },
    function (a) {
      this.jb("Panning", a, this.mouseMoveTools);
    }
  );
  Ta(
    "dragSelectingTool",
    function () {
      return this.findTool("DragSelecting");
    },
    function (a) {
      this.jb("DragSelecting", a, this.mouseMoveTools);
    }
  );
  Ta(
    "actionTool",
    function () {
      return this.findTool("Action");
    },
    function (a) {
      this.jb("Action", a, this.mouseDownTools);
    }
  );
  function Oe() {
    this.M = this.B = this.j = this.o = null;
  }
  oa.Object.defineProperties(Oe.prototype, {
    mainElement: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        null !== a && x(a, HTMLElement, Oe, "mainElement");
        this.B = a;
      },
    },
    show: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        this.o !== a &&
          (null !== a && A(a, "function", Oe, "show"), (this.o = a));
      },
    },
    hide: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.j !== a &&
          (null !== a && A(a, "function", Oe, "hide"), (this.j = a));
      },
    },
    valueFunction: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        this.M = a;
      },
    },
  });
  Oe.className = "HTMLInfo";
  function Lg(a, b, c) {
    this.text = a;
    this.Jx = b;
    this.visible = c;
  }
  Lg.className = "ContextMenuButtonInfo";
  function Mg() {
    we.call(this);
    0 < arguments.length && Ca(Mg);
    this.name = "ContextMenu";
    this.o = this.Bt = this.j = null;
    this.Zw = new K();
    this.Dt = null;
    this.Zt = !1;
    var a = this;
    this.Ru = function () {
      a.stopTool();
    };
  }
  na(Mg, we);
  function Ng(a) {
    var b = new Oe();
    b.show = function (a, b, c) {
      c.showDefaultContextMenu();
    };
    b.hide = function (a, b) {
      b.hideDefaultContextMenu();
    };
    Og = b;
    a.Ru = function () {
      a.stopTool();
    };
    b = wa("div");
    var c = wa("div");
    b.style.cssText =
      "top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px";
    c.style.cssText =
      "z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;";
    var d = wa("style");
    sa.document.getElementsByTagName("head")[0].appendChild(d);
    d.sheet.insertRule(".goCXul { list-style: none; }", 0);
    d.sheet.insertRule(
      ".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",
      0
    );
    d.sheet.insertRule(
      ".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",
      0
    );
    d = a.diagram;
    null !== d &&
      (d.addEventListener(b, "contextmenu", Pg, !1),
      d.addEventListener(b, "selectstart", Pg, !1),
      d.addEventListener(c, "contextmenu", Pg, !1));
    b.className = "goCXforeground";
    c.className = "goCXbackground";
    sa.document.body &&
      (sa.document.body.appendChild(b), sa.document.body.appendChild(c));
    Qg = b;
    Rg = c;
    Sg = !0;
  }
  function Pg(a) {
    a.preventDefault();
    return !1;
  }
  Mg.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    return this.isBeyondDragSize() ||
      !a.lastInput.right ||
      1 < a.lastInput.clickCount
      ? !1
      : (a.lastInput.isTouchEvent && null !== this.defaultTouchContextMenu) ||
        null !== this.findObjectWithContextMenu()
      ? !0
      : !1;
  };
  Mg.prototype.doStart = function () {
    this.Zw.set(this.diagram.firstInput.documentPoint);
  };
  Mg.prototype.doStop = function () {
    this.hideContextMenu();
    this.currentObject = null;
  };
  Mg.prototype.findObjectWithContextMenu = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram,
      c = b.lastInput,
      d = null;
    a instanceof Q ||
      (a instanceof O
        ? (d = a)
        : (d = b.dc(c.documentPoint, null, function (a) {
            return !a.layer.isTemporary;
          })));
    if (null !== d) {
      for (a = d; null !== a; ) {
        if (null !== a.contextMenu) return a;
        a = a.panel;
      }
      if (b.lastInput.isTouchEvent && this.defaultTouchContextMenu)
        return d.part;
    } else if (null !== b.contextMenu) return b;
    return null;
  };
  Mg.prototype.doActivate = function () {};
  Mg.prototype.doMouseDown = function () {
    we.prototype.doMouseDown.call(this);
    if (this.isActive && this.currentContextMenu instanceof Je) {
      var a = this.diagram.toolManager.findTool("Action");
      null !== a &&
        a.canStart() &&
        (a.doActivate(), a.doMouseDown(), a.doDeactivate());
    }
    this.diagram.toolManager.mouseDownTools.contains(this) && Tg(this);
  };
  Mg.prototype.doMouseUp = function () {
    if (this.isActive && this.currentContextMenu instanceof Je) {
      var a = this.diagram.toolManager.findTool("Action");
      null !== a &&
        a.canStart() &&
        (a.doActivate(), a.doCancel(), a.doDeactivate());
    }
    Tg(this);
  };
  function Tg(a) {
    var b = a.diagram;
    if (a.isActive) {
      var c = a.currentContextMenu;
      if (null !== c) {
        if (!(c instanceof Oe)) {
          var d = b.dc(b.lastInput.documentPoint, null, null);
          null !== d && d.xg(c) && a.standardMouseClick(null, null);
        }
        a.stopTool();
        a.canStart() && ((b.currentTool = a), a.doMouseUp());
      }
    } else a.canStart() && (Ug(a, !0), a.isActive || a.stopTool());
  }
  function Ug(a, b, c) {
    void 0 === c && (c = null);
    if (
      !a.Zt &&
      ((a.Zt = !0),
      b && a.standardMouseSelect(),
      (b = a.standardMouseClick()),
      (a.Zt = !1),
      !b)
    ) {
      a.isActive = !0;
      b = Og;
      null === c && (c = a.findObjectWithContextMenu());
      if (null !== c) {
        var d = c.contextMenu;
        null !== d
          ? ((a.currentObject = c instanceof O ? c : null),
            a.showContextMenu(d, a.currentObject))
          : null !== b && a.showContextMenu(b, a.currentObject);
      } else null !== b && a.showContextMenu(b, null);
      a.currentContextMenu instanceof Je &&
        !a.currentContextMenu.visible &&
        a.stopTool();
    }
  }
  Mg.prototype.doMouseMove = function () {
    var a = this.diagram.toolManager.findTool("Action");
    null !== a && a.doMouseMove();
    this.isActive && this.diagram.toolManager.doMouseMove();
  };
  Mg.prototype.showContextMenu = function (a, b) {
    !G ||
      a instanceof Je ||
      a instanceof Oe ||
      v("showContextMenu:contextMenu must be an Adornment or HTMLInfo.");
    null !== b && x(b, O, Mg, "showContextMenu:obj");
    var c = this.diagram;
    a !== this.currentContextMenu && this.hideContextMenu();
    if (a instanceof Je) {
      a.layerName = "Tool";
      a.selectable = !1;
      a.scale = 1 / c.scale;
      a.category = this.name;
      null !== a.placeholder && (a.placeholder.scale = c.scale);
      var d = a.diagram;
      null !== d && d !== c && d.remove(a);
      c.add(a);
      null !== b ? (a.adornedObject = b) : (a.data = c.model);
      a.Za();
      this.positionContextMenu(a, b);
    } else a instanceof Oe && a.show(b, c, this);
    this.currentContextMenu = a;
  };
  Mg.prototype.positionContextMenu = function (a) {
    if (null === a.placeholder) {
      var b = this.diagram,
        c = b.lastInput.documentPoint.copy(),
        d = a.measuredBounds,
        e = b.viewportBounds;
      b.lastInput.isTouchEvent && (c.x -= d.width);
      c.x + d.width > e.right && (c.x -= d.width + 5 / b.scale);
      c.x < e.x && (c.x = e.x);
      c.y + d.height > e.bottom && (c.y -= d.height + 5 / b.scale);
      c.y < e.y && (c.y = e.y);
      a.position = c;
    }
  };
  Mg.prototype.hideContextMenu = function () {
    var a = this.diagram,
      b = this.currentContextMenu;
    null !== b &&
      (b instanceof Je
        ? (a.remove(b),
          null !== this.Bt && this.Bt.Of(b.category),
          (b.data = null),
          (b.adornedObject = null))
        : b instanceof Oe &&
          (null !== b.hide
            ? b.hide(a, this)
            : null !== b.mainElement && (b.mainElement.style.display = "none")),
      (this.currentContextMenu = null),
      this.standardMouseOver());
  };
  function Vg(a) {
    var b = new H();
    b.add(
      new Lg(
        "Copy",
        function (a) {
          a.commandHandler.copySelection();
        },
        function (a) {
          return a.commandHandler.canCopySelection();
        }
      )
    );
    b.add(
      new Lg(
        "Cut",
        function (a) {
          a.commandHandler.cutSelection();
        },
        function (a) {
          return a.commandHandler.canCutSelection();
        }
      )
    );
    b.add(
      new Lg(
        "Delete",
        function (a) {
          a.commandHandler.deleteSelection();
        },
        function (a) {
          return a.commandHandler.canDeleteSelection();
        }
      )
    );
    b.add(
      new Lg(
        "Paste",
        function (b) {
          b.commandHandler.pasteSelection(a.mouseDownPoint);
        },
        function (b) {
          return b.commandHandler.canPasteSelection(a.mouseDownPoint);
        }
      )
    );
    b.add(
      new Lg(
        "Select All",
        function (a) {
          a.commandHandler.selectAll();
        },
        function (a) {
          return a.commandHandler.canSelectAll();
        }
      )
    );
    b.add(
      new Lg(
        "Undo",
        function (a) {
          a.commandHandler.undo();
        },
        function (a) {
          return a.commandHandler.canUndo();
        }
      )
    );
    b.add(
      new Lg(
        "Redo",
        function (a) {
          a.commandHandler.redo();
        },
        function (a) {
          return a.commandHandler.canRedo();
        }
      )
    );
    b.add(
      new Lg(
        "Scroll To Part",
        function (a) {
          a.commandHandler.scrollToPart();
        },
        function (a) {
          return a.commandHandler.canScrollToPart();
        }
      )
    );
    b.add(
      new Lg(
        "Zoom To Fit",
        function (a) {
          a.commandHandler.zoomToFit();
        },
        function (a) {
          return a.commandHandler.canZoomToFit();
        }
      )
    );
    b.add(
      new Lg(
        "Reset Zoom",
        function (a) {
          a.commandHandler.resetZoom();
        },
        function (a) {
          return a.commandHandler.canResetZoom();
        }
      )
    );
    b.add(
      new Lg(
        "Group Selection",
        function (a) {
          a.commandHandler.groupSelection();
        },
        function (a) {
          return a.commandHandler.canGroupSelection();
        }
      )
    );
    b.add(
      new Lg(
        "Ungroup Selection",
        function (a) {
          a.commandHandler.ungroupSelection();
        },
        function (a) {
          return a.commandHandler.canUngroupSelection();
        }
      )
    );
    b.add(
      new Lg(
        "Edit Text",
        function (a) {
          a.commandHandler.editTextBlock();
        },
        function (a) {
          return a.commandHandler.canEditTextBlock();
        }
      )
    );
    return b;
  }
  Mg.prototype.showDefaultContextMenu = function () {
    var a = this.diagram;
    null === this.Dt && (this.Dt = Vg(this));
    Qg.innerHTML = "";
    Rg.addEventListener("pointerdown", this.Ru, !1);
    var b = this,
      c = wa("ul");
    c.className = "goCXul";
    Qg.appendChild(c);
    c.innerHTML = "";
    for (var d = this.Dt.iterator; d.next(); ) {
      var e = d.value,
        f = e.visible;
      if ("function" === typeof e.Jx && ("function" !== typeof f || f(a))) {
        f = wa("li");
        f.className = "goCXli";
        var g = wa("a");
        g.className = "goCXa";
        g.href = "#";
        g.Ry = e.Jx;
        g.addEventListener(
          "pointerdown",
          function (c) {
            this.Ry(a);
            b.stopTool();
            c.preventDefault();
            return !1;
          },
          !1
        );
        g.textContent = e.text;
        f.appendChild(g);
        c.appendChild(f);
      }
    }
    Qg.style.display = "block";
    Rg.style.display = "block";
  };
  Mg.prototype.hideDefaultContextMenu = function () {
    if (null !== this.currentContextMenu && this.currentContextMenu === Og) {
      Qg.style.display = "none";
      Rg.style.display = "none";
      var a = this.diagram;
      null !== a && a.removeEventListener(Rg, "pointerdown", this.Ru, !1);
      this.currentContextMenu = null;
    }
  };
  oa.Object.defineProperties(Mg.prototype, {
    currentContextMenu: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        !G ||
          null === a ||
          a instanceof Je ||
          a instanceof Oe ||
          v(
            "ContextMenuTool.currentContextMenu must be an Adornment or HTMLInfo."
          );
        this.j = a;
        this.Bt = a instanceof Je ? a.adornedPart : null;
      },
    },
    defaultTouchContextMenu: {
      configurable: !0,
      get: function () {
        !1 === Sg && null === Og && Wg && Ng(this);
        return Og;
      },
      set: function (a) {
        !G ||
          null === a ||
          a instanceof Je ||
          a instanceof Oe ||
          v(
            "ContextMenuTool.defaultTouchContextMenu must be an Adornment or HTMLInfo."
          );
        null === a && (Sg = !0);
        Og = a;
      },
    },
    currentObject: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        null !== a && x(a, O, Mg, "currentObject");
        this.o = a;
      },
    },
    mouseDownPoint: {
      configurable: !0,
      get: function () {
        return this.Zw;
      },
    },
  });
  var Og = null,
    Sg = !1,
    Rg = null,
    Qg = null;
  Mg.className = "ContextMenuTool";
  Ta(
    "contextMenuTool",
    function () {
      return this.findTool("ContextMenu");
    },
    function (a) {
      this.jb("ContextMenu", a, this.mouseUpTools);
    }
  );
  function Xg() {
    0 < arguments.length && Ca(Xg);
    we.call(this);
    this.name = "TextEditing";
    this.vh = new Yg();
    this.Na = null;
    this.Ba = Zg;
    this.Di = null;
    this.qa = $g;
    this.B = 1;
    this.M = !0;
    this.o = null;
    this.j = new Oe();
    this.Et = null;
    ah(this, this.j);
  }
  na(Xg, we);
  function ah(a, b) {
    if (Wg) {
      var c = wa("textarea");
      a.Et = c;
      c.addEventListener(
        "input",
        function () {
          if (null !== a.textBlock) {
            var b = a.sy(this.value);
            this.style.width = 20 + b.measuredBounds.width * this.dB + "px";
            this.rows = b.lineCount;
          }
        },
        !1
      );
      c.addEventListener(
        "keydown",
        function (b) {
          if (null !== a.textBlock) {
            var c = b.key;
            "Enter" === c
              ? (!1 === a.textBlock.isMultiline && b.preventDefault(),
                a.acceptText(bh))
              : "Tab" === c
              ? (a.acceptText(ch), b.preventDefault())
              : "Escape" === c &&
                (a.doCancel(), null !== a.diagram && a.diagram.doFocus());
          }
        },
        !1
      );
      c.addEventListener(
        "focus",
        function () {
          if (null !== a.currentTextEditor && a.state !== $g) {
            var b = a.Et;
            a.qa === dh && (a.qa = eh);
            "function" === typeof b.select &&
              a.selectsTextOnActivate &&
              (b.select(), b.setSelectionRange(0, 9999));
          }
        },
        !1
      );
      c.addEventListener(
        "blur",
        function () {
          if (null !== a.currentTextEditor && a.state !== $g) {
            var b = a.Et;
            "function" === typeof b.focus && b.focus();
            "function" === typeof b.select &&
              a.selectsTextOnActivate &&
              (b.select(), b.setSelectionRange(0, 9999));
          }
        },
        !1
      );
      b.valueFunction = function () {
        return c.value;
      };
      b.mainElement = c;
      b.show = function (a, b, f) {
        if (a instanceof Yg && f instanceof Xg)
          if (f.state === fh) (c.style.border = "3px solid red"), c.focus();
          else {
            var d = a.ka(Kc),
              e = b.position,
              k = b.scale,
              l = a.If() * k;
            l < f.minimumEditorScale && (l = f.minimumEditorScale);
            var m = a.naturalBounds.width * l + 6,
              n = a.naturalBounds.height * l + 2,
              p = (d.x - e.x) * k;
            d = (d.y - e.y) * k;
            e = a.verticalAlignment;
            k =
              (a.lineHeight + a.spacingAbove + a.spacingBelow) *
              a.lineCount *
              l;
            n = e.y * n - e.y * k + e.offsetY - (0.5 * n - 0.5 * k) - k / 2;
            c.value = a.text;
            b.div.style.font = a.font;
            c.style.position = "absolute";
            c.style.zIndex = "100";
            c.style.font = "inherit";
            c.style.fontSize = 100 * l + "%";
            c.style.lineHeight = "normal";
            c.style.width = m + "px";
            c.style.left = ((p - m / 2) | 0) - 1 + "px";
            c.style.top = ((d + n) | 0) - 1 + "px";
            c.style.textAlign = a.textAlign;
            c.style.margin = "0";
            c.style.padding = "1px";
            c.style.border = "0";
            c.style.outline = "none";
            c.style.whiteSpace = "pre-wrap";
            c.style.overflow = "hidden";
            c.rows = a.lineCount;
            c.dB = l;
            c.className = "goTXarea";
            b.div.appendChild(c);
            c.focus();
            f.selectsTextOnActivate &&
              (c.select(), c.setSelectionRange(0, 9999));
          }
      };
      b.hide = function (a) {
        a.div.removeChild(c);
      };
    }
  }
  Xg.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    if (
      null === a ||
      a.isReadOnly ||
      (gh && gh !== this && (gh.acceptText(hh), gh && gh !== this)) ||
      !a.lastInput.left ||
      this.isBeyondDragSize()
    )
      return !1;
    var b = a.dc(a.lastInput.documentPoint);
    if (!(null !== b && b instanceof Yg && b.editable && b.part.canEdit()))
      return !1;
    b = b.part;
    return null === b ||
      (this.starting === Zg && !b.isSelected) ||
      (this.starting === ih && 2 > a.lastInput.clickCount)
      ? !1
      : !0;
  };
  Xg.prototype.doStart = function () {
    gh = this;
    null !== this.textBlock && this.doActivate();
  };
  Xg.prototype.doActivate = function () {
    if (!this.isActive) {
      var a = this.diagram;
      if (null !== a) {
        var b = this.textBlock;
        null === b && (b = a.dc(a.lastInput.documentPoint));
        if (
          null !== b &&
          b instanceof Yg &&
          ((this.textBlock = b), null !== b.part)
        ) {
          a.animationManager.wc();
          this.isActive = !0;
          this.qa = dh;
          var c = this.defaultTextEditor;
          null !== b.textEditor && (c = b.textEditor);
          this.vh = this.textBlock.copy();
          var d = new M(this.textBlock.ka(Fc), this.textBlock.ka(Pc));
          a.Vv(d);
          c.show(b, a, this);
          this.currentTextEditor = c;
        }
      }
    }
  };
  Xg.prototype.doCancel = function () {
    this.stopTool();
  };
  Xg.prototype.doMouseUp = function () {
    this.canStart() && this.doActivate();
  };
  Xg.prototype.doMouseDown = function () {
    this.isActive && this.acceptText(hh);
  };
  Xg.prototype.acceptText = function (a) {
    switch (a) {
      case hh:
        if (this.qa === jh)
          this.currentTextEditor instanceof HTMLElement &&
            this.currentTextEditor.focus();
        else if (this.qa === dh || this.qa === fh || this.qa === eh)
          (this.qa = kh), lh(this);
        break;
      case mh:
      case bh:
      case ch:
        if (bh !== a || !0 !== this.textBlock.isMultiline)
          if (this.qa === dh || this.qa === fh || this.qa === eh)
            (this.qa = kh), lh(this);
    }
  };
  function lh(a) {
    var b = a.textBlock,
      c = a.diagram,
      d = a.currentTextEditor;
    if (null !== b && null !== d) {
      var e = b.text,
        f = "";
      null !== d.valueFunction && (f = d.valueFunction());
      a.isValidText(b, e, f)
        ? (a.Fa(a.name),
          (a.qa = jh),
          (a.transactionResult = a.name),
          (b.text = f),
          a.doSuccess(e, f),
          null !== c && c.V("TextEdited", b, e),
          a.stopTransaction(),
          a.stopTool(),
          null !== c && c.doFocus())
        : ((a.qa = fh), a.doError(e, f));
    }
  }
  Xg.prototype.doError = function (a, b) {
    var c = this.textBlock;
    null !== c.errorFunction && c.errorFunction(this, a, b);
    (a = this.currentTextEditor) && a.show(c, this.diagram, this);
  };
  Xg.prototype.doSuccess = function (a, b) {
    var c = this.textBlock;
    null !== c.textEdited && c.textEdited(c, a, b);
  };
  Xg.prototype.doDeactivate = function () {
    var a = this.diagram;
    null !== a &&
      ((this.qa = $g),
      null !== this.currentTextEditor && this.currentTextEditor.hide(a, this),
      (this.textBlock = null),
      (this.isActive = !1));
  };
  Xg.prototype.doStop = function () {
    gh = null;
  };
  Xg.prototype.isValidText = function (a, b, c) {
    x(a, Yg, Xg, "isValidText:textblock");
    var d = this.textValidation;
    if (null !== d && !d(a, b, c)) return !1;
    d = a.textValidation;
    return null === d || d(a, b, c) ? !0 : !1;
  };
  Xg.prototype.sy = function (a) {
    var b = this.vh;
    b.text = a;
    b.measure(this.textBlock.li, Infinity);
    return b;
  };
  oa.Object.defineProperties(Xg.prototype, {
    textBlock: {
      configurable: !0,
      get: function () {
        return this.Na;
      },
      set: function (a) {
        null !== a && x(a, Yg, Xg, "textBlock");
        this.Na = a;
      },
    },
    currentTextEditor: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        this.o = a;
      },
    },
    defaultTextEditor: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        !G ||
          a instanceof Oe ||
          v("TextEditingTool.defaultTextEditor must be an HTMLInfo.");
        this.j = a;
      },
    },
    starting: {
      configurable: !0,
      get: function () {
        return this.Ba;
      },
      set: function (a) {
        cb(a, Xg, Xg, "starting");
        this.Ba = a;
      },
    },
    textValidation: {
      configurable: !0,
      get: function () {
        return this.Di;
      },
      set: function (a) {
        null !== a && A(a, "function", Xg, "textValidation");
        this.Di = a;
      },
    },
    minimumEditorScale: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        null !== a && A(a, "number", Xg, "minimumEditorScale");
        this.B = a;
      },
    },
    selectsTextOnActivate: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        null !== a && A(a, "boolean", Xg, "selectsTextOnActivate");
        this.M = a;
      },
    },
    state: {
      configurable: !0,
      get: function () {
        return this.qa;
      },
      set: function (a) {
        this.qa !== a && (cb(a, Xg, Xg, "starting"), (this.qa = a));
      },
    },
  });
  Xg.prototype.measureTemporaryTextBlock = Xg.prototype.sy;
  var mh = new F(Xg, "LostFocus", 0),
    hh = new F(Xg, "MouseDown", 1),
    ch = new F(Xg, "Tab", 2),
    bh = new F(Xg, "Enter", 3),
    nh = new F(Xg, "SingleClick", 0),
    Zg = new F(Xg, "SingleClickSelected", 1),
    ih = new F(Xg, "DoubleClick", 2),
    $g = new F(Xg, "StateNone", 0),
    dh = new F(Xg, "StateActive", 1),
    eh = new F(Xg, "StateEditing", 2),
    kh = new F(Xg, "StateValidating", 3),
    fh = new F(Xg, "StateInvalid", 4),
    jh = new F(Xg, "StateValidated", 5),
    gh = null;
  Xg.className = "TextEditingTool";
  Xg.LostFocus = mh;
  Xg.MouseDown = hh;
  Xg.Tab = ch;
  Xg.Enter = bh;
  Xg.SingleClick = nh;
  Xg.SingleClickSelected = Zg;
  Xg.DoubleClick = ih;
  Xg.StateNone = $g;
  Xg.StateActive = dh;
  Xg.StateEditing = eh;
  Xg.StateValidating = kh;
  Xg.StateInvalid = fh;
  Xg.StateValidated = jh;
  Ta(
    "textEditingTool",
    function () {
      return this.findTool("TextEditing");
    },
    function (a) {
      this.jb("TextEditing", a, this.mouseUpTools);
    }
  );
  function oh(a) {
    ph || (qh(), (ph = !0));
    this.G = xe;
    this.nl = this.zb = this.Br = this.qc = !1;
    this.ux = !0;
    this.ol = rh;
    this.fn = !1;
    this.ii = this.Dd = !0;
    this.Qg = 600;
    this.Dw = this.sx = !1;
    this.Vd = new I();
    this.Yd = new sh();
    this.Yd.Ud = this;
    this.ij = new I();
    this.Nu = new I();
    this.qs = new I();
    this.Ql = new I();
    a && Object.assign(this, a);
  }
  oh.prototype.Xe = function (a) {
    this.G = a;
  };
  oh.prototype.canStart = function () {
    return !0;
  };
  function th(a, b) {
    a.Dd &&
      a.canStart(b) &&
      (a.Vd.add(b),
      a.defaultAnimation.isAnimating && a.wc(),
      uh(a.G),
      (a.zb = !0));
  }
  function vh(a) {
    if (a.Dd && a.zb) {
      var b = a.Yd,
        c = a.G,
        d = a.Vd.contains("Model");
      d &&
        ((a.nl = !0),
        a.ol === rh
          ? ((b.isViewportUnconstrained = !0),
            b.sc.clear(),
            b.add(c, "position", c.position.copy().offset(0, -200), c.position),
            b.add(c, "opacity", 0, 1))
          : a.ol === wh && b.sc.clear(),
        (a.ux = a.ol === xh && c.Bu.D(c.ra) ? !0 : !1),
        c.V("InitialAnimationStarting", a));
      (d && !a.ii) || 0 === b.sc.count
        ? (a.Vd.clear(),
          (a.zb = !1),
          b.sc.clear(),
          yh(b, c),
          (a.nl = !1),
          c.R())
        : (a.Vd.clear(),
          (c.pg = !1),
          (d = b.sc.get(c)),
          c.autoScale !== zh &&
            null !== d &&
            (delete d.start.scale, delete d.end.scale),
          sa.requestAnimationFrame(function () {
            !1 === a.zb ||
              b.qc ||
              (c.Se("temporaryPixelRatio") && Xe(c),
              Ah(c),
              (a.zb = !1),
              b.start(),
              Bh(a),
              c.Wa(),
              Ch(b, 0),
              Ef(c, !0),
              Dh(a),
              c.V("AnimationStarting", a));
          }));
    }
  }
  function Eh(a) {
    return a.Vd.contains("Trigger") && 1 === a.Vd.count;
  }
  function Fh(a, b, c, d) {
    a.isTicking ||
      Eh(a) ||
      (b instanceof R && (null !== b.fromNode || null !== b.toNode)) ||
      a.Yd.add(b, "position", c, d, !1);
  }
  t = oh.prototype;
  t.Ys = function (a) {
    return this.Yd.Ys(a);
  };
  t.Dv = function (a) {
    return this.Yd.Dv(a);
  };
  function Gh(a, b) {
    function c() {
      0 < e.qs.count && (d.addAll(e.qs), e.qs.clear(), (e.qc = !0));
      if (!1 !== e.qc && 0 !== d.count) {
        e.Nu.addAll(d);
        for (var a = e.Nu.iterator; a.next(); ) {
          var b = a.value;
          if (!1 !== b.qc) {
            a: if (0 < b.bm.count) var h = !0;
            else {
              for (h = b.sc.iterator; h.next(); ) {
                var k = h.key;
                if ((k instanceof O && null !== k.diagram) || k instanceof Q) {
                  h = !0;
                  break a;
                }
              }
              h = !1;
            }
            h ? Hh(b, !1) : (b.wl = !0);
          }
        }
        e.Nu.clear();
        Bh(e);
        Ef(e.G);
        Dh(e);
        sa.requestAnimationFrame(c);
      }
    }
    var d = a.ij,
      e = a;
    a.qc
      ? a.qs.add(b)
      : ((a.qc = !0),
        d.add(b),
        sa.requestAnimationFrame(function () {
          c();
        }));
  }
  function Th(a) {
    for (a = a.ij.iterator; a.next(); ) a.value.wl = !1;
  }
  function Bh(a) {
    if (!a.Br) {
      var b = a.G;
      a.sx = b.skipsUndoManager;
      a.Dw = b.skipsModelSourceBindings;
      b.skipsUndoManager = !0;
      b.skipsModelSourceBindings = !0;
      a.Br = !0;
    }
  }
  function Dh(a) {
    var b = a.G;
    b.skipsUndoManager = a.sx;
    b.skipsModelSourceBindings = a.Dw;
    a.Br = !1;
  }
  t.wc = function (a) {
    var b = this.Yd;
    !0 === this.zb &&
      ((this.nl = this.zb = !1),
      this.Vd.clear(),
      0 < b.sc.count && this.G.Ob());
    if (this.qc) {
      if ((b.jm(!0), b.sc.clear(), yh(b, null), !0 === a))
        for (a = this.ij.Ga(), b = 0; b < a.length; b++) a[b].jm(!0);
    } else b.sc.clear(), yh(b, this.G);
  };
  t.jm = function (a) {
    a === this.defaultAnimation && this.defaultAnimation.sc.clear();
    this.ij.remove(a);
    0 === this.ij.count && ((this.qc = !1), this.G.Ob());
    a === this.defaultAnimation &&
      (this.defaultAnimation.sc.clear(), this.G.V("AnimationFinished", this));
  };
  t.ek = function (a, b) {
    this.zb &&
      (this.Vd.contains("Expand Tree") ||
        this.Vd.contains("Expand SubGraph")) &&
      (this.Yd.ek(a, b), Uh(this, a));
  };
  t.ck = function (a, b) {
    this.zb &&
      (this.Vd.contains("Collapse Tree") ||
        this.Vd.contains("Collapse SubGraph")) &&
      (this.Yd.ck(a, b),
      Vh(this.Yd, b, "position", b.position, b.position),
      Uh(this, a));
  };
  function Wh(a, b, c) {
    !a.zb ||
      b.D(c) ||
      Eh(a) ||
      (a.G.Yi || (b = c.copy()), Vh(a.Yd, a.G, "position", b, c));
  }
  function Uh(a, b) {
    for (b = b.findLinksConnected(); b.next(); ) {
      var c = b.value;
      c.qf = c.points.copy();
      a.Ql.add(c);
    }
  }
  function Xh(a, b, c, d, e) {
    null === a && (a = [0, 0, 0, 0]);
    null === b && (b = [0, 0, 0, 0]);
    var f = a[0],
      g = a[1],
      h = a[2];
    a = a[3];
    var k = b[0],
      l = b[1],
      m = b[2];
    b = b[3];
    if (0 === h || 100 === h) (f = k), (g = l);
    else if (0 === m || 100 === m) (k = f), (l = g);
    180 < Math.abs(k - f) && (k > f ? (f += 360) : (k += 360));
    f = e(c, f, k - f, d) % 360;
    g = e(c, g, l - g, d);
    h = e(c, h, m - h, d);
    c = e(c, a, b - a, d);
    return "hsla(" + f + ", " + g + "%, " + h + "%, " + c + ")";
  }
  function qh() {
    function a(a, b, e, f, g, h) {
      a.position = new K(f(g, b.x, e.x - b.x, h), f(g, b.y, e.y - b.y, h));
    }
    var b = new xb();
    b.add("position:diagram", a);
    b.add("position", a);
    b.add("position:part", function (a, b, e, f, g, h) {
      g < h
        ? a.Jm(f(g, b.x, e.x - b.x, h), f(g, b.y, e.y - b.y, h), !1)
        : (a.position = new K(
            f(g, b.x, e.x - b.x, h),
            f(g, b.y, e.y - b.y, h)
          ));
    });
    b.add("location", function (a, b, e, f, g, h) {
      g < h
        ? a.Jm(f(g, b.x, e.x - b.x, h), f(g, b.y, e.y - b.y, h), !0)
        : (a.location = new K(
            f(g, b.x, e.x - b.x, h),
            f(g, b.y, e.y - b.y, h)
          ));
    });
    b.add("position:placeholder", function (a, b, e, f, g, h) {
      g < h
        ? a.Jm(f(g, b.x, e.x - b.x, h), f(g, b.y, e.y - b.y, h), !1)
        : (a.position = new K(
            f(g, b.x, e.x - b.x, h),
            f(g, b.y, e.y - b.y, h)
          ));
    });
    b.add("position:nodeCollapse", function (a, b, e, f, g, h) {
      var c = a.actualBounds,
        d = e.actualBounds;
      e = d.x + d.width / 2 - c.width / 2;
      c = d.y + d.height / 2 - c.height / 2;
      g < h
        ? a.Jm(f(g, b.x, e - b.x, h), f(g, b.y, c - b.y, h), !1)
        : (a.position = new K(f(g, b.x, e - b.x, h), f(g, b.y, c - b.y, h)));
    });
    b.add("desiredSize", function (a, b, e, f, g, h) {
      a.desiredSize = new M(
        f(g, b.width, e.width - b.width, h),
        f(g, b.height, e.height - b.height, h)
      );
    });
    b.add("width", function (a, b, e, f, g, h) {
      a.width = f(g, b, e - b, h);
    });
    b.add("height", function (a, b, e, f, g, h) {
      a.height = f(g, b, e - b, h);
    });
    b.add("fill", function (a, b, e, f, g, h) {
      a.fill = Xh(b, e, g, h, f);
    });
    b.add("stroke", function (a, b, e, f, g, h) {
      a.stroke = Xh(b, e, g, h, f);
    });
    b.add("strokeWidth", function (a, b, e, f, g, h) {
      a.strokeWidth = f(g, b, e - b, h);
    });
    b.add("strokeDashOffset", function (a, b, e, f, g, h) {
      a.strokeDashOffset = f(g, b, e - b, h);
    });
    b.add("background", function (a, b, e, f, g, h) {
      a.background = Xh(b, e, g, h, f);
    });
    b.add("areaBackground", function (a, b, e, f, g, h) {
      a.areaBackground = Xh(b, e, g, h, f);
    });
    b.add("opacity", function (a, b, e, f, g, h) {
      a.opacity = f(g, b, e - b, h);
    });
    b.add("scale", function (a, b, e, f, g, h) {
      a.scale = f(g, b, e - b, h);
    });
    b.add("angle", function (a, b, e, f, g, h) {
      a.angle = f(g, b, e - b, h);
    });
    Yh = b;
  }
  oa.Object.defineProperties(oh.prototype, {
    animationReasons: {
      configurable: !0,
      get: function () {
        return this.Vd;
      },
    },
    isEnabled: {
      configurable: !0,
      get: function () {
        return this.Dd;
      },
      set: function (a) {
        A(a, "boolean", oh, "isEnabled");
        (this.Dd = a) &&
          this.ij.each(function (a) {
            a.isAnimating || Infinity !== a.runCount || a.start();
          });
      },
    },
    duration: {
      configurable: !0,
      get: function () {
        return this.Qg;
      },
      set: function (a) {
        A(a, "number", oh, "duration");
        1 > a && Aa(a, ">= 1", oh, "duration");
        this.Qg = a;
      },
    },
    isAnimating: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.qc;
      },
    },
    isTicking: {
      configurable: !0,
      get: function () {
        return this.Br;
      },
    },
    isInitial: {
      configurable: !0,
      get: function () {
        return this.ii;
      },
      set: function (a) {
        A(a, "boolean", oh, "isInitial");
        this.ii = a;
      },
    },
    defaultAnimation: {
      configurable: !0,
      get: function () {
        return this.Yd;
      },
    },
    activeAnimations: {
      configurable: !0,
      get: function () {
        return this.ij;
      },
    },
    initialAnimationStyle: {
      configurable: !0,
      get: function () {
        return this.ol;
      },
      set: function (a) {
        G && cb(a, oh, oh, "initialAnimationStyle");
        this.ol = a;
      },
    },
  });
  oh.prototype.stopAnimation = oh.prototype.wc;
  var Yh = null,
    ph = !1,
    rh = new F(oh, "Default", 1),
    xh = new F(oh, "AnimateLocations", 2),
    wh = new F(oh, "None", 3);
  oh.className = "AnimationManager";
  oh.defineAnimationEffect = function (a, b) {
    ph || (qh(), (ph = !0));
    Yh.add(a, b);
  };
  oh.Default = rh;
  oh.AnimateLocations = xh;
  oh.None = wh;
  function sh(a) {
    this.Tu = this.qx = this.Ud = this.G = null;
    this.wl = this.qc = this.j = !1;
    this.Jn = this.Kd = 0;
    this.Zq = this.Jt = Zh;
    this.vl = this.hp = !1;
    this.Au = 1;
    this.yu = 0;
    this.Cd = this.Qg = NaN;
    this.Hw = 0;
    this.Kn = null;
    this.o = yb;
    this.sc = new xb();
    this.qu = new xb();
    this.bm = new I();
    this.ru = new I();
    this.Ew = $h;
    a && Object.assign(this, a);
  }
  sh.prototype.suspend = function () {
    this.wl = !0;
  };
  sh.prototype.advanceTo = function (a, b) {
    b && (this.wl = !1);
    this.hp && a >= this.Cd && ((this.vl = !0), (a -= this.Cd));
    this.Hw = a;
    Hh(this, !0);
    Bh(this.Ud);
    Ef(this.G);
    Dh(this.Ud);
    this.G.redraw();
  };
  function yh(a, b) {
    a.qu.clear();
    a.vl = !1;
    a.yu = 0;
    a.Cd = NaN;
    0 < a.bm.count && a.bm.clear();
    0 < a.ru.count && a.ru.clear();
    if (null !== b) for (a = b.links; a.next(); ) a.value.qf = null;
  }
  t = sh.prototype;
  t.start = function () {
    if (0 === this.sc.count || this.qc) return this;
    for (var a = this.G, b = this.sc.iterator; b.next(); ) {
      var c = b.value.end,
        d = b.key;
      if (c["position:placeholder"]) {
        var e = d.findVisibleNode();
        if (e instanceof vf && null !== e.placeholder) {
          var f = e.placeholder;
          e = f.ka(Fc);
          f = f.padding;
          e.x += f.left;
          e.y += f.top;
          c["position:placeholder"] = e;
        }
      }
      null === a &&
        (d instanceof Q ? (a = d) : d instanceof O && (a = d.diagram));
    }
    if (null !== a) (this.G = a), (this.Ud = a.animationManager);
    else return this;
    b = this.Ud;
    if (!1 === b.isEnabled) return this;
    this.Cd = isNaN(this.Qg) ? b.duration : this.Qg;
    this.Zq = this.Jt;
    b.nl &&
      b.ol === rh &&
      this === b.defaultAnimation &&
      ((this.Zq = ai),
      (this.Cd = isNaN(this.Qg)
        ? 600 === b.duration
          ? 900
          : b.duration
        : this.Qg));
    this.Ew = a.scrollMode;
    this.isViewportUnconstrained && (a.Zj = bi);
    Bh(b);
    this.bm.each(function (b) {
      b.data = null;
      a.add(b);
    });
    Dh(b);
    this.qc = !0;
    this.Kd = +new Date();
    this.Jn = this.Kd + this.Cd;
    Gh(b, this);
    return this;
  };
  t.mz = function (a, b) {
    if (!a.Tc()) return this;
    G &&
      (void 0 === b && v("addTemporaryPart: Required Diagram argument missing"),
      a.diagram === b &&
        v(
          "addTemporaryPart: Part already in Diagram, did you mean to pass in a copy?"
        ),
      null !== this.G &&
        this.G !== b &&
        v(
          "addTemporaryPart: A different Diagram is already associated with this Animation: " +
            this.G.toString()
        ));
    this.bm.add(a);
    this.G = b;
    return this;
  };
  t.add = function (a, b, c, d, e) {
    if ("position" === b && c.D(d)) return this;
    null === this.G &&
      (a instanceof Q
        ? (this.G = a)
        : a instanceof O && null !== a.diagram && (this.G = a.diagram));
    if (a instanceof U) {
      if (!a.isAnimated) return this;
      "position" === b && (b = "position:part");
    }
    Vh(this, a, b, c, d, e);
    return this;
  };
  function Vh(a, b, c, d, e, f) {
    var g = a.sc;
    b instanceof Q && "position" === c && (c = "position:diagram");
    if (
      "fill" === c ||
      "stroke" === c ||
      "background" === c ||
      "areaBackground" === c
    )
      ci(d),
        di(),
        (d = [ei.j, ei.B, ei.o, ei.M]),
        ci(e),
        di(),
        (e = [ei.j, ei.B, ei.o, ei.M]);
    if (g.contains(b)) {
      var h = g.K(b);
      var k = h.start;
      var l = h.end;
      void 0 === k[c] && (k[c] = fi(d));
      l[c] = fi(e);
    } else
      (k = {}),
        (l = {}),
        (k[c] = fi(d)),
        (l[c] = fi(e)),
        (h = k.position),
        b instanceof O &&
          h instanceof K &&
          !h.s() &&
          b.diagram.animationManager.Vd.contains("Expand SubGraph") &&
          h.assign(l.position),
        (h = new gi(k, l, f)),
        g.add(b, h);
    g = k[c];
    g instanceof K && !g.s() && g.assign(a.o);
    f && 0 === c.indexOf("position:") && b instanceof U
      ? (h.ov.location = fi(b.location))
      : f && (h.ov[c] = fi(d));
  }
  function fi(a) {
    return a instanceof K ? a.copy() : a instanceof Gb ? a.copy() : a;
  }
  t.Ys = function (a) {
    if (!this.qc) return !1;
    a = this.sc.K(a);
    return null !== a && a.Pv;
  };
  t.Dv = function (a) {
    if (!this.qc) return !1;
    a = this.sc.K(a);
    return null !== a && (a.start.position || a.start.location);
  };
  function Hh(a, b) {
    if (!a.wl || b) {
      var c = a.Ud;
      if (!1 !== a.qc) {
        var d = +new Date(),
          e = d > a.Jn ? a.Cd : d - a.Kd;
        b &&
          ((e = a.Hw),
          e < a.Cd
            ? ((a.Kd = +new Date() - e), (a.Jn = a.Kd + a.Cd))
            : (e = a.Cd));
        Bh(c);
        Ch(a, e);
        Ef(a.G, !0);
        Dh(c);
        d > a.Jn &&
          (a.hp && !a.vl
            ? ((a.Kd = +new Date()), (a.Jn = a.Kd + a.Cd), (a.vl = !0))
            : a.jm(!1));
      }
    }
  }
  function Ch(a, b) {
    for (var c = a.Cd, d = a.sc.iterator, e = a.vl; d.next(); ) {
      var f = d.key;
      if (!(f instanceof O && null === f.diagram)) {
        var g = d.value,
          h = e ? g.end : g.start;
        g = e ? g.start : g.end;
        var k = Yh,
          l;
        for (l in g)
          ("position" === l &&
            (g["position:placeholder"] || g["position:nodeCollapse"])) ||
            null === k.get(l) ||
            k.get(l)(f, h[l], g[l], a.Zq, b, c, a);
      }
    }
  }
  t.stop = function () {
    if (!this.qc) return this;
    this.jm(!0);
    return this;
  };
  t.jm = function (a) {
    null !== this.Tu && this.Tu.op.remove(this.qx);
    if (this.qc) {
      var b = this.G,
        c = this.Ud;
      this.wl = this.qc = c.nl = !1;
      Bh(c);
      for (var d = this.sc, e = this.bm.iterator; e.next(); ) b.remove(e.value);
      for (e = this.ru.iterator; e.next(); ) e.value.v();
      e = this.hp;
      d = d.iterator;
      for (var f = Yh; d.next(); ) {
        var g = d.key,
          h = d.value,
          k = e ? h.end : h.start,
          l = e ? h.start : h.end,
          m = h.ov,
          n;
        for (n in l)
          if (null !== f.get(n)) {
            var p = n;
            !h.gv ||
              ("position:nodeCollapse" !== p && "position:placeholder" !== p) ||
              (p = "position");
            f.get(p)(
              g,
              k[n],
              void 0 !== m[n] ? m[n] : h.gv ? k[n] : l[n],
              this.Zq,
              this.Cd,
              this.Cd,
              this
            );
          }
        h.gv &&
          void 0 !== m.location &&
          g instanceof U &&
          (g.location = m.location);
        h.Pv && g instanceof U && g.Vb(!1);
      }
      b.Ts.clear();
      ff(b, !1);
      b.Wa();
      b.R();
      Ef(b, !0);
      if (c.defaultAnimation === this) {
        for (n = c.Ql.iterator; n.next(); )
          (e = n.value), null !== e.qf && ((e.points = e.qf), (e.qf = null));
        c.Ql.clear();
      }
      this.isViewportUnconstrained && (b.scrollMode = this.Ew);
      Dh(c);
      this.yu++;
      !a && this.Au > this.yu
        ? ((this.vl = !1), this.start())
        : (this.Kn && this.Kn(this), yh(this, null), c.jm(this), b.Ob());
    }
  };
  t.ek = function (a, b) {
    var c = b.actualBounds,
      d = null;
    b instanceof vf && (d = b.placeholder);
    null !== d
      ? ((c = d.ka(Fc)),
        (d = d.padding),
        (c.x += d.left),
        (c.y += d.top),
        this.add(a, "position", c, a.position, !1))
      : this.add(
          a,
          "position",
          new K(c.x + c.width / 2, c.y + c.height / 2),
          a.position,
          !1
        );
    this.add(a, "scale", 0.01, a.scale, !1);
    if (a instanceof vf)
      for (a = a.memberParts; a.next(); )
        (d = a.value), d instanceof V && this.ek(d, b);
  };
  t.ck = function (a, b) {
    if (a.isVisible()) {
      var c = null;
      b instanceof vf && (c = b.placeholder);
      null !== c
        ? this.add(a, "position:placeholder", a.position, c, !0)
        : this.add(a, "position:nodeCollapse", a.position, b, !0);
      this.add(a, "scale", a.scale, 0.01, !0);
      c = this.sc;
      c.contains(a) && (c.K(a).Pv = !0);
      if (a instanceof vf)
        for (a = a.memberParts; a.next(); )
          (c = a.value), c instanceof V && this.ck(c, b);
    }
  };
  t.nA = function (a) {
    var b = this.qu.get(a);
    null === b && ((b = {}), this.qu.add(a, b));
    return b;
  };
  oa.Object.defineProperties(sh.prototype, {
    duration: {
      configurable: !0,
      get: function () {
        return this.Qg;
      },
      set: function (a) {
        A(a, "number", sh, "duration");
        1 > a && Aa(a, ">= 1", sh, "duration");
        this.Qg = a;
      },
    },
    reversible: {
      configurable: !0,
      get: function () {
        return this.hp;
      },
      set: function (a) {
        this.hp = a;
      },
    },
    runCount: {
      configurable: !0,
      get: function () {
        return this.Au;
      },
      set: function (a) {
        0 < a
          ? (this.Au = a)
          : v("Animation.runCount value must be a positive integer.");
      },
    },
    finished: {
      configurable: !0,
      get: function () {
        return this.Kn;
      },
      set: function (a) {
        this.Kn !== a &&
          (null !== a && A(a, "function", sh, "finished"), (this.Kn = a));
      },
    },
    easing: {
      configurable: !0,
      get: function () {
        return this.Jt;
      },
      set: function (a) {
        this.Jt = a;
      },
    },
    isViewportUnconstrained: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.j = a;
      },
    },
    isAnimating: {
      configurable: !0,
      get: function () {
        return this.qc;
      },
    },
  });
  sh.prototype.getTemporaryState = sh.prototype.nA;
  sh.prototype.stop = sh.prototype.stop;
  sh.prototype.add = sh.prototype.add;
  sh.prototype.addTemporaryPart = sh.prototype.mz;
  function Zh(a, b, c, d) {
    a /= d / 2;
    return 1 > a ? (c / 2) * a * a + b : (-c / 2) * (--a * (a - 2) - 1) + b;
  }
  function ai(a, b, c, d) {
    return a === d ? b + c : c * (-Math.pow(2, (-10 * a) / d) + 1) + b;
  }
  sh.className = "Animation";
  sh.EaseLinear = function (a, b, c, d) {
    return (c * a) / d + b;
  };
  sh.EaseInOutQuad = Zh;
  sh.EaseInQuad = function (a, b, c, d) {
    return c * (a /= d) * a + b;
  };
  sh.EaseOutQuad = function (a, b, c, d) {
    return -c * (a /= d) * (a - 2) + b;
  };
  sh.EaseInExpo = function (a, b, c, d) {
    return 0 === a ? b : c * Math.pow(2, 10 * (a / d - 1)) + b;
  };
  sh.EaseOutExpo = ai;
  function gi(a, b, c) {
    this.start = a;
    this.end = b;
    this.ov = {};
    this.gv = c;
    this.Pv = !1;
  }
  gi.className = "AnimationState";
  function hi(a, b, c) {
    this.wd = null;
    this.pf = a;
    this.Ep = c || ii;
    this.Qk = null;
    void 0 !== b && ((this.Qk = b), void 0 === c && (this.Ep = ji));
  }
  hi.prototype.copy = function () {
    var a = new hi(this.pf);
    a.Ep = this.Ep;
    var b = this.Qk;
    if (null !== b) {
      var c = {};
      void 0 !== b.duration && (c.duration = b.duration);
      void 0 !== b.finished && (c.finished = b.finished);
      void 0 !== b.easing && (c.easing = b.easing);
      a.Qk = c;
    }
    return a;
  };
  function ki(a, b) {
    a = a.Qk;
    null !== a &&
      (a.duration && (b.duration = a.duration),
      a.finished && (b.finished = a.finished),
      a.easing && (b.easing = a.easing));
  }
  oa.Object.defineProperties(hi.prototype, {
    propertyName: {
      configurable: !0,
      get: function () {
        return this.pf;
      },
      set: function (a) {
        this.pf = a;
      },
    },
    animationSettings: {
      configurable: !0,
      get: function () {
        return this.Qk;
      },
      set: function (a) {
        this.Qk = a;
      },
    },
    startCondition: {
      configurable: !0,
      get: function () {
        return this.Ep;
      },
      set: function (a) {
        G && cb(a, hi, hi, "startCondition");
        this.Ep = a;
      },
    },
  });
  var ii = new F(hi, "Default", 1),
    ji = new F(hi, "Immediate", 2),
    li = new F(hi, "Bundled", 3);
  hi.className = "AnimationTrigger";
  hi.Default = ii;
  hi.Immediate = ji;
  hi.Bundled = li;
  function mi(a) {
    ab(this);
    this.G = null;
    this.Ma = new H();
    this.ua = "";
    this.tb = 1;
    this.o = !1;
    this.j =
      this.xi =
      this.B =
      this.sj =
      this.rj =
      this.qj =
      this.pj =
      this.nj =
      this.oj =
      this.mj =
      this.uj =
      this.lj =
      this.tj =
      this.kj =
      this.jj =
        !0;
    this.Uo = [];
    a && Object.assign(this, a);
  }
  t = mi.prototype;
  t.clear = function () {
    this.Ma.clear();
    this.Uo.length = 0;
  };
  t.Xe = function (a) {
    this.G = a;
  };
  t.toString = function (a) {
    void 0 === a && (a = 0);
    var b = 'Layer "' + this.name + '"';
    if (0 >= a) return b;
    for (
      var c = 0, d = 0, e = 0, f = 0, g = 0, h = this.Ma.iterator;
      h.next();

    ) {
      var k = h.value;
      k instanceof vf
        ? e++
        : k instanceof V
        ? d++
        : k instanceof R
        ? f++
        : k instanceof Je
        ? g++
        : c++;
    }
    h = "";
    0 < c && (h += c + " Parts ");
    0 < d && (h += d + " Nodes ");
    0 < e && (h += e + " Groups ");
    0 < f && (h += f + " Links ");
    0 < g && (h += g + " Adornments ");
    if (1 < a)
      for (a = this.Ma.iterator; a.next(); )
        (c = a.value),
          (h += "\n    " + c.toString()),
          (d = c.data),
          null !== d && lb(d) && (h += " #" + lb(d)),
          c instanceof V
            ? (h += " " + Ra(d))
            : c instanceof R &&
              (h += " " + Ra(c.fromNode) + " " + Ra(c.toNode));
    return b + " " + this.Ma.count + ": " + h;
  };
  t.dc = function (a, b, c) {
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    if (!1 === this.xi) return null;
    G &&
      !a.s() &&
      v("findObjectAt: Point must have a real value, not: " + a.toString());
    var d = !1;
    null !== this.diagram && this.diagram.viewportBounds.ca(a) && (d = !0);
    for (var e = K.alloc(), f = this.Ma.m, g = f.length; g--; ) {
      var h = f[g];
      if (
        (!0 !== d || !1 !== qg(h)) &&
        h.isVisible() &&
        (e.assign(a),
        Lb(e, h.ke),
        (h = h.dc(e, b, c)),
        null !== h &&
          (null !== b && (h = b(h)), null !== h && (null === c || c(h))))
      )
        return K.free(e), h;
    }
    K.free(e);
    return null;
  };
  t.Qi = function (a, b, c, d) {
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    d instanceof H || d instanceof I || (d = new I());
    if (!1 === this.xi) return d;
    G &&
      !a.s() &&
      v("findObjectsAt: Point must have a real value, not: " + a.toString());
    var e = !1;
    null !== this.diagram && this.diagram.viewportBounds.ca(a) && (e = !0);
    for (var f = K.alloc(), g = this.Ma.m, h = g.length; h--; ) {
      var k = g[h];
      if ((!0 !== e || !1 !== qg(k)) && k.isVisible()) {
        f.assign(a);
        Lb(f, k.ke);
        var l = k;
        k.Qi(f, b, c, d) &&
          (null !== b && (l = b(l)),
          null === l || (null !== c && !c(l)) || d.add(l));
      }
    }
    K.free(f);
    return d;
  };
  t.Hf = function (a, b, c, d, e) {
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    void 0 === d && (d = !1);
    e instanceof H || e instanceof I || (e = new I());
    if (!1 === this.xi) return e;
    G &&
      !a.s() &&
      v("findObjectsIn: Rect must have a real value, not: " + a.toString());
    var f = !1;
    null !== this.diagram && this.diagram.viewportBounds.Qe(a) && (f = !0);
    for (var g = this.Ma.m, h = g.length; h--; ) {
      var k = g[h];
      if ((!0 !== f || !1 !== qg(k)) && k.isVisible()) {
        var l = k;
        k.Hf(a, b, c, d, e) &&
          (null !== b && (l = b(l)),
          null === l || (null !== c && !c(l)) || e.add(l));
      }
    }
    return e;
  };
  t.tv = function (a, b, c, d, e, f, g) {
    if (!1 === this.xi) return e;
    for (var h = this.Ma.m, k = h.length; k--; ) {
      var l = h[k];
      if ((!0 !== g || !1 !== qg(l)) && f(l) && l.isVisible()) {
        var m = l;
        l.Hf(a, b, c, d, e) &&
          (null !== b && (m = b(m)),
          null === m || (null !== c && !c(m)) || e.add(m));
      }
    }
    return e;
  };
  t.vg = function (a, b, c, d, e, f) {
    void 0 === c && (c = null);
    void 0 === d && (d = null);
    void 0 === e && (e = !0);
    if (!1 !== e && !0 !== e) {
      if (e instanceof H || e instanceof I) f = e;
      e = !0;
    }
    f instanceof H || f instanceof I || (f = new I());
    if (!1 === this.xi) return f;
    G &&
      !a.s() &&
      v("findObjectsNear: Point must have a real value, not: " + a.toString());
    var g = !1;
    null !== this.diagram && this.diagram.viewportBounds.ca(a) && (g = !0);
    for (var h = K.alloc(), k = K.alloc(), l = this.Ma.m, m = l.length; m--; ) {
      var n = l[m];
      if ((!0 !== g || !1 !== qg(n)) && n.isVisible()) {
        h.assign(a);
        Lb(h, n.ke);
        k.h(a.x + b, a.y);
        Lb(k, n.ke);
        var p = n;
        n.vg(h, k, c, d, e, f) &&
          (null !== c && (p = c(p)),
          null === p || (null !== d && !d(p)) || f.add(p));
      }
    }
    K.free(h);
    K.free(k);
    return f;
  };
  t.Sd = function (a, b) {
    if (this.visible) {
      var c = this.Ma.m,
        d = c.length;
      if (0 !== d) {
        a = Ma();
        for (var e = Ma(), f = 0; f < d; f++) {
          var g = c[f];
          g.Xw = f;
          if (g instanceof R) {
            if (!1 === g.Bd) continue;
          } else if (g instanceof Je && null !== g.adornedPart) continue;
          var h = g.actualBounds;
          g.isVisible() && lc(h, b)
            ? (g.Sd(!0), a.push(g))
            : (g.Sd(!1),
              null !== g.adornments && 0 < g.adornments.count && e.push(g));
        }
        for (b = 0; b < a.length; b++)
          for (c = a[b], ni(c), c = c.adornments; c.next(); )
            (d = c.value), d.measure(Infinity, Infinity), d.arrange(), d.Sd(!0);
        for (b = 0; b < e.length; b++) ni(e[b]);
        Pa(a);
        Pa(e);
      }
    }
  };
  function oi(a, b) {
    var c = 1;
    1 !== a.tb && ((c = b.globalAlpha), (b.globalAlpha = c * a.tb));
    return c;
  }
  t.uc = function (a, b, c) {
    if (
      this.visible &&
      0 !== this.tb &&
      (void 0 === c && (c = !0), c || !this.isTemporary)
    ) {
      c = this.Ma.m;
      var d = c.length;
      if (0 !== d) {
        var e = oi(this, a),
          f = this.Uo;
        f.length = 0;
        for (var g = b.scale, h = M.alloc(), k = 0; k < d; k++)
          this.Mi(a, c[k], b, f, g, h, !0);
        M.free(h);
        a.globalAlpha = e;
      }
    }
  };
  t.Mi = function (a, b, c, d, e, f, g) {
    if (!g || qg(b)) {
      if (
        null !== d &&
        b instanceof R &&
        (b.isOrthogonal && d.push(b), !1 === b.Bd)
      )
        return;
      g = !1;
      for (d = b.containingGroup; null !== d; )
        g
          ? null !== d.kb && f.jy(d.kb)
          : null !== d.kb && ((g = !0), f.assign(d.kb)),
          (d = d.containingGroup);
      var h = b.actualBounds;
      d = !1;
      if (g && b.isVisible()) {
        if (!f.Sc(h)) return;
        d = !f.Qe(h);
      }
      d &&
        (a.save(),
        a.beginPath(),
        a.rect(f.x, f.y, f.width, f.height),
        a.clip());
      h.width * e > c.Hr || h.height * e > c.Hr
        ? b.uc(a, c)
        : ((e = b.actualBounds),
          (f = b.naturalBounds),
          0 === e.width ||
            0 === e.height ||
            isNaN(e.x) ||
            isNaN(e.y) ||
            !b.isVisible() ||
            ((c = b.transform),
            null !== b.areaBackground &&
              (pi(b, a, b.areaBackground, !0, !0, f, e),
              a.fillRect(e.x, e.y, e.width, e.height)),
            null === b.areaBackground &&
              null === b.background &&
              (pi(b, a, "rgba(0,0,0,0.3)", !0, !1, f, e),
              a.fillRect(e.x, e.y, e.width, e.height)),
            null !== b.background &&
              (a.transform(c.m11, c.m12, c.m21, c.m22, c.dx, c.dy),
              pi(b, a, b.background, !0, !1, f, e),
              a.fillRect(0, 0, f.width / 2, f.height / 2),
              c.Ps() ||
                ((b = 1 / (c.m11 * c.m22 - c.m12 * c.m21)),
                a.transform(
                  c.m22 * b,
                  -c.m12 * b,
                  -c.m21 * b,
                  c.m11 * b,
                  b * (c.m21 * c.dy - c.m22 * c.dx),
                  b * (c.m12 * c.dx - c.m11 * c.dy)
                )))));
      d && (a.restore(), a.Nc(!0));
    }
  };
  t.g = function (a, b, c, d, e) {
    var f = this.diagram;
    null !== f && f.cb(pe, a, this, b, c, d, e);
  };
  t.Wi = function (a, b, c) {
    var d = this.Ma;
    b.mi = this;
    if (a >= d.count) a = d.count;
    else if (d.N(a) === b) return -1;
    d.Cb(a, b);
    b.mq(c);
    d = this.diagram;
    null !== d && (c ? d.R() : d.Wi(b));
    qi(this, a, b);
    return a;
  };
  t.kc = function (a, b, c) {
    if (!c && b.layer !== this && null !== b.layer) return b.layer.kc(a, b, c);
    var d = this.Ma;
    if (0 > a || a >= d.length) {
      if (((a = d.indexOf(b)), 0 > a)) return -1;
    } else if (d.N(a) !== b && ((a = d.indexOf(b)), 0 > a)) return -1;
    b.nq(c);
    d.nb(a);
    d = this.diagram;
    null !== d && (c ? d.R() : d.kc(b));
    b.mi = null;
    return a;
  };
  function qi(a, b, c) {
    b = ri(a, b, c);
    if (c instanceof vf && null !== c && isNaN(c.zOrder)) {
      if (0 !== c.memberParts.count) {
        for (var d = -1, e = a.Ma.m, f = e.length, g = 0; g < f; g++) {
          var h = e[g];
          if (h === c && ((b = g), 0 <= d)) break;
          if (0 > d && h.containingGroup === c && ((d = g), 0 <= b)) break;
        }
        !(0 > d) && d < b && ((e = a.Ma), e.nb(b), e.Cb(d, c));
      }
      c = c.containingGroup;
      null !== c && qi(a, -1, c);
    }
  }
  function ri(a, b, c) {
    var d = c.zOrder;
    if (isNaN(d)) return b;
    a = a.Ma;
    var e = a.count;
    if (1 >= e) return b;
    0 > b && (b = a.indexOf(c));
    if (0 > b) return -1;
    for (var f = b - 1, g = NaN; 0 <= f; ) {
      g = a.N(f).zOrder;
      if (!isNaN(g)) break;
      f--;
    }
    for (var h = b + 1, k = NaN; h < e; ) {
      k = a.N(h).zOrder;
      if (!isNaN(k)) break;
      h++;
    }
    if (!isNaN(g) && g > d)
      for (;;) {
        if (-1 === f || g <= d) {
          f++;
          if (f === b) break;
          a.nb(b);
          a.Cb(f, c);
          return f;
        }
        for (g = NaN; 0 <= --f && ((g = a.N(f).zOrder), isNaN(g)); );
      }
    else if (!isNaN(k) && k < d)
      for (;;) {
        if (h === e || k >= d) {
          h--;
          if (h === b) break;
          a.nb(b);
          a.Cb(h, c);
          return h;
        }
        for (k = NaN; ++h < e && ((k = a.N(h).zOrder), isNaN(k)); );
      }
    return b;
  }
  oa.Object.defineProperties(mi.prototype, {
    parts: {
      configurable: !0,
      get: function () {
        return this.Ma.iterator;
      },
    },
    partsBackwards: {
      configurable: !0,
      get: function () {
        return this.Ma.iteratorBackwards;
      },
    },
    diagram: {
      configurable: !0,
      get: function () {
        return this.G;
      },
    },
    name: {
      configurable: !0,
      get: function () {
        return this.ua;
      },
      set: function (a) {
        A(a, "string", mi, "name");
        var b = this.ua;
        if (b !== a) {
          var c = this.diagram;
          if (null !== c)
            for (
              "" === b && v("Cannot rename default Layer to: " + a),
                c = c.layers;
              c.next();

            )
              c.value.name === a &&
                v("Layer.name is already present in this diagram: " + a);
          this.ua = a;
          this.g("name", b, a);
          for (a = this.Ma.iterator; a.next(); ) a.value.layerName = this.ua;
        }
      },
    },
    opacity: {
      configurable: !0,
      get: function () {
        return this.tb;
      },
      set: function (a) {
        var b = this.tb;
        b !== a &&
          (A(a, "number", mi, "opacity"),
          (0 > a || 1 < a) && Aa(a, "0 <= value <= 1", mi, "opacity"),
          (this.tb = a),
          this.g("opacity", b, a),
          (a = this.diagram),
          null !== a && a.R());
      },
    },
    isTemporary: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        var b = this.o;
        if (b !== a) {
          A(a, "boolean", mi, "isTemporary");
          if ((this.o = a)) this.isInDocumentBounds = !1;
          this.g("isTemporary", b, a);
        }
      },
    },
    visible: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        var b = this.B;
        if (b !== a) {
          A(a, "boolean", mi, "visible");
          this.B = a;
          this.g("visible", b, a);
          for (b = this.Ma.iterator; b.next(); ) b.value.Vb(a);
          a = this.diagram;
          null !== a && a.R();
        }
      },
    },
    pickable: {
      configurable: !0,
      get: function () {
        return this.xi;
      },
      set: function (a) {
        var b = this.xi;
        b !== a &&
          (A(a, "boolean", mi, "pickable"),
          (this.xi = a),
          this.g("pickable", b, a));
      },
    },
    isInDocumentBounds: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.j !== a &&
          ((this.j = a), null !== this.diagram && this.diagram.Wa());
      },
    },
    allowCopy: {
      configurable: !0,
      get: function () {
        return this.jj;
      },
      set: function (a) {
        var b = this.jj;
        b !== a &&
          (A(a, "boolean", mi, "allowCopy"),
          (this.jj = a),
          this.g("allowCopy", b, a));
      },
    },
    allowDelete: {
      configurable: !0,
      get: function () {
        return this.kj;
      },
      set: function (a) {
        var b = this.kj;
        b !== a &&
          (A(a, "boolean", mi, "allowDelete"),
          (this.kj = a),
          this.g("allowDelete", b, a));
      },
    },
    allowTextEdit: {
      configurable: !0,
      get: function () {
        return this.tj;
      },
      set: function (a) {
        var b = this.tj;
        b !== a &&
          (A(a, "boolean", mi, "allowTextEdit"),
          (this.tj = a),
          this.g("allowTextEdit", b, a));
      },
    },
    allowGroup: {
      configurable: !0,
      get: function () {
        return this.lj;
      },
      set: function (a) {
        var b = this.lj;
        b !== a &&
          (A(a, "boolean", mi, "allowGroup"),
          (this.lj = a),
          this.g("allowGroup", b, a));
      },
    },
    allowUngroup: {
      configurable: !0,
      get: function () {
        return this.uj;
      },
      set: function (a) {
        var b = this.uj;
        b !== a &&
          (A(a, "boolean", mi, "allowUngroup"),
          (this.uj = a),
          this.g("allowUngroup", b, a));
      },
    },
    allowLink: {
      configurable: !0,
      get: function () {
        return this.mj;
      },
      set: function (a) {
        var b = this.mj;
        b !== a &&
          (A(a, "boolean", mi, "allowLink"),
          (this.mj = a),
          this.g("allowLink", b, a));
      },
    },
    allowRelink: {
      configurable: !0,
      get: function () {
        return this.oj;
      },
      set: function (a) {
        var b = this.oj;
        b !== a &&
          (A(a, "boolean", mi, "allowRelink"),
          (this.oj = a),
          this.g("allowRelink", b, a));
      },
    },
    allowMove: {
      configurable: !0,
      get: function () {
        return this.nj;
      },
      set: function (a) {
        var b = this.nj;
        b !== a &&
          (A(a, "boolean", mi, "allowMove"),
          (this.nj = a),
          this.g("allowMove", b, a));
      },
    },
    allowReshape: {
      configurable: !0,
      get: function () {
        return this.pj;
      },
      set: function (a) {
        var b = this.pj;
        b !== a &&
          (A(a, "boolean", mi, "allowReshape"),
          (this.pj = a),
          this.g("allowReshape", b, a));
      },
    },
    allowResize: {
      configurable: !0,
      get: function () {
        return this.qj;
      },
      set: function (a) {
        var b = this.qj;
        b !== a &&
          (A(a, "boolean", mi, "allowResize"),
          (this.qj = a),
          this.g("allowResize", b, a));
      },
    },
    allowRotate: {
      configurable: !0,
      get: function () {
        return this.rj;
      },
      set: function (a) {
        var b = this.rj;
        b !== a &&
          (A(a, "boolean", mi, "allowRotate"),
          (this.rj = a),
          this.g("allowRotate", b, a));
      },
    },
    allowSelect: {
      configurable: !0,
      get: function () {
        return this.sj;
      },
      set: function (a) {
        var b = this.sj;
        b !== a &&
          (A(a, "boolean", mi, "allowSelect"),
          (this.sj = a),
          this.g("allowSelect", b, a));
      },
    },
  });
  mi.prototype.findObjectsNear = mi.prototype.vg;
  mi.prototype.findObjectsIn = mi.prototype.Hf;
  mi.prototype.findObjectsAt = mi.prototype.Qi;
  mi.prototype.findObjectAt = mi.prototype.dc;
  mi.className = "Layer";
  function Q(a, b) {
    si || (ti(), (si = !0));
    ab(this);
    xe = this;
    this.wb = !0;
    this.La = null;
    this.Ca = this.Da = 0;
    this.Ia = null;
    if (Wg) {
      var c = this,
        d = function () {
          c.removeEventListener(sa.document, "DOMContentLoaded", d, !1);
          c.setRTL();
        };
      null !== sa.document.body
        ? this.setRTL()
        : c.addEventListener(sa.document, "DOMContentLoaded", d, !1);
    }
    this.Pl = null;
    ui.add("Model", vi);
    var e = this;
    this.Td = function (a) {
      var b = e.partManager;
      if (a.model === b.diagram.model && b.diagram.ba) {
        b.diagram.ba = !1;
        try {
          var c = a.change;
          "" === a.modelChange &&
            c === pe &&
            b.updateDataBindings(a.object, a.propertyName);
        } finally {
          b.diagram.ba = !0;
        }
      }
    };
    this.Rh = function (a) {
      e.partManager.doModelChanged(a);
    };
    this.Fu = this.Iu = null;
    wi(this);
    this.model = xi();
    this.qh = !0;
    yi(this);
    this.layout = new zi();
    this.qh = !1;
    this.Fk = this.Gk = this.Ek = this.Dk = this.JA = this.zk = this.lw = null;
    this.yq = function () {};
    this.preventDefault = null;
    this.eo = !1;
    this.hi = new Ai();
    void 0 !== a &&
      ("string" === typeof a || (sa.Element && a instanceof Element)
        ? Bi(this, a)
        : (b = a));
    this.wb = !1;
    b && this.Km(b);
    return this;
  }
  var Ci, xe;
  function wi(a) {
    a.Ud = new oh();
    a.Ud.Xe(a);
    a.Ab = 17;
    a.jx = !1;
    a.ho = !1;
    a.zu = "default";
    a.Va = new H();
    a.Zy = new xb();
    a.By();
    a.Ay();
    a.tb = 1;
    a.ra = new K(NaN, NaN).freeze();
    a.Bu = new K(NaN, NaN);
    a.Aa = 1;
    a.cr = 1;
    a.Ut = new K(NaN, NaN).freeze();
    a.Vt = NaN;
    a.lu = 1e-4;
    a.hu = 100;
    a.Bb = new Kb();
    a.Xu = new K(NaN, NaN).freeze();
    a.Pt = new M(NaN, NaN, NaN, NaN).freeze();
    a.Yj = new ic(0, 0, 0, 0).freeze();
    a.Zj = $h;
    a.Lu = !1;
    a.wu = null;
    a.Du = null;
    a.Xh = zh;
    a.Yk = gd;
    a.Wg = zh;
    a.tr = gd;
    a.Tt = Fc;
    a.Wt = Fc;
    a.dd = !0;
    a.bo = !1;
    a.ze = new I();
    a.ei = new xb();
    a.Dn = !0;
    a.Mq = 250;
    a.Rk = -1;
    a.Oq = new ic(16, 16, 16, 16).freeze();
    a.pg = !1;
    a.hl = !1;
    a.Ln = !0;
    a.mr = new le();
    a.mr.diagram = a;
    a.mh = new le();
    a.mh.diagram = a;
    a.Kj = new le();
    a.Kj.diagram = a;
    a.Fg = null;
    a.mf = null;
    a.Ou = !1;
    Di(a);
    a.Fi = new I();
    a.cu = !0;
    a.Su = Ei;
    a.Rw = !1;
    a.Uu = Jf;
    a.Ct = "auto";
    a.br = "auto";
    a.Gg = null;
    a.Og = null;
    a.Ig = null;
    a.hh = null;
    a.fh = null;
    a.eh = null;
    a.nu = null;
    a.bh = null;
    a.St = !1;
    a.dh = null;
    a.gh = null;
    a.zh = null;
    a.Jg = null;
    a.ou = !1;
    a.vu = {};
    a.Ml = [null, null];
    a.qh = !1;
    a.lx = !1;
    a.Mu = !1;
    a.Ft = !1;
    a.Tw = !0;
    a.ed = !1;
    a.Hj = !1;
    a.wx = !0;
    a.ye = -2;
    a.kh = new xb();
    a.Yo = new H();
    a.Xg = !1;
    a.Dd = !0;
    a.ot = !0;
    a.jj = !0;
    a.kj = !0;
    a.pt = !1;
    a.qt = !0;
    a.tj = !0;
    a.lj = !0;
    a.uj = !0;
    a.st = !0;
    a.mj = !0;
    a.oj = !0;
    a.nj = !0;
    a.pj = !0;
    a.qj = !0;
    a.rj = !0;
    a.sj = !0;
    a.tt = !0;
    a.vt = !0;
    a.Sw = !1;
    a.ul = !1;
    a.Yn = !0;
    a.Zn = !0;
    a.rt = !0;
    a.ut = !0;
    a.Gu = 16;
    a.Ku = 16;
    a.Yr = !1;
    a.Eu = !1;
    a.Ju = 0;
    a.Hu = 0;
    a.ub = new ic(5).freeze();
    a.kx = new I().freeze();
    a.iu = 999999999;
    a.Pw = new I().freeze();
    a.Dj = !0;
    a.Ej = !0;
    a.Fj = !0;
    a.ff = !1;
    a.$f = !1;
    a.Wh = !0;
    a.bg = !1;
    a.Yy = new I();
    a.Qw = new I();
    a.Ai = null;
    a.Bw = new Gb(8, 8);
    a.Cw = 999;
    a.bx = 1;
    a.mx = 0;
    a.md = {
      scale: 1,
      position: new K(),
      bounds: new M(),
      Gx: new Gb(),
      ty: new Gb(),
      my: !1,
    };
    a.vx = new M(NaN, NaN, NaN, NaN).freeze();
    a.Op = new Gb(NaN, NaN).freeze();
    a.er = new M(NaN, NaN, NaN, NaN).freeze();
    a.du = !1;
    a.jh = new xb();
    var b = new V(),
      c = new Yg();
    c.bind(new Fi("text", "", Ra));
    b.add(c);
    a.Uy = b;
    a.jh.add("", b);
    b = new V();
    c = new Yg();
    c.stroke = "brown";
    c.bind(new Fi("text", "", Ra));
    b.add(c);
    a.jh.add("Comment", b);
    b = new V();
    b.selectable = !1;
    b.avoidable = !1;
    c = new Hf();
    c.figure = "Ellipse";
    c.fill = "black";
    c.stroke = null;
    c.desiredSize = new Gb(3, 3).ia();
    b.add(c);
    a.jh.add("LinkLabel", b);
    a.Cj = new xb();
    b = new vf();
    b.selectionObjectName = "GROUPPANEL";
    b.type = W.Vertical;
    c = new Yg();
    c.font = "bold 12pt sans-serif";
    c.bind(new Fi("text", "", Ra));
    b.add(c);
    c = new W(W.Auto);
    c.name = "GROUPPANEL";
    var d = new Hf();
    d.figure = "Rectangle";
    d.fill = "rgba(128,128,128,0.2)";
    d.stroke = "black";
    c.add(d);
    d = new rg();
    d.padding = new ic(5, 5, 5, 5).ia();
    c.add(d);
    b.add(c);
    a.Sy = b;
    a.Cj.add("", b);
    a.pi = new xb();
    b = new R();
    c = new Hf();
    c.isPanelMain = !0;
    b.add(c);
    c = new Hf();
    c.toArrow = "Standard";
    c.fill = "black";
    c.stroke = null;
    c.strokeWidth = 0;
    b.add(c);
    a.Ty = b;
    a.pi.add("", b);
    b = new R();
    c = new Hf();
    c.isPanelMain = !0;
    c.stroke = "brown";
    b.add(c);
    a.pi.add("Comment", b);
    b = new Je();
    b.type = W.Auto;
    c = new Hf();
    c.fill = null;
    c.stroke = "dodgerblue";
    c.strokeWidth = 3;
    b.add(c);
    c = new rg();
    c.margin = new ic(1.5, 1.5, 1.5, 1.5).ia();
    b.add(c);
    a.pu = b;
    a.Rt = b;
    b = new Je();
    b.type = W.Link;
    c = new Hf();
    c.isPanelMain = !0;
    c.fill = null;
    c.stroke = "dodgerblue";
    c.strokeWidth = 3;
    b.add(c);
    a.fu = b;
    a.ae = null;
    a.rr = !1;
    a.al = null;
    a.partManager = new vi();
    a.toolManager = new Ua();
    a.toolManager.initializeStandardTools();
    a.defaultTool = a.toolManager;
    a.currentTool = a.defaultTool;
    a.Ht = null;
    a.Bn = new Re();
    a.su = null;
    a.tu = null;
    a.ms = !1;
    a.commandHandler = Gi();
    a.ns = !1;
    a.pr = null;
    a.qr = Cb;
    a.tx = !1;
    a.jc = 1;
    a.Bi = null;
    a.Hr = 1;
    a.Kr = 0;
    a.$w = [0, 0, 0, 0, 0];
    a.Lr = 0;
    a.Cr = 1;
    a.Vw = 0;
    a.Ww = new K();
    a.fz = 500;
    a.Nq = new K();
    a.bu = !1;
  }
  Q.prototype.clear = function () {
    this.animationManager.wc();
    this.model.clear();
    Hi = null;
    Ii = "";
    Ji(this, !1);
    this.Yo.clear();
    Ki();
    this.kh.clear();
    this.Ai = null;
    this.Wa();
    this.Za();
    this.R();
  };
  function Ji(a, b) {
    a.animationManager.wc(!0);
    a.kx = new I().freeze();
    a.Pw = new I().freeze();
    var c = a.skipsUndoManager,
      d = null !== a.ac && void 0 !== a.ac;
    d && (a.skipsUndoManager = !0);
    var e = null;
    null !== a.ae && ((e = a.ae.part), null !== e && a.remove(e));
    var f = [],
      g = a.Va.length;
    if (b) {
      for (b = 0; b < g; b++)
        for (var h = a.Va.m[b].parts; h.next(); ) {
          var k = h.value;
          k !== e && null === k.data && f.push(k);
        }
      for (b = 0; b < f.length; b++) a.remove(f[b]);
    }
    for (b = 0; b < g; b++) a.Va.m[b].clear();
    a.partManager.clear();
    a.ze.clear();
    a.ei.clear();
    a.Fi.clear();
    a.al = null;
    a.Yo.clear();
    Ki();
    a.kh.clear();
    Oa = [];
    null !== e && (a.add(e), a.partManager.parts.remove(e));
    d && (a.skipsUndoManager = c);
    return f;
  }
  function Gi() {
    return null;
  }
  Q.prototype.reset = function () {
    this.clear();
    this.wb = !0;
    wi(this);
    Li(this);
    this.qh = !0;
    yi(this);
    this.layout = new zi();
    this.qh = !1;
    this.model = xi();
    this.model.undoManager = new ue();
    this.wb = this.eo = !1;
    this.R();
  };
  Q.prototype.setRTL = function (a) {
    a = void 0 === a ? this.div : a;
    null === a && (a = sa.document.body);
    var b = wa("div");
    b.dir = "rtl";
    b.style.cssText =
      "font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;";
    b.textContent = "A";
    a.appendChild(b);
    var c = "reverse";
    0 < b.scrollLeft
      ? (c = "default")
      : ((b.scrollLeft = 1), 0 === b.scrollLeft && (c = "negative"));
    a.removeChild(b);
    this.zu = c;
  };
  Q.prototype.setScrollWidth = function (a) {
    a = void 0 === a ? this.div : a;
    null === a && (a = sa.document.body);
    var b = 0;
    if (Wg) {
      var c = Mi;
      b = Ci;
      null === c &&
        ((c = Mi = wa("p")),
        (c.style.width = "100%"),
        (c.style.height = "200px"),
        (c.style.boxSizing = "content-box"),
        (b = Ci = wa("div")),
        (b.style.position = "absolute"),
        (b.style.visibility = "hidden"),
        (b.style.width = "200px"),
        (b.style.height = "150px"),
        (b.style.boxSizing = "content-box"),
        b.appendChild(c));
      b.style.overflow = "hidden";
      a.appendChild(b);
      var d = c.offsetWidth;
      b.style.overflow = "scroll";
      c = c.offsetWidth;
      d === c && (c = b.clientWidth);
      a.removeChild(b);
      b = d - c;
      0 !== b || $a || (b = 11);
    }
    this.Ab = b;
    this.jx = !0;
  };
  Q.prototype.pb = function (a) {
    a.classType === Q ? (this.autoScale = a) : Ea(this, a);
  };
  Q.prototype.toString = function (a) {
    void 0 === a && (a = 0);
    var b = "";
    this.div && this.div.id && (b = this.div.id);
    b = 'Diagram "' + b + '"';
    if (0 >= a) return b;
    for (var c = this.Va.iterator; c.next(); )
      b += "\n  " + c.value.toString(a - 1);
    return b;
  };
  Q.prototype.addEventListener = function (a, b, c, d) {
    a.addEventListener(b, c, { capture: d, passive: !1 });
  };
  Q.prototype.removeEventListener = function (a, b, c, d) {
    a.removeEventListener(b, c, { capture: d });
  };
  function Ni(a) {
    var b = a.Ia.Sa;
    b instanceof HTMLCanvasElement &&
      (a.addEventListener(b, "pointerdown", a.Dk, !1),
      a.addEventListener(b, "pointermove", a.Ek, !1),
      a.addEventListener(b, "pointerup", a.Gk, !1),
      a.addEventListener(b, "pointerout", a.Fk, !1),
      a.addEventListener(b, "pointerenter", a.Jz, !1),
      a.addEventListener(b, "pointerleave", a.Kz, !1),
      a.addEventListener(b, "wheel", a.zk, !1),
      a.addEventListener(b, "keydown", a.zA, !1),
      a.addEventListener(b, "keyup", a.AA, !1),
      a.addEventListener(b, "blur", a.vz, !1),
      a.addEventListener(b, "focus", a.wz, !1),
      a.addEventListener(
        b,
        "selectstart",
        function (a) {
          a.preventDefault();
          return !1;
        },
        !1
      ),
      a.addEventListener(
        b,
        "contextmenu",
        function (a) {
          a.preventDefault();
          return !1;
        },
        !1
      ),
      a.addEventListener(sa, "resize", a.lw, !1),
      $a &&
        a.addEventListener(
          b,
          "touchstart",
          function (a) {
            a.preventDefault();
          },
          !1
        ));
  }
  function Xe(a) {
    30 < a.Kr && (a.Bi = 1);
  }
  function ff(a, b) {
    null !== a.Bi &&
      ((a.Bi = null),
      b && a.yq(),
      (G && G.Qx) || ((a.Kr = 0), (a.$w = [0, 0, 0, 0, 0]), (a.Lr = 0)));
  }
  Q.prototype.computePixelRatio = function () {
    return null !== this.Bi ? this.Bi : sa.devicePixelRatio || 1;
  };
  Q.prototype.doMouseMove = function () {
    this.currentTool.doMouseMove();
  };
  Q.prototype.doMouseDown = function () {
    this.currentTool.doMouseDown();
  };
  Q.prototype.doMouseUp = function () {
    this.currentTool.doMouseUp();
  };
  Q.prototype.doMouseWheel = function () {
    this.currentTool.doMouseWheel();
  };
  Q.prototype.doKeyDown = function () {
    this.currentTool.doKeyDown();
  };
  Q.prototype.doKeyUp = function () {
    this.currentTool.doKeyUp();
  };
  Q.prototype.doFocus = function () {
    this.focus();
  };
  Q.prototype.focus = function () {
    if (this.Ia)
      if (this.scrollsPageOnFocus) this.Ia.focus();
      else {
        var a = sa.scrollX || sa.pageXOffset,
          b = sa.scrollY || sa.pageYOffset;
        this.Ia.focus();
        sa.scrollTo(a, b);
      }
  };
  Q.prototype.wz = function () {
    this.G.V("GainedFocus");
  };
  Q.prototype.vz = function () {
    this.G.V("LostFocus");
  };
  function Ah(a) {
    if (null !== a.Ia) {
      var b = a.La;
      if (null !== b && 0 !== b.clientWidth && 0 !== b.clientHeight) {
        a.jx || a.setScrollWidth();
        var c = a.$f ? a.Ab : 0,
          d = a.ff ? a.Ab : 0,
          e = a.jc;
        a.jc = a.computePixelRatio();
        a.jc !== e && ((a.bo = !0), a.Ob());
        if (b.clientWidth !== a.Da + c || b.clientHeight !== a.Ca + d)
          (a.Ej = !0),
            (a.dd = !0),
            (b = a.layout),
            null !== b &&
              b.isViewportSized &&
              a.autoScale === zh &&
              ((a.hl = !0), b.F()),
            a.ed || a.Ob();
      }
    }
  }
  function yi(a) {
    var b = new mi();
    b.name = "Background";
    a.dm(b);
    b = new mi();
    b.name = "";
    a.dm(b);
    b = new mi();
    b.name = "Foreground";
    a.dm(b);
    b = new mi();
    b.name = "Adornment";
    b.isTemporary = !0;
    b.isInDocumentBounds = !1;
    a.dm(b);
    b = new mi();
    b.name = "Tool";
    b.isTemporary = !0;
    b.isInDocumentBounds = !0;
    a.dm(b);
    b = new mi();
    b.name = "Grid";
    b.allowSelect = !1;
    b.pickable = !1;
    b.isTemporary = !0;
    b.isInDocumentBounds = !1;
    a.zx(b, a.qk("Background"));
  }
  function Oi(a) {
    var b = new W(W.Grid);
    b.name = "GRID";
    var c = new Hf();
    c.figure = "LineH";
    c.stroke = "lightgray";
    c.strokeWidth = 0.5;
    c.interval = 1;
    b.add(c);
    c = new Hf();
    c.figure = "LineH";
    c.stroke = "gray";
    c.strokeWidth = 0.5;
    c.interval = 5;
    b.add(c);
    c = new Hf();
    c.figure = "LineH";
    c.stroke = "gray";
    c.strokeWidth = 1;
    c.interval = 10;
    b.add(c);
    c = new Hf();
    c.figure = "LineV";
    c.stroke = "lightgray";
    c.strokeWidth = 0.5;
    c.interval = 1;
    b.add(c);
    c = new Hf();
    c.figure = "LineV";
    c.stroke = "gray";
    c.strokeWidth = 0.5;
    c.interval = 5;
    b.add(c);
    c = new Hf();
    c.figure = "LineV";
    c.stroke = "gray";
    c.strokeWidth = 1;
    c.interval = 10;
    b.add(c);
    c = new U();
    c.add(b);
    c.layerName = "Grid";
    c.zOrder = 0;
    c.isInDocumentBounds = !1;
    c.isAnimated = !1;
    c.pickable = !1;
    c.locationObjectName = "GRID";
    a.add(c);
    a.partManager.parts.remove(c);
    b.visible = !1;
    return b;
  }
  function aj() {
    this.G.Eu
      ? (this.G.Eu = !1)
      : this.G.isEnabled
      ? this.G.Mx(this)
      : bj(this.G);
  }
  function cj(a) {
    this.G.isEnabled
      ? ((this.G.Ju = a.target.scrollTop), (this.G.Hu = a.target.scrollLeft))
      : bj(this.G);
  }
  Q.prototype.Mx = function (a) {
    if (null !== this.Ia) {
      var b = this.Iu,
        c = this.Fu;
      this.Yr = !0;
      var d = this.documentBounds,
        e = this.viewportBounds,
        f = this.Yj,
        g = d.x - f.left,
        h = d.y - f.top,
        k = d.width + f.left + f.right,
        l = d.height + f.top + f.bottom,
        m = d.right + f.right;
      f = d.bottom + f.bottom;
      var n = e.x;
      d = e.y;
      var p = e.width,
        r = e.height,
        q = e.right,
        u = e.bottom;
      e = this.scale;
      var w = a.scrollLeft;
      if (this.ho)
        switch (this.zu) {
          case "negative":
            w = w + a.scrollWidth - a.clientWidth;
            break;
          case "reverse":
            w = a.scrollWidth - w - a.clientWidth;
        }
      var y = w;
      p < k || r < l
        ? ((w = K.allocAt(this.position.x, this.position.y)),
          this.allowHorizontalScroll &&
            this.Hu !== y &&
            ((w.x = y / e + g), (this.Hu = y)),
          this.allowVerticalScroll &&
            this.Ju !== a.scrollTop &&
            ((w.y = a.scrollTop / e + h), (this.Ju = a.scrollTop)),
          (this.position = w),
          K.free(w),
          (this.Ej = this.Yr = !1))
        : ((w = K.alloc()),
          a.az &&
            this.allowHorizontalScroll &&
            (g < n && (this.position = w.h(y + g, this.position.y)),
            m > q &&
              (this.position = w.h(
                -(b.scrollWidth - this.Da) + y - this.Da / e + m,
                this.position.y
              ))),
          a.bz &&
            this.allowVerticalScroll &&
            (h < d && (this.position = w.h(this.position.x, a.scrollTop + h)),
            f > u &&
              (this.position = w.h(
                this.position.x,
                -(b.scrollHeight - this.Ca) + a.scrollTop - this.Ca / e + f
              ))),
          K.free(w),
          dj(this),
          (this.Ej = this.Yr = !1),
          (d = this.documentBounds),
          (e = this.viewportBounds),
          (m = d.right),
          (q = e.right),
          (f = d.bottom),
          (u = e.bottom),
          (g = d.x),
          (n = e.x),
          (h = d.y),
          (d = e.y),
          p >= k && g >= n && m <= q && (c.style.width = "1px"),
          r >= l && h >= d && f <= u && (c.style.height = "1px"));
    }
  };
  Q.prototype.computeBounds = function (a) {
    void 0 === a && (a = new M());
    uh(this);
    return ej(this, a);
  };
  function ej(a, b) {
    if (a.fixedBounds.s()) return b.assign(a.fixedBounds), b.Up(a.ub), b;
    for (var c = !0, d = a.Va.m, e = d.length, f = 0; f < e; f++) {
      var g = d[f];
      if (g.visible && g.isInDocumentBounds) {
        g = g.Ma.m;
        for (var h = g.length, k = 0; k < h; k++) {
          var l = g[k];
          l.isInDocumentBounds &&
            l.isVisible() &&
            ((l = l.actualBounds),
            l.s() && (c ? ((c = !1), b.assign(l)) : b.Xc(l)));
        }
      }
    }
    c && b.h(0, 0, 0, 0);
    b.Up(a.ub);
    return b;
  }
  Q.prototype.computePartsBounds = function (a, b) {
    void 0 === b && (b = !1);
    var c = null;
    if (Ha(a))
      for (var d = 0; d < a.length; d++) {
        var e = a[d];
        (!b && e instanceof R) ||
          (e.Za(),
          null === c ? (c = e.actualBounds.copy()) : c.Xc(e.actualBounds));
      }
    else
      for (a = a.iterator; a.next(); )
        (d = a.value),
          (!b && d instanceof R) ||
            (d.Za(),
            null === c ? (c = d.actualBounds.copy()) : c.Xc(d.actualBounds));
    return null === c ? new M(NaN, NaN, 0, 0) : c;
  };
  function fj(a, b) {
    if ((b || a.bg) && !a.wb && null !== a.Ia && a.documentBounds.s()) {
      if (b) {
        var c = a.initialPosition;
        if (c.s()) {
          a.position = c;
          return;
        }
        c = K.alloc();
        c.cj(a.documentBounds, a.initialDocumentSpot);
        var d = a.viewportBounds;
        d = M.allocAt(0, 0, d.width, d.height);
        var e = K.alloc();
        e.cj(d, a.initialViewportSpot);
        e.h(c.x - e.x, c.y - e.y);
        a.position = e;
        M.free(d);
        K.free(e);
        K.free(c);
      }
      a.wb = !0;
      c = a.Xh;
      b && a.Wg !== zh && (c = a.Wg);
      var f = c !== zh ? gj(a, c) : a.scale;
      c = a.ra.x;
      d = a.ra.y;
      e = a.Da / f;
      var g = a.Ca / f,
        h = a.Yk,
        k = a.tr;
      b && !h.ib() && (k.ib() || k.Nb()) && (h = k.Nb() ? Kc : k);
      hj(a, a.documentBounds, e, g, h, b);
      b = a.scale;
      a.scale = f;
      a.wb = !1;
      ij(a);
      jj(a, !0, !1);
      f = a.viewportBounds;
      if (!(L.C(f.I, c) && L.C(f.J, d) && L.C(f.fa, e) && L.C(f.ea, g)))
        a.onViewportBoundsChanged(new M(c, d, e, g), f, b, !1);
    }
  }
  function gj(a, b) {
    var c = a.cr;
    if (null === a.Ia) return c;
    a.Za();
    var d = a.documentBounds;
    if (!d.s()) return c;
    var e = d.width;
    d = d.height;
    var f = a.Da + (a.$f ? a.Ab : 0),
      g = a.Ca + (a.ff ? a.Ab : 0),
      h = f / e,
      k = g / d;
    return b === kj
      ? ((b = Math.min(k, h)),
        b > c && (b = c),
        b < a.minScale && (b = a.minScale),
        b > a.maxScale && (b = a.maxScale),
        b)
      : b === lj
      ? ((b = k > h ? (g - a.Ab) / d : (f - a.Ab) / e),
        b > c && (b = c),
        b < a.minScale && (b = a.minScale),
        b > a.maxScale && (b = a.maxScale),
        b)
      : a.scale;
  }
  Q.prototype.zoomToFit = function () {
    var a = this.Zj;
    this.Zj = $h;
    this.scale = gj(this, kj);
    a !== $h &&
      (fj(this, !1),
      hj(
        this,
        this.documentBounds,
        this.Da / this.Aa,
        this.Ca / this.Aa,
        this.Yk,
        !1
      ));
    this.Zj = a;
  };
  t = Q.prototype;
  t.lB = function (a, b) {
    void 0 === b && (b = kj);
    var c = a.width,
      d = a.height;
    if (!(0 === c || 0 === d || (isNaN(c) && isNaN(d)))) {
      var e = 1;
      if (b === kj || b === lj)
        if (isNaN(c)) e = (this.viewportBounds.height * this.scale) / d;
        else if (isNaN(d)) e = (this.viewportBounds.width * this.scale) / c;
        else {
          e = this.Da;
          var f = this.Ca;
          e =
            b === lj
              ? f / d > e / c
                ? (f - (this.ff ? this.Ab : 0)) / d
                : (e - (this.$f ? this.Ab : 0)) / c
              : Math.min(f / d, e / c);
        }
      this.scale = e;
      this.position = new K(a.x, a.y);
    }
  };
  t.nz = function (a, b) {
    this.Za();
    var c = this.documentBounds,
      d = this.viewportBounds;
    this.position = new K(
      c.x + (a.x * c.width + a.offsetX) - (b.x * d.width - b.offsetX),
      c.y + (a.y * c.height + a.offsetY) - (b.y * d.height - b.offsetY)
    );
  };
  t.iA = function (a) {
    if (a instanceof O) {
      this.pr = a;
      var b = K.alloc();
      this.qr = this.Gq(a.ka(Fc, b));
      K.free(b);
    } else (this.pr = null), (this.qr = Cb);
  };
  function hj(a, b, c, d, e, f) {
    var g = K.allocAt(a.ra.x, a.ra.y),
      h = g.x,
      k = g.y;
    if (null !== a.pr) {
      var l = K.alloc();
      l = a.pr.ka(Fc, l);
      h = l.x - a.qr.x / a.scale;
      k = l.y - a.qr.y / a.scale;
      e = Ec;
      K.free(l);
    }
    if (f || a.scrollMode === $h)
      e.ib() &&
        (c > b.width &&
          (h = b.x + (e.x * b.width + e.offsetX) - (e.x * c - e.offsetX)),
        d > b.height &&
          (k = b.y + (e.y * b.height + e.offsetY) - (e.y * d - e.offsetY))),
        (e = a.Yj),
        (f = c - b.width),
        c < b.width + e.left + e.right
          ? ((h = Math.min(h + c / 2, b.right + Math.max(f, e.right) - c / 2)),
            (h = Math.max(h, b.left - Math.max(f, e.left) + c / 2)),
            (h -= c / 2))
          : h > b.left
          ? (h = b.left)
          : h < b.right - c && (h = b.right - c),
        (c = d - b.height),
        d < b.height + e.top + e.bottom
          ? ((k = Math.min(
              k + d / 2,
              b.bottom + Math.max(c, e.bottom) - d / 2
            )),
            (k = Math.max(k, b.top - Math.max(c, e.top) + d / 2)),
            (k -= d / 2))
          : k > b.top
          ? (k = b.top)
          : k < b.bottom - d && (k = b.bottom - d);
    g.x = isFinite(h) ? h : -a.ub.left;
    g.y = isFinite(k) ? k : -a.ub.top;
    null !== a.positionComputation &&
      ((b = a.positionComputation(a, g)), (g.x = b.x), (g.y = b.y));
    Wh(a.Ud, a.ra, g);
    a.ra.h(g.x, g.y);
    Li(a);
    K.free(g);
  }
  t.lm = function (a, b) {
    void 0 === b && (b = !0);
    if (b) {
      if (
        ((a = wf(
          this,
          a,
          function (a) {
            return a.part;
          },
          function (a) {
            return a.canSelect();
          }
        )),
        a instanceof U)
      )
        return a;
    } else if (
      ((a = wf(this, a, function (a) {
        return a.part;
      })),
      a instanceof U)
    )
      return a;
    return null;
  };
  t.dc = function (a, b, c) {
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    uh(this);
    for (var d = this.Va.iteratorBackwards; d.next(); ) {
      var e = d.value;
      if (e.visible && ((e = e.dc(a, b, c)), null !== e)) return e;
    }
    return null;
  };
  function wf(a, b, c, d) {
    void 0 === c && (c = null);
    void 0 === d && (d = null);
    uh(a);
    for (a = a.Va.iteratorBackwards; a.next(); ) {
      var e = a.value;
      if (e.visible && !e.isTemporary && ((e = e.dc(b, c, d)), null !== e))
        return e;
    }
    return null;
  }
  t.Wz = function (a, b, c) {
    void 0 === b && (b = !0);
    return mj(
      this,
      a,
      function (a) {
        return a.part;
      },
      b
        ? function (a) {
            return a instanceof U && a.canSelect();
          }
        : null,
      c
    );
  };
  function mj(a, b, c, d, e) {
    void 0 === c && (c = null);
    void 0 === d && (d = null);
    e instanceof H || e instanceof I || (e = new I());
    uh(a);
    for (a = a.Va.iteratorBackwards; a.next(); ) {
      var f = a.value;
      f.visible && !f.isTemporary && f.Qi(b, c, d, e);
    }
    return e;
  }
  t.Qi = function (a, b, c, d) {
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    d instanceof H || d instanceof I || (d = new I());
    uh(this);
    for (var e = this.Va.iteratorBackwards; e.next(); ) {
      var f = e.value;
      f.visible && f.Qi(a, b, c, d);
    }
    return d;
  };
  t.Wx = function (a, b, c, d) {
    void 0 === b && (b = !1);
    void 0 === c && (c = !0);
    return nj(
      this,
      a,
      function (a) {
        return a instanceof U && (!c || a.canSelect());
      },
      b,
      d
    );
  };
  t.Hf = function (a, b, c, d, e) {
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    void 0 === d && (d = !1);
    e instanceof H || e instanceof I || (e = new I());
    uh(this);
    for (var f = this.Va.iteratorBackwards; f.next(); ) {
      var g = f.value;
      g.visible && g.Hf(a, b, c, d, e);
    }
    return e;
  };
  t.tv = function (a, b, c, d, e, f) {
    var g = new I();
    uh(this);
    for (var h = this.Va.iteratorBackwards; h.next(); ) {
      var k = h.value;
      k.visible && k.tv(a, b, c, d, g, e, f);
    }
    return g;
  };
  function nj(a, b, c, d, e) {
    var f = null;
    void 0 === f && (f = null);
    void 0 === c && (c = null);
    void 0 === d && (d = !1);
    e instanceof H || e instanceof I || (e = new I());
    uh(a);
    for (a = a.Va.iteratorBackwards; a.next(); ) {
      var g = a.value;
      g.visible && !g.isTemporary && g.Hf(b, f, c, d, e);
    }
    return e;
  }
  t.Xz = function (a, b, c, d, e) {
    void 0 === c && (c = !0);
    void 0 === d && (d = !0);
    return oj(
      this,
      a,
      b,
      function (a) {
        return a instanceof U && (!d || a.canSelect());
      },
      c,
      e
    );
  };
  t.vg = function (a, b, c, d, e, f) {
    void 0 === c && (c = null);
    void 0 === d && (d = null);
    void 0 === e && (e = !0);
    if (!1 !== e && !0 !== e) {
      if (e instanceof H || e instanceof I) f = e;
      e = !0;
    }
    f instanceof H || f instanceof I || (f = new I());
    uh(this);
    for (var g = this.Va.iteratorBackwards; g.next(); ) {
      var h = g.value;
      h.visible && h.vg(a, b, c, d, e, f);
    }
    return f;
  };
  function oj(a, b, c, d, e, f) {
    var g = null;
    void 0 === g && (g = null);
    void 0 === d && (d = null);
    void 0 === e && (e = !0);
    if (!1 !== e && !0 !== e) {
      if (e instanceof H || e instanceof I) f = e;
      e = !0;
    }
    f instanceof H || f instanceof I || (f = new I());
    uh(a);
    for (a = a.Va.iteratorBackwards; a.next(); ) {
      var h = a.value;
      h.visible && !h.isTemporary && h.vg(b, c, g, d, e, f);
    }
    return f;
  }
  Q.prototype.acceptEvent = function (a) {
    return pj(this, a, a instanceof MouseEvent);
  };
  function pj(a, b, c) {
    var d = a.mh;
    a.mh = a.Kj;
    a.Kj = d;
    d.diagram = a;
    d.event = b;
    c
      ? qj(a, b, d)
      : ((d.viewPoint = a.mh.viewPoint),
        (d.documentPoint = a.mh.documentPoint));
    a = 0;
    b.ctrlKey && (a += 1);
    b.altKey && (a += 2);
    b.shiftKey && (a += 4);
    b.metaKey && (a += 8);
    d.modifiers = a;
    d.button = b.button;
    void 0 !== b.buttons && (d.buttons = b.buttons);
    $a && 0 === b.button && b.ctrlKey && (d.button = 2);
    d.down = !1;
    d.up = !1;
    d.clickCount = 1;
    d.delta = 0;
    d.handled = !1;
    d.bubbles = !1;
    d.timestamp = b.timeStamp;
    d.isMultiTouch = !1;
    d.targetDiagram = rj(b, b.target);
    d.targetObject = null;
    return d;
  }
  function rj(a, b) {
    if (null === b) return null;
    if ((b = b.G)) return b;
    (b = a.path) ||
      "function" !== typeof a.composedPath ||
      (b = a.composedPath());
    return b && b[0] && b[0].G ? b[0].G : null;
  }
  function sj(a, b, c, d, e, f) {
    var g = a.mh;
    a.mh = a.Kj;
    a.Kj = g;
    g.diagram = a;
    g.clickCount = 1;
    a = g.delta = 0;
    b.ctrlKey && (a += 1);
    b.altKey && (a += 2);
    b.shiftKey && (a += 4);
    b.metaKey && (a += 8);
    g.modifiers = a;
    g.event = b;
    g.timestamp = b.timeStamp;
    g.button = b.button;
    g.buttons = b.buttons;
    $a && 0 === b.button && b.ctrlKey && (g.button = 2);
    g.down = c;
    g.up = d;
    g.handled = !1;
    g.bubbles = e;
    g.isMultiTouch = f;
    return g;
  }
  function tj(a, b, c) {
    if (b.bubbles)
      return G && G.iy && Fa("NOT handled " + c.type + " " + b.toString()), !0;
    G &&
      G.iy &&
      Fa("handled " + c.type + " " + a.currentTool.name + " " + b.toString());
    void 0 !== c.stopPropagation && c.stopPropagation();
    !1 !== c.cancelable && c.preventDefault();
    c.cancelBubble = !0;
    return !1;
  }
  Q.prototype.zA = function (a) {
    var b = this.G;
    if (!this.G.isEnabled) return !1;
    var c = pj(b, a, !1);
    c.key = String.fromCharCode(a.which);
    c.down = !0;
    switch (a.which) {
      case 8:
        c.key = "Backspace";
        break;
      case 33:
        c.key = "PageUp";
        break;
      case 34:
        c.key = "PageDown";
        break;
      case 35:
        c.key = "End";
        break;
      case 36:
        c.key = "Home";
        break;
      case 37:
        c.key = "Left";
        break;
      case 38:
        c.key = "Up";
        break;
      case 39:
        c.key = "Right";
        break;
      case 40:
        c.key = "Down";
        break;
      case 45:
        c.key = "Insert";
        break;
      case 46:
        c.key = "Del";
        break;
      case 48:
        c.key = "0";
        break;
      case 187:
      case 61:
      case 107:
        c.key = "Add";
        break;
      case 189:
      case 173:
      case 109:
        c.key = "Subtract";
        break;
      case 27:
        c.key = "Esc";
    }
    b.doKeyDown();
    return tj(b, c, a);
  };
  Q.prototype.AA = function (a) {
    var b = this.G;
    if (!b.isEnabled) return !1;
    var c = pj(b, a, !1);
    c.key = String.fromCharCode(a.which);
    c.up = !0;
    switch (a.which) {
      case 8:
        c.key = "Backspace";
        break;
      case 33:
        c.key = "PageUp";
        break;
      case 34:
        c.key = "PageDown";
        break;
      case 35:
        c.key = "End";
        break;
      case 36:
        c.key = "Home";
        break;
      case 37:
        c.key = "Left";
        break;
      case 38:
        c.key = "Up";
        break;
      case 39:
        c.key = "Right";
        break;
      case 40:
        c.key = "Down";
        break;
      case 45:
        c.key = "Insert";
        break;
      case 46:
        c.key = "Del";
    }
    b.doKeyUp();
    return tj(b, c, a);
  };
  Q.prototype.Jz = function (a) {
    var b = this.G;
    if (!b.isEnabled) return !1;
    var c = pj(b, a, !0);
    null !== b.mouseEnter && b.mouseEnter(c);
    return tj(b, c, a);
  };
  Q.prototype.Kz = function (a) {
    var b = this.G;
    if (!b.isEnabled) return !1;
    var c = pj(b, a, !0);
    null !== b.mouseLeave && b.mouseLeave(c);
    return tj(b, c, a);
  };
  Q.prototype.getMouse = function (a) {
    var b = this.Ia;
    if (null === b) return new K(0, 0);
    var c = b.getBoundingClientRect();
    b = a.clientX - (this.Da / c.width) * c.left;
    a = a.clientY - (this.Ca / c.height) * c.top;
    return null !== this.Bb ? Lb(new K(b, a), this.Bb) : new K(b, a);
  };
  function qj(a, b, c) {
    var d = a.Ia,
      e = a.Da,
      f = a.Ca,
      g = 0,
      h = 0;
    null !== d &&
      ((d = d.getBoundingClientRect()),
      (g = b.clientX - (e / d.width) * d.left),
      (h = b.clientY - (f / d.height) * d.top));
    c.viewPoint.h(g, h);
    null !== a.Bb
      ? ((b = K.allocAt(g, h)),
        a.Bb.Od(b),
        c.documentPoint.assign(b),
        K.free(b))
      : c.documentPoint.h(g, h);
  }
  function me(a, b, c, d) {
    if (void 0 !== b.targetTouches) {
      if (2 > b.targetTouches.length) return;
      b = b.targetTouches[c];
    } else if (null !== a.Ml[0]) b = a.Ml[c];
    else return;
    c = a.Ia;
    null !== c &&
      ((c = c.getBoundingClientRect()),
      d.h(
        b.clientX - (a.Da / c.width) * c.left,
        b.clientY - (a.Ca / c.height) * c.top
      ));
  }
  Q.prototype.Wa = function () {
    this.Dj || ((this.Dj = !0), this.Ob(!0));
  };
  function uj(a) {
    a.ed || uh(a);
    a.Za();
  }
  Q.prototype.redraw = function () {
    this.wb || this.ed || (this.R(), ij(this), this.pd());
  };
  t = Q.prototype;
  t.yA = function () {
    return this.pg;
  };
  t.Ez = function (a) {
    void 0 === a && (a = null);
    var b = this.animationManager,
      c = b.isEnabled;
    b.wc();
    b.isEnabled = !1;
    Ef(this);
    this.bg = !1;
    this.Bu = new K(NaN, NaN);
    b.isEnabled = c;
    this.ed = !0;
    var d = this;
    null !== a &&
      va(function () {
        d.ed = !1;
        th(b, "Model");
        a(d);
      }, 1);
  };
  t.Ob = function (a) {
    void 0 === a && (a = !1);
    if (!0 !== this.pg && !(this.wb || (!1 === a && this.ed))) {
      this.pg = !0;
      var b = this;
      sa.requestAnimationFrame(function () {
        b.pg && b.pd();
      });
    }
  };
  t.pd = function () {
    if (!this.Ln || this.pg) this.Ln && (this.Ln = !1), Ef(this);
  };
  function jj(a, b, c) {
    a.animationManager.defaultAnimation.isAnimating ||
      a.wb ||
      !a.Ej ||
      bj(a) ||
      (b && uh(a), c && fj(a, !1));
  }
  function Ef(a, b) {
    if (!a.ed && ((a.pg = !1), null !== a.La || a.Op.s())) {
      a.ed = !0;
      var c = a.animationManager,
        d = a.Yo;
      if (!c.isAnimating && 0 !== d.length) {
        for (var e = d.m, f = e.length, g = 0; g < f; g++) {
          var h = e[g];
          vj(h, !1);
          h.v();
        }
        d.clear();
      }
      d = a.Qw;
      0 < d.count &&
        (d.each(function (a) {
          a.kw();
        }),
        d.clear());
      e = d = !1;
      c.defaultAnimation.isAnimating &&
        ((e = !0), (d = a.skipsUndoManager), (a.skipsUndoManager = !0));
      c.zb || Ah(a);
      jj(a, !1, !0);
      null !== a.ae &&
        (a.ae.visible && !a.rr && (wj(a), (a.rr = !0)),
        !a.ae.visible && a.rr && (a.rr = !1));
      uh(a);
      f = !1;
      if (!a.bg || a.Wh)
        a.bg
          ? xj(a, !a.hl)
          : (a.Fa("Initial Layout"), !1 === c.isEnabled && c.wc(), xj(a, !1)),
          (f = !0);
      a.hl = !1;
      uh(a);
      a.Mu || uj(a);
      jj(a, !0, !1);
      g = !1;
      f
        ? ((c = M.alloc()),
          c.assign(a.viewportBounds),
          a.bg ||
            ((g = a.bg = !0),
            a.skipsUndoManager || (a.undoManager.isPendingClear = !0),
            (a.undoManager.isPendingUnmodified = !0),
            yj(a)),
          a.V("LayoutCompleted"),
          c.D(a.viewportBounds) || jj(a, !0, !1),
          M.free(c))
        : c.nl &&
          c.ux &&
          (a.Wg !== zh
            ? (a.scale = gj(a, a.Wg))
            : a.Xh !== zh
            ? (a.scale = gj(a, a.Xh))
            : ((c = a.initialScale), isFinite(c) && 0 < c && (a.scale = c)),
          fj(a, !0));
      uh(a);
      f && g && a.gb("Initial Layout");
      a.ev();
      b || a.uc(a.$b);
      e && (a.skipsUndoManager = d);
      a.ed = !1;
    }
  }
  function yj(a) {
    var b = a.Aa;
    if (a.Wg !== zh) a.scale = gj(a, a.Wg);
    else if (a.Xh !== zh) a.scale = gj(a, a.Xh);
    else {
      var c = a.initialScale;
      isFinite(c) && 0 < c && (a.scale = c);
    }
    a.Aa !== b && (ij(a), jj(a, !0, !1));
    fj(a, !0);
    b = a.Va.m;
    a.Sd(b, b.length, a, a.viewportBounds);
    a.V("InitialLayoutCompleted");
    a.Bu.assign(a.ra);
    wj(a);
  }
  function uh(a) {
    if (0 !== a.ze.count && (a.ed || !a.animationManager.isTicking)) {
      for (var b = 0; 23 > b; b++) {
        var c = a.ze.iterator;
        if (null === c || 0 === a.ze.count) break;
        a.ze = new I();
        a.kw(c, a.ze);
        G && 22 === b && Fa("failure to validate parts");
      }
      a.nodes.each(function (a) {
        a instanceof vf && (0 !== (a.U & 65536)) !== !1 && (a.U = a.U ^ 65536);
      });
    }
  }
  t.kw = function (a, b) {
    for (a.reset(); a.next(); ) {
      var c = a.value;
      !c.Tc() ||
        c instanceof vf ||
        (c.aj() ? (c.measure(Infinity, Infinity), c.arrange()) : b.add(c));
    }
    for (a.reset(); a.next(); )
      (c = a.value), c instanceof vf && c.isVisible() && zj(this, c);
    for (a.reset(); a.next(); )
      (c = a.value),
        c instanceof R &&
          c.isVisible() &&
          (c.aj() ? (c.measure(Infinity, Infinity), c.arrange()) : b.add(c));
    for (a.reset(); a.next(); )
      (c = a.value),
        c instanceof Je &&
          c.isVisible() &&
          (c.aj() ? (c.measure(Infinity, Infinity), c.arrange()) : b.add(c));
  };
  function zj(a, b) {
    for (var c = Ma(), d = Ma(), e = b.memberParts; e.next(); ) {
      var f = e.value;
      f.isVisible() &&
        (f instanceof vf
          ? (Aj(f) || Bj(f) || Cj(f)) && zj(a, f)
          : f instanceof R
          ? f.fromNode === b || f.toNode === b
            ? d.push(f)
            : c.push(f)
          : (f.measure(Infinity, Infinity), f.arrange()));
    }
    a = c.length;
    for (e = 0; e < a; e++)
      (f = c[e]), f.measure(Infinity, Infinity), f.arrange();
    Pa(c);
    b.measure(Infinity, Infinity);
    b.arrange();
    a = d.length;
    for (b = 0; b < a; b++)
      (c = d[b]), c.measure(Infinity, Infinity), c.arrange();
    Pa(d);
  }
  t.Sd = function (a, b, c, d) {
    if (this.Fj || this.animationManager.isAnimating)
      for (var e = 0; e < b; e++) a[e].Sd(c, d);
  };
  t.uc = function (a, b) {
    if (null !== this.La) {
      null === this.Ia && v("No canvas specified");
      var c = this.animationManager;
      if (!c.zb && (!c.isAnimating || c.isTicking)) {
        var d = new Date();
        Dj(this);
        if ("0" !== this.La.style.opacity) {
          var e = a !== this.$b,
            f = this.Va.m,
            g = f.length,
            h = this;
          this.Sd(f, g, h, h.viewportBounds);
          if (e) a.Nc(!0), dj(this);
          else if (!this.dd && void 0 === b && !c.isAnimating) return;
          g = this.ra;
          var k = this.Aa,
            l = Math.round(g.x * k) / k,
            m = Math.round(g.y * k) / k;
          c = this.Bb;
          c.reset();
          1 !== k && c.scale(k);
          (0 === g.x && 0 === g.y) || c.translate(-l, -m);
          k = this.jc;
          a.setTransform(k, 0, 0, k, 0, 0);
          a.clearRect(0, 0, this.Da, this.Ca);
          1 !== this.tb && (a.globalAlpha = this.tb);
          G &&
            G.fm &&
            G.lv &&
            (a.setTransform(
              c.m11 * k,
              c.m12 * k,
              c.m21 * k,
              c.m22 * k,
              c.dx,
              c.dy
            ),
            G.lv(this, a));
          Ej(this, a);
          l =
            void 0 !== b
              ? function (c) {
                  if (c.visible && 0 !== c.tb) {
                    var d = c.Ma.m,
                      e = d.length;
                    if (0 !== e) {
                      var f = oi(c, a),
                        g = c.Uo;
                      g.length = 0;
                      for (var k = h.scale, l = M.alloc(), m = 0; m < e; m++) {
                        var n = d[m];
                        b.contains(n) || c.Mi(a, n, h, g, k, l, !0);
                      }
                      M.free(l);
                      a.globalAlpha = f;
                    }
                  }
                }
              : function (b) {
                  b.uc(a, h);
                };
          g = f.length;
          for (m = 0; m < g; m++)
            a.setTransform(k, 0, 0, k, 0, 0),
              a.transform(c.m11, c.m12, c.m21, c.m22, c.dx, c.dy),
              a.Oc(),
              l(f[m]);
          f = !1;
          this.hi ? Fj(this.hi, this) && (f = this.It()) : (f = !0);
          f && (Kb.prototype.Od = Kb.prototype.Fx);
          G && (G.Rx || G.fm) && G.mv && G.mv(a, this, c);
          e ? (this.$b.Nc(!0), dj(this)) : (this.dd = this.Fj = !1);
          f = +new Date() - +d;
          e = G && G.Qx;
          d = this.$w;
          if (e || null === this.Bi) {
            d[this.Lr] = f;
            this.Lr = (this.Lr + 1) % d.length;
            for (c = f = 0; c < d.length; c++) f += d[c];
            this.Kr = f / d.length;
          }
          1 !== this.tb && (a.globalAlpha = 1);
          if (e)
            for (a.setTransform(1, 0, 0, 1, 0, 0), e = 0; e < d.length; e++)
              a.fillText(d[e].toString(), 20, 150 + +(20 * e));
        }
      }
    }
  };
  function Gj(a, b, c, d, e, f, g, h, k, l) {
    if (null !== a.La) {
      null === a.Ia && v("No canvas specified");
      void 0 === g && (g = null);
      void 0 === h && (h = null);
      void 0 === k && (k = !1);
      void 0 === l && (l = !1);
      Dj(a);
      a.$b.Nc(!0);
      dj(a);
      a.Hj = !0;
      var m = a.Aa;
      a.Aa = e;
      var n = a.Va.m,
        p = n.length;
      try {
        var r = new M(f.x, f.y, d.width / e, d.height / e),
          q = r.copy();
        q.Up(c);
        wj(a, q);
        uh(a);
        a.Sd(n, p, a, r);
        b.setTransform(1, 0, 0, 1, 0, 0);
        b.clearRect(0, 0, d.width, d.height);
        null !== h &&
          "" !== h &&
          ((b.fillStyle = h), b.fillRect(0, 0, d.width, d.height));
        var u = a.jc;
        b.scale(u, u);
        var w = Kb.alloc();
        w.reset();
        w.translate(c.left, c.top);
        w.scale(e);
        (0 === f.x && 0 === f.y) || w.translate(-f.x, -f.y);
        b.setTransform(w.m11, w.m12, w.m21, w.m22, w.dx, w.dy);
        b.Oc();
        Kb.free(w);
        Ej(a, b);
        b.globalAlpha = a.tb;
        var y = a.qk("Grid");
        if (g) {
          var z = new I(),
            B = g.iterator;
          for (B.reset(); B.next(); ) {
            var C = B.value;
            C instanceof U && (l || C.layer !== y) && z.add(C);
          }
          for (l = 0; l < p; l++) {
            var E = n[l];
            y = b;
            var J = a;
            if (E.visible && 0 !== E.tb && (k || !E.isTemporary)) {
              var S = E.Ma.m,
                aa = S.length;
              if (0 !== aa) {
                var Y = oi(E, y),
                  T = E.Uo;
                T.length = 0;
                var P = J.scale,
                  ma = M.alloc();
                for (c = 0; c < aa; c++) {
                  var ia = S[c];
                  z.contains(ia) && E.Mi(y, ia, J, T, P, ma, !1);
                }
                M.free(ma);
                y.globalAlpha = Y;
              }
            }
          }
        } else
          for (z = 0; z < p; z++)
            (J = n[z]), J === y ? l && J.uc(b, a, !0) : J.uc(b, a, k);
        a.Hj = !1;
        a.hi && Fj(a.hi, a) && a.It();
      } finally {
        (a.Aa = m), a.$b.Nc(!0), dj(a), a.Sd(n, p, a, a.viewportBounds), wj(a);
      }
    }
  }
  t.Se = function (a) {
    return this.nh[a];
  };
  t.Fy = function (a, b) {
    "minDrawingLength" === a && (this.Hr = b);
    this.nh[a] = b;
    this.redraw();
  };
  t.By = function () {
    this.nh = new eb();
    this.nh.drawShadows = !0;
    this.nh.textGreeking = !0;
    this.nh.viewportOptimizations = $a || Wa ? !1 : !0;
    this.nh.temporaryPixelRatio = !0;
    this.nh.pictureRatioOptimization = !0;
    this.Hr = this.nh.minDrawingLength = 1;
  };
  function Ej(a, b) {
    a = a.nh;
    null !== a &&
      (void 0 !== a.imageSmoothingEnabled && b.Ey(!!a.imageSmoothingEnabled),
      (a = a.defaultFont),
      void 0 !== a && null !== a && (b.font = a));
  }
  t.nm = function (a) {
    return this.ao[a];
  };
  t.$A = function (a, b) {
    this.ao[a] = b;
  };
  t.Ay = function () {
    this.ao = new eb();
    this.ao.extraTouchArea = 10;
    this.ao.extraTouchThreshold = 10;
    this.ao.hasGestureZoom = !0;
  };
  t.set = function (a) {
    if (G)
      for (var b in a)
        (b.startsWith("_") || -1 !== b.indexOf(".")) &&
          v(
            "Property with underscore or period passed to Diagram.set. Did you mean to use Diagram.assign?"
          );
    Object.assign(this, a);
    return this;
  };
  t.cv = function (a) {
    return this.Km(a);
  };
  t.Km = function (a) {
    Hj(this, a);
    return this;
  };
  function Hj(a, b) {
    var c = a instanceof W,
      d = a instanceof Q,
      e;
    for (e in b) {
      "" === e && v("Setting properties requires non-empty property names");
      var f = a,
        g = e;
      if (c || d) {
        var h = e.indexOf(".");
        if (0 < h) {
          var k = e.substring(0, h);
          if (c) f = a.hb(k);
          else if (((f = a[k]), void 0 === f || null === f))
            f = a.toolManager[k];
          Ga(f)
            ? (g = e.substr(h + 1))
            : v(
                "Unable to find object named: " +
                  k +
                  " in " +
                  a.toString() +
                  " when trying to set property: " +
                  e
              );
        }
      }
      if ("_" !== g[0] && !Sa(f, g))
        if (d && "ModelChanged" === g) {
          a.Bx(b[g]);
          continue;
        } else if (d && "Changed" === g) {
          a.Dh(b[g]);
          continue;
        } else if (d && Sa(a.toolManager, g)) f = a.toolManager;
        else if (d && Ij(a, g)) {
          a.dk(g, b[g]);
          continue;
        } else if (a instanceof X && "Changed" === g) {
          a.Dh(b[g]);
          continue;
        } else
          v(
            'Trying to set undefined property "' +
              g +
              '" on object: ' +
              f.toString()
          );
      f[g] = b[e];
      "_" === g[0] && f instanceof O && f.yx(g);
    }
  }
  t.ev = function () {
    if (0 === this.undoManager.transactionLevel && 0 !== this.ei.count) {
      for (; 0 < this.ei.count; ) {
        var a = this.ei;
        this.ei = new xb();
        for (a = a.iterator; a.next(); ) {
          var b = a.key;
          b.oq(a.value);
          b.lc(!1);
        }
      }
      this.R();
    }
  };
  t.R = function (a) {
    if (void 0 === a) (this.dd = !0), this.Ob();
    else {
      var b = this.viewportBounds;
      a.s() && b.Sc(a) && ((this.dd = !0), this.Ob());
    }
    this.V("InvalidateDraw");
  };
  Q.prototype.invalidateViewport = function (a, b) {
    if (!0 !== this.dd) {
      this.dd = !0;
      var c = !0 === this.Se("temporaryPixelRatio");
      if (
        !0 === this.Se("viewportOptimizations") &&
        this.scrollMode !== bi &&
        this.Yj.Oi(0, 0, 0, 0) &&
        b.width === a.width &&
        b.height === a.height
      ) {
        var d = this.scale,
          e = Math.max(a.x, b.x),
          f = Math.max(a.y, b.y);
        d = M.allocAt(
          e,
          f,
          Math.max(0, Math.min(a.x + a.width, b.x + b.width) - e) * d,
          Math.max(0, Math.min(a.y + a.height, b.y + b.height) - f) * d
        );
        if (!this.ns && 0 < d.width && 0 < d.height) {
          if (
            !(
              this.ed ||
              ((this.pg = !1),
              null === this.La ||
                ((this.ed = !0),
                this.ev(),
                this.documentBounds.s() ||
                  ((e = M.alloc()), Jj(this, this.computeBounds(e)), M.free(e)),
                (e = this.Ia),
                null === e || e instanceof Kj))
            )
          ) {
            var g = this.jc;
            f = this.Da * g;
            var h = this.Ca * g,
              k = this.scale * g,
              l = Math.round(Math.round(b.x * k) - Math.round(a.x * k));
            b = Math.round(Math.round(b.y * k) - Math.round(a.y * k));
            k = this.Kw;
            a = this.Vy;
            k.width !== f && (k.width = f);
            k.height !== h && (k.height = h);
            a.clearRect(0, 0, f, h);
            k = 190 * g;
            var m = 70 * g,
              n = Math.max(l, 0),
              p = Math.max(b, 0),
              r = Math.floor(f - n),
              q = Math.floor(h - p);
            a.drawImage(e.Sa, n, p, r, q, 0, 0, r, q);
            Fj(this.hi, this) && a.clearRect(0, 0, k, m);
            e = Ma();
            a = Ma();
            q = Math.abs(l);
            r = Math.abs(b);
            var u = 0 === n ? 0 : f - q;
            n = K.allocAt(u, 0);
            q = K.allocAt(q + u, h);
            a.push(
              new M(
                Math.min(n.x, q.x),
                Math.min(n.y, q.y),
                Math.abs(n.x - q.x),
                Math.abs(n.y - q.y)
              )
            );
            var w = this.Bb;
            w.reset();
            w.scale(g, g);
            1 !== this.Aa && w.scale(this.Aa);
            g = this.ra;
            (0 !== g.x || 0 !== g.y) &&
              isFinite(g.x) &&
              isFinite(g.y) &&
              w.translate(-g.x, -g.y);
            Lb(n, w);
            Lb(q, w);
            e.push(
              new M(
                Math.min(n.x, q.x),
                Math.min(n.y, q.y),
                Math.abs(n.x - q.x),
                Math.abs(n.y - q.y)
              )
            );
            u = 0 === p ? 0 : h - r;
            n.h(0, u);
            q.h(f, r + u);
            a.push(
              new M(
                Math.min(n.x, q.x),
                Math.min(n.y, q.y),
                Math.abs(n.x - q.x),
                Math.abs(n.y - q.y)
              )
            );
            Lb(n, w);
            Lb(q, w);
            e.push(
              new M(
                Math.min(n.x, q.x),
                Math.min(n.y, q.y),
                Math.abs(n.x - q.x),
                Math.abs(n.y - q.y)
              )
            );
            Fj(this.hi, this) &&
              ((f = 0 < l ? 0 : -l),
              (h = 0 < b ? 0 : -b),
              n.h(f, h),
              q.h(k + f, m + h),
              a.push(
                new M(
                  Math.min(n.x, q.x),
                  Math.min(n.y, q.y),
                  Math.abs(n.x - q.x),
                  Math.abs(n.y - q.y)
                )
              ),
              Lb(n, w),
              Lb(q, w),
              e.push(
                new M(
                  Math.min(n.x, q.x),
                  Math.min(n.y, q.y),
                  Math.abs(n.x - q.x),
                  Math.abs(n.y - q.y)
                )
              ));
            K.free(n);
            K.free(q);
            jj(this, !1, !0);
            null === this.La && v("No div specified");
            null === this.Ia && v("No canvas specified");
            if (!this.animationManager.zb && ((f = this.$b), this.dd)) {
              Dj(this);
              h = this.jc;
              f.setTransform(1, 0, 0, 1, 0, 0);
              f.clearRect(0, 0, this.Da * h, this.Ca * h);
              f.drawImage(
                this.Kw.Sa,
                0 < l ? 0 : Math.round(-l),
                0 < b ? 0 : Math.round(-b)
              );
              b = this.ra;
              g = this.Aa;
              k = Math.round(b.x * g) / g;
              m = Math.round(b.y * g) / g;
              l = this.Bb;
              l.reset();
              1 !== g && l.scale(g);
              (0 === b.x && 0 === b.y) || l.translate(-k, -m);
              f.save();
              f.beginPath();
              b = a.length;
              for (g = 0; g < b; g++)
                (k = a[g]),
                  0 !== k.width &&
                    0 !== k.height &&
                    f.rect(
                      Math.floor(k.x),
                      Math.floor(k.y),
                      Math.ceil(k.width),
                      Math.ceil(k.height)
                    );
              f.clip();
              f.setTransform(h, 0, 0, h, 0, 0);
              f.transform(l.m11, l.m12, l.m21, l.m22, l.dx, l.dy);
              f.Oc();
              G && G.fm && G.lv && G.lv(this, f);
              h = this.Va.m;
              b = h.length;
              this.Sd(h, b, this, this.viewportBounds);
              Ej(this, f);
              f.globalAlpha = this.tb;
              for (g = 0; g < b; g++)
                if (((k = h[g]), (m = e), k.visible && 0 !== k.tb)) {
                  p = oi(k, f);
                  n = k.Uo;
                  n.length = 0;
                  r = this.scale;
                  q = M.alloc();
                  w = k.Ma.m;
                  u = w.length;
                  for (var y = m.length, z = 0; z < u; z++) {
                    var B = w[z];
                    a: {
                      var C = Lj(B, B.actualBounds);
                      for (
                        var E = m, J = y, S = 2 / r, aa = 4 / r, Y = 0;
                        Y < J;
                        Y++
                      ) {
                        var T = E[Y];
                        if (
                          0 !== T.width &&
                          0 !== T.height &&
                          C.Bv(T.x - S, T.y - S, T.width + aa, T.height + aa)
                        ) {
                          C = !0;
                          break a;
                        }
                      }
                      C = !1;
                    }
                    C && k.Mi(f, B, this, n, r, q, !0);
                  }
                  M.free(q);
                  f.globalAlpha = p;
                }
              f.restore();
              f.Nc(!0);
              G && (G.Rx || G.fm) && G.mv && G.mv(f, this, l);
              this.hi && Fj(this.hi, this) && this.It();
              this.dd = this.Fj = !1;
              this.yq();
            }
            Pa(e);
            Pa(a);
            this.ed = !1;
          }
        } else this.pd();
        M.free(d);
        c && (Xe(this), this.pd(), ff(this, !0));
      } else c ? (Xe(this), this.pd(), ff(this, !0)) : this.pd();
    }
  };
  function ij(a) {
    !1 === a.Ej && (a.Ej = !0);
  }
  function dj(a) {
    !1 === a.Fj && (a.Fj = !0);
  }
  function Dj(a) {
    !1 !== a.bo && ((a.bo = !1), Mj(a, a.Da, a.Ca));
  }
  function Mj(a, b, c) {
    Li(a);
    var d = a.jc;
    a.Ia.resize(b * d, c * d, b, c) && ((a.dd = !0), a.$b.Nc(!0));
  }
  function bj(a) {
    var b = a.Ia;
    if (null === b || a.Op.s()) return !0;
    var c = a.Da,
      d = a.Ca,
      e = a.viewportBounds;
    if (!a.viewportBounds.s()) return !0;
    var f = e.x,
      g = e.y,
      h = e.width,
      k = e.height,
      l = a.Iu,
      m = a.Fu,
      n = a.La,
      p = !1,
      r = a.$f ? a.Ab : 0,
      q = a.ff ? a.Ab : 0,
      u = n.clientWidth || c + r,
      w = n.clientHeight || d + q;
    if (u !== c + r || w !== d + q)
      (a.$f = !1),
        (a.ff = !1),
        (q = r = 0),
        (a.Da = u),
        (a.Ca = w),
        (p = a.bo = !0),
        Li(a);
    if (!(p || a.$f || a.ff || a.Yn || a.Zn)) return !0;
    a.Ej = !1;
    var y = a.documentBounds,
      z = 0,
      B = 0,
      C = 0,
      E = 0;
    n = e.width;
    var J = e.height,
      S = a.Yj;
    a.contentAlignment.ib()
      ? (y.width > n && ((z = S.left), (B = S.right)),
        y.height > J && ((C = S.top), (E = S.bottom)))
      : ((z = S.left), (B = S.right), (C = S.top), (E = S.bottom));
    S = y.width + z + B;
    var aa = y.height + C + E;
    z = y.x - z;
    var Y = e.x;
    B = y.right + B;
    var T = e.right + r;
    C = y.y - C;
    var P = e.y;
    y = y.bottom + E;
    E = e.bottom + q;
    var ma = "1px",
      ia = "1px";
    e = a.scale;
    u = S > u / e;
    w = aa > w / e;
    a.scrollMode === $h &&
      (u || w) &&
      (u &&
        a.hasHorizontalScrollbar &&
        a.allowHorizontalScroll &&
        ((u = 1),
        z + 1 < Y && (u = Math.max((Y - z) * e + a.Da, u)),
        B > T + 1 && (u = Math.max((B - T) * e + a.Da, u)),
        n + r + 1 < S && (u = Math.max((S - n) * e + a.Da, u)),
        (ma = u.toString() + "px")),
      w &&
        a.hasVerticalScrollbar &&
        a.allowVerticalScroll &&
        ((u = 1),
        C + 1 < P && (u = Math.max((P - C) * e + a.Ca, u)),
        y > E + 1 && (u = Math.max((y - E) * e + a.Ca, u)),
        J + q + 1 < aa && (u = Math.max((aa - J) * e + a.Ca, u)),
        (ia = u.toString() + "px")));
    u = "1px" !== ma;
    w = "1px" !== ia;
    (u && w) ||
      (!u && !w) ||
      (w && (T -= a.Ab),
      u && (E -= a.Ab),
      S < n + r ||
        !a.hasHorizontalScrollbar ||
        !a.allowHorizontalScroll ||
        ((r = 1),
        z + 1 < Y && (r = Math.max((Y - z) * e + a.Da, r)),
        B > T + 1 && (r = Math.max((B - T) * e + a.Da, r)),
        n + 1 < S && (r = Math.max((S - n) * e + a.Da, r)),
        (ma = r.toString() + "px")),
      (u = "1px" !== ma),
      (r = a.Ca),
      u !== a.ff && (r = u ? a.Ca - a.Ab : a.Ca + a.Ab),
      aa < J + q ||
        !a.hasVerticalScrollbar ||
        !a.allowVerticalScroll ||
        ((q = 1),
        C + 1 < P && (q = Math.max((P - C) * e + r, q)),
        y > E + 1 && (q = Math.max((y - E) * e + r, q)),
        J + 1 < aa && (q = Math.max((aa - J) * e + r, q)),
        (ia = q.toString() + "px")),
      (w = "1px" !== ia));
    if (a.Yr && u === a.ff && w === a.$f)
      return (c === a.Da && d === a.Ca) || a.pd(), !1;
    u !== a.ff &&
      ("1px" === ma ? (a.Ca = a.Ca + a.Ab) : (a.Ca = Math.max(a.Ca - a.Ab, 1)),
      (p = !0));
    a.ff = u;
    m.style.width = ma;
    w !== a.$f &&
      ("1px" === ia ? (a.Da = a.Da + a.Ab) : (a.Da = Math.max(a.Da - a.Ab, 1)),
      (p = !0),
      a.ho &&
        ((q = K.alloc()),
        w
          ? ((b.style.left = a.Ab + "px"),
            (a.position = q.h(a.ra.x + a.Ab / a.scale, a.ra.y)))
          : ((b.style.left = "0px"),
            (a.position = q.h(a.ra.x - a.Ab / a.scale, a.ra.y))),
        K.free(q)));
    p && Li(a);
    a.$f = w;
    m.style.height = ia;
    a.Eu = !0;
    p && (a.bo = !0);
    b = l.scrollLeft;
    a.hasHorizontalScrollbar &&
      a.allowHorizontalScroll &&
      (n + 1 < S
        ? (b = (a.position.x - z) * e)
        : z + 1 < Y
        ? (b = l.scrollWidth - l.clientWidth)
        : B > T + 1 && (b = a.position.x * e));
    if (a.ho)
      switch (a.zu) {
        case "negative":
          b = -(l.scrollWidth - b - l.clientWidth);
          break;
        case "reverse":
          b = l.scrollWidth - b - l.clientWidth;
      }
    l.scrollLeft = b;
    a.hasVerticalScrollbar &&
      a.allowVerticalScroll &&
      (J + 1 < aa
        ? (l.scrollTop = (a.position.y - C) * e)
        : C + 1 < P
        ? (l.scrollTop = l.scrollHeight - l.clientHeight)
        : y > E + 1 && (l.scrollTop = a.position.y * e));
    u = a.Da;
    w = a.Ca;
    l.style.width = u + (a.$f ? a.Ab : 0) + "px";
    l.style.height = w + (a.ff ? a.Ab : 0) + "px";
    return c !== u || d !== w || a.animationManager.zb
      ? ((c = M.allocAt(f, g, h, k)),
        a.onViewportBoundsChanged(c, a.viewportBounds, e, p),
        M.free(c),
        !1)
      : !0;
  }
  t = Q.prototype;
  t.add = function (a) {
    x(a, U, Q, "add:part");
    var b = a.diagram;
    if (
      b !== this &&
      (null !== b &&
        v(
          "Cannot add part " +
            a.toString() +
            " to " +
            this.toString() +
            ". It is already a part of " +
            b.toString()
        ),
      (b = this.qk(a.layerName)),
      null === b && (b = this.qk("")),
      null === b &&
        v(
          'Cannot add a Part when unable find a Layer named "' +
            a.layerName +
            '" and there is no default Layer'
        ),
      a.layer !== b)
    ) {
      var c = b.Wi(99999999, a, a.diagram === this);
      0 <= c && this.cb(re, "parts", b, null, a, null, c);
      b.isTemporary || this.Wa();
      a.F(1);
      c = a.layerChanged;
      null !== c && c(a, null, b);
    }
  };
  t.Wi = function (a) {
    this.partManager.Wi(a);
    var b = this;
    Nj(a, function (a) {
      Oj(b, a);
    });
    (a instanceof Je || (a instanceof vf && null !== a.placeholder)) && a.v();
    null !== a.data &&
      Nj(a, function (a) {
        Pj(b.partManager, a);
      });
    (!0 !== Bj(a) && !0 !== Cj(a)) || this.ze.add(a);
    Qj(a, !0, this);
    Rj(a)
      ? (a.actualBounds.s() && this.R(Lj(a, a.actualBounds)), this.Wa())
      : a.isVisible() && a.actualBounds.s() && this.R(Lj(a, a.actualBounds));
    this.Ob();
  };
  t.kc = function (a) {
    a.gk();
    this.partManager.kc(a);
    var b = this;
    null !== a.data &&
      Nj(a, function (a) {
        Sj(b.partManager, a, b);
      });
    this.ze.remove(a);
    Rj(a)
      ? (a.actualBounds.s() && this.R(Lj(a, a.actualBounds)), this.Wa())
      : a.isVisible() && a.actualBounds.s() && this.R(Lj(a, a.actualBounds));
    this.Ob();
  };
  t.remove = function (a) {
    x(a, U, Q, "remove:part");
    Tj(this, a, !0);
  };
  function Tj(a, b, c) {
    var d = b.layer;
    null !== d &&
      d.diagram === a &&
      ((b.isSelected = !1),
      (b.isHighlighted = !1),
      b.F(2),
      c && b.mk(),
      (c = d.kc(-1, b, !1)),
      0 <= c && a.cb(se, "parts", d, b, null, c, null),
      (a = b.layerChanged),
      null !== a && a(b, d, null));
  }
  t.at = function (a, b) {
    void 0 === b && (b = !1);
    if (Ha(a))
      for (var c = a.length, d = 0; d < c; d++) {
        var e = a[d];
        (b && !e.canDelete()) || this.remove(e);
      }
    else
      for (c = new I(), c.addAll(a), a = c.iterator; a.next(); )
        (c = a.value), (b && !c.canDelete()) || this.remove(c);
  };
  t.lk = function (a, b, c) {
    void 0 === c && (c = !1);
    return this.partManager.lk(a, b, c);
  };
  Q.prototype.moveParts = function (a, b, c, d) {
    void 0 === c && (c = !1);
    void 0 === d && (d = Uj(this));
    x(b, K, Q, "moveParts:offset");
    if (null !== this.toolManager) {
      var e = new xb();
      if (null !== a)
        if (Ha(a)) for (var f = 0; f < a.length; f++) Vj(this, e, a[f], c, d);
        else for (a = a.iterator; a.next(); ) Vj(this, e, a.value, c, d);
      else {
        for (a = this.parts; a.next(); ) Vj(this, e, a.value, c, d);
        for (a = this.nodes; a.next(); ) Vj(this, e, a.value, c, d);
        for (a = this.links; a.next(); ) Vj(this, e, a.value, c, d);
      }
      nf(this, e, b, d, c);
    }
  };
  function Vj(a, b, c, d, e, f) {
    if (
      !b.contains(c) &&
      (void 0 === f && (f = !1), !d || f || c.canMove() || c.canCopy())
    )
      if ((void 0 === e && (e = Uj(a)), c instanceof V)) {
        b.add(c, a.Jd(e, c, c.location));
        if (c instanceof vf && (null !== c.placeholder || e.dragsMembers))
          for (f = c.memberParts; f.next(); )
            Vj(a, b, f.value, d, e, e.groupsAlwaysMove);
        for (f = c.linksConnected; f.next(); ) {
          var g = f.value;
          if (!b.contains(g)) {
            var h = g.fromNode,
              k = g.toNode;
            null !== h &&
              b.contains(h) &&
              null !== k &&
              b.contains(k) &&
              Vj(a, b, g, d, e);
          }
        }
        if (e.dragsTree) for (c = c.uv(); c.next(); ) Vj(a, b, c.value, d, e);
      } else if (c instanceof R)
        for (b.add(c, a.Jd(e, c)), c = c.labelNodes; c.next(); )
          Vj(a, b, c.value, d, e);
      else c instanceof Je || b.add(c, a.Jd(e, c, c.location));
  }
  function nf(a, b, c, d, e) {
    if (null !== b && (x(b, xb, Q, "moveParts:parts"), 0 !== b.count)) {
      var f = K.alloc(),
        g = K.alloc();
      g.assign(c);
      isNaN(g.x) && (g.x = 0);
      isNaN(g.y) && (g.y = 0);
      (c = a.ms) || Ye(a, b);
      for (var h = Ma(), k = Ma(), l = b.iterator, m = K.alloc(); l.next(); ) {
        var n = l.key,
          p = l.value;
        if (n.Tc()) {
          var r = Wj(a, n, b);
          if (null !== r) h.push(new Xj(n, p, r));
          else if (!e || n.canMove())
            (r = p.point),
              f.assign(r),
              a.computeMove(n, f.add(g), d, m),
              (n.location = m),
              void 0 === p.shifted && (p.shifted = new K()),
              p.shifted.assign(m.ne(r));
        } else l.key instanceof R && k.push(l.sa);
      }
      K.free(m);
      e = h.length;
      for (l = 0; l < e; l++)
        (n = h[l]),
          f.assign(n.info.point),
          void 0 === n.yv.shifted && (n.yv.shifted = new K()),
          (n.node.location = f.add(n.yv.shifted));
      e = K.alloc();
      l = K.alloc();
      n = k.length;
      for (p = 0; p < n; p++) {
        var q = k[p];
        r = q.key;
        if (r instanceof R)
          if (r.suspendsRouting) {
            r.qf = null;
            m = r.fromNode;
            var u = r.toNode;
            if (null !== a.draggedLink && d.dragsLink)
              if (((u = q.value.point), null === r.dragComputation))
                b.add(r, a.Jd(d, r, g)), lf(r, g.x - u.x, g.y - u.y);
              else {
                q = K.allocAt(0, 0);
                (m = r.i(0)) && m.s() && q.assign(m);
                var w = (m = K.alloc().assign(q).add(g));
                d.isGridSnapEnabled &&
                  (d.isGridSnapRealtime || a.lastInput.up) &&
                  ((w = K.alloc()), Ag(a, r, m, w, d));
                m.assign(r.dragComputation(r, m, w)).ne(q);
                b.add(r, a.Jd(d, r, m));
                lf(r, m.x - u.x, m.y - u.y);
                K.free(q);
                K.free(m);
                w !== m && K.free(w);
              }
            else
              null !== m &&
                (e.assign(m.location),
                (w = b.K(m)),
                null !== w && e.ne(w.point)),
                null !== u &&
                  (l.assign(u.location),
                  (w = b.K(u)),
                  null !== w && l.ne(w.point)),
                null !== m && null !== u
                  ? e.$a(l)
                    ? ((m = q.value.point),
                      (u = f),
                      u.assign(e),
                      u.ne(m),
                      b.add(r, a.Jd(d, r, e)),
                      lf(r, u.x, u.y))
                    : ((r.suspendsRouting = !1), r.ab())
                  : ((q = q.value.point),
                    (m = null !== m ? e : null !== u ? l : g),
                    b.add(r, a.Jd(d, r, m)),
                    lf(r, m.x - q.x, m.y - q.y));
          } else if (null === r.fromNode || null === r.toNode)
            (m = q.value.point),
              b.add(r, a.Jd(d, r, g)),
              lf(r, g.x - m.x, g.y - m.y);
      }
      K.free(f);
      K.free(g);
      K.free(e);
      K.free(l);
      Pa(h);
      Pa(k);
      c || (uh(a), cf(a, b));
    }
  }
  Q.prototype.computeMove = function (a, b, c, d) {
    void 0 === d && (d = new K());
    d.assign(b);
    if (null === a) return d;
    var e = b,
      f = c.isGridSnapEnabled;
    f &&
      (c.isGridSnapRealtime || this.lastInput.up) &&
      ((e = K.alloc()), Ag(this, a, b, e, c));
    c = null !== a.dragComputation ? a.dragComputation(a, b, e) : e;
    var g = a.minLocation,
      h = g.x;
    isNaN(h) && (h = f ? Math.round(1e3 * a.location.x) / 1e3 : a.location.x);
    g = g.y;
    isNaN(g) && (g = f ? Math.round(1e3 * a.location.y) / 1e3 : a.location.y);
    var k = a.maxLocation,
      l = k.x;
    isNaN(l) && (l = f ? Math.round(1e3 * a.location.x) / 1e3 : a.location.x);
    k = k.y;
    isNaN(k) && (k = f ? Math.round(1e3 * a.location.y) / 1e3 : a.location.y);
    d.h(Math.max(h, Math.min(c.x, l)), Math.max(g, Math.min(c.y, k)));
    e !== b && K.free(e);
    return d;
  };
  function Uj(a) {
    var b = a.toolManager.findTool("Dragging");
    return null !== b ? b.dragOptions : a.Bn;
  }
  function Ag(a, b, c, d, e) {
    void 0 === e && (e = Uj(a));
    d.assign(c);
    if (null !== b) {
      var f = a.grid;
      b = e.gridSnapCellSize;
      a = b.width;
      b = b.height;
      var g = e.gridSnapOrigin,
        h = g.x;
      g = g.y;
      e = e.gridSnapCellSpot;
      if (null !== f) {
        var k = f.gridCellSize;
        isNaN(a) && (a = k.width);
        isNaN(b) && (b = k.height);
        f = f.gridOrigin;
        isNaN(h) && (h = f.x);
        isNaN(g) && (g = f.y);
      }
      f = K.allocAt(0, 0);
      f.dj(0, 0, a, b, e);
      L.gq(c.x, c.y, h + f.x, g + f.y, a, b, d);
      K.free(f);
    }
  }
  function Ye(a, b) {
    if (null !== b)
      for (a.ms = !0, a = b.iterator; a.next(); )
        (b = a.key), b instanceof R && (b.suspendsRouting = !0);
  }
  function cf(a, b) {
    if (null !== b) {
      for (b = b.iterator; b.next(); ) {
        var c = b.key;
        c instanceof R && ((c.suspendsRouting = !1), Yj(c) && c.ab());
      }
      a.ms = !1;
    }
  }
  function Wj(a, b, c) {
    b = b.containingGroup;
    if (null !== b) {
      a = Wj(a, b, c);
      if (null !== a) return a;
      a = c.K(b);
      if (null !== a) return a;
    }
    return null;
  }
  t = Q.prototype;
  t.Jd = function (a, b, c) {
    if (void 0 === c) return new af(yb);
    var d = a.isGridSnapEnabled;
    a.groupsSnapMembers || null === b.containingGroup || (d = !1);
    return d
      ? new af(new K(Math.round(1e3 * c.x) / 1e3, Math.round(1e3 * c.y) / 1e3))
      : new af(c.copy());
  };
  function Zj(a, b, c) {
    x(b, mi, Q, "addLayer:layer");
    null !== b.diagram &&
      b.diagram !== a &&
      v("Cannot share a Layer with another Diagram: " + b + " of " + b.diagram);
    null === c
      ? null !== b.diagram &&
        v("Cannot add an existing Layer to this Diagram again: " + b)
      : (x(c, mi, Q, "addLayer:existingLayer"),
        c.diagram !== a &&
          v(
            "Existing Layer must be in this Diagram: " +
              c +
              " not in " +
              c.diagram
          ),
        b === c && v("Cannot move a Layer before or after itself: " + b));
    if (b.diagram !== a) {
      b = b.name;
      a = a.Va;
      c = a.count;
      for (var d = 0; d < c; d++)
        a.N(d).name === b &&
          v(
            "Cannot add Layer with the name '" +
              b +
              "'; a Layer with the same name is already present in this Diagram."
          );
    }
  }
  t.dm = function (a) {
    Zj(this, a, null);
    a.Xe(this);
    var b = this.Va,
      c = b.count - 1;
    if (!a.isTemporary) for (; 0 <= c && b.N(c).isTemporary; ) c--;
    b.Cb(c + 1, a);
    null !== this.ac && this.cb(re, "layers", this, null, a, null, c + 1);
    this.R();
    this.Wa();
    return this;
  };
  t.zx = function (a, b) {
    Zj(this, a, b);
    a.Xe(this);
    var c = this.Va,
      d = c.indexOf(a);
    0 <= d &&
      (c.remove(a),
      null !== this.ac && this.cb(se, "layers", this, a, null, d, null));
    var e = c.count,
      f;
    for (f = 0; f < e; f++)
      if (c.N(f) === b) {
        c.Cb(f, a);
        break;
      }
    null !== this.ac && this.cb(re, "layers", this, null, a, null, f);
    this.R();
    0 > d && this.Wa();
    return this;
  };
  t.hz = function (a, b) {
    Zj(this, a, b);
    a.Xe(this);
    var c = this.Va,
      d = c.indexOf(a);
    0 <= d &&
      (c.remove(a),
      null !== this.ac && this.cb(se, "layers", this, a, null, d, null));
    var e = c.count,
      f;
    for (f = 0; f < e; f++)
      if (c.N(f) === b) {
        c.Cb(f + 1, a);
        break;
      }
    null !== this.ac && this.cb(re, "layers", this, null, a, null, f + 1);
    this.R();
    0 > d && this.Wa();
    return this;
  };
  t.SA = function (a) {
    x(a, mi, Q, "removeLayer:layer");
    a.diagram !== this &&
      v(
        "Cannot remove a Layer from another Diagram: " + a + " of " + a.diagram
      );
    if ("" !== a.name) {
      var b = this.Va,
        c = b.indexOf(a);
      if (b.remove(a)) {
        for (b = a.Ma.copy().iterator; b.next(); ) {
          var d = b.value,
            e = d.layerName;
          e !== a.name ? (d.layerName = e) : (d.layerName = "");
        }
        null !== this.ac && this.cb(se, "layers", this, a, null, c, null);
        this.R();
        this.Wa();
      }
    }
  };
  t.qk = function (a) {
    for (var b = this.layers; b.next(); ) {
      var c = b.value;
      if (c.name === a) return c;
    }
    return null;
  };
  t.Bx = function (a) {
    A(a, "function", Q, "addModelChangedListener:listener");
    null === this.mf && (this.mf = new H());
    this.mf.add(a);
    this.model.Dh(a);
    return this;
  };
  t.UA = function (a) {
    A(a, "function", Q, "removeModelChangedListener:listener");
    null !== this.mf &&
      (this.mf.remove(a), 0 === this.mf.count && (this.mf = null));
    this.model.Ik(a);
  };
  t.Dh = function (a) {
    A(a, "function", Q, "addChangedListener:listener");
    null === this.Fg && (this.Fg = new H());
    this.Fg.add(a);
    return this;
  };
  t.Ik = function (a) {
    A(a, "function", Q, "removeChangedListener:listener");
    null !== this.Fg &&
      (this.Fg.remove(a), 0 === this.Fg.count && (this.Fg = null));
  };
  t.ws = function (a) {
    this.skipsUndoManager ||
      this.model.skipsUndoManager ||
      this.model.undoManager.zv(a);
    a.change !== qe && (this.isModified = !0);
    if (null !== this.Fg)
      for (var b = this.Fg, c = b.length, d = 0; d < c; d++) b.N(d)(a);
  };
  t.cb = function (a, b, c, d, e, f, g) {
    void 0 === f && (f = null);
    void 0 === g && (g = null);
    var h = new oe();
    h.diagram = this;
    h.change = a;
    h.propertyName = b;
    h.object = c;
    h.oldValue = d;
    h.oldParam = f;
    h.newValue = e;
    h.newParam = g;
    this.ws(h);
  };
  t.g = function (a, b, c, d, e) {
    this.cb(pe, a, this, b, c, d, e);
  };
  Q.prototype.changeState = function (a, b) {
    if (null !== a && a.diagram === this) {
      var c = this.skipsModelSourceBindings;
      try {
        this.skipsModelSourceBindings = !0;
        var d = a.change;
        if (d === pe) {
          var e = a.object;
          ak(e, a.propertyName, a.K(b));
          if (e instanceof O) {
            var f = e.part;
            null !== f && f.Tb();
          }
          this.isModified = !0;
        } else if (d === re) {
          var g = a.object,
            h = a.newParam,
            k = a.newValue;
          if (g instanceof W)
            if ("number" === typeof h && k instanceof O) {
              b ? g.kc(h) : g.Cb(h, k);
              var l = g.part;
              null !== l && l.Tb();
            } else
              "number" === typeof h &&
                k instanceof bk &&
                (k.isRow ? ck(g, h, b ? void 0 : k) : dk(g, h, b ? void 0 : k));
          else if (g instanceof mi) {
            var m = !0 === a.oldParam;
            "number" === typeof h &&
              k instanceof U &&
              (b
                ? ((k.isSelected = !1),
                  (k.isHighlighted = !1),
                  k.Tb(),
                  g.kc(m ? h : -1, k, m))
                : g.Wi(h, k, m));
          } else
            g instanceof Q
              ? "number" === typeof h &&
                k instanceof mi &&
                (b ? this.Va.nb(h) : (k.Xe(this), this.Va.Cb(h, k)))
              : v("unknown ChangedEvent.Insert object: " + a.toString());
          this.isModified = !0;
        } else if (d === se) {
          var n = a.object,
            p = a.oldParam,
            r = a.oldValue;
          if (n instanceof W)
            "number" === typeof p && r instanceof O
              ? b
                ? n.Cb(p, r)
                : n.kc(p)
              : "number" === typeof p &&
                r instanceof bk &&
                (r.isRow ? ck(n, p, b ? r : void 0) : dk(n, p, b ? r : void 0));
          else if (n instanceof mi) {
            var q = !0 === a.newParam;
            "number" === typeof p &&
              r instanceof U &&
              (b
                ? 0 > n.Ma.indexOf(r) && n.Wi(p, r, q)
                : ((r.isSelected = !1),
                  (r.isHighlighted = !1),
                  r.Tb(),
                  n.kc(q ? p : -1, r, q)));
          } else
            n instanceof Q
              ? "number" === typeof p &&
                r instanceof mi &&
                (b ? (r.Xe(this), this.Va.Cb(p, r)) : this.Va.nb(p))
              : v("unknown ChangedEvent.Remove object: " + a.toString());
          this.isModified = !0;
        } else d !== qe && v("unknown ChangedEvent: " + a.toString());
      } finally {
        this.skipsModelSourceBindings = c;
      }
    }
  };
  Q.prototype.Fa = function (a) {
    return this.undoManager.Fa(a);
  };
  Q.prototype.gb = function (a) {
    return this.undoManager.gb(a);
  };
  Q.prototype.Pf = function () {
    return this.undoManager.Pf();
  };
  Q.prototype.commit = function (a, b) {
    void 0 === b && (b = "");
    var c = this.skipsUndoManager;
    null === b && ((this.skipsUndoManager = !0), (b = ""));
    this.undoManager.Fa(b);
    var d = !1;
    try {
      a(this), (d = !0);
    } finally {
      d ? this.undoManager.gb(b) : this.undoManager.Pf(),
        (this.skipsUndoManager = c);
    }
  };
  Q.prototype.updateAllTargetBindings = function (a) {
    this.partManager.updateAllTargetBindings(a);
  };
  Q.prototype.Jq = function () {
    this.partManager.Jq();
  };
  function ek(a, b, c) {
    var d = a.animationManager;
    if (a.wb || a.ed)
      (a.Aa = c),
        Li(a),
        (a = a.Aa),
        d.zb && (Eh(d) || d.Yd.add(d.G, "scale", b, a));
    else if (null === a.Ia) (a.Aa = c), Li(a);
    else {
      a.wb = !0;
      var e = a.viewportBounds.copy(),
        f = a.Da,
        g = a.Ca;
      e.width = a.Da / b;
      e.height = a.Ca / b;
      var h = a.zoomPoint.x,
        k = a.zoomPoint.y,
        l = a.contentAlignment;
      isNaN(h) &&
        (l.Uc()
          ? l.Lf(Rc)
            ? (h = 0)
            : l.Lf(Sc) && (h = f - 1)
          : (h = l.ib() ? l.x * (f - 1) : f / 2));
      isNaN(k) &&
        (l.Uc()
          ? l.Lf(Qc)
            ? (k = 0)
            : l.Lf(Tc) && (k = g - 1)
          : (k = l.ib() ? l.y * (g - 1) : g / 2));
      null === a.scaleComputation ||
        a.animationManager.defaultAnimation.isAnimating ||
        (c = a.scaleComputation(a, c));
      c < a.minScale && (c = a.minScale);
      c > a.maxScale && (c = a.maxScale);
      f = K.allocAt(a.ra.x + h / b - h / c, a.ra.y + k / b - k / c);
      a.position = f;
      K.free(f);
      a.Aa = c;
      Li(a);
      a.onViewportBoundsChanged(e, a.viewportBounds, b, !1);
      a.wb = !1;
      fj(a, !1);
      c = a.Aa;
      d.zb && (Eh(d) || d.Yd.add(d.G, "scale", b, c));
      a.R();
      ij(a);
    }
  }
  Q.prototype.onViewportBoundsChanged = function (a, b, c, d) {
    if (!a.D(b)) {
      void 0 === d && (d = !1);
      d || ij(this);
      dj(this);
      var e = this.layout;
      null === e ||
        !e.isViewportSized ||
        this.autoScale !== zh ||
        d ||
        (a.width === b.width && a.height === b.height) ||
        e.F();
      e = this.currentTool;
      !0 === this.ul &&
        e instanceof Ua &&
        ((this.lastInput.documentPoint = this.jt(this.lastInput.viewPoint)),
        Ne(e, this));
      this.wb || this.invalidateViewport(a, b);
      wj(this);
      this.md.scale = c;
      this.md.position.x = a.x;
      this.md.position.y = a.y;
      this.md.bounds.assign(a);
      this.md.Gx.width = Math.round(a.width * c);
      this.md.Gx.height = Math.round(a.height * c);
      this.md.ty.width = this.Da;
      this.md.ty.height = this.Ca;
      this.md.my = d;
      this.V("ViewportBoundsChanged", this.md, a);
      this.isVirtualized &&
        this.links.each(function (a) {
          a.isAvoiding && a.actualBounds.Sc(b) && a.ab();
        });
    }
  };
  function wj(a, b) {
    var c = a.ae;
    if (null !== c && c.visible) {
      for (
        var d = Gb.alloc(), e = 1, f = 1, g = c.W.m, h = g.length, k = 0;
        k < h;
        k++
      ) {
        var l = g[k],
          m = Math.abs(l.interval);
        2 > m ||
          (fk(l.figure)
            ? (f = (f * m) / L.Xx(f, m))
            : (e = (e * m) / L.Xx(e, m)));
      }
      g = c.gridCellSize;
      d.h(f * g.width, e * g.height);
      if (void 0 !== b) (e = b.width), (f = b.height), (a = b.x), (g = b.y);
      else {
        b = M.alloc();
        a = a.viewportBounds;
        b.h(a.x, a.y, a.width, a.height);
        if (!b.s()) {
          M.free(b);
          return;
        }
        e = b.width;
        f = b.height;
        a = b.x;
        g = b.y;
        M.free(b);
      }
      c.width = e + 2 * d.width;
      c.height = f + 2 * d.height;
      b = K.alloc();
      L.gq(a, g, 0, 0, d.width, d.height, b);
      b.offset(-d.width, -d.height);
      Gb.free(d);
      c.part.location = b;
      K.free(b);
    }
  }
  Q.prototype.clearSelection = function (a) {
    void 0 === a && (a = !1);
    var b = this.selection;
    if (0 !== b.count) {
      a || this.V("ChangingSelection", b);
      for (var c = b.Ga(), d = c.length, e = 0; e < d; e++)
        c[e].isSelected = !1;
      b.la();
      b.clear();
      b.freeze();
      a || this.V("ChangedSelection", b);
    }
  };
  Q.prototype.select = function (a) {
    null !== a &&
      (x(a, U, Q, "select:part"),
      a.diagram === this &&
        (!a.isSelected || 1 < this.selection.count) &&
        (this.V("ChangingSelection", this.selection),
        this.clearSelection(!0),
        (a.isSelected = !0),
        this.V("ChangedSelection", this.selection)));
  };
  Q.prototype.ZA = function (a) {
    this.V("ChangingSelection", this.selection);
    this.clearSelection(!0);
    if (Ha(a))
      for (var b = a.length, c = 0; c < b; c++) {
        var d = a[c];
        d instanceof U ||
          v(
            "Diagram.selectCollection given something that is not a Part: " + d
          );
        d.isSelected = !0;
      }
    else
      for (a = a.iterator; a.next(); )
        (b = a.value),
          b instanceof U ||
            v(
              "Diagram.selectCollection given something that is not a Part: " +
                b
            ),
          (b.isSelected = !0);
    this.V("ChangedSelection", this.selection);
  };
  Q.prototype.clearHighlighteds = function () {
    var a = this.highlighteds;
    if (0 < a.count) {
      for (var b = a.Ga(), c = b.length, d = 0; d < c; d++)
        b[d].isHighlighted = !1;
      a.la();
      a.clear();
      a.freeze();
    }
  };
  t = Q.prototype;
  t.sA = function (a) {
    null !== a &&
      a.diagram === this &&
      (x(a, U, Q, "highlight:part"),
      !a.isHighlighted || 1 < this.highlighteds.count) &&
      (this.clearHighlighteds(), (a.isHighlighted = !0));
  };
  t.tA = function (a) {
    a = new I().addAll(a);
    for (var b = this.highlighteds.copy().zq(a).iterator; b.next(); )
      b.value.isHighlighted = !1;
    for (a = a.iterator; a.next(); )
      (b = a.value),
        b instanceof U ||
          v(
            "Diagram.highlightCollection given something that is not a Part: " +
              b
          ),
        (b.isHighlighted = !0);
  };
  t.scroll = function (a, b, c) {
    void 0 === c && (c = 1);
    var d = "up" === b || "down" === b,
      e = 0;
    if ("pixel" === a) e = c;
    else if ("line" === a)
      e =
        c *
        (d ? this.scrollVerticalLineChange : this.scrollHorizontalLineChange);
    else if ("page" === a)
      (a = d ? this.viewportBounds.height : this.viewportBounds.width),
        (a *= this.scale),
        0 !== a &&
          (e =
            c *
            Math.max(
              a -
                (d
                  ? this.scrollVerticalLineChange
                  : this.scrollHorizontalLineChange),
              0
            ));
    else {
      if ("document" === a) {
        e = this.documentBounds;
        c = this.viewportBounds;
        d = K.alloc();
        "up" === b
          ? (this.position = d.h(c.x, e.y))
          : "left" === b
          ? (this.position = d.h(e.x, c.y))
          : "down" === b
          ? (this.position = d.h(c.x, e.bottom - c.height))
          : "right" === b && (this.position = d.h(e.right - c.width, c.y));
        K.free(d);
        return;
      }
      v(
        "scrolling unit must be 'pixel', 'line', 'page', or 'document', not: " +
          a
      );
    }
    e /= this.scale;
    c = this.position.copy();
    "up" === b
      ? (c.y = this.position.y - e)
      : "down" === b
      ? (c.y = this.position.y + e)
      : "left" === b
      ? (c.x = this.position.x - e)
      : "right" === b
      ? (c.x = this.position.x + e)
      : v(
          "scrolling direction must be 'up', 'down', 'left', or 'right', not: " +
            b
        );
    this.position = c;
  };
  t.Vv = function (a) {
    var b = this.viewportBounds;
    b.Qe(a) ||
      ((a = a.center),
      (a.x -= b.width / 2),
      (a.y -= b.height / 2),
      (this.position = a));
  };
  t.xs = function (a) {
    var b = this.viewportBounds;
    a = a.center;
    a.x -= b.width / 2;
    a.y -= b.height / 2;
    this.position = a;
  };
  t.Gq = function (a) {
    var b = this.Bb;
    b.reset();
    1 !== this.Aa && b.scale(this.Aa);
    var c = this.ra;
    (0 !== c.x || 0 !== c.y) &&
      isFinite(c.x) &&
      isFinite(c.y) &&
      b.translate(-c.x, -c.y);
    return a.copy().transform(this.Bb);
  };
  t.hB = function (a) {
    var b = this.Bb,
      c = a.x,
      d = a.y,
      e = c + a.width,
      f = d + a.height,
      g = b.m11,
      h = b.m12,
      k = b.m21,
      l = b.m22,
      m = b.dx,
      n = b.dy,
      p = c * g + d * k + m;
    b = c * h + d * l + n;
    var r = e * g + d * k + m;
    a = e * h + d * l + n;
    d = c * g + f * k + m;
    c = c * h + f * l + n;
    g = e * g + f * k + m;
    e = e * h + f * l + n;
    f = Math.min(p, r);
    p = Math.max(p, r);
    r = Math.min(b, a);
    b = Math.max(b, a);
    f = Math.min(f, d);
    p = Math.max(p, d);
    r = Math.min(r, c);
    b = Math.max(b, c);
    f = Math.min(f, g);
    p = Math.max(p, g);
    r = Math.min(r, e);
    b = Math.max(b, e);
    return new M(f, r, p - f, b - r);
  };
  t.jt = function (a) {
    var b = this.Bb;
    b.reset();
    1 !== this.Aa && b.scale(this.Aa);
    var c = this.ra;
    (0 !== c.x || 0 !== c.y) &&
      isFinite(c.x) &&
      isFinite(c.y) &&
      b.translate(-c.x, -c.y);
    return Lb(a.copy(), this.Bb);
  };
  function gk(a) {
    var b = a.isModified;
    a.wx !== b && ((a.wx = b), a.V("Modified"));
  }
  function hk(a) {
    a = ui.get(a);
    return null !== a ? new a() : new vi();
  }
  Q.prototype.doModelChanged = function (a) {
    var b = this;
    if (a.model === this.model) {
      var c = a.change,
        d = a.propertyName;
      if (c === qe && "S" === d[0])
        if ("StartingFirstTransaction" === d) {
          var e = this;
          a = this.toolManager;
          a.mouseDownTools.each(function (a) {
            a.diagram = e;
          });
          a.mouseMoveTools.each(function (a) {
            a.diagram = e;
          });
          a.mouseUpTools.each(function (a) {
            a.diagram = e;
          });
          this.ed || this.bg || ((this.hl = !0), this.Ln && (this.pg = !0));
        } else
          "StartingUndo" === d || "StartingRedo" === d
            ? ((a = this.animationManager),
              a.defaultAnimation.isAnimating &&
                !this.skipsUndoManager &&
                a.wc(),
              this.V("ChangingSelection", this.selection))
            : "StartedTransaction" === d &&
              ((a = this.animationManager),
              a.defaultAnimation.isAnimating &&
                !this.skipsUndoManager &&
                a.wc());
      else if (this.ba) {
        this.ba = !1;
        try {
          if ("" === a.modelChange && c === qe) {
            if ("FinishedUndo" === d || "FinishedRedo" === d)
              this.V("ChangedSelection", this.selection), uh(this);
            var f = this.animationManager;
            "RolledBackTransaction" === d && f.wc();
            this.hl = !0;
            this.pd();
            (0 !== this.undoManager.transactionLevel &&
              1 !== this.undoManager.transactionLevel) ||
              vh(f);
            "CommittedTransaction" === d &&
              this.undoManager.isJustDiscarded &&
              (this.ye = Math.min(this.ye, this.undoManager.historyIndex - 1));
            ("CommittedTransaction" !== d && "RolledBackTransaction" !== d) ||
              !this.undoManager.isPendingUnmodified ||
              setTimeout(function () {
                b.isModified = !1;
              }, 1);
            var g = a.isTransactionFinished;
            g && (gk(this), this.Ts.clear(), Th(this.animationManager));
            if (!this.ou && g && this.lastInput.targetDiagram) {
              this.ou = !0;
              var h = this;
              va(function () {
                h.currentTool.standardMouseOver();
                h.ou = !1;
              }, 10);
            }
          }
        } finally {
          this.ba = !0;
        }
      }
    }
  };
  function Oj(a, b) {
    b = b.W.m;
    for (var c = b.length, d = 0; d < c; d++) ik(a, b[d]);
  }
  function ik(a, b) {
    if (b instanceof jk) {
      var c = b.element;
      if (null !== c && c instanceof HTMLImageElement) {
        c.Ng instanceof I && c.Ng.add(a);
        var d = b.Rg;
        null !== d && !0 === d.xr && null !== b.diagram && b.diagram.Yo.add(b);
        if (c.Qn)
          if (((c = c.getAttribute("src") || ""), (d = a.kh.K(c)), null === d))
            (d = []), d.push(b), a.kh.add(c, d);
          else {
            for (a = 0; a < d.length; a++) if (d[a] === b) return;
            d.push(b);
          }
      }
    }
  }
  function kk(a, b) {
    if (b instanceof jk) {
      var c = b.element;
      if (
        null !== c &&
        c instanceof HTMLImageElement &&
        (c.Ng instanceof I && c.Ng.remove(a), lk(c), c.Qn)
      ) {
        c = c.getAttribute("src") || "";
        var d = a.kh.K(c);
        if (null !== d)
          for (var e = 0; e < d.length; e++)
            if (d[e] === b) {
              d.splice(e, 1);
              0 === d.length && (a.kh.remove(c), Ki(c));
              break;
            }
      }
    }
  }
  Q.prototype.Rd = function () {
    this.partManager.Rd();
  };
  Q.prototype.ck = function (a, b) {
    this.Ud.ck(a, b);
  };
  Q.prototype.ek = function (a, b) {
    this.Ud.ek(a, b);
  };
  Q.prototype.findPartForKey = function (a) {
    return this.partManager.findPartForKey(a);
  };
  Q.prototype.Mb = function (a) {
    return this.partManager.Mb(a);
  };
  Q.prototype.findLinkForKey = function (a) {
    return this.partManager.findLinkForKey(a);
  };
  t = Q.prototype;
  t.Fc = function (a) {
    return this.partManager.Fc(a);
  };
  t.Pi = function (a) {
    return this.partManager.Pi(a);
  };
  t.Ec = function (a) {
    return this.partManager.Ec(a);
  };
  t.Ds = function (a) {
    for (var b = [], c = 0; c < arguments.length; ++c) b[c] = arguments[c];
    return this.partManager.Ds.apply(
      this.partManager,
      b instanceof Array ? b : da(ca(b))
    );
  };
  t.Cs = function (a) {
    for (var b = [], c = 0; c < arguments.length; ++c) b[c] = arguments[c];
    return this.partManager.Cs.apply(
      this.partManager,
      b instanceof Array ? b : da(ca(b))
    );
  };
  function Li(a) {
    var b = a.ra,
      c = a.Aa;
    a.vx.h(b.x, b.y, Math.max(a.Da, 0) / c, Math.max(a.Ca, 0) / c);
  }
  function Jj(a, b) {
    a.Dj = !1;
    var c = a.er;
    c.D(b) ||
      ((c = c.copy()),
      a.er.assign(b),
      fj(a, !1),
      a.V("DocumentBoundsChanged", void 0, c),
      ij(a));
  }
  t.Za = function () {
    if (this.Dj) {
      var a = M.alloc();
      Jj(this, this.computeBounds(a));
      M.free(a);
    }
  };
  t.bA = function () {
    for (var a = new I(), b = this.nodes; b.next(); ) {
      var c = b.value;
      c.isTopLevel && a.add(c);
    }
    for (b = this.links; b.next(); ) (c = b.value), c.isTopLevel && a.add(c);
    return a.iterator;
  };
  t.aA = function () {
    return this.Fi.iterator;
  };
  t.CA = function (a) {
    uh(this);
    a && mk(this, !0);
    this.ed ? xj(this, !1) : ((this.hl = !0), Ef(this));
  };
  function mk(a, b) {
    for (var c = a.Fi.iterator; c.next(); ) nk(a, c.value, b);
    a.layout && (b ? (a.layout.isValidLayout = !1) : a.layout.F());
  }
  function nk(a, b, c) {
    if (null !== b) {
      for (var d = b.Hl.iterator; d.next(); ) nk(a, d.value, c);
      null !== b.layout && (c ? (b.layout.isValidLayout = !1) : b.layout.F());
    }
  }
  function xj(a, b) {
    if (a.Wh && !a.Ft) {
      var c = a.ba;
      a.ba = !0;
      var d = a.undoManager.transactionLevel,
        e = a.layout,
        f = a.animationManager;
      try {
        0 === d && ((a.undoManager.isInternalTransaction = !0), a.Fa("Layout"));
        1 >= d &&
          !f.defaultAnimation.isAnimating &&
          !f.zb &&
          (b || th(f, "Layout"));
        a.Wh = !1;
        for (var g = a.Fi.iterator; g.next(); ) ok(a, g.value, b, d);
        e.isValidLayout ||
          (!b || e.isRealtime || null === e.isRealtime || 0 === d
            ? (e.doLayout(a), uh(a), (e.isValidLayout = !0))
            : (a.Wh = !0));
      } finally {
        (b = a.undoManager.isInternalTransaction),
          0 === d &&
            (a.gb("Layout"), (a.undoManager.isInternalTransaction = !1)),
          !b || (0 !== d && 1 !== d) || vh(f),
          (a.ba = c);
      }
    }
  }
  function ok(a, b, c, d) {
    if (null !== b) {
      for (var e = b.Hl.iterator; e.next(); ) ok(a, e.value, c, d);
      e = b.layout;
      null === e ||
        e.isValidLayout ||
        (!c || e.isRealtime || 0 === d
          ? ((b.Oh = !b.location.s()),
            e.doLayout(b),
            b.F(32),
            zj(a, b),
            (e.isValidLayout = !0))
          : (a.Wh = !0));
    }
  }
  t.hA = function () {
    for (var a = new H(), b = this.nodes; b.next(); ) {
      var c = b.value;
      c.isTopLevel && null === c.Ri() && a.add(c);
    }
    return a.iterator;
  };
  function Di(a) {
    function b(a) {
      var b = a.toLowerCase(),
        e = new H();
      c.add(a, e);
      c.add(b, e);
      d.add(a, a);
      d.add(b, a);
    }
    var c = new xb(),
      d = new xb();
    b("InitialAnimationStarting");
    b("AnimationStarting");
    b("AnimationFinished");
    b("BackgroundSingleClicked");
    b("BackgroundDoubleClicked");
    b("BackgroundContextClicked");
    b("ClipboardChanged");
    b("ClipboardPasted");
    b("DocumentBoundsChanged");
    b("ExternalObjectsDropped");
    b("GainedFocus");
    b("InitialLayoutCompleted");
    b("LayoutCompleted");
    b("LinkDrawn");
    b("LinkRelinked");
    b("LinkReshaped");
    b("LostFocus");
    b("Modified");
    b("ObjectSingleClicked");
    b("ObjectDoubleClicked");
    b("ObjectContextClicked");
    b("PartCreated");
    b("PartResized");
    b("PartRotated");
    b("SelectionMoved");
    b("SelectionCopied");
    b("SelectionDeleting");
    b("SelectionDeleted");
    b("SelectionGrouped");
    b("SelectionUngrouped");
    b("ChangingSelection");
    b("ChangedSelection");
    b("SubGraphCollapsed");
    b("SubGraphExpanded");
    b("TextEdited");
    b("TreeCollapsed");
    b("TreeExpanded");
    b("ViewportBoundsChanged");
    b("InvalidateDraw");
    a.Jw = c;
    a.Iw = d;
  }
  function Ij(a, b) {
    var c = a.Iw.K(b);
    return null !== c ? c : a.Iw.K(b.toLowerCase());
  }
  function pk(a, b) {
    var c = a.Jw.K(b);
    if (null !== c) return c;
    c = a.Jw.K(b.toLowerCase());
    if (null !== c) return c;
    v("Unknown DiagramEvent name: " + b);
  }
  t.dk = function (a, b) {
    A(a, "string", Q, "addDiagramListener:name");
    A(b, "function", Q, "addDiagramListener:listener");
    a = pk(this, a);
    null !== a && a.add(b);
    return this;
  };
  t.xm = function (a, b) {
    A(a, "string", Q, "removeDiagramListener:name");
    A(b, "function", Q, "addDiagramListener:listener");
    a = pk(this, a);
    null !== a && a.remove(b);
  };
  t.V = function (a, b, c) {
    G && A(a, "string", Q, "raiseDiagramEvent:name");
    var d = pk(this, a),
      e = new ne();
    e.diagram = this;
    a = Ij(this, a);
    null !== a && (e.name = a);
    void 0 !== b && (e.subject = b);
    void 0 !== c && (e.parameter = c);
    b = d.length;
    if (1 === b) d.N(0)(e);
    else if (0 !== b) for (d = d.Ga(), c = 0; c < b; c++) (0, d[c])(e);
  };
  function qk(a) {
    if (a.animationManager.isTicking) return !1;
    var b = a.currentTool;
    return b === a.toolManager.findTool("Dragging")
      ? !a.ms || b.isComplexRoutingRealtime
      : !0;
  }
  t.wk = function (a, b) {
    return rk(this, !1, null, b || null).wk(a.x, a.y, a.width, a.height);
  };
  Q.prototype.computeOccupiedArea = function (a) {
    return this.isVirtualized
      ? this.viewportBounds.copy()
      : this.Dj
      ? ej(this, a)
      : a.assign(this.documentBounds);
  };
  function rk(a, b, c, d) {
    var e = a.Ai;
    null === e && (a.Ai = e = new sk(a.avoidanceCellSize));
    if (e.Ms || e.group !== c || e.Hy !== d) {
      e.ny = Math.max(
        e.ht + 1,
        Math.floor(a.avoidanceLimit / a.avoidanceCellSize.width)
      );
      e.oy = Math.max(
        e.ht + 1,
        Math.floor(a.avoidanceLimit / a.avoidanceCellSize.height)
      );
      null !== c && (c = tk(a, c));
      if (null === c) {
        b = M.alloc();
        a.computeOccupiedArea(b);
        b.Qc(100, 100);
        e.initialize(b);
        for (var f = a.nodes; f.next(); ) {
          var g = f.value,
            h = g.layer;
          null !== h && h.visible && !h.isTemporary && uk(a, g, d, b);
        }
        M.free(b);
      } else {
        0 < c.memberParts.count &&
          ((b = a.computePartsBounds(c.memberParts, !1)),
          b.Qc(20, 20),
          e.initialize(b));
        b = M.alloc();
        for (f = c.memberParts; f.next(); )
          (g = f.value), g instanceof V && uk(a, g, d, b);
        M.free(b);
      }
      e.group = c;
      e.Hy = d;
      e.Ms = !1;
    } else b && vk(e);
    return e;
  }
  function tk(a, b) {
    return b.avoidable && !b.isLinkLabel
      ? b
      : null !== b.containingGroup
      ? tk(a, b.containingGroup)
      : null;
  }
  function uk(a, b, c, d) {
    if (b !== c && b.isVisible())
      if (b.avoidable && !b.isLinkLabel) {
        b = b.getAvoidableRect(d);
        a = a.Ai;
        var e = b.x,
          f = b.y;
        if (Dk(a, e, f))
          for (
            c = ((f - a.Hd) / a.nc) | 0,
              d = Math.min(((e + b.width - a.Gd) / a.mc) | 0, a.Hi),
              b = Math.min(((f + b.height - a.Hd) / a.nc) | 0, a.Ii),
              e = ((e - a.Gd) / a.mc) | 0;
            e <= d;
            e++
          )
            if (((f = a.Yb[e]), f.fill)) f.fill(Hk, c, b + 1);
            else for (var g = c; g <= b; g++) f[g] = Hk;
      } else if (b instanceof vf)
        for (b = b.memberParts; b.next(); )
          (e = b.value), e instanceof V && uk(a, e, c, d);
  }
  function Ik(a, b) {
    null === a.Ai ||
      a.Ai.Ms ||
      (void 0 !== b && (!b.avoidable || b.isLinkLabel)) ||
      (a.Ai.Ms = !0);
  }
  Q.prototype.zs = function (a) {
    this.Nq.assign(a);
    this.computeAutoScrollPosition(this.Nq).$a(this.position)
      ? this.zg()
      : Jk(this);
  };
  function Jk(a) {
    -1 === a.Rk &&
      (a.Rk = va(function () {
        if (-1 !== a.Rk && (a.zg(), null !== a.lastInput.event)) {
          var b = a.computeAutoScrollPosition(a.Nq);
          b.$a(a.position) ||
            ((a.position = b),
            (a.lastInput.documentPoint = a.jt(a.Nq)),
            a.doMouseMove(),
            (a.Dj = !0),
            (b = M.alloc()),
            a.computeBounds(b),
            b.Xc(a.documentBounds),
            Jj(a, b),
            M.free(b),
            (a.dd = !0),
            a.pd(),
            Jk(a));
        }
      }, a.Mq));
  }
  Q.prototype.zg = function () {
    -1 !== this.Rk && (sa.clearTimeout(this.Rk), (this.Rk = -1));
  };
  Q.prototype.computeAutoScrollPosition = function (a) {
    var b = this.position,
      c = this.Oq;
    if (0 >= c.top && 0 >= c.left && 0 >= c.right && 0 >= c.bottom) return b;
    var d = this.viewportBounds,
      e = this.scale;
    d = M.allocAt(0, 0, d.width * e, d.height * e);
    var f = K.allocAt(0, 0);
    if (a.x >= d.x && a.x < d.x + c.left && this.allowHorizontalScroll) {
      var g = Math.max(this.scrollHorizontalLineChange, 1);
      g |= 0;
      f.x -= g;
      a.x < d.x + c.left / 2 && (f.x -= g);
      a.x < d.x + c.left / 4 && (f.x -= 4 * g);
    } else
      a.x <= d.x + d.width &&
        a.x > d.x + d.width - c.right &&
        this.allowHorizontalScroll &&
        ((g = Math.max(this.scrollHorizontalLineChange, 1)),
        (g |= 0),
        (f.x += g),
        a.x > d.x + d.width - c.right / 2 && (f.x += g),
        a.x > d.x + d.width - c.right / 4 && (f.x += 4 * g));
    a.y >= d.y && a.y < d.y + c.top && this.allowVerticalScroll
      ? ((g = Math.max(this.scrollVerticalLineChange, 1)),
        (g |= 0),
        (f.y -= g),
        a.y < d.y + c.top / 2 && (f.y -= g),
        a.y < d.y + c.top / 4 && (f.y -= 4 * g))
      : a.y <= d.y + d.height &&
        a.y > d.y + d.height - c.bottom &&
        this.allowVerticalScroll &&
        ((g = Math.max(this.scrollVerticalLineChange, 1)),
        (g |= 0),
        (f.y += g),
        a.y > d.y + d.height - c.bottom / 2 && (f.y += g),
        a.y > d.y + d.height - c.bottom / 4 && (f.y += 4 * g));
    f.$a(yb) || (b = new K(b.x + f.x / e, b.y + f.y / e));
    M.free(d);
    K.free(f);
    return b;
  };
  t = Q.prototype;
  t.Vs = function () {
    return null;
  };
  t.Gv = function () {
    return null;
  };
  t.lz = function (a, b) {
    this.Zy.add(a, b);
  };
  t.dv = function (a) {
    (this.tx = a) ||
      this.nodes.each(function (a) {
        a instanceof vf && (a.kr = null);
      });
  };
  function Kk(a, b, c) {
    function d() {
      var a = +new Date();
      f = !0;
      for (g.reset(); g.next(); )
        if (!g.value[0].Cl) {
          f = !1;
          break;
        }
      f || a - l > k ? b(c, e, h) : sa.requestAnimationFrame(d);
    }
    for (var e = c.callback, f = !0, g = a.kh.iterator; g.next(); )
      if (!g.value[0].Cl) {
        f = !1;
        break;
      }
    if ("function" !== typeof e || f) return b(c, e, a);
    var h = a,
      k = c.callbackTimeout || 300,
      l = +new Date();
    sa.requestAnimationFrame(function () {
      d();
    });
    return null;
  }
  t.EA = function (a) {
    if (!Wg) return null;
    void 0 === a && (a = {});
    a.returnType = "Image";
    return this.py(a);
  };
  t.py = function (a) {
    void 0 === a && (a = {});
    return Kk(this, this.FA, a);
  };
  t.FA = function (a, b, c) {
    var d = Lk(c, a, "canvas", null);
    if (null === d) return null;
    c = d.aa.canvas;
    var e = null;
    if (null !== c)
      switch (
        ((e = a.returnType),
        void 0 === e ? (e = "string") : (e = e.toLowerCase()),
        e)
      ) {
        case Mk + "data":
          e = d.getImageData(0, 0, c.width, c.height);
          break;
        case Mk:
          d = (a.document || document).createElement("img");
          d.src = c.toDataURL(a.type, a.details);
          e = d;
          break;
        case "blob":
          "function" !== typeof b &&
            v(
              'Error: Diagram.makeImageData called with "returnType: toBlob", but no required "callback" function property defined.'
            );
          if ("function" === typeof c.toBlob)
            return c.toBlob(b, a.type, a.details), "toBlob";
          if ("function" === typeof c.msToBlob)
            return b(c.msToBlob()), "msToBlob";
          b(null);
          return null;
        default:
          e = c.toDataURL(a.type, a.details);
      }
    return "function" === typeof b ? (b(e), null) : e;
  };
  function Lk(a, b, c, d) {
    a.animationManager.wc();
    a.pd();
    if (null === a.Ia) return null;
    "object" !== typeof b && v("properties argument must be an Object.");
    var e = !1,
      f = b.size || null,
      g = b.scale || null;
    void 0 !== b.scale && isNaN(b.scale) && (g = "NaN");
    var h = b.maxSize;
    void 0 === b.maxSize &&
      ((e = !0),
      (h = "SVG" === c ? new Gb(Infinity, Infinity) : new Gb(2e3, 2e3)));
    var k = b.position || null,
      l = b.parts || null,
      m = void 0 === b.padding ? 1 : b.padding,
      n = b.background || null,
      p = b.omitTemporary;
    void 0 === p && (p = !0);
    var r = b.document || document,
      q = b.elementFinished || null,
      u = b.showTemporary;
    void 0 === u && (u = !p);
    b = b.showGrid;
    void 0 === b && (b = u);
    null !== f && isNaN(f.width) && isNaN(f.height) && (f = null);
    "number" === typeof m
      ? (m = new ic(m))
      : m instanceof ic || v("MakeImage padding must be a Margin or a number.");
    m.left = Math.max(m.left, 0);
    m.right = Math.max(m.right, 0);
    m.top = Math.max(m.top, 0);
    m.bottom = Math.max(m.bottom, 0);
    a.$b.Nc(!0);
    p = new Nk(null, r);
    var w = p.context;
    if (!(f || g || l || k)) {
      p.width = a.Da + Math.ceil(m.left + m.right);
      p.height = a.Ca + Math.ceil(m.top + m.bottom);
      if ("SVG" === c) {
        if (null === d) return null;
        d.resize(p.width, p.height, p.width, p.height);
        d.ownerDocument = r;
        d.cq = q;
        Gj(a, d.context, m, new Gb(p.width, p.height), a.Aa, a.ra, l, n, u, b);
        return d.context;
      }
      a.Dn = !1;
      Gj(a, w, m, new Gb(p.width, p.height), a.Aa, a.ra, l, n, u, b);
      a.Dn = !0;
      return p.context;
    }
    var y = a.cr,
      z = a.documentBounds.copy();
    z.cw(a.ub);
    if (u)
      for (var B = a.Va.m, C = B.length, E = 0; E < C; E++) {
        var J = B[E];
        if (J.visible && J.isTemporary) {
          J = J.Ma.m;
          for (var S = J.length, aa = 0; aa < S; aa++) {
            var Y = J[aa];
            Y.isInDocumentBounds &&
              Y.isVisible() &&
              ((Y = Y.actualBounds), Y.s() && z.Xc(Y));
          }
        }
      }
    B = new K(z.x, z.y);
    if (null !== l) {
      C = new M(0, 0, 0, 0);
      E = !0;
      J = l.iterator;
      for (J.reset(); J.next(); )
        (S = J.value),
          S instanceof U &&
            ((aa = S.layer),
            (null !== aa && !aa.visible) ||
              (null !== aa && !u && aa.isTemporary) ||
              !S.isVisible() ||
              ((S = S.actualBounds),
              S.s() && (E ? ((E = !1), C.assign(S)) : C.Xc(S))));
      z.width = C.width;
      z.height = C.height;
      B.x = C.x;
      B.y = C.y;
    }
    null !== k && k.s() && ((B = k), g || (g = y));
    C = k = 0;
    null !== m && ((k = m.left + m.right), (C = m.top + m.bottom));
    E = J = 0;
    null !== f &&
      ((J = f.width),
      (E = f.height),
      isFinite(J) && (J = Math.max(0, J - k)),
      isFinite(E) && (E = Math.max(0, E - C)));
    null !== f && null !== g
      ? ("NaN" === g && (g = y),
        f.s()
          ? ((f = J), (z = E))
          : isNaN(E)
          ? ((f = J), (z = z.height * g))
          : ((f = z.width * g), (z = E)))
      : null !== f
      ? f.s()
        ? ((g = Math.min(J / z.width, E / z.height)), (f = J), (z = E))
        : isNaN(E)
        ? ((g = J / z.width), (f = J), (z = z.height * g))
        : ((g = E / z.height), (f = z.width * g), (z = E))
      : null !== g
      ? "NaN" === g && h.s()
        ? ((g = Math.min((h.width - k) / z.width, (h.height - C) / z.height)),
          g > y
            ? ((g = y), (f = z.width), (z = z.height))
            : ((f = h.width), (z = h.height)))
        : ((f = z.width * g), (z = z.height * g))
      : ((g = y), (f = z.width), (z = z.height));
    null !== m ? ((f += k), (z += C)) : (m = new ic(0));
    null !== h &&
      ((y = h.width),
      (h = h.height),
      "SVG" !== c &&
        e &&
        !Ok &&
        G &&
        (f > y || z > h) &&
        (Fa(
          "Diagram.makeImage(data): Diagram width or height is larger than the default max size. (" +
            Math.ceil(f) +
            "x" +
            Math.ceil(z) +
            " vs 2000x2000) Consider increasing the max size."
        ),
        (Ok = !0)),
      isNaN(y) && (y = 2e3),
      isNaN(h) && (h = 2e3),
      isFinite(y) && (f = Math.min(f, y)),
      isFinite(h) && (z = Math.min(z, h)));
    p.width = Math.ceil(f);
    p.height = Math.ceil(z);
    if ("SVG" === c) {
      if (null === d) return null;
      d.resize(p.width, p.height, p.width, p.height);
      d.ownerDocument = r;
      d.cq = q;
      Gj(a, d.context, m, new Gb(Math.ceil(f), Math.ceil(z)), g, B, l, n, u, b);
      return d.context;
    }
    a.Dn = !1;
    Gj(a, w, m, new Gb(Math.ceil(f), Math.ceil(z)), g, B, l, n, u, b);
    a.Dn = !0;
    return p.context;
  }
  oa.Object.defineProperties(Q.prototype, {
    div: {
      configurable: !0,
      get: function () {
        return this.La;
      },
      set: function (a) {
        null !== a && x(a, HTMLDivElement, Q, "div");
        if (this.La !== a) {
          var b = this.La;
          null !== b
            ? ((b.G = void 0),
              (b.goDiagram = void 0),
              (b.go = void 0),
              (b.innerHTML = ""),
              null !== this.Ia &&
                ((b = this.Ia.Sa),
                this.removeEventListener(b, "pointermove", this.Ek, !1),
                this.removeEventListener(b, "pointerdown", this.Dk, !1),
                this.removeEventListener(b, "pointerup", this.Gk, !1),
                this.removeEventListener(b, "pointerout", this.Fk, !1),
                this.Ia.Ox()),
              this.Pl && (this.Pl.disconnect(), (this.Pl = null)),
              (b = this.toolManager),
              null !== b &&
                (b.mouseDownTools.each(function (a) {
                  a.cancelWaitAfter();
                }),
                b.mouseMoveTools.each(function (a) {
                  a.cancelWaitAfter();
                }),
                b.mouseUpTools.each(function (a) {
                  a.cancelWaitAfter();
                })),
              b.cancelWaitAfter(),
              this.currentTool.doCancel(),
              (this.Ia = null),
              this.removeEventListener(sa, "resize", this.lw, !1),
              this.removeEventListener(sa, "wheel", this.zk, !0),
              xe === this && (xe = null))
            : (this.bg = !1);
          this.La = null;
          if (null !== a) {
            if ((b = a.G)) b.div = null;
            Bi(this, a);
            this.redraw();
          }
        }
      },
    },
    Ex: {
      configurable: !0,
      get: function () {
        return this.Kr;
      },
    },
    Yi: {
      configurable: !0,
      get: function () {
        return this.bg;
      },
    },
    draggedLink: {
      configurable: !0,
      get: function () {
        return this.Ht;
      },
      set: function (a) {
        this.Ht !== a &&
          ((this.Ht = a),
          null !== a && ((this.su = a.fromPort), (this.tu = a.toPort)));
      },
    },
    uy: {
      configurable: !0,
      get: function () {
        return this.su;
      },
      set: function (a) {
        this.su = a;
      },
    },
    vy: {
      configurable: !0,
      get: function () {
        return this.tu;
      },
      set: function (a) {
        this.tu = a;
      },
    },
    animationManager: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Ud;
      },
    },
    undoManager: {
      configurable: !0,
      get: function () {
        return this.ac.undoManager;
      },
    },
    skipsUndoManager: {
      configurable: !0,
      get: function () {
        return this.qh;
      },
      set: function (a) {
        A(a, "boolean", Q, "skipsUndoManager");
        this.qh = a;
        this.ac.skipsUndoManager = a;
      },
    },
    delaysLayout: {
      configurable: !0,
      get: function () {
        return this.Ft;
      },
      set: function (a) {
        this.Ft = a;
      },
    },
    opacity: {
      configurable: !0,
      get: function () {
        return this.tb;
      },
      set: function (a) {
        var b = this.tb;
        b !== a &&
          (A(a, "number", Q, "opacity"),
          (0 > a || 1 < a) && Aa(a, "0 <= value <= 1", Q, "opacity"),
          (this.tb = a),
          this.g("opacity", b, a),
          this.R());
      },
    },
    validCycle: {
      configurable: !0,
      get: function () {
        return this.Uu;
      },
      set: function (a) {
        var b = this.Uu;
        b !== a &&
          (cb(a, Q, Q, "validCycle"),
          (this.Uu = a),
          this.g("validCycle", b, a));
      },
    },
    layers: {
      configurable: !0,
      get: function () {
        return this.Va.iterator;
      },
    },
    isModelReadOnly: {
      configurable: !0,
      get: function () {
        var a = this.ac;
        return null === a ? !1 : a.isReadOnly;
      },
      set: function (a) {
        var b = this.ac;
        null !== b && (b.isReadOnly = a);
      },
    },
    isReadOnly: {
      configurable: !0,
      get: function () {
        return this.Xg;
      },
      set: function (a) {
        var b = this.Xg;
        b !== a &&
          (A(a, "boolean", Q, "isReadOnly"),
          (this.Xg = a),
          this.g("isReadOnly", b, a));
      },
    },
    isEnabled: {
      configurable: !0,
      get: function () {
        return this.Dd;
      },
      set: function (a) {
        var b = this.Dd;
        b !== a &&
          (A(a, "boolean", Q, "isEnabled"),
          (this.Dd = a),
          this.g("isEnabled", b, a));
      },
    },
    allowClipboard: {
      configurable: !0,
      get: function () {
        return this.ot;
      },
      set: function (a) {
        var b = this.ot;
        b !== a &&
          (A(a, "boolean", Q, "allowClipboard"),
          (this.ot = a),
          this.g("allowClipboard", b, a));
      },
    },
    allowCopy: {
      configurable: !0,
      get: function () {
        return this.jj;
      },
      set: function (a) {
        var b = this.jj;
        b !== a &&
          (A(a, "boolean", Q, "allowCopy"),
          (this.jj = a),
          this.g("allowCopy", b, a));
      },
    },
    allowDelete: {
      configurable: !0,
      get: function () {
        return this.kj;
      },
      set: function (a) {
        var b = this.kj;
        b !== a &&
          (A(a, "boolean", Q, "allowDelete"),
          (this.kj = a),
          this.g("allowDelete", b, a));
      },
    },
    allowDragOut: {
      configurable: !0,
      get: function () {
        return this.pt;
      },
      set: function (a) {
        var b = this.pt;
        b !== a &&
          (A(a, "boolean", Q, "allowDragOut"),
          (this.pt = a),
          this.g("allowDragOut", b, a));
      },
    },
    allowDrop: {
      configurable: !0,
      get: function () {
        return this.qt;
      },
      set: function (a) {
        var b = this.qt;
        b !== a &&
          (A(a, "boolean", Q, "allowDrop"),
          (this.qt = a),
          this.g("allowDrop", b, a));
      },
    },
    allowTextEdit: {
      configurable: !0,
      get: function () {
        return this.tj;
      },
      set: function (a) {
        var b = this.tj;
        b !== a &&
          (A(a, "boolean", Q, "allowTextEdit"),
          (this.tj = a),
          this.g("allowTextEdit", b, a));
      },
    },
    allowGroup: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.lj;
      },
      set: function (a) {
        var b = this.lj;
        b !== a &&
          (A(a, "boolean", Q, "allowGroup"),
          (this.lj = a),
          this.g("allowGroup", b, a));
      },
    },
    allowUngroup: {
      configurable: !0,
      get: function () {
        return this.uj;
      },
      set: function (a) {
        var b = this.uj;
        b !== a &&
          (A(a, "boolean", Q, "allowUngroup"),
          (this.uj = a),
          this.g("allowUngroup", b, a));
      },
    },
    allowInsert: {
      configurable: !0,
      get: function () {
        return this.st;
      },
      set: function (a) {
        var b = this.st;
        b !== a &&
          (A(a, "boolean", Q, "allowInsert"),
          (this.st = a),
          this.g("allowInsert", b, a));
      },
    },
    allowLink: {
      configurable: !0,
      get: function () {
        return this.mj;
      },
      set: function (a) {
        var b = this.mj;
        b !== a &&
          (A(a, "boolean", Q, "allowLink"),
          (this.mj = a),
          this.g("allowLink", b, a));
      },
    },
    allowRelink: {
      configurable: !0,
      get: function () {
        return this.oj;
      },
      set: function (a) {
        var b = this.oj;
        b !== a &&
          (A(a, "boolean", Q, "allowRelink"),
          (this.oj = a),
          this.g("allowRelink", b, a));
      },
    },
    allowMove: {
      configurable: !0,
      get: function () {
        return this.nj;
      },
      set: function (a) {
        var b = this.nj;
        b !== a &&
          (A(a, "boolean", Q, "allowMove"),
          (this.nj = a),
          this.g("allowMove", b, a));
      },
    },
    allowReshape: {
      configurable: !0,
      get: function () {
        return this.pj;
      },
      set: function (a) {
        var b = this.pj;
        b !== a &&
          (A(a, "boolean", Q, "allowReshape"),
          (this.pj = a),
          this.g("allowReshape", b, a));
      },
    },
    allowResize: {
      configurable: !0,
      get: function () {
        return this.qj;
      },
      set: function (a) {
        var b = this.qj;
        b !== a &&
          (A(a, "boolean", Q, "allowResize"),
          (this.qj = a),
          this.g("allowResize", b, a));
      },
    },
    allowRotate: {
      configurable: !0,
      get: function () {
        return this.rj;
      },
      set: function (a) {
        var b = this.rj;
        b !== a &&
          (A(a, "boolean", Q, "allowRotate"),
          (this.rj = a),
          this.g("allowRotate", b, a));
      },
    },
    allowSelect: {
      configurable: !0,
      get: function () {
        return this.sj;
      },
      set: function (a) {
        var b = this.sj;
        b !== a &&
          (A(a, "boolean", Q, "allowSelect"),
          (this.sj = a),
          this.g("allowSelect", b, a));
      },
    },
    allowUndo: {
      configurable: !0,
      get: function () {
        return this.tt;
      },
      set: function (a) {
        var b = this.tt;
        b !== a &&
          (A(a, "boolean", Q, "allowUndo"),
          (this.tt = a),
          this.g("allowUndo", b, a));
      },
    },
    allowZoom: {
      configurable: !0,
      get: function () {
        return this.vt;
      },
      set: function (a) {
        var b = this.vt;
        b !== a &&
          (A(a, "boolean", Q, "allowZoom"),
          (this.vt = a),
          this.g("allowZoom", b, a));
      },
    },
    hasVerticalScrollbar: {
      configurable: !0,
      get: function () {
        return this.Zn;
      },
      set: function (a) {
        var b = this.Zn;
        b !== a &&
          (A(a, "boolean", Q, "hasVerticalScrollbar"),
          (this.Zn = a),
          ij(this),
          this.R(),
          this.g("hasVerticalScrollbar", b, a),
          fj(this, !1));
      },
    },
    hasHorizontalScrollbar: {
      configurable: !0,
      get: function () {
        return this.Yn;
      },
      set: function (a) {
        var b = this.Yn;
        b !== a &&
          (A(a, "boolean", Q, "hasHorizontalScrollbar"),
          (this.Yn = a),
          ij(this),
          this.R(),
          this.g("hasHorizontalScrollbar", b, a),
          fj(this, !1));
      },
    },
    allowHorizontalScroll: {
      configurable: !0,
      get: function () {
        return this.rt;
      },
      set: function (a) {
        var b = this.rt;
        b !== a &&
          (A(a, "boolean", Q, "allowHorizontalScroll"),
          (this.rt = a),
          this.g("allowHorizontalScroll", b, a),
          fj(this, !1));
      },
    },
    allowVerticalScroll: {
      configurable: !0,
      get: function () {
        return this.ut;
      },
      set: function (a) {
        var b = this.ut;
        b !== a &&
          (A(a, "boolean", Q, "allowVerticalScroll"),
          (this.ut = a),
          this.g("allowVerticalScroll", b, a),
          fj(this, !1));
      },
    },
    scrollHorizontalLineChange: {
      configurable: !0,
      get: function () {
        return this.Gu;
      },
      set: function (a) {
        var b = this.Gu;
        b !== a &&
          (A(a, "number", Q, "scrollHorizontalLineChange"),
          0 > a && Aa(a, ">= 0", Q, "scrollHorizontalLineChange"),
          (this.Gu = a),
          this.g("scrollHorizontalLineChange", b, a));
      },
    },
    scrollVerticalLineChange: {
      configurable: !0,
      get: function () {
        return this.Ku;
      },
      set: function (a) {
        var b = this.Ku;
        b !== a &&
          (A(a, "number", Q, "scrollVerticalLineChange"),
          0 > a && Aa(a, ">= 0", Q, "scrollVerticalLineChange"),
          (this.Ku = a),
          this.g("scrollVerticalLineChange", b, a));
      },
    },
    lastInput: {
      configurable: !0,
      get: function () {
        return this.Kj;
      },
      set: function (a) {
        G && x(a, le, Q, "lastInput");
        this.Kj = a;
      },
    },
    previousInput: {
      configurable: !0,
      get: function () {
        return this.mh;
      },
      set: function (a) {
        G && x(a, le, Q, "previousInput");
        this.mh = a;
      },
    },
    firstInput: {
      configurable: !0,
      get: function () {
        return this.mr;
      },
      set: function (a) {
        G && x(a, le, Q, "firstInput");
        this.mr = a;
      },
    },
    currentCursor: {
      configurable: !0,
      get: function () {
        return this.Ct;
      },
      set: function (a) {
        "" === a && (a = this.br);
        if (this.Ct !== a) {
          A(a, "string", Q, "currentCursor");
          var b = this.Ia,
            c = this.La;
          if (null !== b && null !== c) {
            this.Ct = a;
            var d = b.style.cursor;
            b.style.cursor = a;
            c.style.cursor = a;
            b.style.cursor === d &&
              ((b.style.cursor = "-webkit-" + a),
              (c.style.cursor = "-webkit-" + a),
              b.style.cursor === d &&
                ((b.style.cursor = "-moz-" + a),
                (c.style.cursor = "-moz-" + a),
                b.style.cursor === d &&
                  ((b.style.cursor = a), (c.style.cursor = a))));
          }
        }
      },
    },
    defaultCursor: {
      configurable: !0,
      get: function () {
        return this.br;
      },
      set: function (a) {
        "" === a && (a = "auto");
        var b = this.br;
        b !== a &&
          (A(a, "string", Q, "defaultCursor"),
          (this.br = a),
          this.g("defaultCursor", b, a));
      },
    },
    click: {
      configurable: !0,
      get: function () {
        return this.Gg;
      },
      set: function (a) {
        var b = this.Gg;
        b !== a &&
          (null !== a && A(a, "function", Q, "click"),
          (this.Gg = a),
          this.g("click", b, a));
      },
    },
    doubleClick: {
      configurable: !0,
      get: function () {
        return this.Og;
      },
      set: function (a) {
        var b = this.Og;
        b !== a &&
          (null !== a && A(a, "function", Q, "doubleClick"),
          (this.Og = a),
          this.g("doubleClick", b, a));
      },
    },
    contextClick: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Ig;
      },
      set: function (a) {
        var b = this.Ig;
        b !== a &&
          (null !== a && A(a, "function", Q, "contextClick"),
          (this.Ig = a),
          this.g("contextClick", b, a));
      },
    },
    mouseOver: {
      configurable: !0,
      get: function () {
        return this.hh;
      },
      set: function (a) {
        var b = this.hh;
        b !== a &&
          (null !== a && A(a, "function", Q, "mouseOver"),
          (this.hh = a),
          this.g("mouseOver", b, a));
      },
    },
    mouseHover: {
      configurable: !0,
      get: function () {
        return this.fh;
      },
      set: function (a) {
        var b = this.fh;
        b !== a &&
          (null !== a && A(a, "function", Q, "mouseHover"),
          (this.fh = a),
          this.g("mouseHover", b, a));
      },
    },
    mouseHold: {
      configurable: !0,
      get: function () {
        return this.eh;
      },
      set: function (a) {
        var b = this.eh;
        b !== a &&
          (null !== a && A(a, "function", Q, "mouseHold"),
          (this.eh = a),
          this.g("mouseHold", b, a));
      },
    },
    mouseDragOver: {
      configurable: !0,
      get: function () {
        return this.nu;
      },
      set: function (a) {
        var b = this.nu;
        b !== a &&
          (null !== a && A(a, "function", Q, "mouseDragOver"),
          (this.nu = a),
          this.g("mouseDragOver", b, a));
      },
    },
    mouseDrop: {
      configurable: !0,
      get: function () {
        return this.bh;
      },
      set: function (a) {
        var b = this.bh;
        b !== a &&
          (G && null !== a && A(a, "function", Q, "mouseDrop"),
          (this.bh = a),
          this.g("mouseDrop", b, a));
      },
    },
    handlesDragDropForTopLevelParts: {
      configurable: !0,
      get: function () {
        return this.St;
      },
      set: function (a) {
        var b = this.St;
        b !== a &&
          (A(a, "boolean", Q, "handlesDragDropForTopLevelParts"),
          (this.St = a),
          this.g("handlesDragDropForTopLevelParts", b, a));
      },
    },
    mouseEnter: {
      configurable: !0,
      get: function () {
        return this.dh;
      },
      set: function (a) {
        var b = this.dh;
        b !== a &&
          (null !== a && A(a, "function", Q, "mouseEnter"),
          (this.dh = a),
          this.g("mouseEnter", b, a));
      },
    },
    mouseLeave: {
      configurable: !0,
      get: function () {
        return this.gh;
      },
      set: function (a) {
        var b = this.gh;
        b !== a &&
          (null !== a && A(a, "function", Q, "mouseLeave"),
          (this.gh = a),
          this.g("mouseLeave", b, a));
      },
    },
    toolTip: {
      configurable: !0,
      get: function () {
        return this.zh;
      },
      set: function (a) {
        var b = this.zh;
        b !== a &&
          (!G ||
            null === a ||
            a instanceof Je ||
            a instanceof Oe ||
            v("Diagram.toolTip must be an Adornment or HTMLInfo."),
          (this.zh = a),
          this.g("toolTip", b, a));
      },
    },
    contextMenu: {
      configurable: !0,
      get: function () {
        return this.Jg;
      },
      set: function (a) {
        var b = this.Jg;
        b !== a &&
          (!G ||
            a instanceof Je ||
            a instanceof Oe ||
            v("Diagram.contextMenu must be an Adornment or HTMLInfo."),
          (this.Jg = a),
          this.g("contextMenu", b, a));
      },
    },
    commandHandler: {
      configurable: !0,
      get: function () {
        return this.Yc;
      },
      set: function (a) {
        this.Yc !== a && ((this.Yc = a), a.Xe(this));
      },
    },
    toolManager: {
      configurable: !0,
      get: function () {
        return this.hj;
      },
      set: function (a) {
        this.hj !== a &&
          (x(a, Ua, Q, "toolManager"), (this.hj = a), (a.diagram = this));
      },
    },
    defaultTool: {
      configurable: !0,
      get: function () {
        return this.Zc;
      },
      set: function (a) {
        var b = this.Zc;
        b !== a &&
          (x(a, we, Q, "defaultTool"),
          (this.Zc = a),
          (a.diagram = this),
          this.currentTool === b && (this.currentTool = a));
      },
    },
    currentTool: {
      configurable: !0,
      get: function () {
        return this.Hc;
      },
      set: function (a) {
        var b = this.Hc;
        b && (b.isActive && b.doDeactivate(), b.cancelWaitAfter(), b.doStop());
        null === a && (a = this.defaultTool);
        null !== a &&
          (x(a, we, Q, "currentTool"),
          (this.Hc = a),
          (a.diagram = this),
          a.doStart());
      },
    },
    selection: {
      configurable: !0,
      get: function () {
        return this.kx;
      },
    },
    maxSelectionCount: {
      configurable: !0,
      get: function () {
        return this.iu;
      },
      set: function (a) {
        var b = this.iu;
        if (b !== a)
          if ((A(a, "number", Q, "maxSelectionCount"), 0 <= a && !isNaN(a))) {
            if (
              ((this.iu = a),
              this.g("maxSelectionCount", b, a),
              !this.undoManager.isUndoingRedoing &&
                ((a = this.selection.count - a), 0 < a))
            ) {
              this.V("ChangingSelection", this.selection);
              b = this.selection.Ga();
              for (var c = 0; c < a; c++) b[c].isSelected = !1;
              this.V("ChangedSelection", this.selection);
            }
          } else Aa(a, ">= 0", Q, "maxSelectionCount");
      },
    },
    nodeSelectionAdornmentTemplate: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.pu;
      },
      set: function (a) {
        var b = this.pu;
        b !== a &&
          (x(a, Je, Q, "nodeSelectionAdornmentTemplate"),
          (this.pu = a),
          this.g("nodeSelectionAdornmentTemplate", b, a));
      },
    },
    groupSelectionAdornmentTemplate: {
      configurable: !0,
      get: function () {
        return this.Rt;
      },
      set: function (a) {
        var b = this.Rt;
        b !== a &&
          (x(a, Je, Q, "groupSelectionAdornmentTemplate"),
          (this.Rt = a),
          this.g("groupSelectionAdornmentTemplate", b, a));
      },
    },
    linkSelectionAdornmentTemplate: {
      configurable: !0,
      get: function () {
        return this.fu;
      },
      set: function (a) {
        var b = this.fu;
        b !== a &&
          (x(a, Je, Q, "linkSelectionAdornmentTemplate"),
          (this.fu = a),
          this.g("linkSelectionAdornmentTemplate", b, a));
      },
    },
    highlighteds: {
      configurable: !0,
      get: function () {
        return this.Pw;
      },
    },
    isModified: {
      configurable: !0,
      get: function () {
        var a = this.undoManager;
        return a.isEnabled
          ? null !== a.currentTransaction
            ? !0
            : this.eo && this.ye !== a.historyIndex
          : this.eo;
      },
      set: function (a) {
        if (this.eo !== a) {
          A(a, "boolean", Q, "isModified");
          this.eo = a;
          var b = this.undoManager;
          !a && b.isEnabled && (this.ye = b.historyIndex);
          a || gk(this);
        }
      },
    },
    model: {
      configurable: !0,
      get: function () {
        return this.ac;
      },
      set: function (a) {
        var b = this.ac;
        if (b !== a) {
          x(a, X, Q, "model");
          this.currentTool.doCancel();
          b &&
            b.undoManager !== a.undoManager &&
            b.undoManager.isInTransaction &&
            v(
              "Do not replace a Diagram.model while a transaction is in progress."
            );
          this.animationManager.wc(!0);
          var c = Ji(this, !0);
          this.bg = !1;
          this.Ln = !0;
          this.ye = -2;
          this.pg = !1;
          var d = this.wb;
          this.wb = !0;
          th(this.animationManager, "Model");
          b &&
            (null !== this.mf &&
              this.mf.each(function (a) {
                b.Ik(a);
              }),
            b.Ik(this.Rh));
          this.ac = a;
          this.partManager = hk(this.ac.type);
          for (var e = 0; e < c.length; e++) this.add(c[e]);
          a.Dh(this.Td);
          this.partManager.addAllModeledParts();
          a.Ik(this.Td);
          a.Dh(this.Rh);
          null !== this.mf &&
            this.mf.each(function (b) {
              a.Dh(b);
            });
          this.wb = d;
          this.Wa();
          this.wb || this.R();
          b && a.undoManager.copyProperties(b.undoManager);
        }
      },
    },
    ba: {
      configurable: !0,
      get: function () {
        return this.Tw;
      },
      set: function (a) {
        this.Tw = a;
      },
    },
    Ts: {
      configurable: !0,
      get: function () {
        return this.Yy;
      },
    },
    skipsModelSourceBindings: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.lx;
      },
      set: function (a) {
        this.lx = a;
      },
    },
    gt: {
      configurable: !0,
      get: function () {
        return this.Mu;
      },
      set: function (a) {
        this.Mu = a;
      },
    },
    nodeTemplate: {
      configurable: !0,
      get: function () {
        return this.jh.K("");
      },
      set: function (a) {
        var b = this.jh.K("");
        b !== a &&
          (x(a, U, Q, "nodeTemplate"),
          this.jh.add("", a),
          this.g("nodeTemplate", b, a),
          this.undoManager.isUndoingRedoing || this.Rd());
      },
    },
    nodeTemplateMap: {
      configurable: !0,
      get: function () {
        return this.jh;
      },
      set: function (a) {
        var b = this.jh;
        b !== a &&
          (x(a, xb, Q, "nodeTemplateMap"),
          (this.jh = a),
          this.g("nodeTemplateMap", b, a),
          this.undoManager.isUndoingRedoing || this.Rd());
      },
    },
    groupTemplate: {
      configurable: !0,
      get: function () {
        return this.Cj.K("");
      },
      set: function (a) {
        var b = this.Cj.K("");
        b !== a &&
          (x(a, vf, Q, "groupTemplate"),
          this.Cj.add("", a),
          this.g("groupTemplate", b, a),
          this.undoManager.isUndoingRedoing || this.Rd());
      },
    },
    groupTemplateMap: {
      configurable: !0,
      get: function () {
        return this.Cj;
      },
      set: function (a) {
        var b = this.Cj;
        b !== a &&
          (x(a, xb, Q, "groupTemplateMap"),
          (this.Cj = a),
          this.g("groupTemplateMap", b, a),
          this.undoManager.isUndoingRedoing || this.Rd());
      },
    },
    linkTemplate: {
      configurable: !0,
      get: function () {
        return this.pi.K("");
      },
      set: function (a) {
        var b = this.pi.K("");
        b !== a &&
          (x(a, R, Q, "linkTemplate"),
          this.pi.add("", a),
          this.g("linkTemplate", b, a),
          this.undoManager.isUndoingRedoing || this.Rd());
      },
    },
    linkTemplateMap: {
      configurable: !0,
      get: function () {
        return this.pi;
      },
      set: function (a) {
        var b = this.pi;
        b !== a &&
          (x(a, xb, Q, "linkTemplateMap"),
          (this.pi = a),
          this.g("linkTemplateMap", b, a),
          this.undoManager.isUndoingRedoing || this.Rd());
      },
    },
    isMouseCaptured: {
      configurable: !0,
      get: function () {
        return this.Sw;
      },
      set: function (a) {
        var b = this.Ia;
        null !== b &&
          ((b = b.Sa),
          b instanceof SVGElement ||
            (a
              ? ((this.lastInput.bubbles = !1),
                this.removeEventListener(b, "pointermove", this.Ek, !1),
                this.removeEventListener(b, "pointerdown", this.Dk, !1),
                this.removeEventListener(b, "pointerup", this.Gk, !1),
                this.removeEventListener(b, "pointerout", this.Fk, !1),
                this.addEventListener(sa, "pointermove", this.Ek, !0),
                this.addEventListener(sa, "pointerdown", this.Dk, !0),
                this.addEventListener(sa, "pointerup", this.Gk, !0),
                this.addEventListener(sa, "pointerout", this.Fk, !0),
                this.removeEventListener(b, "wheel", this.zk, !1),
                this.addEventListener(sa, "wheel", this.zk, !0),
                this.addEventListener(
                  sa,
                  "selectstart",
                  this.preventDefault,
                  !1
                ))
              : (this.removeEventListener(sa, "pointermove", this.Ek, !0),
                this.removeEventListener(sa, "pointerdown", this.Dk, !0),
                this.removeEventListener(sa, "pointerup", this.Gk, !0),
                this.removeEventListener(sa, "pointerout", this.Fk, !0),
                this.addEventListener(b, "pointermove", this.Ek, !1),
                this.addEventListener(b, "pointerdown", this.Dk, !1),
                this.addEventListener(b, "pointerup", this.Gk, !1),
                this.addEventListener(b, "pointerout", this.Fk, !1),
                this.removeEventListener(sa, "wheel", this.zk, !0),
                this.removeEventListener(
                  sa,
                  "selectstart",
                  this.preventDefault,
                  !1
                ),
                this.addEventListener(b, "wheel", this.zk, !1)),
            (this.Sw = a)));
      },
    },
    position: {
      configurable: !0,
      get: function () {
        return this.ra;
      },
      set: function (a) {
        var b = K.alloc().assign(this.ra);
        if (!b.D(a)) {
          x(a, K, Q, "position");
          var c = this.viewportBounds.copy();
          this.ra.assign(a);
          Wh(this.animationManager, b, this.ra);
          this.wb || (null === this.Ia && !this.Op.s())
            ? Li(this)
            : ((this.wb = !0),
              (a = this.scale),
              hj(this, this.er, this.Da / a, this.Ca / a, this.Yk, !1),
              (this.wb = !1));
          if (!this.wb)
            this.onViewportBoundsChanged(c, this.viewportBounds, this.Aa, !1);
        }
        K.free(b);
      },
    },
    initialPosition: {
      configurable: !0,
      get: function () {
        return this.Ut;
      },
      set: function (a) {
        this.Ut.D(a) || (x(a, K, Q, "initialPosition"), (this.Ut = a.L()));
      },
    },
    initialScale: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Vt;
      },
      set: function (a) {
        this.Vt !== a && (A(a, "number", Q, "initialScale"), (this.Vt = a));
      },
    },
    grid: {
      configurable: !0,
      get: function () {
        null === this.ae && (this.ae = Oi(this));
        return this.ae;
      },
      set: function (a) {
        var b = this.ae;
        if (b !== a) {
          null === b && (b = this.ae = Oi(this));
          x(a, W, Q, "grid");
          a.type !== W.Grid &&
            v("Diagram.grid must be a Panel of type Panel.Grid");
          var c = b.panel;
          null !== c && c.remove(b);
          this.ae = a;
          a.name = "GRID";
          null !== c && c.add(a);
          wj(this);
          this.R();
          this.g("grid", b, a);
        }
      },
    },
    viewportBounds: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.vx;
      },
    },
    viewSize: {
      configurable: !0,
      get: function () {
        return this.Op;
      },
      set: function (a) {
        var b = this.viewSize;
        b.D(a) ||
          (x(a, Gb, Q, "viewSize"),
          (this.Op = a = a.L()),
          (this.Ca = this.Da = 0),
          a.s()
            ? ((this.Da = a.width), (this.Ca = a.height))
            : null !== this.La &&
              ((this.Da = this.La.clientWidth || 1),
              (this.Ca = this.La.clientHeight || 1)),
          Li(this),
          this.Wa(),
          this.g("viewSize", b, a),
          this.redraw());
      },
    },
    fixedBounds: {
      configurable: !0,
      get: function () {
        return this.Pt;
      },
      set: function (a) {
        var b = this.Pt;
        b.D(a) ||
          (x(a, M, Q, "fixedBounds"),
          ((G && Infinity === a.width) ||
            -Infinity === a.width ||
            Infinity === a.height ||
            -Infinity === a.height) &&
            v("fixedBounds width/height must not be Infinity"),
          (this.Pt = a = a.L()),
          this.Wa(),
          this.g("fixedBounds", b, a));
      },
    },
    scrollMargin: {
      configurable: !0,
      get: function () {
        return this.Yj;
      },
      set: function (a) {
        "number" === typeof a ? (a = new ic(a)) : x(a, ic, Q, "scrollMargin");
        var b = this.Yj;
        b.D(a) ||
          ((this.Yj = a = a.L()), this.g("scrollMargin", b, a), this.yq());
      },
    },
    scrollMode: {
      configurable: !0,
      get: function () {
        return this.Zj;
      },
      set: function (a) {
        var b = this.Zj;
        b !== a &&
          (cb(a, Q, Q, "scrollMode"),
          (this.Zj = a),
          a === $h && fj(this, !1),
          this.g("scrollMode", b, a),
          this.R());
      },
    },
    scrollsPageOnFocus: {
      configurable: !0,
      get: function () {
        return this.Lu;
      },
      set: function (a) {
        var b = this.Lu;
        b !== a &&
          (A(a, "boolean", Q, "scrollsPageOnFocus"),
          (this.Lu = a),
          this.g("scrollsPageOnFocus", b, a));
      },
    },
    positionComputation: {
      configurable: !0,
      get: function () {
        return this.wu;
      },
      set: function (a) {
        var b = this.wu;
        b !== a &&
          (null !== a && A(a, "function", Q, "positionComputation"),
          (this.wu = a),
          fj(this, !1),
          this.g("positionComputation", b, a));
      },
    },
    scaleComputation: {
      configurable: !0,
      get: function () {
        return this.Du;
      },
      set: function (a) {
        var b = this.Du;
        b !== a &&
          (null !== a && A(a, "function", Q, "scaleComputation"),
          (this.Du = a),
          ek(this, this.scale, this.scale),
          this.g("scaleComputation", b, a));
      },
    },
    documentBounds: {
      configurable: !0,
      get: function () {
        return this.er;
      },
    },
    isVirtualized: {
      configurable: !0,
      get: function () {
        return this.du;
      },
      set: function (a) {
        var b = this.du;
        b !== a &&
          (A(a, "boolean", Q, "isVirtualized"),
          (this.du = a),
          this.g("isVirtualized", b, a));
      },
    },
    scale: {
      configurable: !0,
      get: function () {
        return this.Aa;
      },
      set: function (a) {
        var b = this.Aa;
        D(a, Q, "scale");
        b !== a && ek(this, b, a);
      },
    },
    defaultScale: {
      configurable: !0,
      get: function () {
        return this.cr;
      },
      set: function (a) {
        G && D(a, Q, "defaultScale");
        !G || 0 < a || v("defaultScale must be larger than zero, not: " + a);
        this.cr = a;
      },
    },
    autoScale: {
      configurable: !0,
      get: function () {
        return this.Xh;
      },
      set: function (a) {
        var b = this.Xh;
        b !== a &&
          (cb(a, Q, Q, "autoScale"),
          (this.Xh = a),
          this.g("autoScale", b, a),
          a !== zh && fj(this, !1));
      },
    },
    initialAutoScale: {
      configurable: !0,
      get: function () {
        return this.Wg;
      },
      set: function (a) {
        var b = this.Wg;
        b !== a &&
          (cb(a, Q, Q, "initialAutoScale"),
          (this.Wg = a),
          this.g("initialAutoScale", b, a));
      },
    },
    initialViewportSpot: {
      configurable: !0,
      get: function () {
        return this.Wt;
      },
      set: function (a) {
        var b = this.Wt;
        b !== a &&
          (x(a, Ib, Q, "initialViewportSpot"),
          a.ib() || v("initialViewportSpot must be a specific Spot: " + a),
          (this.Wt = a),
          this.g("initialViewportSpot", b, a));
      },
    },
    initialDocumentSpot: {
      configurable: !0,
      get: function () {
        return this.Tt;
      },
      set: function (a) {
        var b = this.Tt;
        b !== a &&
          (x(a, Ib, Q, "initialDocumentSpot"),
          a.ib() || v("initialViewportSpot must be a specific Spot: " + a),
          (this.Tt = a),
          this.g("initialDocumentSpot", b, a));
      },
    },
    minScale: {
      configurable: !0,
      get: function () {
        return this.lu;
      },
      set: function (a) {
        D(a, Q, "minScale");
        var b = this.lu;
        b !== a &&
          (0 < a
            ? ((this.lu = a),
              this.g("minScale", b, a),
              a > this.scale && (this.scale = a))
            : Aa(a, "> 0", Q, "minScale"));
      },
    },
    maxScale: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.hu;
      },
      set: function (a) {
        D(a, Q, "maxScale");
        var b = this.hu;
        b !== a &&
          (0 < a
            ? ((this.hu = a),
              this.g("maxScale", b, a),
              a < this.scale && (this.scale = a))
            : Aa(a, "> 0", Q, "maxScale"));
      },
    },
    zoomPoint: {
      configurable: !0,
      get: function () {
        return this.Xu;
      },
      set: function (a) {
        this.Xu.D(a) || (x(a, K, Q, "zoomPoint"), (this.Xu = a = a.L()));
      },
    },
    contentAlignment: {
      configurable: !0,
      get: function () {
        return this.Yk;
      },
      set: function (a) {
        var b = this.Yk;
        b.D(a) ||
          (x(a, Ib, Q, "contentAlignment"),
          (this.Yk = a = a.L()),
          this.g("contentAlignment", b, a),
          fj(this, !1));
      },
    },
    initialContentAlignment: {
      configurable: !0,
      get: function () {
        return this.tr;
      },
      set: function (a) {
        var b = this.tr;
        b.D(a) ||
          (x(a, Ib, Q, "initialContentAlignment"),
          (this.tr = a = a.L()),
          this.g("initialContentAlignment", b, a));
      },
    },
    padding: {
      configurable: !0,
      get: function () {
        return this.ub;
      },
      set: function (a) {
        "number" === typeof a ? (a = new ic(a)) : x(a, ic, Q, "padding");
        var b = this.ub;
        b.D(a) || ((this.ub = a = a.L()), this.Wa(), this.g("padding", b, a));
      },
    },
    partManager: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Sh;
      },
      set: function (a) {
        var b = this.Sh;
        b !== a &&
          (x(a, vi, Q, "partManager"),
          null !== a.diagram &&
            v("Cannot share PartManagers between Diagrams: " + a.toString()),
          b && b.Xe(null),
          (this.Sh = a),
          a.Xe(this));
      },
    },
    nodes: {
      configurable: !0,
      get: function () {
        return this.partManager.nodes.iterator;
      },
    },
    links: {
      configurable: !0,
      get: function () {
        return this.partManager.links.iterator;
      },
    },
    parts: {
      configurable: !0,
      get: function () {
        return this.partManager.parts.iterator;
      },
    },
    layout: {
      configurable: !0,
      get: function () {
        return this.Jc;
      },
      set: function (a) {
        var b = this.Jc;
        b !== a &&
          (x(a, zi, Q, "layout"),
          (this.Jc = a),
          (a.diagram = this),
          (a.group = null),
          (this.Wh = !0),
          this.g("layout", b, a),
          this.Ob());
      },
    },
    isTreePathToChildren: {
      configurable: !0,
      get: function () {
        return this.cu;
      },
      set: function (a) {
        var b = this.cu;
        if (
          b !== a &&
          (A(a, "boolean", Q, "isTreePathToChildren"),
          (this.cu = a),
          this.g("isTreePathToChildren", b, a),
          !this.undoManager.isUndoingRedoing)
        )
          for (a = this.nodes; a.next(); ) Pk(a.value);
      },
    },
    treeCollapsePolicy: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Su;
      },
      set: function (a) {
        var b = this.Su;
        b !== a &&
          (a !== Ei &&
            a !== Qk &&
            a !== Rk &&
            v("Unknown Diagram.treeCollapsePolicy: " + a),
          (this.Su = a),
          this.g("treeCollapsePolicy", b, a));
      },
    },
    Ue: {
      configurable: !0,
      get: function () {
        return this.Rw;
      },
      set: function (a) {
        this.Rw = a;
      },
    },
    avoidanceCellSize: {
      configurable: !0,
      get: function () {
        return this.Bw;
      },
      set: function (a) {
        this.Ai = null;
        this.Bw = new Gb(Math.max(1, a.width), Math.max(1, a.height));
      },
    },
    avoidanceLimit: {
      configurable: !0,
      get: function () {
        return this.Cw;
      },
      set: function (a) {
        this.Cw = Math.max(1, a);
      },
    },
    autoScrollInterval: {
      configurable: !0,
      get: function () {
        return this.Mq;
      },
      set: function (a) {
        var b = this.Mq;
        D(a, Q, "scale");
        b !== a && ((this.Mq = a), this.g("autoScrollInterval", b, a));
      },
    },
    autoScrollRegion: {
      configurable: !0,
      get: function () {
        return this.Oq;
      },
      set: function (a) {
        "number" === typeof a
          ? (a = new ic(a))
          : x(a, ic, Q, "autoScrollRegion");
        var b = this.Oq;
        b.D(a) ||
          ((this.Oq = a = a.L()), this.Wa(), this.g("autoScrollRegion", b, a));
      },
    },
  });
  oa.Object.defineProperties(Q, {
    licenseKey: {
      configurable: !0,
      get: function () {
        return Sk.fc();
      },
      set: function (a) {
        Sk.add(a.replace(/\s/g, ""));
      },
    },
    version: {
      configurable: !0,
      get: function () {
        return Tk;
      },
    },
  });
  Q.prototype.makeImageData = Q.prototype.py;
  Q.prototype.makeImage = Q.prototype.EA;
  Q.prototype.cacheGroupExternalLinks = Q.prototype.dv;
  Q.prototype.addRenderer = Q.prototype.lz;
  Q.prototype.makeSVG = Q.prototype.Gv;
  Q.prototype.makeSvg = Q.prototype.Vs;
  Q.prototype.stopAutoScroll = Q.prototype.zg;
  Q.prototype.doAutoScroll = Q.prototype.zs;
  Q.prototype.isUnoccupied = Q.prototype.wk;
  Q.prototype.raiseDiagramEvent = Q.prototype.V;
  Q.prototype.removeDiagramListener = Q.prototype.xm;
  Q.prototype.addDiagramListener = Q.prototype.dk;
  Q.prototype.findTreeRoots = Q.prototype.hA;
  Q.prototype.layoutDiagram = Q.prototype.CA;
  Q.prototype.findTopLevelGroups = Q.prototype.aA;
  Q.prototype.findTopLevelNodesAndLinks = Q.prototype.bA;
  Q.prototype.ensureBounds = Q.prototype.Za;
  Q.prototype.findLinksByExample = Q.prototype.Cs;
  Q.prototype.findNodesByExample = Q.prototype.Ds;
  Q.prototype.findLinkForData = Q.prototype.Ec;
  Q.prototype.findNodeForData = Q.prototype.Pi;
  Q.prototype.findPartForData = Q.prototype.Fc;
  Q.prototype.findLinkForKey = Q.prototype.findLinkForKey;
  Q.prototype.findNodeForKey = Q.prototype.Mb;
  Q.prototype.findPartForKey = Q.prototype.findPartForKey;
  Q.prototype.rebuildParts = Q.prototype.Rd;
  Q.prototype.transformViewToDoc = Q.prototype.jt;
  Q.prototype.transformRectDocToView = Q.prototype.hB;
  Q.prototype.transformDocToView = Q.prototype.Gq;
  Q.prototype.centerRect = Q.prototype.xs;
  Q.prototype.scrollToRect = Q.prototype.Vv;
  Q.prototype.scroll = Q.prototype.scroll;
  Q.prototype.highlightCollection = Q.prototype.tA;
  Q.prototype.highlight = Q.prototype.sA;
  Q.prototype.selectCollection = Q.prototype.ZA;
  Q.prototype.select = Q.prototype.select;
  Q.prototype.updateAllRelationshipsFromData = Q.prototype.Jq;
  Q.prototype.updateAllTargetBindings = Q.prototype.updateAllTargetBindings;
  Q.prototype.commit = Q.prototype.commit;
  Q.prototype.rollbackTransaction = Q.prototype.Pf;
  Q.prototype.commitTransaction = Q.prototype.gb;
  Q.prototype.startTransaction = Q.prototype.Fa;
  Q.prototype.raiseChanged = Q.prototype.g;
  Q.prototype.raiseChangedEvent = Q.prototype.cb;
  Q.prototype.removeChangedListener = Q.prototype.Ik;
  Q.prototype.addChangedListener = Q.prototype.Dh;
  Q.prototype.removeModelChangedListener = Q.prototype.UA;
  Q.prototype.addModelChangedListener = Q.prototype.Bx;
  Q.prototype.findLayer = Q.prototype.qk;
  Q.prototype.removeLayer = Q.prototype.SA;
  Q.prototype.addLayerAfter = Q.prototype.hz;
  Q.prototype.addLayerBefore = Q.prototype.zx;
  Q.prototype.addLayer = Q.prototype.dm;
  Q.prototype.moveParts = Q.prototype.moveParts;
  Q.prototype.copyParts = Q.prototype.lk;
  Q.prototype.removeParts = Q.prototype.at;
  Q.prototype.remove = Q.prototype.remove;
  Q.prototype.add = Q.prototype.add;
  Q.prototype.clearDelayedGeometries = Q.prototype.ev;
  Q.prototype.setProperties = Q.prototype.Km;
  Q.prototype.attach = Q.prototype.cv;
  Q.prototype.set = Q.prototype.set;
  Q.prototype.resetInputOptions = Q.prototype.Ay;
  Q.prototype.setInputOption = Q.prototype.$A;
  Q.prototype.getInputOption = Q.prototype.nm;
  Q.prototype.resetRenderingHints = Q.prototype.By;
  Q.prototype.setRenderingHint = Q.prototype.Fy;
  Q.prototype.getRenderingHint = Q.prototype.Se;
  Q.prototype.maybeUpdate = Q.prototype.pd;
  Q.prototype.requestUpdate = Q.prototype.Ob;
  Q.prototype.delayInitialization = Q.prototype.Ez;
  Q.prototype.isUpdateRequested = Q.prototype.yA;
  Q.prototype.invalidateDocumentBounds = Q.prototype.Wa;
  Q.prototype.findObjectsNear = Q.prototype.vg;
  Q.prototype.findPartsNear = Q.prototype.Xz;
  Q.prototype.findObjectsIn = Q.prototype.Hf;
  Q.prototype.findPartsIn = Q.prototype.Wx;
  Q.prototype.findObjectsAt = Q.prototype.Qi;
  Q.prototype.findPartsAt = Q.prototype.Wz;
  Q.prototype.findObjectAt = Q.prototype.dc;
  Q.prototype.findPartAt = Q.prototype.lm;
  Q.prototype.focusObject = Q.prototype.iA;
  Q.prototype.alignDocument = Q.prototype.nz;
  Q.prototype.zoomToRect = Q.prototype.lB;
  Q.prototype.zoomToFit = Q.prototype.zoomToFit;
  Q.prototype.diagramScroll = Q.prototype.Mx;
  Q.prototype.focus = Q.prototype.focus;
  var ui = new xb(),
    Mi = null,
    Wg = void 0 !== sa.document,
    Hi = null,
    Ii = "",
    zh = new F(Q, "None", 0),
    kj = new F(Q, "Uniform", 1),
    lj = new F(Q, "UniformToFill", 2),
    Jf = new F(Q, "CycleAll", 10),
    Nf = new F(Q, "CycleNotDirected", 11),
    Zf = new F(Q, "CycleNotDirectedFast", 12),
    $f = new F(Q, "CycleNotUndirected", 13),
    Kf = new F(Q, "CycleDestinationTree", 14),
    Mf = new F(Q, "CycleSourceTree", 15),
    $h = new F(Q, "DocumentScroll", 1),
    bi = new F(Q, "InfiniteScroll", 2),
    Ei = new F(Q, "TreeParentCollapsed", 21),
    Qk = new F(Q, "AllParentsCollapsed", 22),
    Rk = new F(Q, "AnyParentsCollapsed", 23),
    Sk = new H(),
    Tk = "2.2.11",
    Mk = "image",
    Ok = !1,
    Uk = null,
    si = !1;
  function ti() {
    if (Wg) {
      var a = sa.document.createElement("canvas"),
        b = a.getContext("2d"),
        c = Va("7ca11abfd022028846");
      b[c] = Va("398c3597c01238");
      for (
        var d = [
            "5da73c80a36455d6038e4972187c3cae51fd22",
            ta.Dx + "4ae6247590da4bb21c324ba3a84e385776",
            Kb.xF + "fb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387",
            L.za,
          ],
          e = 1;
        5 > e;
        e++
      )
        b[Va("7ca11abfd7330390")](Va(d[e - 1]), 10, 15 * e);
      b[c] = Va("39f046ebb36e4b");
      for (c = 1; 5 > c; c++)
        b[Va("7ca11abfd7330390")](Va(d[c - 1]), 10, 15 * c);
      if (4 !== d.length || "5" !== d[0][0] || "7" !== d[3][0])
        Kb.prototype.Od = Kb.prototype.Fx;
      Uk = a;
    }
  }
  Q.className = "Diagram";
  Q.fromDiv = function (a) {
    var b = a;
    "string" === typeof a && (b = sa.document.getElementById(a));
    return b instanceof HTMLDivElement && b.G instanceof Q ? b.G : null;
  };
  Q.inherit = function (a, b) {
    function c() {}
    if (Object.getPrototypeOf(a).prototype)
      throw Error(
        "Used go.Diagram.inherit defining already defined class \n" + a
      );
    A(a, "function", Q, "inherit");
    A(b, "function", Q, "inherit");
    c.prototype = b.prototype;
    a.prototype = new c();
    a.prototype.constructor = a;
  };
  Q.useDOM = function (a) {
    Wg = a ? void 0 !== sa.document : !1;
  };
  Q.isUsingDOM = function () {
    return Wg;
  };
  Q.None = zh;
  Q.Uniform = kj;
  Q.UniformToFill = lj;
  Q.CycleAll = Jf;
  Q.CycleNotDirected = Nf;
  Q.CycleNotDirectedFast = Zf;
  Q.CycleNotUndirected = $f;
  Q.CycleDestinationTree = Kf;
  Q.CycleSourceTree = Mf;
  Q.DocumentScroll = $h;
  Q.InfiniteScroll = bi;
  Q.TreeParentCollapsed = Ei;
  Q.AllParentsCollapsed = Qk;
  Q.AnyParentsCollapsed = Rk;
  function Ai() {
    this.cz = null;
    this.j = "zz@orderNum";
    "63ad05bbe23a1786468a4c741b6d2" === this._tk
      ? (this.sd = this.j = !0)
      : (this.sd = null);
  }
  function Fj(a, b) {
    b.$b.setTransform(b.jc, 0, 0, b.jc, 0, 0);
    b.$b.Oc();
    if (null === a.sd)
      a: {
        b = "f";
        var c = sa[Va("76a715b2f73f148a")][Va("72ba13b5")];
        a.sd = !0;
        if (Wg) {
          var d = Q[Va("76a115b6ed251eaf4692")];
          if (d)
            for (var e = Sk.iterator; e.next(); ) {
              d = e.value;
              d = Va(d).split(Va("39e9"));
              if (6 > d.length) break;
              var f = Va(d[1]).split(".");
              if ("7da71ca0" !== d[4]) break;
              var g = Va(ta[Va("6cae19")]).split(".");
              if (f[0] > g[0] || (f[0] === g[0] && f[1] >= g[1])) {
                var h =
                  sa[Va("74a900bae4370f8b51")][
                    Va("6fbb13a1c2311e8a57")
                  ].toLowerCase();
                g = h[Va("73a612b6fb191d")](Va("3aad1ab6e022098b4dc4"));
                f = Va(d[2]);
                if (
                  -1 < g &&
                  ((h = h[Va("73a612b6fb191d")](f.toLowerCase() + "/")),
                  (a.sd = !(-1 < h && h < g)),
                  !a.sd)
                )
                  break;
                g = c[Va("76ad18b4f73e")];
                for (h = c[Va("73a612b6fb191d")](Va("35e7")) + 2; h < g; h++)
                  b += c[h];
                g = b[Va("73a612b6fb191d")](f);
                0 > g &&
                  f !== Va("7da71ca0ad381e90") &&
                  (g = b[Va("73a612b6fb191d")](Va("76a715b2ef3e149757")));
                0 > g &&
                  (g = b[Va("73a612b6fb191d")](Va("76a715b2ef3e149757")));
                0 > g &&
                  (g = c[Va("73a612b6fb191d")](Va("7baa19a6f76c1988428554")));
                a.sd = !(
                  (0 <= g && g < b[Va("73a612b6fb191d")](Va("35"))) ||
                  -1 === b[Va("73a612b6fb191d")](Va("35"))
                );
                if (!a.sd) break;
                if (
                  c[Va("73a612b6fb191d")](Va("7fb002b6ed25128b4da25b2e")) &&
                  c[Va("73a612b6fb191d")](Va("75ba1beee63a1e875799507d")) &&
                  ((a.sd = !(-1 < c[Va("73a612b6fb191d")](f))), !a.sd)
                )
                  break;
                if ("#" === f[0]) {
                  g = sa.document.createElement("div");
                  for (var k = d[0].replace(/[A-Za-z]/g, ""); 4 > k.length; )
                    k += "9";
                  h = k;
                  k = k.substr(k.length - 4);
                  d = "";
                  d += ["gsh", "gsf"][parseInt(k.substr(0, 1), 10) % 2];
                  d += ["Header", "Background", "Display", "Feedback"][
                    parseInt(k.substr(0, 1), 10) % 4
                  ];
                  g[Va("79a417a0f0181a8946")] = d;
                  if (sa.document[Va("78a712aa")]) {
                    sa.document[Va("78a712aa")][Va("7bb806b6ed32388c4a875b")](
                      g
                    );
                    k = sa
                      .getComputedStyle(g)
                      .getPropertyValue(Va("78a704b7e62456904c9b12701b6532a8"));
                    var l = sa
                      .getComputedStyle(g)
                      .getPropertyValue(Va("75b817b0ea2202"));
                    sa.document[Va("78a712aa")][Va("68ad1bbcf533388c4a875b")](
                      g
                    );
                    if (k)
                      if (
                        ((g = sa[Va("77a902b0eb1b1e804a8a")]),
                        l === "0." + (parseInt(h, 10) % 100) ||
                          (-1 !== k.indexOf(parseInt(f[1] + f[2], 16)) &&
                            -1 !== k.indexOf(parseInt(f[3] + f[4], 16))))
                      ) {
                        a.sd = !1;
                        break;
                      } else if (
                        g &&
                        g(Va("32ae19a1e0331fc94084537c067a67fa59f1386b89d006"))
                          .matches
                      )
                        for (
                          d = "." + d, f = 0;
                          f < document.styleSheets.length;
                          f++
                        ) {
                          g =
                            document.styleSheets[f].rules ||
                            document.styleSheets[f].cssRules;
                          for (var m in g)
                            if (d === g[m].selectorText) {
                              a.sd = !1;
                              break a;
                            }
                        }
                  } else (a.sd = null), (a.sd = !1);
                }
              }
            }
          else {
            m = c[Va("76ad18b4f73e")];
            for (e = c[Va("73a612b6fb191d")](Va("35e7")) + 2; e < m; e++)
              b += c[e];
            c = b[Va("73a612b6fb191d")](Va("7da71ca0ad381e90"));
            a.sd = !(0 <= c && c < b[Va("73a612b6fb191d")](Va("35")));
          }
        }
      }
    return 0 < a.sd && a !== a.cz ? !0 : !1;
  }
  function Bi(a, b) {
    if (Wg) {
      (void 0 !== b && null !== b) ||
        v("Diagram setup requires an argument DIV.");
      null !== a.La && v("Diagram has already completed setup.");
      "string" === typeof b
        ? (a.La = sa.document.getElementById(b))
        : b instanceof HTMLDivElement
        ? (a.La = b)
        : v("No DIV or DIV id supplied: " + b);
      null === a.La && v("Invalid DIV id; could not get element with id: " + b);
      void 0 !== a.La.G &&
        v("Invalid div id; div already has a Diagram associated with it.");
      if (!a.Pl && sa.ResizeObserver) {
        var c = ua(function () {
          a.Ob();
        }, 250);
        a.Pl = new sa.ResizeObserver(function () {
          c();
        });
        a.Pl.observe(a.La);
      }
      "static" === sa.getComputedStyle(a.La, null).position &&
        (a.La.style.position = "relative");
      b = 5;
      var d = "rgba(2" + b + "5, 255, 255, 0)";
      b--;
      a.La.style["-webkit-tap-highlight-color"] = d;
      a.La.innerHTML = "";
      a.La.G = a;
      a.La.goDiagram = a;
      a.La.go = sa.go;
      var e = a.ns ? new Kj(a) : new Nk(a);
      void 0 !== e.style &&
        ((e.style.position = "absolute"),
        (e.style.top = "0px"),
        (e.style.left = "0px"),
        "rtl" ===
          sa.getComputedStyle(a.La, null).getPropertyValue("direction") &&
          (a.ho = !0),
        (e.style.zIndex = "2"),
        (e.style.userSelect = "none"),
        (e.style.MozUserSelect = "none"),
        (e.style.touchAction = "none"));
      a.Ia = e;
      a.$b = e.context;
      d = a.$b;
      a.jc = a.computePixelRatio();
      a.viewSize.s() ||
        ((a.Da = a.La.clientWidth || 1), (a.Ca = a.La.clientHeight || 1));
      Mj(a, a.Da, a.Ca);
      a.La.insertBefore(e.Sa, a.La.firstChild);
      e = new Nk(null);
      e.width = 1;
      e.height = 1;
      a.Kw = e;
      a.Vy = e.context;
      if (Wg) {
        e = wa("div");
        var f = wa("div");
        e.style.position = "absolute";
        e.style.overflow = "auto";
        e.style.width = a.Da + "px";
        e.style.height = a.Ca + "px";
        e.style.zIndex = "1";
        f.style.position = "absolute";
        f.style.width = "1px";
        f.style.height = "1px";
        a.La.appendChild(e);
        e.appendChild(f);
        e.onscroll = aj;
        e.addEventListener("pointerdown", cj);
        e.G = a;
        e.az = !0;
        e.bz = !0;
        a.Iu = e;
        a.Fu = f;
      }
      a.yq = ua(function () {
        a.Bi = null;
        a.R();
      }, 300);
      a.lw = ua(function () {
        Ah(a);
      }, 250);
      a.preventDefault = function (a) {
        a.preventDefault();
        return !1;
      };
      a.zk = function (b) {
        if (a.isEnabled) {
          var c = pj(a, b, !0);
          c.bubbles = !0;
          var d = 0,
            e = 0;
          c.delta = 0;
          void 0 !== b.deltaX
            ? (0 !== b.deltaX && (d = 0 < b.deltaX ? 1 : -1),
              0 !== b.deltaY && (e = 0 < b.deltaY ? 1 : -1),
              (c.delta = Math.abs(b.deltaX) > Math.abs(b.deltaY) ? -d : -e))
            : void 0 !== b.wheelDeltaX
            ? (0 !== b.wheelDeltaX && (d = 0 < b.wheelDeltaX ? -1 : 1),
              0 !== b.wheelDeltaY && (e = 0 < b.wheelDeltaY ? -1 : 1),
              (c.delta =
                Math.abs(b.wheelDeltaX) > Math.abs(b.wheelDeltaY) ? -d : -e))
            : void 0 !== b.wheelDelta &&
              0 !== b.wheelDelta &&
              (c.delta = 0 < b.wheelDelta ? 1 : -1);
          a.doMouseWheel();
          tj(a, c, b);
        }
      };
      a.JA = function (b) {
        a.isEnabled &&
          ((a.ul = !1),
          pj(a, b, !0),
          (b = a.currentTool),
          b.cancelWaitAfter(),
          b.standardMouseOver());
      };
      a.Dk = function (b) {
        if (a.isEnabled) {
          a.ul = !0;
          var c = a.vu;
          void 0 === c[b.pointerId] && (c[b.pointerId] = b);
          c = a.Ml;
          var d = !1;
          if (null !== c[0] && c[0].pointerId === b.pointerId) c[0] = b;
          else if (null !== c[1] && c[1].pointerId === b.pointerId)
            (c[1] = b), (d = !0);
          else if (null === c[0]) c[0] = b;
          else if (null === c[1]) (c[1] = b), (d = !0);
          else {
            b.preventDefault();
            return;
          }
          if ((c = "touch" === b.pointerType || "pen" === b.pointerType))
            (a.Ou = !1), (a.bu = !0);
          var e = d;
          d = sj(a, b, !0, !1, !0, e);
          qj(a, b, d);
          d.targetDiagram = rj(b, b.target);
          d.targetObject = null;
          e || d.clone(a.mr);
          e = a.Ww;
          c = c ? 25 : 10;
          b.timeStamp - a.Vw < a.fz &&
          !(Math.abs(e.x - b.screenX) > c || Math.abs(e.y - b.screenY) > c)
            ? a.Cr++
            : (a.Cr = 1);
          d.clickCount = a.Cr;
          a.Vw = b.timeStamp;
          a.Ww.yg(b.screenX, b.screenY);
          a.doMouseDown();
          1 === b.button ? b.preventDefault() : tj(a, d, b);
        }
      };
      a.Ek = function (b) {
        if (a.isEnabled) {
          a.ul = !0;
          var c = a.Ml;
          if (null !== c[0] && c[0].pointerId === b.pointerId) c[0] = b;
          else {
            if (null !== c[1] && c[1].pointerId === b.pointerId) {
              c[1] = b;
              return;
            }
            if (null === c[0]) c[0] = b;
            else return;
          }
          if (c[0].pointerId === b.pointerId) {
            c = sj(a, b, !1, !1, !1, null !== c[1]);
            var d = sa.document.elementFromPoint(b.clientX, b.clientY);
            null !== d &&
              void 0 !== d.shadowRoot &&
              null !== d.shadowRoot &&
              (d = d.shadowRoot.elementFromPoint(b.clientX, b.clientY));
            var e = a,
              f = b;
            d && d.G && ((f = b), (e = d.G));
            c.targetDiagram = e;
            qj(a, f, c);
            c.targetObject = null;
            a.doMouseMove();
            tj(a, c, b);
          }
        }
      };
      a.Gk = function (b) {
        if (a.isEnabled) {
          a.ul = !0;
          var c = "touch" === b.pointerType || "pen" === b.pointerType,
            d = a.vu;
          if (c && a.Ou) delete d[b.pointerId], b.preventDefault();
          else if (
            ((d = a.Ml), null !== d[0] && d[0].pointerId === b.pointerId)
          ) {
            d[0] = null;
            d = sj(a, b, !1, !0, !0, !1);
            var e = sa.document.elementFromPoint(b.clientX, b.clientY);
            null !== e &&
              void 0 !== e.shadowRoot &&
              null !== e.shadowRoot &&
              (e = e.shadowRoot.elementFromPoint(b.clientX, b.clientY));
            null !== e && e.G instanceof Q && e.G !== a && qj(e.G, b, d);
            null === e && (e = b.target);
            qj(a, b, d);
            d.clickCount = a.Cr;
            d.targetDiagram = rj(b, e);
            d.targetObject = null;
            a.doMouseUp();
            tj(a, d, b);
            c && (a.bu = !1);
          } else
            null !== d[1] && d[1].pointerId === b.pointerId && (d[1] = null);
        }
      };
      a.Fk = function (b) {
        if (a.isEnabled) {
          a.ul = !1;
          var c = a.vu;
          c[b.pointerId] && delete c[b.pointerId];
          c = a.Ml;
          null !== c[0] && c[0].pointerId === b.pointerId && (c[0] = null);
          null !== c[1] && c[1].pointerId === b.pointerId && (c[1] = null);
          "touch" !== b.pointerType &&
            "pen" !== b.pointerType &&
            ((b = a.currentTool), b.cancelWaitAfter(), b.standardMouseOver());
        }
      };
      a.It = d.aa["d" + Vk[1] + Vk[2] + "wI" + Mk.slice(1, 5)][
        "b" + Wk.slice(1, b)
      ](d.aa, Uk, b, b);
      d.Nc(!0);
      Ni(a);
    }
  }
  Ai.className = "DiagramHelper";
  function af(a) {
    this.j = void 0 === a ? new K() : a;
    this.o = new K();
  }
  oa.Object.defineProperties(af.prototype, {
    point: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.j = a;
      },
    },
    shifted: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        this.o = a;
      },
    },
  });
  var Vk = "DraggingInfo";
  af.className = "DraggingInfo";
  function Xj(a, b, c) {
    this.node = a;
    this.info = b;
    this.yv = c;
  }
  Xj.className = "DraggingNodeInfoPair";
  function Re() {
    this.reset();
  }
  Re.prototype.reset = function () {
    this.isGridSnapEnabled = !1;
    this.isGridSnapRealtime = !0;
    this.gridSnapCellSize = new Gb(NaN, NaN).freeze();
    this.gridSnapCellSpot = Fc;
    this.gridSnapOrigin = new K(NaN, NaN).freeze();
    this.groupsSnapMembers = this.dragsTree = this.dragsLink = !1;
    this.dragsMembers = this.groupsAlwaysMove = !0;
  };
  Re.className = "DraggingOptions";
  function Xk(a, b) {
    if ("string" === typeof a || (sa.Element && a instanceof Element))
      var c = Q.call(this, a) || this;
    else (c = Q.call(this) || this), (b = a);
    Yk(c);
    b && c.Km(b);
    return c;
  }
  na(Xk, Q);
  function Yk(a) {
    a.allowDragOut = !0;
    a.allowMove = !1;
    a.isReadOnly = !0;
    a.contentAlignment = Gc;
    a.layout = new Zk();
  }
  Xk.prototype.reset = function () {
    Q.prototype.reset.call(this);
    Yk(this);
  };
  Xk.className = "Palette";
  function $k(a, b) {
    if ("string" === typeof a || (sa.Element && a instanceof Element))
      var c = Q.call(this, a) || this;
    else (c = Q.call(this) || this), (b = a);
    var d = c;
    c.animationManager.isEnabled = !1;
    c.wb = !0;
    c.Ba = null;
    c.Yn = !1;
    c.Zn = !1;
    c.M = !0;
    c.B = !0;
    c.Na = 0;
    c.o = !1;
    c.Tl = null;
    c.Fy("drawShadows", !1);
    a = new U();
    var e = new Hf();
    e.stroke = "magenta";
    e.strokeWidth = 2;
    e.fill = "transparent";
    e.name = "BOXSHAPE";
    a.selectable = !0;
    a.selectionAdorned = !1;
    a.selectionObjectName = "BOXSHAPE";
    a.locationObjectName = "BOXSHAPE";
    a.resizeObjectName = "BOXSHAPE";
    a.cursor = "move";
    a.add(e);
    c.j = a;
    c.allowCopy = !1;
    c.allowDelete = !1;
    c.allowSelect = !0;
    c.autoScrollRegion = new ic(0, 0, 0, 0);
    c.ra.h(0, 0);
    c.toolManager.jb("Dragging", new al(), c.toolManager.mouseMoveTools);
    c.click = function () {
      var a = d.observed;
      if (null !== a) {
        var b = a.viewportBounds,
          c = d.lastInput.documentPoint;
        a.position = new K(c.x - b.width / 2, c.y - b.height / 2);
      }
    };
    c.Vm = function () {
      d.Wa();
      bl(d);
    };
    c.Um = function () {
      null !== d.observed && (d.Wa(), d.R());
    };
    c.eb = function () {
      1 > d.updateDelay
        ? d.R()
        : d.o ||
          ((d.o = !0),
          setTimeout(function () {
            return d.redraw();
          }, d.updateDelay));
    };
    c.Th = function () {
      null !== d.observed && bl(d);
    };
    c.autoScale = kj;
    c.wb = !1;
    b && Object.assign(c, b);
    return c;
  }
  na($k, Q);
  $k.prototype.computePixelRatio = function () {
    return 1;
  };
  $k.prototype.redraw = function () {
    if (this.o && 1 <= this.updateDelay) {
      this.o = !1;
      var a = this.Ia,
        b = this.$b;
      if (null !== a && null !== b) {
        Dj(this);
        if (null === this.Tl) {
          var c = new Nk(null);
          c.width = a.width;
          c.height = a.height;
          this.Tl = c;
        }
        try {
          (this.Ia = this.Tl),
            (this.$b = this.Ia.context),
            this.$b.Nc(!0),
            this.$b.setTransform(1, 0, 0, 1, 0, 0),
            this.$b.clearRect(0, 0, this.Ia.width, this.Ia.height),
            cl(this);
        } finally {
          (this.Ia = a), (this.$b = b);
        }
      }
    }
    Q.prototype.redraw.call(this);
  };
  $k.prototype.uc = function () {
    null === this.La && v("No div specified");
    null === this.Ia && v("No canvas specified");
    if (!(this.Ia instanceof Kj) && (ni(this.box), this.dd)) {
      var a = this.observed;
      if (
        null !== a &&
        !a.animationManager.defaultAnimation.isAnimating &&
        a.Yi
      ) {
        Dj(this);
        var b = this.Ia;
        a = this.$b;
        a.Nc(!0);
        a.setTransform(1, 0, 0, 1, 0, 0);
        a.clearRect(0, 0, b.width, b.height);
        1 > this.updateDelay
          ? cl(this)
          : null !== this.Tl &&
            (a.drawImage(this.Tl.Sa, 0, 0),
            (b = this.Bb),
            b.reset(),
            1 !== this.scale && b.scale(this.scale),
            (0 === this.position.x && 0 === this.position.y) ||
              b.translate(-this.position.x, -this.position.y),
            a.scale(this.jc, this.jc),
            a.transform(b.m11, b.m12, b.m21, b.m22, b.dx, b.dy));
        b = this.Va.m;
        for (var c = b.length, d = 0; d < c; d++) b[d].uc(a, this);
        this.dd = this.Fj = !1;
      }
    }
  };
  function cl(a) {
    var b = a.observed;
    if (null !== b) {
      var c = a.drawsTemporaryLayers,
        d = a.drawsGrid && c,
        e = b.grid;
      d &&
        null !== e &&
        e.visible &&
        !isNaN(e.width) &&
        !isNaN(e.height) &&
        ((e = M.alloc().assign(a.viewportBounds).Xc(b.viewportBounds)),
        wj(b, e),
        M.free(e),
        uh(b));
      var f = a.Bb;
      f.reset();
      1 !== a.scale && f.scale(a.scale);
      (0 === a.position.x && 0 === a.position.y) ||
        f.translate(-a.position.x, -a.position.y);
      e = a.$b;
      e.scale(a.jc, a.jc);
      e.transform(f.m11, f.m12, f.m21, f.m22, f.dx, f.dy);
      b = b.Va.m;
      f = b.length;
      for (var g = 0; g < f; g++) {
        var h = b[g],
          k = a;
        if (h.visible && 0 !== h.opacity) {
          var l = h.diagram.grid.part;
          if (!c && h.isTemporary)
            d &&
              l.layer === h &&
              ((h = oi(h, e)), l.uc(e, k), (e.globalAlpha = h));
          else {
            for (
              var m = oi(h, e),
                n = k.scale,
                p = M.alloc(),
                r = h.Ma.m,
                q = r.length,
                u = 0;
              u < q;
              u++
            ) {
              var w = r[u];
              (d || w !== l) && h.Mi(e, w, k, null, n, p, !1);
            }
            M.free(p);
            e.globalAlpha = m;
          }
        }
      }
    }
  }
  function bl(a) {
    var b = a.box;
    if (null !== b) {
      var c = a.observed;
      if (null !== c) {
        a.dd = !0;
        c = c.viewportBounds;
        var d = b.selectionObject,
          e = Gb.alloc();
        e.h(c.width, c.height);
        d.desiredSize = e;
        Gb.free(e);
        a = 2 / a.scale;
        d instanceof Hf && (d.strokeWidth = a);
        b.location = new K(c.x - a / 2, c.y - a / 2);
        b.isSelected = !0;
      }
    }
  }
  $k.prototype.computeBounds = function () {
    var a = this.observed;
    if (null === a) return qc;
    var b = a.documentBounds.copy();
    b.Xc(a.viewportBounds);
    return b;
  };
  $k.prototype.invalidateViewport = function () {
    !0 !== this.dd && ((this.dd = !0), this.Ob());
  };
  $k.prototype.onViewportBoundsChanged = function (a, b, c, d) {
    this.wb ||
      (dj(this),
      this.R(),
      ij(this),
      this.Wa(),
      bl(this),
      (this.md.scale = c),
      (this.md.position.x = a.x),
      (this.md.position.y = a.y),
      this.md.bounds.assign(a),
      (this.md.my = d),
      this.V("ViewportBoundsChanged", this.md, a));
  };
  oa.Object.defineProperties($k.prototype, {
    observed: {
      configurable: !0,
      get: function () {
        return this.Ba;
      },
      set: function (a) {
        var b = this.Ba;
        null !== a && x(a, Q, $k, "observed");
        a instanceof $k &&
          v("Overview.observed Diagram may not be an Overview itself: " + a);
        if (b !== a) {
          null !== b &&
            (this.remove(this.box),
            b.xm("ViewportBoundsChanged", this.Vm),
            b.xm("DocumentBoundsChanged", this.Um),
            b.xm("InvalidateDraw", this.eb),
            b.xm("AnimationFinished", this.Th));
          this.Ba = a;
          null !== a &&
            (a.dk("ViewportBoundsChanged", this.Vm),
            a.dk("DocumentBoundsChanged", this.Um),
            a.dk("InvalidateDraw", this.eb),
            a.dk("AnimationFinished", this.Th),
            this.add(this.box));
          this.Wa();
          if (null === a) {
            this.Tl = null;
            var c = this.Ia,
              d = this.$b;
            c &&
              d &&
              (d.setTransform(1, 0, 0, 1, 0, 0),
              d.clearRect(0, 0, c.width, c.height));
          } else this.eb(null), bl(this), this.R();
          this.g("observed", b, a);
        }
      },
    },
    box: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        var b = this.j;
        b !== a &&
          ((this.j = a),
          this.remove(b),
          this.add(this.j),
          bl(this),
          this.g("box", b, a));
      },
    },
    drawsTemporaryLayers: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        this.M !== a && ((this.M = a), this.redraw());
      },
    },
    drawsGrid: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        this.B !== a && ((this.B = a), this.redraw());
      },
    },
    updateDelay: {
      configurable: !0,
      get: function () {
        return this.Na;
      },
      set: function (a) {
        0 > a && (a = 0);
        this.Na !== a && (this.Na = a);
      },
    },
  });
  $k.className = "Overview";
  function al() {
    Qe.call(this);
    this.j = null;
  }
  na(al, Qe);
  al.prototype.canStart = function () {
    if (!this.isEnabled) return !1;
    var a = this.diagram;
    if (null === a || !a.allowMove || !a.allowSelect) return !1;
    var b = a.observed;
    if (null === b) return !1;
    var c = a.lastInput;
    if (
      !c.left ||
      (a.currentTool !== this &&
        (!this.isBeyondDragSize() ||
          (c.isTouchEvent &&
            c.timestamp - a.firstInput.timestamp < this.delay)))
    )
      return !1;
    null === this.findDraggablePart() &&
      ((c = b.viewportBounds),
      (this.j = new K(c.width / 2, c.height / 2)),
      (a = a.firstInput.documentPoint),
      (b.position = new K(a.x - this.j.x, a.y - this.j.y)));
    return !0;
  };
  al.prototype.doActivate = function () {
    this.j = null;
    Qe.prototype.doActivate.call(this);
  };
  al.prototype.doUpdateCursor = function () {
    var a = this.diagram,
      b = a.box;
    null !== b && b.cursor && (a.currentCursor = b.cursor);
  };
  al.prototype.moveParts = function () {
    var a = this.diagram,
      b = a.observed;
    if (null !== b) {
      var c = a.box;
      if (null !== c) {
        if (null === this.j) {
          var d = a.firstInput.documentPoint;
          c = c.location;
          this.j = new K(d.x - c.x, d.y - c.y);
        }
        a = a.lastInput.documentPoint;
        b.position = new K(a.x - this.j.x, a.y - this.j.y);
      }
    }
  };
  al.className = "OverviewDraggingTool";
  function dl() {
    0 < arguments.length && Ca(dl);
    ab(this);
    this.G = xe;
    this.eb = this.B = this.o = !0;
    this.M = this.Ba = this.Yc = this.Na = !1;
    this.ti = this.j = null;
    this.Td = 1.05;
    this.eu = NaN;
    this.Uw = null;
    this.Yu = NaN;
    this.Wu = qc;
    this.Hc = !0;
    this.jg = null;
    this.Zc = 200;
  }
  dl.prototype.toString = function () {
    return "CommandHandler";
  };
  dl.prototype.Xe = function (a) {
    this.G = a;
  };
  dl.prototype.doKeyDown = function () {
    var a = this.diagram,
      b = a.lastInput,
      c = $a ? b.meta : b.control,
      d = b.shift,
      e = b.alt,
      f = b.key;
    !c || ("C" !== f && "Insert" !== f)
      ? (c && "X" === f) || (d && "Del" === f)
        ? this.canCutSelection() && this.cutSelection()
        : (c && "V" === f) || (d && "Insert" === f)
        ? this.canPasteSelection() && this.pasteSelection()
        : (c && "Y" === f) || (e && d && "Backspace" === f)
        ? this.canRedo() && this.redo()
        : (c && "Z" === f) || (e && "Backspace" === f)
        ? this.canUndo() && this.undo()
        : "Del" === f || "Backspace" === f
        ? this.canDeleteSelection() && this.deleteSelection()
        : c && "A" === f
        ? this.canSelectAll() && this.selectAll()
        : "Esc" === f
        ? this.canStopCommand() && this.stopCommand()
        : "Up" === f
        ? a.allowVerticalScroll &&
          (c ? a.scroll("pixel", "up") : a.scroll("line", "up"))
        : "Down" === f
        ? a.allowVerticalScroll &&
          (c ? a.scroll("pixel", "down") : a.scroll("line", "down"))
        : "Left" === f
        ? a.allowHorizontalScroll &&
          (c ? a.scroll("pixel", "left") : a.scroll("line", "left"))
        : "Right" === f
        ? a.allowHorizontalScroll &&
          (c ? a.scroll("pixel", "right") : a.scroll("line", "right"))
        : "PageUp" === f
        ? d && a.allowHorizontalScroll
          ? a.scroll("page", "left")
          : a.allowVerticalScroll && a.scroll("page", "up")
        : "PageDown" === f
        ? d && a.allowHorizontalScroll
          ? a.scroll("page", "right")
          : a.allowVerticalScroll && a.scroll("page", "down")
        : "Home" === f
        ? c && a.allowVerticalScroll
          ? a.scroll("document", "up")
          : !c && a.allowHorizontalScroll && a.scroll("document", "left")
        : "End" === f
        ? c && a.allowVerticalScroll
          ? a.scroll("document", "down")
          : !c && a.allowHorizontalScroll && a.scroll("document", "right")
        : " " === f
        ? this.canScrollToPart() && this.scrollToPart()
        : "Subtract" === f
        ? this.canDecreaseZoom() && this.decreaseZoom()
        : "Add" === f
        ? this.canIncreaseZoom() && this.increaseZoom()
        : c && "0" === f
        ? this.canResetZoom() && this.resetZoom()
        : d && "Z" === f
        ? this.canZoomToFit() && this.zoomToFit()
        : c && !d && "G" === f
        ? this.canGroupSelection() && this.groupSelection()
        : c && d && "G" === f
        ? this.canUngroupSelection() && this.ungroupSelection()
        : "F2" === f || (b.event && "F2" === b.event.key)
        ? this.canEditTextBlock() && this.editTextBlock()
        : "ContextMenu" === f || (b.event && "ContextMenu" === b.event.key)
        ? this.canShowContextMenu() && this.showContextMenu()
        : (b.bubbles = !0)
      : this.canCopySelection() && this.copySelection();
  };
  dl.prototype.doKeyUp = function () {
    this.diagram.lastInput.bubbles = !0;
  };
  dl.prototype.stopCommand = function () {
    var a = this.diagram,
      b = a.currentTool;
    b instanceof Ua && a.allowSelect && a.clearSelection();
    null !== b && b.doCancel();
  };
  dl.prototype.canStopCommand = function () {
    return !0;
  };
  dl.prototype.selectAll = function () {
    var a = this.diagram;
    a.R();
    try {
      a.currentCursor = "wait";
      a.V("ChangingSelection", a.selection);
      for (var b = a.parts; b.next(); ) b.value.isSelected = !0;
      for (var c = a.nodes; c.next(); ) c.value.isSelected = !0;
      for (var d = a.links; d.next(); ) d.value.isSelected = !0;
    } finally {
      a.V("ChangedSelection", a.selection), (a.currentCursor = "");
    }
  };
  dl.prototype.canSelectAll = function () {
    return this.diagram.allowSelect;
  };
  dl.prototype.deleteSelection = function () {
    var a = this.diagram;
    try {
      a.currentCursor = "wait";
      a.V("ChangingSelection", a.selection);
      a.Fa("Delete");
      a.V("SelectionDeleting", a.selection);
      for (var b = new I(), c = a.selection.iterator; c.next(); )
        el(
          b,
          c.value,
          !0,
          this.deletesTree ? Infinity : 0,
          this.deletesConnectedLinks ? null : !1,
          function (a) {
            return a.canDelete();
          }
        );
      a.at(b, !0);
      a.V("SelectionDeleted", b);
    } finally {
      a.gb("Delete"),
        a.V("ChangedSelection", a.selection),
        (a.currentCursor = "");
    }
  };
  dl.prototype.canDeleteSelection = function () {
    var a = this.diagram;
    return a.isReadOnly ||
      a.isModelReadOnly ||
      !a.allowDelete ||
      0 === a.selection.count
      ? !1
      : !0;
  };
  dl.prototype.copySelection = function () {
    var a = this.diagram,
      b = new I();
    for (a = a.selection.iterator; a.next(); )
      el(
        b,
        a.value,
        !0,
        this.copiesTree ? Infinity : 0,
        this.copiesConnectedLinks,
        function (a) {
          return a.canCopy();
        }
      );
    this.copyToClipboard(b);
  };
  dl.prototype.canCopySelection = function () {
    var a = this.diagram;
    return a.allowCopy && a.allowClipboard && 0 !== a.selection.count ? !0 : !1;
  };
  dl.prototype.cutSelection = function () {
    this.copySelection();
    this.deleteSelection();
  };
  dl.prototype.canCutSelection = function () {
    var a = this.diagram;
    return !a.isReadOnly &&
      !a.isModelReadOnly &&
      a.allowCopy &&
      a.allowDelete &&
      a.allowClipboard &&
      0 !== a.selection.count
      ? !0
      : !1;
  };
  dl.prototype.copyToClipboard = function (a) {
    var b = this.diagram,
      c = null;
    if (null === a) (Hi = null), (Ii = "");
    else {
      c = b.model;
      var d = !1,
        e = !1,
        f = null;
      try {
        c.qm() && ((d = c.kk), (c.kk = this.copiesParentKey)),
          c.vk() && ((e = c.jk), (c.jk = this.copiesGroupKey)),
          (f = b.lk(a, null, !0));
      } finally {
        c.qm() && (c.kk = d),
          c.vk() && (c.jk = e),
          (c = new H()),
          c.addAll(f),
          (Hi = c),
          (Ii = b.model.dataFormat);
      }
    }
    b.V("ClipboardChanged", c);
  };
  dl.prototype.pasteFromClipboard = function () {
    var a = new I(),
      b = Hi;
    if (null === b) return a;
    var c = this.diagram;
    if (Ii !== c.model.dataFormat) return a;
    var d = c.model,
      e = !1,
      f = !1,
      g = null;
    try {
      d.qm() && ((e = d.kk), (d.kk = this.copiesParentKey)),
        d.vk() && ((f = d.jk), (d.jk = this.copiesGroupKey)),
        (g = c.lk(b, c, !1));
    } finally {
      for (
        d.qm() && (d.kk = e), d.vk() && (d.jk = f), b = g.iterator;
        b.next();

      )
        (c = b.value),
          (d = b.key),
          c.location.s() ||
            (d.location.s()
              ? (c.location = d.location)
              : !c.position.s() && d.position.s() && (c.position = d.position)),
          a.add(c);
    }
    return a;
  };
  dl.prototype.pasteSelection = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    try {
      b.currentCursor = "wait";
      b.V("ChangingSelection", b.selection);
      b.Fa("Paste");
      var c = this.pasteFromClipboard();
      0 < c.count && b.clearSelection(!0);
      for (var d = c.iterator; d.next(); ) d.value.isSelected = !0;
      if (null !== a) {
        var e = b.computePartsBounds(b.selection);
        if (e.s()) {
          var f = this.computeEffectiveCollection(b.selection, b.Bn);
          nf(b, f, new K(a.x - e.centerX, a.y - e.centerY), b.Bn, !1);
        }
      }
      b.V("ClipboardPasted", c);
    } finally {
      b.gb("Paste"),
        b.V("ChangedSelection", b.selection),
        (b.currentCursor = "");
    }
  };
  dl.prototype.canPasteSelection = function () {
    var a = this.diagram;
    return a.isReadOnly ||
      a.isModelReadOnly ||
      !a.allowInsert ||
      !a.allowClipboard ||
      null === Hi ||
      0 === Hi.count ||
      Ii !== a.model.dataFormat
      ? !1
      : !0;
  };
  dl.prototype.undo = function () {
    this.diagram.undoManager.undo();
  };
  dl.prototype.canUndo = function () {
    var a = this.diagram;
    return a.isReadOnly || a.isModelReadOnly
      ? !1
      : a.allowUndo && a.undoManager.canUndo();
  };
  dl.prototype.redo = function () {
    this.diagram.undoManager.redo();
  };
  dl.prototype.canRedo = function () {
    var a = this.diagram;
    return a.isReadOnly || a.isModelReadOnly
      ? !1
      : a.allowUndo && a.undoManager.canRedo();
  };
  dl.prototype.decreaseZoom = function (a) {
    void 0 === a && (a = 1 / this.zoomFactor);
    D(a, dl, "decreaseZoom:factor");
    var b = this.diagram;
    b.autoScale === zh &&
      ((a = b.scale * a), a < b.minScale || a > b.maxScale || (b.scale = a));
  };
  dl.prototype.canDecreaseZoom = function (a) {
    void 0 === a && (a = 1 / this.zoomFactor);
    D(a, dl, "canDecreaseZoom:factor");
    var b = this.diagram;
    if (b.autoScale !== zh) return !1;
    a = b.scale * a;
    return a < b.minScale || a > b.maxScale ? !1 : b.allowZoom;
  };
  dl.prototype.increaseZoom = function (a) {
    void 0 === a && (a = this.zoomFactor);
    D(a, dl, "increaseZoom:factor");
    var b = this.diagram;
    b.autoScale === zh &&
      ((a = b.scale * a), a < b.minScale || a > b.maxScale || (b.scale = a));
  };
  dl.prototype.canIncreaseZoom = function (a) {
    void 0 === a && (a = this.zoomFactor);
    D(a, dl, "canIncreaseZoom:factor");
    var b = this.diagram;
    if (b.autoScale !== zh) return !1;
    a = b.scale * a;
    return a < b.minScale || a > b.maxScale ? !1 : b.allowZoom;
  };
  dl.prototype.resetZoom = function (a) {
    void 0 === a && (a = this.defaultScale);
    D(a, dl, "resetZoom:newscale");
    var b = this.diagram;
    a < b.minScale || a > b.maxScale || (b.scale = a);
  };
  dl.prototype.canResetZoom = function (a) {
    void 0 === a && (a = this.defaultScale);
    D(a, dl, "canResetZoom:newscale");
    var b = this.diagram;
    return a < b.minScale || a > b.maxScale ? !1 : b.allowZoom;
  };
  dl.prototype.zoomToFit = function () {
    var a = this.diagram,
      b = a.animationManager;
    b.wc();
    a.redraw();
    var c = a.position,
      d = a.scale;
    th(b, "Zoom To Fit");
    this.isZoomToFitRestoreEnabled &&
    d === this.Yu &&
    !isNaN(this.eu) &&
    a.documentBounds.D(this.Wu)
      ? ((a.scale = this.eu),
        (a.position = this.Uw),
        (this.Yu = NaN),
        (this.Wu = qc))
      : ((this.eu = d),
        (this.Uw = c.copy()),
        a.zoomToFit(),
        (this.Yu = a.scale),
        (this.Wu = a.documentBounds.copy()));
    vh(b);
  };
  dl.prototype.canZoomToFit = function () {
    return this.diagram.allowZoom;
  };
  dl.prototype.scrollToPart = function (a) {
    void 0 === a && (a = null);
    null !== a && x(a, U, dl, "part");
    var b = this.diagram;
    b.Za();
    if (null === a) {
      try {
        null !== this.jg &&
          (this.jg.next() ? (a = this.jg.value) : (this.jg = null));
      } catch (k) {
        this.jg = null;
      }
      null === a &&
        (0 < b.highlighteds.count
          ? (this.jg = b.highlighteds.iterator)
          : 0 < b.selection.count && (this.jg = b.selection.iterator),
        null !== this.jg && this.jg.next() && (a = this.jg.value));
    }
    if (null !== a) {
      var c = b.animationManager;
      th(c, "Scroll To Part");
      var d = this.scrollToPartPause;
      if (0 < d) {
        var e = fl(this, a, [a]);
        if (1 === e.length)
          b.Fa(), b.xs(a.actualBounds), b.gb("Scroll To Part");
        else {
          var f = function () {
              b.Fa();
              for (
                var a = e.pop();
                0 < e.length &&
                a instanceof V &&
                a.isTreeExpanded &&
                (!(a instanceof vf) || a.isSubGraphExpanded);

              )
                a = e.pop();
              0 < e.length
                ? (a instanceof U && b.Vv(a.actualBounds),
                  a instanceof V &&
                    !a.isTreeExpanded &&
                    (a.isTreeExpanded = !0),
                  a instanceof vf &&
                    !a.isSubGraphExpanded &&
                    (a.isSubGraphExpanded = !0))
                : (a instanceof U && b.xs(a.actualBounds),
                  b.xm("LayoutCompleted", g));
              b.gb("Scroll To Part");
            },
            g = function () {
              va(f, (c.isEnabled ? c.duration : 0) + d);
            };
          b.dk("LayoutCompleted", g);
          f();
        }
      } else {
        var h = b.position.copy();
        b.xs(a.actualBounds);
        h.$a(b.position) && c.wc();
      }
    }
  };
  function fl(a, b, c) {
    if (b.isVisible()) return c;
    if (b instanceof Je) fl(a, b.adornedPart, c);
    else if (b instanceof R) {
      var d = b.fromNode;
      null !== d && fl(a, d, c);
      b = b.toNode;
      null !== b && fl(a, b, c);
    } else
      b instanceof V &&
        ((d = b.labeledLink),
        null !== d && fl(a, d, c),
        (d = b.wg()),
        null !== d &&
          (d.isTreeExpanded || d.wasTreeExpanded || c.push(d), fl(a, d, c))),
        (b = b.containingGroup),
        null !== b &&
          (b.isSubGraphExpanded || b.wasSubGraphExpanded || c.push(b),
          fl(a, b, c));
    return c;
  }
  dl.prototype.canScrollToPart = function (a) {
    void 0 === a && (a = null);
    if (null !== a && !(a instanceof U)) return !1;
    a = this.diagram;
    return 0 === a.selection.count && 0 === a.highlighteds.count
      ? !1
      : a.allowHorizontalScroll && a.allowVerticalScroll;
  };
  dl.prototype.collapseTree = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    try {
      b.Fa("Collapse Tree");
      th(b.animationManager, "Collapse Tree");
      var c = new H();
      if (null !== a && a.isTreeExpanded) a.collapseTree(), c.add(a);
      else if (null === a)
        for (var d = b.selection.iterator; d.next(); ) {
          var e = d.value;
          e instanceof V && e.isTreeExpanded && (e.collapseTree(), c.add(e));
        }
      b.V("TreeCollapsed", c);
    } finally {
      b.gb("Collapse Tree");
    }
  };
  dl.prototype.canCollapseTree = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    if (b.isReadOnly) return !1;
    if (null !== a) {
      if (!(a instanceof V && a.isTreeExpanded)) return !1;
      if (0 < a.hq().count) return !0;
    } else
      for (a = b.selection.iterator; a.next(); )
        if (
          ((b = a.value),
          b instanceof V && b.isTreeExpanded && 0 < b.hq().count)
        )
          return !0;
    return !1;
  };
  dl.prototype.expandTree = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    try {
      b.Fa("Expand Tree");
      th(b.animationManager, "Expand Tree");
      var c = new H();
      if (null !== a && !a.isTreeExpanded) a.expandTree(), c.add(a);
      else if (null === a)
        for (var d = b.selection.iterator; d.next(); ) {
          var e = d.value;
          e instanceof V && !e.isTreeExpanded && (e.expandTree(), c.add(e));
        }
      b.V("TreeExpanded", c);
    } finally {
      b.gb("Expand Tree");
    }
  };
  dl.prototype.canExpandTree = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    if (b.isReadOnly) return !1;
    if (null !== a) {
      if (!(a instanceof V) || a.isTreeExpanded) return !1;
      if (0 < a.hq().count) return !0;
    } else
      for (a = b.selection.iterator; a.next(); )
        if (
          ((b = a.value),
          b instanceof V && !b.isTreeExpanded && 0 < b.hq().count)
        )
          return !0;
    return !1;
  };
  dl.prototype.groupSelection = function () {
    var a = this.diagram,
      b = a.model;
    if (b.Xi()) {
      var c = this.archetypeGroupData;
      if (null !== c) {
        var d = null;
        try {
          a.currentCursor = "wait";
          a.V("ChangingSelection", a.selection);
          a.Fa("Group");
          for (var e = new H(), f = a.selection.iterator; f.next(); ) {
            var g = f.value;
            g.Tc() && g.canGroup() && e.add(g);
          }
          for (var h = new H(), k = e.iterator; k.next(); ) {
            var l = k.value;
            f = !1;
            for (var m = e.iterator; m.next(); )
              if (l.Pd(m.value)) {
                f = !0;
                break;
              }
            f || h.add(l);
          }
          if (0 < h.count) {
            var n = h.first().containingGroup;
            if (null !== n)
              for (; null !== n; ) {
                e = !1;
                for (var p = h.iterator; p.next(); )
                  if (!p.value.Pd(n)) {
                    e = !0;
                    break;
                  }
                if (e) n = n.containingGroup;
                else break;
              }
            if (c instanceof vf) sg(c), (d = c.copy()), null !== d && a.add(d);
            else if (b.Os(c)) {
              var r = b.copyNodeData(c);
              Ga(r) && (b.Af(r), (d = a.Pi(r)));
            }
            if (null !== d) {
              null !== n && this.isValidMember(n, d) && (d.containingGroup = n);
              for (var q = h.iterator; q.next(); ) {
                var u = q.value;
                this.isValidMember(d, u) && (u.containingGroup = d);
              }
              a.clearSelection(!0);
              d.isSelected = !0;
            }
          }
          a.V("SelectionGrouped", d);
        } finally {
          a.gb("Group"),
            a.V("ChangedSelection", a.selection),
            (a.currentCursor = "");
        }
      }
    }
  };
  dl.prototype.canGroupSelection = function () {
    var a = this.diagram;
    if (
      a.isReadOnly ||
      a.isModelReadOnly ||
      !a.allowInsert ||
      !a.allowGroup ||
      !a.model.Xi() ||
      null === this.archetypeGroupData
    )
      return !1;
    for (a = a.selection.iterator; a.next(); ) {
      var b = a.value;
      if (b.Tc() && b.canGroup()) return !0;
    }
    return !1;
  };
  function gl(a) {
    var b = Ma();
    for (a = a.iterator; a.next(); ) {
      var c = a.value;
      c instanceof R || b.push(c);
    }
    a = new I();
    c = b.length;
    for (var d = 0; d < c; d++) {
      for (var e = b[d], f = !0, g = 0; g < c; g++)
        if (e.Pd(b[g])) {
          f = !1;
          break;
        }
      f && a.add(e);
    }
    Pa(b);
    return a;
  }
  dl.prototype.isValidMember = function (a, b) {
    if (null === b || a === b || b instanceof R) return !1;
    if (null !== a) {
      if (a === b || a.Pd(b)) return !1;
      var c = a.memberValidation;
      if (
        (null !== c && !c(a, b)) ||
        (null === a.data && null !== b.data) ||
        (null !== a.data && null === b.data)
      )
        return !1;
    }
    c = this.memberValidation;
    return null !== c ? c(a, b) : !0;
  };
  dl.prototype.ungroupSelection = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram,
      c = b.model;
    if (c.Xi())
      try {
        b.currentCursor = "wait";
        b.V("ChangingSelection", b.selection);
        b.Fa("Ungroup");
        var d = new H();
        if (null !== a) d.add(a);
        else
          for (var e = b.selection.iterator; e.next(); ) {
            var f = e.value;
            f instanceof vf && f.canUngroup() && d.add(f);
          }
        var g = new H();
        if (0 < d.count) {
          b.clearSelection(!0);
          for (var h = d.iterator; h.next(); ) {
            var k = h.value;
            k.expandSubGraph();
            var l = k.containingGroup,
              m = null !== l && null !== l.data ? c.wa(l.data) : void 0;
            g.addAll(k.memberParts);
            for (var n = g.iterator; n.next(); ) {
              var p = n.value;
              p.isSelected = !0;
              if (!(p instanceof R)) {
                var r = p.data;
                null !== r ? c.Eq(r, m) : (p.containingGroup = l);
              }
            }
            b.remove(k);
          }
        }
        b.V("SelectionUngrouped", d, g);
      } finally {
        b.gb("Ungroup"),
          b.V("ChangedSelection", b.selection),
          (b.currentCursor = "");
      }
  };
  dl.prototype.canUngroupSelection = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    if (
      b.isReadOnly ||
      b.isModelReadOnly ||
      !b.allowDelete ||
      !b.allowUngroup ||
      !b.model.Xi()
    )
      return !1;
    if (null !== a) {
      if (!(a instanceof vf)) return !1;
      if (a.canUngroup()) return !0;
    } else
      for (a = b.selection.iterator; a.next(); )
        if (((b = a.value), b instanceof vf && b.canUngroup())) return !0;
    return !1;
  };
  dl.prototype.addTopLevelParts = function (a, b) {
    var c = !0;
    for (a = gl(a).iterator; a.next(); ) {
      var d = a.value;
      null !== d.containingGroup &&
        (!b || this.isValidMember(null, d)
          ? (d.containingGroup = null)
          : (c = !1));
    }
    return c;
  };
  dl.prototype.collapseSubGraph = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    try {
      b.Fa("Collapse SubGraph");
      th(b.animationManager, "Collapse SubGraph");
      var c = new H();
      if (null !== a && a.isSubGraphExpanded) a.collapseSubGraph(), c.add(a);
      else if (null === a)
        for (var d = b.selection.iterator; d.next(); ) {
          var e = d.value;
          e instanceof vf &&
            e.isSubGraphExpanded &&
            (e.collapseSubGraph(), c.add(e));
        }
      b.V("SubGraphCollapsed", c);
    } finally {
      b.gb("Collapse SubGraph");
    }
  };
  dl.prototype.canCollapseSubGraph = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    if (b.isReadOnly) return !1;
    if (null !== a) return a instanceof vf && a.isSubGraphExpanded ? !0 : !1;
    for (a = b.selection.iterator; a.next(); )
      if (((b = a.value), b instanceof vf && b.isSubGraphExpanded)) return !0;
    return !1;
  };
  dl.prototype.expandSubGraph = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    try {
      b.Fa("Expand SubGraph");
      th(b.animationManager, "Expand SubGraph");
      var c = new H();
      if (null !== a && !a.isSubGraphExpanded) a.expandSubGraph(), c.add(a);
      else if (null === a)
        for (var d = b.selection.iterator; d.next(); ) {
          var e = d.value;
          e instanceof vf &&
            !e.isSubGraphExpanded &&
            (e.expandSubGraph(), c.add(e));
        }
      b.V("SubGraphExpanded", c);
    } finally {
      b.gb("Expand SubGraph");
    }
  };
  dl.prototype.canExpandSubGraph = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    if (b.isReadOnly) return !1;
    if (null !== a) return a instanceof vf && !a.isSubGraphExpanded ? !0 : !1;
    for (a = b.selection.iterator; a.next(); )
      if (((b = a.value), b instanceof vf && !b.isSubGraphExpanded)) return !0;
    return !1;
  };
  dl.prototype.editTextBlock = function (a) {
    void 0 === a && (a = null);
    null !== a && x(a, Yg, dl, "editTextBlock");
    var b = this.diagram,
      c = b.toolManager.findTool("TextEditing");
    if (null !== c) {
      if (null === a) {
        a = null;
        for (var d = b.selection.iterator; d.next(); ) {
          var e = d.value;
          if (e.canEdit()) {
            a = e;
            break;
          }
        }
        if (null === a) return;
        a = a.km(function (a) {
          return a instanceof Yg && a.editable;
        });
      }
      null !== a &&
        ((b.currentTool = null), (c.textBlock = a), (b.currentTool = c));
    }
  };
  dl.prototype.canEditTextBlock = function (a) {
    void 0 === a && (a = null);
    var b = this.diagram;
    if (
      b.isReadOnly ||
      b.isModelReadOnly ||
      !b.allowTextEdit ||
      null === b.toolManager.findTool("TextEditing")
    )
      return !1;
    if (null !== a) {
      if (!(a instanceof Yg)) return !1;
      a = a.part;
      if (null !== a && a.canEdit()) return !0;
    } else
      for (b = b.selection.iterator; b.next(); )
        if (
          ((a = b.value),
          a.canEdit() &&
            ((a = a.km(function (a) {
              return a instanceof Yg && a.editable;
            })),
            null !== a))
        )
          return !0;
    return !1;
  };
  dl.prototype.showContextMenu = function (a) {
    var b = this.diagram,
      c = b.toolManager.findTool("ContextMenu");
    if (
      null !== c &&
      (void 0 === a && (a = 0 < b.selection.count ? b.selection.first() : b),
      (a = c.findObjectWithContextMenu(a)),
      null !== a)
    ) {
      var d = b.lastInput,
        e = null;
      a instanceof O
        ? (e = a.ka(Kc))
        : b.viewportBounds.ca(d.documentPoint) ||
          ((e = b.viewportBounds),
          (e = new K(e.x + e.width / 2, e.y + e.height / 2)));
      null !== e &&
        ((d.viewPoint = b.Gq(e)),
        (d.documentPoint = e),
        (d.left = !1),
        (d.right = !0),
        (d.up = !0));
      b.currentTool = c;
      Ug(c, !1, a);
    }
  };
  dl.prototype.canShowContextMenu = function (a) {
    var b = this.diagram,
      c = b.toolManager.findTool("ContextMenu");
    if (null === c) return !1;
    void 0 === a && (a = 0 < b.selection.count ? b.selection.first() : b);
    return null === c.findObjectWithContextMenu(a) ? !1 : !0;
  };
  dl.prototype.computeEffectiveCollection = function (a, b) {
    var c = this.diagram,
      d = c.toolManager.findTool("Dragging"),
      e = c.currentTool === d;
    void 0 === b && (b = e ? d.dragOptions : c.Bn);
    d = new xb();
    if (null === a) return d;
    for (var f = a.iterator; f.next(); ) Vj(c, d, f.value, e, b);
    if (null !== c.draggedLink && b.dragsLink) return d;
    for (f = a.iterator; f.next(); )
      (a = f.value),
        a instanceof R &&
          ((b = a.fromNode),
          null === b || d.contains(b)
            ? ((b = a.toNode), null === b || d.contains(b) || d.remove(a))
            : d.remove(a));
    return d;
  };
  oa.Object.defineProperties(dl.prototype, {
    diagram: {
      configurable: !0,
      get: function () {
        return this.G;
      },
    },
    copiesClipboardData: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        A(a, "boolean", dl, "copiesClipboardData");
        this.o = a;
      },
    },
    copiesConnectedLinks: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        A(a, "boolean", dl, "copiesConnectedLinks");
        this.B = a;
      },
    },
    deletesConnectedLinks: {
      configurable: !0,
      get: function () {
        return this.eb;
      },
      set: function (a) {
        A(a, "boolean", dl, "deletesConnectedLinks");
        this.eb = a;
      },
    },
    copiesTree: {
      configurable: !0,
      get: function () {
        return this.Na;
      },
      set: function (a) {
        A(a, "boolean", dl, "copiesTree");
        this.Na = a;
      },
    },
    deletesTree: {
      configurable: !0,
      get: function () {
        return this.Yc;
      },
      set: function (a) {
        A(a, "boolean", dl, "deletesTree");
        this.Yc = a;
      },
    },
    copiesParentKey: {
      configurable: !0,
      get: function () {
        return this.Ba;
      },
      set: function (a) {
        A(a, "boolean", dl, "copiesParentKey");
        this.Ba = a;
      },
    },
    copiesGroupKey: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        A(a, "boolean", dl, "copiesGroupKey");
        this.M = a;
      },
    },
    archetypeGroupData: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        null !== a && A(a, "object", dl, "archetypeGroupData");
        var b = this.diagram;
        G &&
          ((b = b.model),
          !b.Xi() ||
            a instanceof vf ||
            b.Os(a) ||
            v(
              "CommandHandler.archetypeGroupData must be either a Group or a data object for which GraphLinksModel.isGroupForNodeData is true: " +
                a
            ));
        this.j = a;
      },
    },
    memberValidation: {
      configurable: !0,
      get: function () {
        return this.ti;
      },
      set: function (a) {
        null !== a && A(a, "function", dl, "memberValidation");
        this.ti = a;
      },
    },
    defaultScale: {
      configurable: !0,
      get: function () {
        return this.diagram.defaultScale;
      },
      set: function (a) {
        this.diagram.defaultScale = a;
      },
    },
    zoomFactor: {
      configurable: !0,
      get: function () {
        return this.Td;
      },
      set: function (a) {
        D(a, dl, "zoomFactor");
        1 < a || v("zoomFactor must be larger than 1.0, not: " + a);
        this.Td = a;
      },
    },
    isZoomToFitRestoreEnabled: {
      configurable: !0,
      get: function () {
        return this.Hc;
      },
      set: function (a) {
        A(a, "boolean", dl, "isZoomToFitRestoreEnabled");
        this.Hc = a;
      },
    },
    scrollToPartPause: {
      configurable: !0,
      get: function () {
        return this.Zc;
      },
      set: function (a) {
        D(a, dl, "scrollToPartPause");
        this.Zc = a;
      },
    },
  });
  dl.className = "CommandHandler";
  Gi = function () {
    return new dl();
  };
  function O() {
    ab(this);
    this.A = 30723;
    this.tb = 1;
    this.ig = null;
    this.ua = "";
    this.qd = this.Zb = null;
    this.ra = new K(NaN, NaN).freeze();
    this.bd = $b;
    this.fg = Rb;
    this.eg = Zb;
    this.Bb = new Kb();
    this.Vh = new Kb();
    this.Ib = null;
    this.Aa = this.il = 1;
    this.Fb = 0;
    this.Ne = hl;
    this.$g = Cc;
    this.rc = new M(NaN, NaN, NaN, NaN).freeze();
    this.Db = new M(NaN, NaN, NaN, NaN).freeze();
    this.zc = new M(0, 0, NaN, NaN).freeze();
    this.T = this.Zo = this.$o = null;
    this.Ok = this.Eb = gd;
    this.lp = 0;
    this.mp = 1;
    this.Hg = 0;
    this.ln = 1;
    this.Ra = this.Cp = null;
    this.ai = "";
    this.ob = this.S = null;
    this.Uk = -1;
    this.Sl = this.kb = this.$h = this.Wl = null;
    this.Ur = tg;
    this.op = this.Cg = this.Uj = null;
  }
  var Fd, tg, vg, hl, il, jl, kl, ll, ml, nl;
  O.prototype.cloneProtected = function (a) {
    a.A = this.A | 6144;
    a.tb = this.tb;
    a.ua = this.ua;
    a.Zb = this.Zb;
    a.qd = this.qd;
    a.Cg = this.Cg;
    a.ra.assign(this.ra);
    a.bd = this.bd.L();
    a.fg = this.fg.L();
    a.eg = this.eg.L();
    null !== this.Ib ? (a.Ib = this.Ib.copy()) : (a.Ib = null);
    a.Aa = this.Aa;
    a.Fb = this.Fb;
    a.Ne = this.Ne;
    a.$g = this.$g.L();
    a.rc.assign(this.rc);
    a.Db.assign(this.Db);
    a.zc.assign(this.zc);
    a.Zo = this.Zo;
    null !== this.T && (a.T = this.T.copy());
    a.Eb = this.Eb.L();
    a.Ok = this.Ok.L();
    a.lp = this.lp;
    a.mp = this.mp;
    a.Hg = this.Hg;
    a.ln = this.ln;
    a.Cp = this.Cp;
    null !== this.Ra && (a.Ra = this.Ra.copy());
    a.ai = this.ai;
    null !== this.S && (a.S = this.S.copy());
    a.ob = this.ob;
    a.Uk = this.Uk;
    null !== this.$h && (a.$h = Ja(this.$h));
    null !== this.kb && (a.kb = this.kb.copy());
    a.Sl = this.Sl;
  };
  O.prototype.yx = function (a) {
    var b = this.$h;
    if (Ha(b))
      for (var c = 0; c < b.length; c++) {
        if (b[c] === a) return;
      }
    else this.$h = b = [];
    b.push(a);
  };
  O.prototype.Ef = function (a) {
    a.$o = null;
    a.Uj = null;
    a.v();
  };
  O.prototype.clone = function () {
    var a = new this.constructor();
    this.cloneProtected(a);
    if (null !== this.$h)
      for (var b = 0; b < this.$h.length; b++) {
        var c = this.$h[b];
        a[c] = this[c];
      }
    return a;
  };
  O.prototype.copy = function () {
    return this.clone();
  };
  t = O.prototype;
  t.pb = function (a) {
    a.classType === R
      ? 0 === a.name.indexOf("Orient")
        ? (this.segmentOrientation = a)
        : v(
            "Unknown Link enum value for GraphObject.segmentOrientation property: " +
              a
          )
      : a.classType === O
      ? (this.stretch = a)
      : Ea(this, a);
  };
  t.toString = function () {
    return Qa(this.constructor) + "#" + lb(this);
  };
  function ol(a) {
    null === a.S && (a.S = new pl());
  }
  t.Rc = function () {
    if (null === this.T) {
      var a = new ql();
      a.Ug = Ec;
      a.yh = Ec;
      a.Sg = 10;
      a.wh = 10;
      a.Tg = 0;
      a.xh = 0;
      this.T = a;
    }
  };
  t.cb = function (a, b, c, d, e, f, g) {
    var h = this.part;
    if (
      null !== h &&
      (h.Hk(a, b, c, d, e, f, g),
      c === this && a === pe && rl(this) && sl(this, h, b),
      (f = this.diagram),
      null === this.Cg ||
        null === f ||
        !f.Yi ||
        f.undoManager.isUndoingRedoing ||
        f.animationManager.fn ||
        ((a = this.Cg.get(b)),
        null !== a &&
          f.animationManager.isEnabled &&
          !f.animationManager.isTicking &&
          (null === this.op && (this.op = new xb()),
          (g = 0 === f.undoManager.transactionLevel),
          a.startCondition === ji
            ? (g = !0)
            : a.startCondition === li && (g = !1),
          g
            ? ((f = new sh()),
              ki(a, f),
              (g = this.op.get(a)),
              null !== g && g.stop(),
              this.op.add(a, f),
              (f.Tu = this),
              (f.qx = a),
              f.add(this, b, d, e),
              f.start())
            : (th(f.animationManager, "Trigger"),
              f.animationManager.defaultAnimation.add(this, b, d, e)))),
      this instanceof W && c === h && 0 !== (h.A & 16777216) && null !== h.data)
    )
      for (c = this.W.m, d = c.length, e = 0; e < d; e++)
        (h = c[e]),
          h instanceof W &&
            Nj(h, function (a) {
              null !== a.data && 0 !== (a.A & 16777216) && a.Ka(b);
            });
  };
  function sl(a, b, c) {
    var d = a.Hh();
    if (null !== d)
      for (var e = a.ob.iterator; e.next(); ) {
        var f = e.value,
          g = null;
        if (null !== f.sourceName) {
          g = tl(f, d, a);
          if (null === g) continue;
          f.Kq(a, g, c, null);
        } else if (f.isToModel) {
          var h = b.diagram;
          null === h ||
            h.skipsModelSourceBindings ||
            f.Kq(a, h.model.modelData, c, d);
        } else {
          h = d.data;
          if (null === h) continue;
          var k = b.diagram;
          null === k || k.skipsModelSourceBindings || f.Kq(a, h, c, d);
        }
        g === a && ((h = d.Bs(f.gj)), null !== h && f.iw(h, g, c));
      }
  }
  t.Bs = function (a) {
    return this.Uk === a ? this : null;
  };
  t.g = function (a, b, c) {
    this.cb(pe, a, this, b, c);
  };
  t.Ee = function (a, b, c, d) {
    var e = this.rc;
    e.h(a, b, c, d);
    if (1 !== this.Aa || 0 !== this.Fb) {
      null === this.Ib && (this.Ib = new Kb());
      var f = this.Ib;
      f.reset();
      this.wp(f, a, b, c, d);
      f.Hq(e);
    }
  };
  function ul(a, b, c, d) {
    if (!1 === a.pickable) return !1;
    d.multiply(a.transform);
    return c ? a.Sc(b, d) : a.Fh(b, d);
  }
  t.Vx = function (a, b, c) {
    if (!1 === this.pickable) return !1;
    var d = this.naturalBounds;
    b = a.Ff(b);
    return c
      ? Mb(a.x, a.y, 0, 0, 0, d.height) <= b ||
          Mb(a.x, a.y, 0, d.height, d.width, d.height) <= b ||
          Mb(a.x, a.y, d.width, d.height, d.width, 0) <= b ||
          Mb(a.x, a.y, d.width, 0, 0, 0) <= b
      : a.xd(0, 0) <= b &&
          a.xd(0, d.height) <= b &&
          a.xd(d.width, 0) <= b &&
          a.xd(d.width, d.height) <= b;
  };
  t.oe = function () {
    return !0;
  };
  t.ca = function (a) {
    G && x(a, K, O, "containsPoint:p");
    var b = K.alloc();
    b.assign(a);
    this.transform.Ha(b);
    var c = this.actualBounds;
    if (!c.s()) return K.free(b), !1;
    var d = this.diagram;
    if (null !== d && d.bu) {
      var e = d.nm("extraTouchThreshold"),
        f = d.nm("extraTouchArea"),
        g = f / 2,
        h = this.naturalBounds;
      d = this.If() * d.scale;
      var k = 1 / d;
      if (h.width * d < e && h.height * d < e)
        return (
          (a = nc(
            c.x - g * k,
            c.y - g * k,
            c.width + f * k,
            c.height + f * k,
            b.x,
            b.y
          )),
          K.free(b),
          a
        );
    }
    e = !1;
    if (
      this instanceof Je || this instanceof Hf
        ? nc(c.x - 5, c.y - 5, c.width + 10, c.height + 10, b.x, b.y)
        : c.ca(b)
    )
      this.kb && !this.kb.ca(b)
        ? (e = !1)
        : null !== this.qd && c.ca(b)
        ? (e = !0)
        : null !== this.Zb && this.zc.ca(a)
        ? (e = !0)
        : (e = this.Gh(a));
    K.free(b);
    return e;
  };
  t.Gh = function (a) {
    var b = this.naturalBounds;
    return nc(0, 0, b.width, b.height, a.x, a.y);
  };
  t.Qe = function (a) {
    if (0 === this.angle) return this.actualBounds.Qe(a);
    var b = this.naturalBounds;
    b = M.allocAt(0, 0, b.width, b.height);
    var c = this.transform,
      d = !1,
      e = K.allocAt(a.x, a.y);
    b.ca(c.Od(e)) &&
      (e.h(a.x, a.bottom),
      b.ca(c.Od(e)) &&
        (e.h(a.right, a.bottom),
        b.ca(c.Od(e)) && (e.h(a.right, a.y), b.ca(c.Od(e)) && (d = !0))));
    K.free(e);
    M.free(b);
    return d;
  };
  t.Fh = function (a, b) {
    G && x(a, M, O, "containedInRect:r");
    if (void 0 === b) return a.Qe(this.actualBounds);
    var c = this.naturalBounds,
      d = !1,
      e = K.allocAt(0, 0);
    a.ca(b.Ha(e)) &&
      (e.h(0, c.height),
      a.ca(b.Ha(e)) &&
        (e.h(c.width, c.height),
        a.ca(b.Ha(e)) && (e.h(c.width, 0), a.ca(b.Ha(e)) && (d = !0))));
    K.free(e);
    return d;
  };
  t.Sc = function (a, b) {
    G && x(a, M, O, "intersectsRect:r");
    if (void 0 === b && ((b = this.transform), 0 === this.angle))
      return a.Sc(this.actualBounds);
    var c = this.naturalBounds,
      d = K.allocAt(0, 0),
      e = K.allocAt(0, c.height),
      f = K.allocAt(c.width, c.height),
      g = K.allocAt(c.width, 0),
      h = !1;
    if (a.ca(b.Ha(d)) || a.ca(b.Ha(e)) || a.ca(b.Ha(f)) || a.ca(b.Ha(g)))
      h = !0;
    else {
      c = M.allocAt(0, 0, c.width, c.height);
      var k = K.allocAt(a.x, a.y);
      c.ca(b.Od(k))
        ? (h = !0)
        : (k.h(a.x, a.bottom),
          c.ca(b.Od(k))
            ? (h = !0)
            : (k.h(a.right, a.bottom),
              c.ca(b.Od(k))
                ? (h = !0)
                : (k.h(a.right, a.y), c.ca(b.Od(k)) && (h = !0))));
      K.free(k);
      M.free(c);
      !h &&
        (L.Ls(a, d, e) || L.Ls(a, e, f) || L.Ls(a, f, g) || L.Ls(a, g, d)) &&
        (h = !0);
    }
    K.free(d);
    K.free(e);
    K.free(f);
    K.free(g);
    return h;
  };
  t.ka = function (a, b) {
    void 0 === b && (b = new K());
    if (a instanceof Ib) {
      G &&
        a.ec() &&
        v("getDocumentPoint:s Spot must be specific: " + a.toString());
      var c = this.naturalBounds;
      b.h(a.x * c.width + a.offsetX, a.y * c.height + a.offsetY);
    } else b.set(a);
    this.ke.Ha(b);
    return b;
  };
  t.Ui = function (a) {
    void 0 === a && (a = new M());
    var b = this.naturalBounds,
      c = this.ke,
      d = K.allocAt(0, 0).transform(c);
    a.h(d.x, d.y, 0, 0);
    d.h(b.width, 0).transform(c);
    mc(a, d.x, d.y, 0, 0);
    d.h(b.width, b.height).transform(c);
    mc(a, d.x, d.y, 0, 0);
    d.h(0, b.height).transform(c);
    mc(a, d.x, d.y, 0, 0);
    K.free(d);
    return a;
  };
  t.Ti = function () {
    var a = this.ke;
    1 === a.m11 && 0 === a.m12
      ? (a = 0)
      : ((a = (180 * Math.atan2(a.m12, a.m11)) / Math.PI), 0 > a && (a += 360));
    return a;
  };
  t.If = function () {
    if ((0 !== (this.A & 4096)) === !1) return this.il;
    var a = this.Aa;
    return null !== this.panel ? a * this.panel.If() : a;
  };
  t.Hs = function (a, b) {
    void 0 === b && (b = new K());
    b.assign(a);
    this.ke.Od(b);
    return b;
  };
  t.Is = function (a, b, c) {
    return this.sk(a.x, a.y, b.x, b.y, c);
  };
  t.sk = function (a, b, c, d, e) {
    var f = this.transform,
      g = 1 / (f.m11 * f.m22 - f.m12 * f.m21),
      h = f.m22 * g,
      k = -f.m12 * g,
      l = -f.m21 * g,
      m = f.m11 * g,
      n = g * (f.m21 * f.dy - f.m22 * f.dx),
      p = g * (f.m12 * f.dx - f.m11 * f.dy);
    if (null !== this.areaBackground)
      return (
        (f = this.actualBounds),
        L.Kf(f.left, f.top, f.right, f.bottom, a, b, c, d, e)
      );
    g = a * h + b * l + n;
    a = a * k + b * m + p;
    b = c * h + d * l + n;
    c = c * k + d * m + p;
    e.h(0, 0);
    d = this.naturalBounds;
    c = L.Kf(0, 0, d.width, d.height, g, a, b, c, e);
    e.transform(f);
    return c;
  };
  O.prototype.measure = function (a, b, c, d) {
    if (!1 !== Aj(this)) {
      var e = this.$g,
        f = e.right + e.left;
      e = e.top + e.bottom;
      a = Math.max(a - f, 0);
      b = Math.max(b - e, 0);
      c = Math.max((c || 0) - f, 0);
      d = Math.max((d || 0) - e, 0);
      f = this.angle;
      e = this.desiredSize;
      var g = 0;
      this instanceof Hf && (g = this.strokeWidth);
      90 === f || 270 === f
        ? ((a = isFinite(e.height) ? e.height + g : a),
          (b = isFinite(e.width) ? e.width + g : b))
        : ((a = isFinite(e.width) ? e.width + g : a),
          (b = isFinite(e.height) ? e.height + g : b));
      e = c || 0;
      g = d || 0;
      var h = this instanceof W;
      switch (vl(this, !0)) {
        case tg:
          g = e = 0;
          h && (b = a = Infinity);
          break;
        case Fd:
          isFinite(a) && a > c && (e = a);
          isFinite(b) && b > d && (g = b);
          break;
        case il:
          isFinite(a) && a > c && (e = a);
          g = 0;
          h && (b = Infinity);
          break;
        case jl:
          isFinite(b) && b > d && (g = b), (e = 0), h && (a = Infinity);
      }
      h = this.maxSize;
      var k = this.minSize;
      e > h.width && k.width < h.width && (e = h.width);
      g > h.height && k.height < h.height && (g = h.height);
      c = Math.max(e / this.scale, k.width);
      d = Math.max(g / this.scale, k.height);
      h.width < c && (c = Math.min(k.width, c));
      h.height < d && (d = Math.min(k.height, d));
      a = Math.min(h.width, a);
      b = Math.min(h.height, b);
      a = Math.max(c, a);
      b = Math.max(d, b);
      if (90 === f || 270 === f)
        (f = a), (a = b), (b = f), (f = c), (c = d), (d = f);
      this.rc.la();
      this.tm(a, b, c, d);
      this.rc.freeze();
      this.rc.s() ||
        v(
          "Non-real measuredBounds has been set. Object " +
            this +
            ", measuredBounds: " +
            this.rc.toString()
        );
      vj(this, !1);
    }
  };
  O.prototype.tm = function () {};
  O.prototype.$i = function () {
    return !1;
  };
  O.prototype.arrange = function (a, b, c, d, e) {
    this.tl();
    var f = M.alloc();
    f.assign(this.Db);
    this.Db.la();
    !1 === Bj(this) ? this.Db.h(a, b, c, d) : this.Eh(a, b, c, d);
    this.Db.freeze();
    void 0 === e ? (this.kb = null) : (this.kb = e);
    c = !1;
    if (void 0 !== e) c = !0;
    else if (
      ((e = this.panel),
      null === e ||
        (e.type !== W.TableRow && e.type !== W.TableColumn) ||
        (e = e.panel),
      null !== e &&
        ((e = e.zc),
        (d = this.measuredBounds),
        null !== this.areaBackground && (d = this.Db),
        (c = b + d.height),
        (d = a + d.width),
        (c = !(
          0 <= a + 0.05 &&
          d <= e.width + 0.05 &&
          0 <= b + 0.05 &&
          c <= e.height + 0.05
        )),
        this instanceof Yg &&
          ((a = this.naturalBounds), this.Gr > a.height || this.yb > a.width)))
    )
      c = !0;
    this.A = c ? this.A | 256 : this.A & -257;
    this.Db.s() ||
      v(
        "Non-real actualBounds has been set. Object " +
          this +
          ", actualBounds: " +
          this.Db.toString()
      );
    this.um(f, this.Db);
    wl(this, !1);
    M.free(f);
  };
  t = O.prototype;
  t.Eh = function () {};
  function xl(a, b, c, d, e) {
    a.Db.h(b, c, d, e);
    if (!a.desiredSize.s()) {
      var f = a.rc;
      c = a.$g;
      b = c.right + c.left;
      var g = c.top + c.bottom;
      c = f.width + b;
      f = f.height + g;
      d += b;
      e += g;
      b = vl(a, !0);
      c === d && f === e && (b = tg);
      switch (b) {
        case tg:
          if (c > d || f > e)
            vj(a, !0), a.measure(c > d ? d : c, f > e ? e : f, 0, 0);
          break;
        case Fd:
          vj(a, !0);
          a.measure(d, e, 0, 0);
          break;
        case il:
          vj(a, !0);
          a.measure(d, f, 0, 0);
          break;
        case jl:
          vj(a, !0), a.measure(c, e, 0, 0);
      }
    }
  }
  t.um = function (a, b) {
    var c = this.part;
    null !== c &&
      null !== c.diagram &&
      ((c.selectionObject !== this &&
        c.resizeObject !== this &&
        c.rotateObject !== this) ||
        yl(c, !0),
      this.R(),
      gc(a, b) || (c.Lh(), this.Po(c)));
  };
  t.Po = function (a) {
    null !== this.portId && (yl(a, !0), a instanceof V && zl(a, this));
  };
  t.uc = function (a, b) {
    if (this.visible) {
      var c = this.opacity;
      if (0 !== c) {
        var d =
            this instanceof W &&
            (this.type === W.TableRow || this.type === W.TableColumn),
          e = this.Db;
        if (
          d ||
          (0 !== e.width && 0 !== e.height && !isNaN(e.x) && !isNaN(e.y))
        ) {
          var f = 1;
          1 !== c && ((f = a.globalAlpha), (a.globalAlpha = f * c));
          if (d) {
            e = this.Db;
            d = this.zc;
            var g = this.qd,
              h = this.Zb;
            (null === g && null === h) || a.Oc();
            null !== g &&
              (pi(this, a, g, !0, !0, d, e),
              g instanceof Al && g.type === Bl
                ? (a.beginPath(), a.rect(e.x, e.y, e.width, e.height), a.Gf(g))
                : a.fillRect(e.x, e.y, e.width, e.height));
            null !== h &&
              (pi(this, a, h, !0, !1, d, e),
              h instanceof Al && h.type === Bl
                ? (a.beginPath(), a.rect(e.x, e.y, e.width, e.height), a.Gf(h))
                : a.fillRect(e.x, e.y, e.width, e.height));
            this.Ni(a, b);
          } else if (!this.Px(a, b)) {
            this instanceof R && this.yk(!1);
            G && G.fm && G.Lz && G.Lz(a, this);
            d = this.transform;
            g = this.panel;
            (0 !== (this.A & 4096)) === !0 && Cl(this);
            var k = this.part;
            h = !1;
            var l = 0;
            if (k && b.Se("drawShadows") && (h = k.isShadowed)) {
              var m = k.shadowOffset;
              l = Math.max(m.y, m.x) * b.scale * b.jc;
            }
            m = this.$i();
            var n;
            if (!(n = b.Hj || !m)) {
              var p = this.naturalBounds;
              n = this.Vh;
              var r = n.m11,
                q = n.m21,
                u = n.dx,
                w = n.m12,
                y = n.m22,
                z = n.dy,
                B,
                C = (B = 0);
              n = B * r + C * q + u;
              var E = B * w + C * y + z;
              B = p.width + l;
              C = 0;
              var J = B * r + C * q + u;
              B = B * w + C * y + z;
              C = Math.min(n, J);
              var S = Math.min(E, B);
              var aa = Math.max(n + 0, J) - C;
              var Y = Math.max(E + 0, B) - S;
              n = C;
              E = S;
              B = p.width + l;
              C = p.height + l;
              J = B * r + C * q + u;
              B = B * w + C * y + z;
              C = Math.min(n, J);
              S = Math.min(E, B);
              aa = Math.max(n + aa, J) - C;
              Y = Math.max(E + Y, B) - S;
              n = C;
              E = S;
              B = 0;
              C = p.height + l;
              J = B * r + C * q + u;
              B = B * w + C * y + z;
              C = Math.min(n, J);
              S = Math.min(E, B);
              aa = Math.max(n + aa, J) - C;
              Y = Math.max(E + Y, B) - S;
              n = C;
              E = S;
              l = b.viewportBounds;
              p = l.x;
              r = l.y;
              n = !(
                n > l.width + p ||
                p > aa + n ||
                E > l.height + r ||
                r > Y + E
              );
            }
            if (n) {
              n = 0 !== (this.A & 256);
              a.clipInsteadOfFill && (n = !1);
              this instanceof Yg && (a.font = this.font);
              if (n) {
                E = g.oe() ? g.naturalBounds : g.actualBounds;
                null !== this.kb
                  ? ((p = this.kb),
                    (aa = p.x),
                    (Y = p.y),
                    (l = p.width),
                    (p = p.height))
                  : ((aa = Math.max(e.x, E.x)),
                    (Y = Math.max(e.y, E.y)),
                    (l = Math.min(e.right, E.right) - aa),
                    (p = Math.min(e.bottom, E.bottom) - Y));
                if (aa > e.width + e.x || e.x > E.width + E.x) {
                  1 !== c && (a.globalAlpha = f);
                  return;
                }
                a.save();
                a.beginPath();
                a.rect(aa, Y, l, p);
                a.clip();
              }
              if (m) {
                if (!k.isVisible()) {
                  1 !== c && (a.globalAlpha = f);
                  return;
                }
                h &&
                  ((E = k.shadowOffset),
                  a.bw(
                    E.x * b.scale * b.jc,
                    E.y * b.scale * b.jc,
                    k.shadowBlur
                  ),
                  Dl(a),
                  (a.shadowColor = k.shadowColor));
              }
              h && !0 === this.shadowVisible
                ? Dl(a)
                : h && !1 === this.shadowVisible && El(a);
              k = this.naturalBounds;
              null !== this.qd &&
                (a.Oc(),
                pi(this, a, this.qd, !0, !0, k, e),
                this.qd instanceof Al && this.qd.type === Bl
                  ? (a.beginPath(),
                    a.rect(e.x, e.y, e.width, e.height),
                    a.Gf(this.qd))
                  : a.fillRect(e.x, e.y, e.width, e.height));
              a.transform(d.m11, d.m12, d.m21, d.m22, d.dx, d.dy);
              h &&
                ((null !== g && 0 !== (g.A & 512)) ||
                  (null !== g &&
                    (g.type === W.Auto || g.type === W.Spot) &&
                    g.vb() !== this)) &&
                null === this.shadowVisible &&
                El(a);
              null !== this.Zb && (a.Oc(), Fl(this, a, k, e));
              G && G.fm && G.Mz && G.Mz(a, this);
              h &&
              (null !== this.Zb ||
                null !== this.qd ||
                (null !== g && 0 !== (g.A & 512)) ||
                (null !== g &&
                  (g.type === W.Auto || g.type === W.Spot) &&
                  g.vb() !== this))
                ? (Gl(this, !0), null === this.shadowVisible && El(a))
                : Gl(this, !1);
              this.Ni(a, b);
              h && (0 !== (this.A & 512)) === !0 && Dl(a);
              m && h && El(a);
              n && (a.restore(), a.Nc(this instanceof W));
              d.Ps() ||
                ((b = 1 / (d.m11 * d.m22 - d.m12 * d.m21)),
                a.transform(
                  d.m22 * b,
                  -d.m12 * b,
                  -d.m21 * b,
                  d.m11 * b,
                  b * (d.m21 * d.dy - d.m22 * d.dx),
                  b * (d.m12 * d.dx - d.m11 * d.dy)
                ));
            }
          }
          1 !== c && (a.globalAlpha = f);
        }
      }
    }
  };
  function Fl(a, b, c, d) {
    var e = a.naturalBounds,
      f = 0,
      g = 0,
      h = e.width;
    e = e.height;
    var k = a.Ow();
    a instanceof Hf &&
      ((e = a.ta.bounds), (f = e.x), (g = e.y), (h = e.width), (e = e.height));
    pi(a, b, a.Zb, !0, !1, c, d);
    a.Zb instanceof Al && a.Zb.type === Bl
      ? (b.beginPath(), b.rect(f - k / 2, g - k / 2, h + k, e + k), b.Gf(a.Zb))
      : b.fillRect(f - k / 2, g - k / 2, h + k, e + k);
  }
  t.Px = function () {
    return !1;
  };
  t.Ni = function () {};
  function pi(a, b, c, d, e, f, g) {
    if (null !== c) {
      var h = 1,
        k = 1;
      if ("string" === typeof c) d ? (b.fillStyle = c) : (b.strokeStyle = c);
      else if (c.type === Hl)
        d ? (b.fillStyle = c.color) : (b.strokeStyle = c.color);
      else {
        var l = 0;
        a instanceof Hf && (l = a.strokeWidth);
        h = f.width;
        k = f.height;
        e ? ((h = g.width), (k = g.height)) : d || ((h += l), (k += l));
        if (
          (f = b instanceof Il) &&
          c.te &&
          (c.type === Jl || (c.Xk === h && c.zt === k))
        )
          var m = c.te;
        else {
          var n = 0,
            p = 0,
            r = 0,
            q = 0,
            u = 0,
            w = 0;
          w = u = 0;
          e ? ((u = g.x), (w = g.y)) : d || ((u -= l / 2), (w -= l / 2));
          n = c.start.x * h + c.start.offsetX;
          p = c.start.y * k + c.start.offsetY;
          r = c.end.x * h + c.end.offsetX;
          q = c.end.y * k + c.end.offsetY;
          n += u;
          r += u;
          p += w;
          q += w;
          if (c.type === Kl) m = b.createLinearGradient(n, p, r, q);
          else if (c.type === Bl)
            (w = isNaN(c.endRadius) ? Math.max(h, k) / 2 : c.endRadius),
              isNaN(c.startRadius)
                ? ((u = 0), (w = Math.max(h, k) / 2))
                : (u = c.startRadius),
              (m = b.createRadialGradient(n, p, u, r, q, w));
          else if (c.type === Jl)
            try {
              m = b.createPattern(c.pattern, "repeat");
            } catch (z) {
              m = null;
            }
          else za(c.type, "Brush type");
          if (c.type !== Jl && ((e = c.colorStops), null !== e))
            for (e = e.iterator; e.next(); ) m.addColorStop(e.key, e.value);
          if (
            f &&
            ((c.te = m),
            null !== m && ((c.Xk = h), (c.zt = k)),
            null === m && c.type === Jl && -1 !== c.Xk)
          ) {
            c.Xk = -1;
            var y = a.diagram;
            null !== y &&
              -1 === c.Xk &&
              va(function () {
                y.redraw();
              }, 600);
          }
        }
        d ? (b.fillStyle = m) : (b.strokeStyle = m);
      }
    }
  }
  t.xg = function (a) {
    if (a instanceof W)
      a: {
        if (this !== a && null !== a)
          for (var b = this.panel; null !== b; ) {
            if (b === a) {
              a = !0;
              break a;
            }
            b = b.panel;
          }
        a = !1;
      }
    else a = !1;
    return a;
  };
  t.Nf = function () {
    if (!this.visible) return !1;
    var a = this.panel;
    return null !== a ? a.Nf() : !0;
  };
  t.Mf = function () {
    for (
      var a = this instanceof W ? this : this.panel;
      null !== a && a.isEnabled;

    )
      a = a.panel;
    return null === a;
  };
  function Cl(a) {
    if ((0 !== (a.A & 2048)) === !0) {
      var b = a.Bb;
      b.reset();
      if (!a.Db.s() || !a.rc.s()) {
        Ll(a, !1);
        return;
      }
      b.translate(a.Db.x - a.rc.x, a.Db.y - a.rc.y);
      if (1 !== a.scale || 0 !== a.angle) {
        var c = a.naturalBounds;
        a.wp(b, c.x, c.y, c.width, c.height);
      }
      Ll(a, !1);
      Ml(a, !0);
    }
    (0 !== (a.A & 4096)) === !0 &&
      ((b = a.panel),
      null === b
        ? (a.Vh.set(a.Bb), (a.il = a.scale), Ml(a, !1))
        : null !== b.ke &&
          ((c = a.Vh),
          c.reset(),
          b.oe()
            ? c.multiply(b.Vh)
            : null !== b.panel && c.multiply(b.panel.Vh),
          c.multiply(a.Bb),
          (a.il = a.scale * b.il),
          Ml(a, !1)));
  }
  t.wp = function (a, b, c, d, e) {
    1 !== this.Aa && a.scale(this.Aa);
    if (0 !== this.Fb) {
      var f = K.alloc();
      f.dj(b, c, d, e, Kc);
      a.rotate(this.Fb, f.x, f.y);
      K.free(f);
    }
  };
  t.v = function (a) {
    if (!Aj(this)) {
      void 0 === a && (a = !1);
      vj(this, !0);
      wl(this, !0);
      var b = this.panel;
      null === b || a || b.v();
    }
  };
  t.uk = function () {
    Aj(this) || (vj(this, !0), wl(this, !0));
  };
  function Nl(a) {
    if (!Bj(a)) {
      var b = a.panel;
      null !== b
        ? b.v()
        : a.$i() &&
          ((b = a.diagram),
          null !== b && (b.ze.add(a), a instanceof V && a.zd(), b.Ob()));
      wl(a, !0);
    }
  }
  t.tl = function () {
    (0 !== (this.A & 2048)) === !1 && (Ll(this, !0), Ml(this, !0));
  };
  t.Cv = function () {
    Ml(this, !0);
  };
  t.R = function () {
    var a = this.part;
    null !== a && a.R();
  };
  function vl(a, b) {
    var c = a.stretch,
      d = a.panel;
    if (null !== d && d.type === W.Table)
      return Ol(
        a,
        d.getRowDefinition(a.row),
        d.getColumnDefinition(a.column),
        b
      );
    if (null !== d && d.type === W.Auto && d.vb() === a) return Pl(a, Fd, b);
    if (c === hl) {
      if (null !== d) {
        if (d.type === W.Spot && d.vb() === a) return Pl(a, Fd, b);
        c = d.defaultStretch;
        return c === hl ? Pl(a, tg, b) : Pl(a, c, b);
      }
      return Pl(a, tg, b);
    }
    return Pl(a, c, b);
  }
  function Ol(a, b, c, d) {
    var e = a.stretch;
    if (e !== hl) return Pl(a, e, d);
    var f = (e = null);
    switch (b.stretch) {
      case jl:
        f = !0;
        break;
      case Fd:
        f = !0;
    }
    switch (c.stretch) {
      case il:
        e = !0;
        break;
      case Fd:
        e = !0;
    }
    b = a.panel.defaultStretch;
    null === e && (e = b === il || b === Fd);
    null === f && (f = b === jl || b === Fd);
    return !0 === e && !0 === f
      ? Pl(a, Fd, d)
      : !0 === e
      ? Pl(a, il, d)
      : !0 === f
      ? Pl(a, jl, d)
      : Pl(a, tg, d);
  }
  function Pl(a, b, c) {
    if (c) return b;
    if (b === tg) return tg;
    c = a.desiredSize;
    if (c.s()) return tg;
    a = a.angle;
    if (!isNaN(c.width))
      if (90 !== a && 270 !== a) {
        if (b === il) return tg;
        if (b === Fd) return jl;
      } else {
        if (b === jl) return tg;
        if (b === Fd) return il;
      }
    if (!isNaN(c.height))
      if (90 !== a && 270 !== a) {
        if (b === jl) return tg;
        if (b === Fd) return il;
      } else {
        if (b === il) return tg;
        if (b === Fd) return jl;
      }
    return b;
  }
  function Gl(a, b) {
    a.A = b ? a.A | 512 : a.A & -513;
  }
  function rl(a) {
    return 0 !== (a.A & 1024);
  }
  function Ql(a, b) {
    a.A = b ? a.A | 1024 : a.A & -1025;
  }
  function Ll(a, b) {
    a.A = b ? a.A | 2048 : a.A & -2049;
  }
  function Ml(a, b) {
    a.A = b ? a.A | 4096 : a.A & -4097;
  }
  function Aj(a) {
    return 0 !== (a.A & 8192);
  }
  function vj(a, b) {
    a.A = b ? a.A | 8192 : a.A & -8193;
  }
  function Bj(a) {
    return 0 !== (a.A & 16384);
  }
  function wl(a, b) {
    a.A = b ? a.A | 16384 : a.A & -16385;
  }
  t.bj = function (a) {
    this.ig = a;
  };
  t.ft = function () {};
  t.Zv = function (a) {
    this.ra = a;
    Nl(this);
    return !0;
  };
  t.Jm = function (a, b) {
    if (this.ra.x !== a || this.ra.y !== b) this.ra.h(a, b), this.tl();
  };
  t.Ow = function () {
    return 0;
  };
  function Rl(a) {
    var b = a.part;
    if (b instanceof V && (null !== a.portId || a === b.port)) {
      var c = b.diagram;
      null === c || c.undoManager.isUndoingRedoing || zl(b, a);
    }
  }
  function Sl(a) {
    var b = a.diagram;
    null === b ||
      b.undoManager.isUndoingRedoing ||
      (a instanceof W
        ? a instanceof V
          ? a.zd()
          : a.Jk(a, function (a) {
              Rl(a);
            })
        : Rl(a));
  }
  t.bind = function (a, b, c, d) {
    var e = null;
    "string" === typeof a ? (e = new Fi(a, b, c, d)) : (e = a);
    e.wd = this;
    a = this.Hh();
    null !== a &&
      Tl(a) &&
      v(
        "Cannot add a Binding to a template that has already been copied: " + e
      );
    null === this.ob && (this.ob = new H());
    this.ob.add(e);
    return this;
  };
  t.set = function (a) {
    if (G)
      for (var b in a)
        (b.startsWith("_") || -1 !== b.indexOf(".")) &&
          v(
            "Property with underscore or period passed to GraphObject.set. Did you mean to use GraphObject.assign?"
          );
    Object.assign(this, a);
    return this;
  };
  t.cv = function (a) {
    Ul(this, a);
    return this;
  };
  t.apply = function (a) {
    a(this);
    return this;
  };
  t.Km = function (a) {
    Hj(this, a);
    return this;
  };
  t.$z = function () {
    return this.Hh();
  };
  t.Hh = function () {
    for (var a = this instanceof W ? this : this.panel; null !== a; ) {
      if (null !== a.Yh) return a;
      a = a.panel;
    }
    return null;
  };
  t.fw = function (a) {
    a.wd = this;
    null === this.Cg && (this.Cg = new xb());
    this.Cg.add(a.propertyName, a);
    return this;
  };
  function Vl(a, b) {
    for (var c = 1; c < arguments.length; ++c);
    c = arguments;
    var d = null,
      e = null;
    if ("function" === typeof a) e = a;
    else if ("string" === typeof a) {
      var f = Wl.K(a);
      "function" === typeof f
        ? ((c = Ja(arguments)),
          (d = f(c)),
          Ga(d) ||
            v(
              'GraphObject.make invoked object builder "' +
                a +
                '", but it did not return an Object'
            ))
        : (e = sa.go[a]);
    }
    null === d &&
      ((void 0 !== e && null !== e && e.constructor) ||
        v(
          "GraphObject.make requires a class function or GoJS class name or name of an object builder, not: " +
            a
        ),
      (d = new e()));
    e = 1;
    if (d instanceof Q && 1 < c.length) {
      f = d;
      var g = c[1];
      if ("string" === typeof g || g instanceof HTMLDivElement) Bi(f, g), e++;
    }
    for (; e < c.length; e++)
      (f = c[e]),
        void 0 === f
          ? v(
              "Undefined value at argument " +
                e +
                " for object being constructed by GraphObject.make: " +
                d
            )
          : Ul(d, f);
    return d;
  }
  function Ul(a, b) {
    if ("string" === typeof b)
      if (a instanceof Yg) a.text = b;
      else if (a instanceof Hf) a.figure = b;
      else if (a instanceof jk) a.source = b;
      else if (a instanceof W) {
        var c = Xl.K(b);
        null !== c
          ? (a.type = c)
          : G &&
            v(
              "Unknown Panel type as an argument to GraphObject.make: " +
                b +
                ". If building from source, you may need to call Panel.definePanelLayout."
            );
      } else
        a instanceof Al
          ? ((c = bb(Al, b)),
            null !== c
              ? (a.type = c)
              : v(
                  "Unknown Brush type as an argument to GraphObject.make: " + b
                ))
          : a instanceof N
          ? ((c = bb(N, b)),
            null !== c
              ? (a.type = c)
              : G &&
                v(
                  "Unknown Geometry type as an argument to GraphObject.make: " +
                    b
                ))
          : a instanceof je
          ? ((c = bb(je, b)),
            null !== c
              ? (a.type = c)
              : G &&
                v(
                  "Unknown PathSegment type as an argument to GraphObject.make: " +
                    b
                ))
          : G &&
            v(
              "Unable to use a string as an argument to GraphObject.make: " + b
            );
    else if (b instanceof O)
      a instanceof W ||
        v("A GraphObject can only be added to a Panel, not to: " + a),
        a.add(b);
    else if (b instanceof bk) {
      var d;
      b.isRow && "function" === typeof a.getRowDefinition
        ? (d = a.getRowDefinition(b.index))
        : b.isRow ||
          "function" !== typeof a.getColumnDefinition ||
          (d = a.getColumnDefinition(b.index));
      d instanceof bk
        ? ((a = d),
          x(b, bk, bk, "copyFrom:pd"),
          b.isRow ? (a.height = b.height) : (a.width = b.width),
          (a.minimum = b.minimum),
          (a.maximum = b.maximum),
          (a.alignment = b.alignment),
          (a.stretch = b.stretch),
          (a.sizing = b.sizing),
          (a.kg = null === b.separatorPadding ? null : b.separatorPadding.L()),
          (a.separatorStroke = b.separatorStroke),
          (a.separatorStrokeWidth = b.separatorStrokeWidth),
          (a.$j = null),
          b.separatorDashArray && (a.$j = Ja(b.separatorDashArray)),
          (a.background = b.background),
          (a.coversSeparators = b.coversSeparators),
          (a.ob = b.ob))
        : v(
            "A RowColumnDefinition can only be added to an object that implements getRowDefinition/getColumnDefinition, not to: " +
              a
          );
    } else if (b instanceof F) "function" === typeof a.pb ? a.pb(b) : Ea(a, b);
    else if (b instanceof Yl) a.type = b;
    else if (b instanceof Fi)
      a instanceof O
        ? a.bind(b)
        : a instanceof bk
        ? a.bind(b)
        : v(
            "A Binding can only be applied to a GraphObject or RowColumnDefinition, not to: " +
              a
          );
    else if (b instanceof hi)
      a instanceof O
        ? a.fw(b)
        : v(
            "An AnimationTrigger can only be applied to a GraphObject, not to: " +
              a
          );
    else if (b instanceof ie)
      a instanceof N
        ? a.figures.add(b)
        : v("A PathFigure can only be added to a Geometry, not to: " + a);
    else if (b instanceof je)
      a instanceof ie
        ? a.segments.add(b)
        : v("A PathSegment can only be added to a PathFigure, not to: " + a);
    else if (b instanceof zi)
      a instanceof Q
        ? (a.layout = b)
        : a instanceof vf
        ? (a.layout = b)
        : v(
            "A Layout can only be assigned to a Diagram or a Group, not to: " +
              a
          );
    else if (Array.isArray(b)) for (c = 0; c < b.length; c++) Ul(a, b[c]);
    else if ("object" === typeof b && null !== b)
      if (a instanceof Al) {
        c = new eb();
        for (var e in b)
          (d = parseFloat(e)),
            isNaN(d) ? (c[e] = b[e]) : a.addColorStop(d, b[e]);
        Hj(a, c);
      } else if (a instanceof bk) {
        void 0 !== b.row
          ? ((e = b.row),
            (void 0 === e ||
              null === e ||
              Infinity === e ||
              isNaN(e) ||
              0 > e) &&
              v(
                "Must specify non-negative integer row for RowColumnDefinition " +
                  b +
                  ", not: " +
                  e
              ),
            (a.isRow = !0),
            (a.index = e))
          : void 0 !== b.column &&
            ((e = b.column),
            (void 0 === e ||
              null === e ||
              Infinity === e ||
              isNaN(e) ||
              0 > e) &&
              v(
                "Must specify non-negative integer column for RowColumnDefinition " +
                  b +
                  ", not: " +
                  e
              ),
            (a.isRow = !1),
            (a.index = e));
        e = new eb();
        for (c in b) "row" !== c && "column" !== c && (e[c] = b[c]);
        Hj(a, e);
      } else Hj(a, b);
    else
      v(
        'Unknown initializer "' +
          b +
          '" for object being constructed by GraphObject.make: ' +
          a
      );
  }
  function Zl(a, b) {
    A(a, "string", O, "defineBuilder:name");
    A(b, "function", O, "defineBuilder:func");
    var c = a.toLowerCase();
    G &&
      ("" === a || "none" === c || a === c) &&
      v(
        "Shape.defineFigureGenerator name must not be empty or None or all-lower-case: " +
          a
      );
    Wl.add(a, b);
  }
  function $l(a, b, c) {
    void 0 === c && (c = null);
    var d = a[1];
    if ("function" === typeof c ? c(d) : "string" === typeof d)
      return a.splice(1, 1), d;
    if (void 0 === b)
      throw Error(
        "no " +
          ("function" === typeof c ? "satisfactory" : "string") +
          " argument for GraphObject builder " +
          a[0]
      );
    return b;
  }
  oa.Object.defineProperties(O.prototype, {
    shadowVisible: {
      configurable: !0,
      get: function () {
        return this.Sl;
      },
      set: function (a) {
        var b = this.Sl;
        b !== a &&
          (G && null !== a && A(a, "boolean", O, "shadowVisible"),
          (this.Sl = a),
          this.R(),
          this.g("shadowVisible", b, a));
      },
    },
    enabledChanged: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.Gn : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Gn;
        b !== a &&
          (null !== a && A(a, "function", O, "enabledChanged"),
          (this.S.Gn = a),
          this.g("enabledChanged", b, a));
      },
    },
    segmentOrientation: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return null !== this.Ra ? this.Ra.Zr : hg;
      },
      set: function (a) {
        var b = this.segmentOrientation;
        b !== a &&
          (G && cb(a, R, O, "segmentOrientation"),
          null === this.Ra && (this.Ra = new am()),
          (this.Ra.Zr = a),
          this.v(),
          this.g("segmentOrientation", b, a),
          a === hg && (this.angle = 0));
      },
    },
    segmentIndex: {
      configurable: !0,
      get: function () {
        return null !== this.Ra ? this.Ra.B : -Infinity;
      },
      set: function (a) {
        G && A(a, "number", O, "segmentIndex");
        a = Math.round(a);
        var b = this.segmentIndex;
        b !== a &&
          (null === this.Ra && (this.Ra = new am()),
          (this.Ra.B = a),
          this.v(),
          this.g("segmentIndex", b, a));
      },
    },
    segmentFraction: {
      configurable: !0,
      get: function () {
        return null !== this.Ra ? this.Ra.o : 0;
      },
      set: function (a) {
        G && A(a, "number", O, "segmentFraction");
        isNaN(a) ? (a = 0) : 0 > a ? (a = 0) : 1 < a && (a = 1);
        var b = this.segmentFraction;
        b !== a &&
          (null === this.Ra && (this.Ra = new am()),
          (this.Ra.o = a),
          this.v(),
          this.g("segmentFraction", b, a));
      },
    },
    segmentOffset: {
      configurable: !0,
      get: function () {
        return null !== this.Ra ? this.Ra.M : yb;
      },
      set: function (a) {
        var b = this.segmentOffset;
        b.D(a) ||
          (G && x(a, K, O, "segmentOffset"),
          (a = a.L()),
          null === this.Ra && (this.Ra = new am()),
          (this.Ra.M = a),
          this.v(),
          this.g("segmentOffset", b, a));
      },
    },
    stretch: {
      configurable: !0,
      get: function () {
        return this.Ne;
      },
      set: function (a) {
        var b = this.Ne;
        b !== a &&
          (G && cb(a, O, O, "stretch"),
          (this.Ne = a),
          this.v(),
          this.g("stretch", b, a));
      },
    },
    name: {
      configurable: !0,
      get: function () {
        return this.ua;
      },
      set: function (a) {
        var b = this.ua;
        b !== a &&
          (G && A(a, "string", O, "name"),
          (this.ua = a),
          null !== this.part && (this.part.ui = null),
          this.g("name", b, a));
      },
    },
    opacity: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.tb;
      },
      set: function (a) {
        var b = this.tb;
        b !== a &&
          (A(a, "number", O, "opacity"),
          (0 > a || 1 < a) && Aa(a, "0 <= value <= 1", O, "opacity"),
          (this.tb = a),
          this.g("opacity", b, a),
          (a = this.diagram),
          (b = this.part),
          null !== a && null !== b && a.R(Lj(b, b.actualBounds)));
      },
    },
    visible: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 1);
      },
      set: function (a) {
        var b = 0 !== (this.A & 1);
        b !== a &&
          (G && A(a, "boolean", O, "visible"),
          (this.A ^= 1),
          this.g("visible", b, a),
          (b = this.panel),
          null !== b ? b.v() : this.$i() && this.Vb(a),
          this.R(),
          Sl(this));
      },
    },
    pickable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 2);
      },
      set: function (a) {
        var b = 0 !== (this.A & 2);
        b !== a &&
          (G && A(a, "boolean", O, "pickable"),
          (this.A ^= 2),
          this.g("pickable", b, a));
      },
    },
    fromLinkableDuplicates: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 4);
      },
      set: function (a) {
        var b = 0 !== (this.A & 4);
        b !== a &&
          (G && A(a, "boolean", O, "fromLinkableDuplicates"),
          (this.A ^= 4),
          this.g("fromLinkableDuplicates", b, a));
      },
    },
    fromLinkableSelfNode: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 8);
      },
      set: function (a) {
        var b = 0 !== (this.A & 8);
        b !== a &&
          (G && A(a, "boolean", O, "fromLinkableSelfNode"),
          (this.A ^= 8),
          this.g("fromLinkableSelfNode", b, a));
      },
    },
    toLinkableDuplicates: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 16);
      },
      set: function (a) {
        var b = 0 !== (this.A & 16);
        b !== a &&
          (G && A(a, "boolean", O, "toLinkableDuplicates"),
          (this.A ^= 16),
          this.g("toLinkableDuplicates", b, a));
      },
    },
    toLinkableSelfNode: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 32);
      },
      set: function (a) {
        var b = 0 !== (this.A & 32);
        b !== a &&
          (G && A(a, "boolean", O, "toLinkableSelfNode"),
          (this.A ^= 32),
          this.g("toLinkableSelfNode", b, a));
      },
    },
    isPanelMain: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 64);
      },
      set: function (a) {
        var b = 0 !== (this.A & 64);
        b !== a &&
          (G && A(a, "boolean", O, "isPanelMain"),
          (this.A ^= 64),
          this.v(),
          this.g("isPanelMain", b, a));
      },
    },
    isActionable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 128);
      },
      set: function (a) {
        var b = 0 !== (this.A & 128);
        b !== a &&
          (G && A(a, "boolean", O, "isActionable"),
          (this.A ^= 128),
          this.g("isActionable", b, a));
      },
    },
    areaBackground: {
      configurable: !0,
      get: function () {
        return this.qd;
      },
      set: function (a) {
        var b = this.qd;
        b !== a &&
          (null !== a && bm(a, "GraphObject.areaBackground"),
          a instanceof Al && a.freeze(),
          (this.qd = a),
          this.R(),
          this.g("areaBackground", b, a));
      },
    },
    background: {
      configurable: !0,
      get: function () {
        return this.Zb;
      },
      set: function (a) {
        var b = this.Zb;
        b !== a &&
          (null !== a && bm(a, "GraphObject.background"),
          a instanceof Al && a.freeze(),
          (this.Zb = a),
          this.R(),
          this.g("background", b, a));
      },
    },
    part: {
      configurable: !0,
      get: function () {
        if (this.$i()) return this;
        if (null !== this.Uj) return this.Uj;
        var a;
        for (a = this.panel; a; ) {
          if (a instanceof U) return (this.Uj = a);
          a = a.panel;
        }
        return null;
      },
    },
    svg: {
      configurable: !0,
      get: function () {
        return this.ns;
      },
      set: function (a) {
        this.ns = a;
      },
    },
    panel: {
      configurable: !0,
      get: function () {
        return this.ig;
      },
    },
    layer: {
      configurable: !0,
      get: function () {
        var a = this.part;
        return null !== a ? a.layer : null;
      },
    },
    diagram: {
      configurable: !0,
      get: function () {
        var a = this.part;
        return null !== a ? a.diagram : null;
      },
    },
    position: {
      configurable: !0,
      get: function () {
        return this.ra;
      },
      set: function (a) {
        G && x(a, K, O, "position");
        var b = a.x,
          c = a.y,
          d = this.ra,
          e = d.x;
        d = d.y;
        (e === b || (isNaN(e) && isNaN(b))) &&
        (d === c || (isNaN(d) && isNaN(c)))
          ? this.ft()
          : ((a = a.copy()),
            this.Zv(a, e, d) && this.g("position", new K(e, d), a));
      },
    },
    actualBounds: {
      configurable: !0,
      get: function () {
        return this.Db;
      },
    },
    scale: {
      configurable: !0,
      get: function () {
        return this.Aa;
      },
      set: function (a) {
        var b = this.Aa;
        b !== a &&
          (G && D(a, O, "scale"),
          0 >= a &&
            v(
              "GraphObject.scale for " +
                this +
                " must be greater than zero, not: " +
                a
            ),
          (this.Aa = a),
          this.v(),
          this.g("scale", b, a));
      },
    },
    angle: {
      configurable: !0,
      get: function () {
        return this.Fb;
      },
      set: function (a) {
        var b = this.Fb;
        b !== a &&
          (G && D(a, O, "angle"),
          (a %= 360),
          0 > a && (a += 360),
          b !== a &&
            ((this.Fb = a), Sl(this), this.v(), this.g("angle", b, a)));
      },
    },
    desiredSize: {
      configurable: !0,
      get: function () {
        return this.bd;
      },
      set: function (a) {
        G && x(a, Gb, O, "desiredSize");
        var b = a.width,
          c = a.height,
          d = this.bd,
          e = d.width,
          f = d.height;
        ((e === b || (isNaN(e) && isNaN(b))) &&
          (f === c || (isNaN(f) && isNaN(c)))) ||
          ((this.bd = a = a.L()),
          this.v(),
          this instanceof Hf && this.lc(),
          this.g("desiredSize", d, a),
          rl(this) &&
            ((a = this.part),
            null !== a && (sl(this, a, "width"), sl(this, a, "height"))));
      },
    },
    width: {
      configurable: !0,
      get: function () {
        return this.bd.width;
      },
      set: function (a) {
        var b = this.bd.width;
        b === a ||
          (isNaN(b) && isNaN(a)) ||
          (G && A(a, "number", O, "width"),
          (b = this.bd),
          (this.bd = a = new Gb(a, this.bd.height).freeze()),
          this.v(),
          this instanceof Hf && this.lc(),
          this.g("desiredSize", b, a),
          rl(this) && ((a = this.part), null !== a && sl(this, a, "width")));
      },
    },
    height: {
      configurable: !0,
      get: function () {
        return this.bd.height;
      },
      set: function (a) {
        var b = this.bd.height;
        b === a ||
          (isNaN(b) && isNaN(a)) ||
          (G && A(a, "number", O, "height"),
          (b = this.bd),
          (this.bd = a = new Gb(this.bd.width, a).freeze()),
          this.v(),
          this instanceof Hf && this.lc(),
          this.g("desiredSize", b, a),
          rl(this) && ((a = this.part), null !== a && sl(this, a, "height")));
      },
    },
    minSize: {
      configurable: !0,
      get: function () {
        return this.fg;
      },
      set: function (a) {
        var b = this.fg;
        b.D(a) ||
          (G && x(a, Gb, O, "minSize"),
          (a = a.copy()),
          isNaN(a.width) && (a.width = 0),
          isNaN(a.height) && (a.height = 0),
          a.freeze(),
          (this.fg = a),
          this.v(),
          this.g("minSize", b, a));
      },
    },
    maxSize: {
      configurable: !0,
      get: function () {
        return this.eg;
      },
      set: function (a) {
        var b = this.eg;
        b.D(a) ||
          (G && x(a, Gb, O, "maxSize"),
          (a = a.copy()),
          isNaN(a.width) && (a.width = Infinity),
          isNaN(a.height) && (a.height = Infinity),
          a.freeze(),
          (this.eg = a),
          this.v(),
          this.g("maxSize", b, a));
      },
    },
    measuredBounds: {
      configurable: !0,
      get: function () {
        return this.rc;
      },
    },
    naturalBounds: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.zc;
      },
    },
    margin: {
      configurable: !0,
      get: function () {
        return this.$g;
      },
      set: function (a) {
        "number" === typeof a ? (a = new ic(a)) : G && x(a, ic, O, "margin");
        var b = this.$g;
        b.D(a) || ((this.$g = a = a.L()), this.v(), this.g("margin", b, a));
      },
    },
    transform: {
      configurable: !0,
      get: function () {
        (0 !== (this.A & 2048)) === !0 && Cl(this);
        return this.Bb;
      },
    },
    ke: {
      configurable: !0,
      get: function () {
        (0 !== (this.A & 4096)) === !0 && Cl(this);
        return this.Vh;
      },
    },
    alignment: {
      configurable: !0,
      get: function () {
        return this.Eb;
      },
      set: function (a) {
        var b = this.Eb;
        b.D(a) ||
          (G && x(a, Ib, O, "alignment"),
          a.ec() &&
            !a.Nb() &&
            v(
              "GraphObject.alignment for " +
                this +
                " must be a real Spot or Spot.Default, not: " +
                a
            ),
          (this.Eb = a = a.L()),
          Nl(this),
          this.g("alignment", b, a));
      },
    },
    column: {
      configurable: !0,
      get: function () {
        return this.Hg;
      },
      set: function (a) {
        G && D(a, O, "column");
        a = Math.round(a);
        var b = this.Hg;
        b !== a &&
          (0 > a && Aa(a, ">= 0", O, "column"),
          (this.Hg = a),
          this.v(),
          this.g("column", b, a));
      },
    },
    columnSpan: {
      configurable: !0,
      get: function () {
        return this.ln;
      },
      set: function (a) {
        G && A(a, "number", O, "columnSpan");
        a = Math.round(a);
        var b = this.ln;
        b !== a &&
          (1 > a && Aa(a, ">= 1", O, "columnSpan"),
          (this.ln = a),
          this.v(),
          this.g("columnSpan", b, a));
      },
    },
    row: {
      configurable: !0,
      get: function () {
        return this.lp;
      },
      set: function (a) {
        G && D(a, O, "row");
        a = Math.round(a);
        var b = this.lp;
        b !== a &&
          (0 > a && Aa(a, ">= 0", O, "row"),
          (this.lp = a),
          this.v(),
          this.g("row", b, a));
      },
    },
    rowSpan: {
      configurable: !0,
      get: function () {
        return this.mp;
      },
      set: function (a) {
        G && A(a, "number", O, "rowSpan");
        a = Math.round(a);
        var b = this.mp;
        b !== a &&
          (1 > a && Aa(a, ">= 1", O, "rowSpan"),
          (this.mp = a),
          this.v(),
          this.g("rowSpan", b, a));
      },
    },
    spanAllocation: {
      configurable: !0,
      get: function () {
        return this.Cp;
      },
      set: function (a) {
        var b = this.Cp;
        b !== a &&
          (null !== a && A(a, "function", O, "spanAllocation"),
          (this.Cp = a),
          this.v(),
          this.g("spanAllocation", b, a));
      },
    },
    alignmentFocus: {
      configurable: !0,
      get: function () {
        return this.Ok;
      },
      set: function (a) {
        var b = this.Ok;
        b.D(a) ||
          (G && x(a, Ib, O, "alignmentFocus"),
          !G ||
            !a.ec() ||
            a.Nb() ||
            (a.pq() && this instanceof V) ||
            v(
              "GraphObject.alignmentFocus must be a real Spot or Spot.Default, not: " +
                a
            ),
          (this.Ok = a = a.L()),
          this.v(),
          this.g("alignmentFocus", b, a));
      },
    },
    portId: {
      configurable: !0,
      get: function () {
        return this.Zo;
      },
      set: function (a) {
        var b = this.Zo;
        if (b !== a) {
          G && null !== a && A(a, "string", O, "portId");
          var c = this.part;
          null === c ||
            c instanceof V ||
            v("Cannot set portID on a Link: " + a);
          null !== b && null !== c && cm(c, this);
          this.Zo = a;
          null !== a && null !== c && ((c.Te = !0), dm(c, this));
          this.g("portId", b, a);
        }
      },
    },
    toSpot: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return null !== this.T ? this.T.yh : Ec;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.yh;
        b.D(a) ||
          (G && x(a, Ib, O, "toSpot"),
          (a = a.L()),
          (this.T.yh = a),
          this.g("toSpot", b, a),
          Rl(this));
      },
    },
    toEndSegmentLength: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.wh : 10;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.wh;
        b !== a &&
          (G && A(a, "number", O, "toEndSegmentLength"),
          0 > a && Aa(a, ">= 0", O, "toEndSegmentLength"),
          (this.T.wh = a),
          this.g("toEndSegmentLength", b, a),
          Rl(this));
      },
    },
    toShortLength: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return null !== this.T ? this.T.xh : 0;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.xh;
        b !== a &&
          (G && A(a, "number", O, "toShortLength"),
          (this.T.xh = a),
          this.g("toShortLength", b, a),
          Rl(this));
      },
    },
    toLinkable: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.Jp : null;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.Jp;
        b !== a &&
          (G && null !== a && A(a, "boolean", O, "toLinkable"),
          (this.T.Jp = a),
          this.g("toLinkable", b, a));
      },
    },
    toMaxLinks: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.Kp : Infinity;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.Kp;
        b !== a &&
          (G && A(a, "number", O, "toMaxLinks"),
          0 > a && Aa(a, ">= 0", O, "toMaxLinks"),
          (this.T.Kp = a),
          this.g("toMaxLinks", b, a));
      },
    },
    fromSpot: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.Ug : Ec;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.Ug;
        b.D(a) ||
          (G && x(a, Ib, O, "fromSpot"),
          (a = a.L()),
          (this.T.Ug = a),
          this.g("fromSpot", b, a),
          Rl(this));
      },
    },
    fromEndSegmentLength: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.Sg : 10;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.Sg;
        b !== a &&
          (G && A(a, "number", O, "fromEndSegmentLength"),
          0 > a && Aa(a, ">= 0", O, "fromEndSegmentLength"),
          (this.T.Sg = a),
          this.g("fromEndSegmentLength", b, a),
          Rl(this));
      },
    },
    fromShortLength: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.Tg : 0;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.Tg;
        b !== a &&
          (G && A(a, "number", O, "fromShortLength"),
          (this.T.Tg = a),
          this.g("fromShortLength", b, a),
          Rl(this));
      },
    },
    fromLinkable: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.Mn : null;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.Mn;
        b !== a &&
          (G && null !== a && A(a, "boolean", O, "fromLinkable"),
          (this.T.Mn = a),
          this.g("fromLinkable", b, a));
      },
    },
    fromMaxLinks: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.Nn : Infinity;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.Nn;
        b !== a &&
          (G && A(a, "number", O, "fromMaxLinks"),
          0 > a && Aa(a, ">= 0", O, "fromMaxLinks"),
          (this.T.Nn = a),
          this.g("fromMaxLinks", b, a));
      },
    },
    cursor: {
      configurable: !0,
      get: function () {
        return this.ai;
      },
      set: function (a) {
        var b = this.ai;
        b !== a &&
          (A(a, "string", O, "cursor"), (this.ai = a), this.g("cursor", b, a));
      },
    },
    click: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.Gg : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Gg;
        b !== a &&
          (null !== a && A(a, "function", O, "click"),
          (this.S.Gg = a),
          this.g("click", b, a));
      },
    },
    doubleClick: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.Og : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Og;
        b !== a &&
          (null !== a && A(a, "function", O, "doubleClick"),
          (this.S.Og = a),
          this.g("doubleClick", b, a));
      },
    },
    contextClick: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return null !== this.S ? this.S.Ig : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Ig;
        b !== a &&
          (null !== a && A(a, "function", O, "contextClick"),
          (this.S.Ig = a),
          this.g("contextClick", b, a));
      },
    },
    mouseEnter: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.dh : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.dh;
        b !== a &&
          (null !== a && A(a, "function", O, "mouseEnter"),
          (this.S.dh = a),
          this.g("mouseEnter", b, a));
      },
    },
    mouseLeave: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.gh : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.gh;
        b !== a &&
          (null !== a && A(a, "function", O, "mouseLeave"),
          (this.S.gh = a),
          this.g("mouseLeave", b, a));
      },
    },
    mouseOver: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.hh : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.hh;
        b !== a &&
          (null !== a && A(a, "function", O, "mouseOver"),
          (this.S.hh = a),
          this.g("mouseOver", b, a));
      },
    },
    mouseHover: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.fh : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.fh;
        b !== a &&
          (null !== a && A(a, "function", O, "mouseHover"),
          (this.S.fh = a),
          this.g("mouseHover", b, a));
      },
    },
    mouseHold: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.eh : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.eh;
        b !== a &&
          (null !== a && A(a, "function", O, "mouseHold"),
          (this.S.eh = a),
          this.g("mouseHold", b, a));
      },
    },
    mouseDragEnter: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.Go : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Go;
        b !== a &&
          (null !== a && A(a, "function", O, "mouseDragEnter"),
          (this.S.Go = a),
          this.g("mouseDragEnter", b, a));
      },
    },
    mouseDragLeave: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.Ho : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Ho;
        b !== a &&
          (null !== a && A(a, "function", O, "mouseDragLeave"),
          (this.S.Ho = a),
          this.g("mouseDragLeave", b, a));
      },
    },
    mouseDrop: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.bh : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.bh;
        b !== a &&
          (null !== a && A(a, "function", O, "mouseDrop"),
          (this.S.bh = a),
          this.g("mouseDrop", b, a));
      },
    },
    actionDown: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.Xm : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Xm;
        b !== a &&
          (null !== a && A(a, "function", O, "actionDown"),
          (this.S.Xm = a),
          this.g("actionDown", b, a));
      },
    },
    actionMove: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.Ym : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Ym;
        b !== a &&
          (null !== a && A(a, "function", O, "actionMove"),
          (this.S.Ym = a),
          this.g("actionMove", b, a));
      },
    },
    actionUp: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.Zm : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Zm;
        b !== a &&
          (null !== a && A(a, "function", O, "actionUp"),
          (this.S.Zm = a),
          this.g("actionUp", b, a));
      },
    },
    actionCancel: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.Wm : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Wm;
        b !== a &&
          (null !== a && A(a, "function", O, "actionCancel"),
          (this.S.Wm = a),
          this.g("actionCancel", b, a));
      },
    },
    toolTip: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.zh : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.zh;
        b !== a &&
          (!G ||
            null === a ||
            a instanceof Je ||
            a instanceof Oe ||
            v("GraphObject.toolTip must be an Adornment or HTMLInfo."),
          (this.S.zh = a),
          this.g("toolTip", b, a));
      },
    },
    contextMenu: {
      configurable: !0,
      get: function () {
        return null !== this.S ? this.S.Jg : null;
      },
      set: function (a) {
        ol(this);
        var b = this.S.Jg;
        b !== a &&
          (!G ||
            a instanceof Je ||
            a instanceof Oe ||
            v("GraphObject.contextMenu must be an Adornment or HTMLInfo."),
          (this.S.Jg = a),
          this.g("contextMenu", b, a));
      },
    },
  });
  O.prototype.trigger = O.prototype.fw;
  O.prototype.findBindingPanel = O.prototype.Hh;
  O.prototype.findTemplateBinder = O.prototype.$z;
  O.prototype.setProperties = O.prototype.Km;
  O.prototype.apply = O.prototype.apply;
  O.prototype.attach = O.prototype.cv;
  O.prototype.set = O.prototype.set;
  O.prototype.isEnabledObject = O.prototype.Mf;
  O.prototype.isVisibleObject = O.prototype.Nf;
  O.prototype.isContainedBy = O.prototype.xg;
  O.prototype.getNearestIntersectionPoint = O.prototype.Is;
  O.prototype.getLocalPoint = O.prototype.Hs;
  O.prototype.getDocumentScale = O.prototype.If;
  O.prototype.getDocumentAngle = O.prototype.Ti;
  O.prototype.getDocumentBounds = O.prototype.Ui;
  O.prototype.getDocumentPoint = O.prototype.ka;
  O.prototype.intersectsRect = O.prototype.Sc;
  O.prototype.containedInRect = O.prototype.Fh;
  O.prototype.containsRect = O.prototype.Qe;
  O.prototype.containsPoint = O.prototype.ca;
  O.prototype.raiseChanged = O.prototype.g;
  O.prototype.raiseChangedEvent = O.prototype.cb;
  O.prototype.addCopyProperty = O.prototype.yx;
  var Wl = null;
  O.className = "GraphObject";
  Wl = new xb();
  Zl("Button", function () {
    function a(a, b) {
      return (
        null !==
        a.diagram.dc(
          a.documentPoint,
          function (a) {
            for (; null !== a.panel && !a.isActionable; ) a = a.panel;
            return a;
          },
          function (a) {
            return a === b;
          }
        )
      );
    }
    var b = Vl(
      W,
      W.Auto,
      {
        isActionable: !0,
        enabledChanged: function (a, b) {
          if (a instanceof W) {
            var c = a.hb("ButtonBorder");
            null !== c &&
              (c.fill = b ? a._buttonFillNormal : a._buttonFillDisabled);
          }
        },
        cursor: "pointer",
        _buttonFillNormal: "#F5F5F5",
        _buttonStrokeNormal: "#BDBDBD",
        _buttonFillOver: "#E0E0E0",
        _buttonStrokeOver: "#9E9E9E",
        _buttonFillPressed: "#BDBDBD",
        _buttonStrokePressed: "#9E9E9E",
        _buttonFillDisabled: "#E5E5E5",
      },
      Vl(Hf, {
        name: "ButtonBorder",
        figure: "RoundedRectangle",
        spot1: new Ib(0, 0, 2.76142374915397, 2.761423749153969),
        spot2: new Ib(1, 1, -2.76142374915397, -2.761423749153969),
        parameter1: 2,
        parameter2: 2,
        fill: "#F5F5F5",
        stroke: "#BDBDBD",
      })
    );
    b.mouseEnter = function (a, b) {
      if (
        b.Mf() &&
        b instanceof W &&
        ((a = b.hb("ButtonBorder")), a instanceof Hf)
      ) {
        var c = b._buttonFillOver;
        b._buttonFillNormal = a.fill;
        a.fill = c;
        c = b._buttonStrokeOver;
        b._buttonStrokeNormal = a.stroke;
        a.stroke = c;
      }
    };
    b.mouseLeave = function (a, b) {
      b.Mf() &&
        b instanceof W &&
        ((a = b.hb("ButtonBorder")),
        a instanceof Hf &&
          ((a.fill = b._buttonFillNormal), (a.stroke = b._buttonStrokeNormal)));
    };
    b.actionDown = function (a, b) {
      if (
        b.Mf() &&
        b instanceof W &&
        null !== b._buttonFillPressed &&
        0 === a.button
      ) {
        var c = b.hb("ButtonBorder");
        if (c instanceof Hf) {
          a = a.diagram;
          var d = a.skipsUndoManager;
          a.skipsUndoManager = !0;
          var g = b._buttonFillPressed;
          b._buttonFillOver = c.fill;
          c.fill = g;
          g = b._buttonStrokePressed;
          b._buttonStrokeOver = c.stroke;
          c.stroke = g;
          a.skipsUndoManager = d;
        }
      }
    };
    b.actionUp = function (b, d) {
      if (
        d.Mf() &&
        d instanceof W &&
        null !== d._buttonFillPressed &&
        0 === b.button
      ) {
        var c = d.hb("ButtonBorder");
        if (c instanceof Hf) {
          var f = b.diagram,
            g = f.skipsUndoManager;
          f.skipsUndoManager = !0;
          a(b, d)
            ? ((c.fill = d._buttonFillOver), (c.stroke = d._buttonStrokeOver))
            : ((c.fill = d._buttonFillNormal),
              (c.stroke = d._buttonStrokeNormal));
          f.skipsUndoManager = g;
        }
      }
    };
    b.actionCancel = function (b, d) {
      if (d.Mf() && d instanceof W && null !== d._buttonFillPressed) {
        var c = d.hb("ButtonBorder");
        if (c instanceof Hf) {
          var f = b.diagram,
            g = f.skipsUndoManager;
          f.skipsUndoManager = !0;
          a(b, d)
            ? ((c.fill = d._buttonFillOver), (c.stroke = d._buttonStrokeOver))
            : ((c.fill = d._buttonFillNormal),
              (c.stroke = d._buttonStrokeNormal));
          f.skipsUndoManager = g;
        }
      }
    };
    b.actionMove = function (b, d) {
      if (d.Mf() && d instanceof W && null !== d._buttonFillPressed) {
        var c = b.diagram;
        if (
          0 === c.firstInput.button &&
          (c.currentTool.standardMouseOver(),
          a(b, d) && ((b = d.hb("ButtonBorder")), b instanceof Hf))
        ) {
          var f = c.skipsUndoManager;
          c.skipsUndoManager = !0;
          var g = d._buttonFillPressed;
          b.fill !== g && (b.fill = g);
          g = d._buttonStrokePressed;
          b.stroke !== g && (b.stroke = g);
          c.skipsUndoManager = f;
        }
      }
    };
    return b;
  });
  Zl("TreeExpanderButton", function () {
    var a = Vl(
      "Button",
      { _treeExpandedFigure: "MinusLine", _treeCollapsedFigure: "PlusLine" },
      Vl(
        Hf,
        {
          name: "ButtonIcon",
          figure: "MinusLine",
          stroke: "#424242",
          strokeWidth: 2,
          desiredSize: Xb,
        },
        new Fi("figure", "isTreeExpanded", function (a, c) {
          c = c.panel;
          return a ? c._treeExpandedFigure : c._treeCollapsedFigure;
        }).uq()
      ),
      { visible: !1 },
      new Fi("visible", "isTreeLeaf", function (a) {
        return !a;
      }).uq()
    );
    a.click = function (a, c) {
      c = c.part;
      c instanceof Je && (c = c.adornedPart);
      if (c instanceof V) {
        var b = c.diagram;
        if (null !== b) {
          b = b.commandHandler;
          if (c.isTreeExpanded) {
            if (!b.canCollapseTree(c)) return;
          } else if (!b.canExpandTree(c)) return;
          a.handled = !0;
          c.isTreeExpanded ? b.collapseTree(c) : b.expandTree(c);
        }
      }
    };
    return a;
  });
  Zl("SubGraphExpanderButton", function () {
    var a = Vl(
      "Button",
      {
        _subGraphExpandedFigure: "MinusLine",
        _subGraphCollapsedFigure: "PlusLine",
      },
      Vl(
        Hf,
        {
          name: "ButtonIcon",
          figure: "MinusLine",
          stroke: "#424242",
          strokeWidth: 2,
          desiredSize: Xb,
        },
        new Fi("figure", "isSubGraphExpanded", function (a, c) {
          c = c.panel;
          return a ? c._subGraphExpandedFigure : c._subGraphCollapsedFigure;
        }).uq()
      )
    );
    a.click = function (a, c) {
      c = c.part;
      c instanceof Je && (c = c.adornedPart);
      if (c instanceof vf) {
        var b = c.diagram;
        if (null !== b) {
          b = b.commandHandler;
          if (c.isSubGraphExpanded) {
            if (!b.canCollapseSubGraph(c)) return;
          } else if (!b.canExpandSubGraph(c)) return;
          a.handled = !0;
          c.isSubGraphExpanded ? b.collapseSubGraph(c) : b.expandSubGraph(c);
        }
      }
    };
    return a;
  });
  Zl("ToolTip", function () {
    return Vl(
      Je,
      W.Auto,
      {
        isShadowed: !0,
        shadowColor: "rgba(0, 0, 0, .4)",
        shadowOffset: new K(0, 3),
        shadowBlur: 5,
      },
      Vl(Hf, {
        name: "Border",
        figure: "RoundedRectangle",
        parameter1: 1,
        parameter2: 1,
        fill: "#F5F5F5",
        stroke: "#F0F0F0",
        spot1: new Ib(0, 0, 4, 6),
        spot2: new Ib(1, 1, -4, -4),
      })
    );
  });
  Zl("ContextMenu", function () {
    return Vl(
      Je,
      W.Vertical,
      {
        background: "#F5F5F5",
        isShadowed: !0,
        shadowColor: "rgba(0, 0, 0, .4)",
        shadowOffset: new K(0, 3),
        shadowBlur: 5,
      },
      new Fi("background", "", function (a) {
        return null !== a.adornedPart && null !== a.placeholder
          ? null
          : "#F5F5F5";
      })
    );
  });
  Zl("ContextMenuButton", function () {
    var a = Vl("Button");
    a.stretch = il;
    var b = a.hb("ButtonBorder");
    b instanceof Hf &&
      ((b.figure = "Rectangle"),
      (b.strokeWidth = 0),
      (b.spot1 = new Ib(0, 0, 2, 3)),
      (b.spot2 = new Ib(1, 1, -2, -2)));
    return a;
  });
  Zl("PanelExpanderButton", function (a) {
    var b = $l(a, "COLLAPSIBLE"),
      c = Vl(
        "Button",
        {
          _buttonExpandedFigure: "M0 0 M0 6 L4 2 8 6 M8 8",
          _buttonCollapsedFigure: "M0 0 M0 2 L4 6 8 2 M8 8",
          _buttonFillNormal: "rgba(0, 0, 0, 0)",
          _buttonStrokeNormal: null,
          _buttonFillOver: "rgba(0, 0, 0, .2)",
          _buttonStrokeOver: null,
          _buttonFillPressed: "rgba(0, 0, 0, .4)",
          _buttonStrokePressed: null,
        },
        Vl(
          Hf,
          { name: "ButtonIcon", strokeWidth: 2 },
          new Fi("geometryString", "visible", function (a) {
            return a ? c._buttonExpandedFigure : c._buttonCollapsedFigure;
          }).uq(b)
        )
      );
    a = c.hb("ButtonBorder");
    a instanceof Hf && ((a.stroke = null), (a.fill = "rgba(0, 0, 0, 0)"));
    c.click = function (a, c) {
      var d = c.diagram;
      if (null !== d && !d.isReadOnly) {
        var e = c.Hh();
        null === e && (e = c.part);
        null !== e &&
          ((c = e.hb(b)),
          null !== c &&
            ((a.handled = !0),
            d.Fa("Collapse/Expand Panel"),
            (c.visible = !c.visible),
            d.gb("Collapse/Expand Panel")));
      }
    };
    return c;
  });
  Zl("CheckBoxButton", function (a) {
    var b = $l(a);
    a = Vl(
      "Button",
      { desiredSize: new Gb(14, 14) },
      Vl(
        Hf,
        {
          name: "ButtonIcon",
          geometryString: "M0 0 M0 8.85 L4.9 13.75 16.2 2.45 M16.2 16.2",
          strokeWidth: 2,
          stretch: Fd,
          geometryStretch: vg,
          visible: !1,
        },
        "" !== b ? new Fi("visible", b).qy() : []
      )
    );
    a.click = function (a, d) {
      if (d instanceof W) {
        var c = a.diagram;
        if (!(null === c || c.isReadOnly || ("" !== b && c.model.isReadOnly))) {
          a.handled = !0;
          var f = d.hb("ButtonIcon");
          c.Fa("checkbox");
          f.visible = !f.visible;
          "function" === typeof d._doClick && d._doClick(a, d);
          c.gb("checkbox");
        }
      }
    };
    return a;
  });
  Zl("CheckBox", function (a) {
    a = $l(a);
    a = Vl("CheckBoxButton", a, {
      name: "Button",
      isActionable: !1,
      margin: new ic(0, 1, 0, 0),
    });
    var b = Vl(W, "Horizontal", a, {
      isActionable: !0,
      cursor: a.cursor,
      margin: 1,
      _buttonFillNormal: a._buttonFillNormal,
      _buttonStrokeNormal: a._buttonStrokeNormal,
      _buttonFillOver: a._buttonFillOver,
      _buttonStrokeOver: a._buttonStrokeOver,
      _buttonFillPressed: a._buttonFillPressed,
      _buttonStrokePressed: a._buttonStrokePressed,
      _buttonFillDisabled: a._buttonFillDisabled,
      mouseEnter: a.mouseEnter,
      mouseLeave: a.mouseLeave,
      actionDown: a.actionDown,
      actionUp: a.actionUp,
      actionCancel: a.actionCancel,
      actionMove: a.actionMove,
      click: a.click,
      _buttonClick: a.click,
    });
    a.mouseEnter = null;
    a.mouseLeave = null;
    a.actionDown = null;
    a.actionUp = null;
    a.actionCancel = null;
    a.actionMove = null;
    a.click = null;
    return b;
  });
  O.None = tg = new F(O, "None", 0);
  O.Default = hl = new F(O, "Default", 0);
  O.Vertical = jl = new F(O, "Vertical", 4);
  O.Horizontal = il = new F(O, "Horizontal", 5);
  O.Fill = Fd = new F(O, "Fill", 3);
  O.Uniform = vg = new F(O, "Uniform", 1);
  O.UniformToFill = kl = new F(O, "UniformToFill", 2);
  O.FlipVertical = ll = new F(O, "FlipVertical", 1);
  O.FlipHorizontal = ml = new F(O, "FlipHorizontal", 2);
  O.FlipBoth = nl = new F(O, "FlipBoth", 3);
  O.make = Vl;
  O.getBuilders = function () {
    var a = new xb(),
      b;
    for (b in Wl)
      if (b !== b.toLowerCase()) {
        var c = Wl.K(b);
        "function" === typeof c && a.add(b, c);
      }
    a.freeze();
    return a;
  };
  O.defineBuilder = Zl;
  O.build = function (a, b) {
    var c = Wl.K(a);
    if ("function" === typeof c && ((c = c(null)), c instanceof O))
      return b && c.set(b), c;
    v(
      'GraphObject.build invoked object builder "' +
        a +
        '", but it did not return an Object'
    );
  };
  O.takeBuilderArgument = $l;
  function pl() {
    this.Gn =
      this.Jg =
      this.zh =
      this.Wm =
      this.Zm =
      this.Ym =
      this.Xm =
      this.bh =
      this.Ho =
      this.Go =
      this.eh =
      this.fh =
      this.hh =
      this.gh =
      this.dh =
      this.Ig =
      this.Og =
      this.Gg =
        null;
  }
  pl.prototype.copy = function () {
    var a = new pl();
    a.Gg = this.Gg;
    a.Og = this.Og;
    a.Ig = this.Ig;
    a.dh = this.dh;
    a.gh = this.gh;
    a.hh = this.hh;
    a.fh = this.fh;
    a.eh = this.eh;
    a.Go = this.Go;
    a.Ho = this.Ho;
    a.bh = this.bh;
    a.Xm = this.Xm;
    a.Ym = this.Ym;
    a.Zm = this.Zm;
    a.Wm = this.Wm;
    a.zh = this.zh;
    a.Jg = this.Jg;
    a.Gn = this.Gn;
    return a;
  };
  pl.className = "GraphObjectEventHandlers";
  function am() {
    this.B = -Infinity;
    this.o = 0;
    this.M = yb;
    this.Zr = hg;
    this.j = this.Ba = "None";
  }
  am.prototype.copy = function () {
    var a = new am();
    a.B = this.B;
    a.o = this.o;
    a.M = this.M.L();
    a.Zr = this.Zr;
    a.Ba = this.Ba;
    a.j = this.j;
    return a;
  };
  am.className = "LinkElementSettings";
  function em() {
    this.Ua = [1, 0, 0, 1, 0, 0];
  }
  em.prototype.copy = function () {
    var a = new em();
    a.Ua[0] = this.Ua[0];
    a.Ua[1] = this.Ua[1];
    a.Ua[2] = this.Ua[2];
    a.Ua[3] = this.Ua[3];
    a.Ua[4] = this.Ua[4];
    a.Ua[5] = this.Ua[5];
    return a;
  };
  em.prototype.translate = function (a, b) {
    this.Ua[4] += this.Ua[0] * a + this.Ua[2] * b;
    this.Ua[5] += this.Ua[1] * a + this.Ua[3] * b;
  };
  em.prototype.scale = function (a, b) {
    this.Ua[0] *= a;
    this.Ua[1] *= a;
    this.Ua[2] *= b;
    this.Ua[3] *= b;
  };
  em.className = "STransform";
  function fm(a) {
    this.type = a;
    this.r2 = this.y2 = this.x2 = this.r1 = this.y1 = this.x1 = 0;
    this.Ix = [];
    this.pattern = null;
  }
  fm.prototype.addColorStop = function (a, b) {
    this.Ix.push({ offset: a, color: b });
  };
  fm.className = "SGradient";
  function Kj(a, b) {
    this.ownerDocument = a = void 0 === b ? sa.document : b;
    this.KA = "http://www.w3.org/2000/svg";
    void 0 !== a &&
      ((this.Sa = this.Wb("svg", {
        width: "1px",
        height: "1px",
        viewBox: "0 0 1 1",
      })),
      this.Sa.setAttributeNS(
        "http://www.w3.org/2000/xmlns/",
        "xmlns",
        "http://www.w3.org/2000/svg"
      ),
      this.Sa.setAttributeNS(
        "http://www.w3.org/2000/xmlns/",
        "xmlns:xlink",
        "http://www.w3.org/1999/xlink"
      ));
    this.cq = null;
    this.context = new gm(this);
  }
  Kj.prototype.resize = function (a, b, c, d) {
    return this.width !== a || this.height !== b
      ? ((this.style.width = c + "px"),
        (this.style.height = d + "px"),
        this.Sa.setAttributeNS(null, "width", c + "px"),
        this.Sa.setAttributeNS(null, "height", d + "px"),
        this.Sa.setAttributeNS(null, "viewBox", "0 0 " + c + " " + d),
        this.context.Yw.firstElementChild.setAttributeNS(
          null,
          "width",
          c + "px"
        ),
        this.context.Yw.firstElementChild.setAttributeNS(
          null,
          "height",
          d + "px"
        ),
        !0)
      : !1;
  };
  Kj.prototype.Wb = function (a, b, c) {
    a = this.ownerDocument.createElementNS(this.KA, a);
    if (Ga(b))
      for (var d in b)
        a.setAttributeNS(
          "href" === d ? "http://www.w3.org/1999/xlink" : "",
          d,
          b[d]
        );
    void 0 !== c && (a.textContent = c);
    return a;
  };
  Kj.prototype.getBoundingClientRect = function () {
    return this.Sa.getBoundingClientRect();
  };
  Kj.prototype.focus = function () {
    this.Sa.focus();
  };
  Kj.prototype.Ox = function () {
    this.ownerDocument = null;
  };
  oa.Object.defineProperties(Kj.prototype, {
    width: {
      configurable: !0,
      get: function () {
        return this.Sa.width.baseVal.value;
      },
      set: function (a) {
        this.Sa.width = a;
      },
    },
    height: {
      configurable: !0,
      get: function () {
        return this.Sa.height.baseVal.value;
      },
      set: function (a) {
        this.Sa.height = a;
      },
    },
    style: {
      configurable: !0,
      get: function () {
        return this.Sa.style;
      },
    },
  });
  Kj.className = "SVGSurface";
  function gm(a) {
    this.it = a;
    this.svg = a.Sa;
    this.stack = [];
    this.od = [];
    this.fillStyle = "#000000";
    this.font = "10px sans-serif";
    this.globalAlpha = 1;
    this.lineCap = "butt";
    this.lineDashOffset = 0;
    this.lineJoin = "miter";
    this.lineWidth = 1;
    this.miterLimit = 10;
    this.shadowBlur = 0;
    this.shadowColor = "rgba(0, 0, 0, 0)";
    this.shadowOffsetY = this.shadowOffsetX = 0;
    this.strokeStyle = "#000000";
    this.textAlign = "start";
    this.clipInsteadOfFill = !1;
    this.mg = this.es = this.ds = 0;
    this.Rs = null;
    this.path = [];
    this.Xt = !1;
    this.sh = null;
    this.ak = 0;
    this.Re = new em();
    hm(this, 1, 0, 0, 1, 0, 0);
    var b = pb++,
      c = this.Wb("clipPath", { id: "mainClip" + b });
    c.appendChild(
      this.Wb("rect", { x: 0, y: 0, width: a.width, height: a.height })
    );
    this.Yw = c;
    this.it.Sa.appendChild(c);
    this.od[0].setAttributeNS(null, "clip-path", "url(#mainClip" + b + ")");
    this.MA = {};
  }
  t = gm.prototype;
  t.arc = function (a, b, c, d, e, f, g, h) {
    var k = 2 * Math.PI,
      l = k - 1e-6,
      m = c * Math.cos(d),
      n = c * Math.sin(d),
      p = a + m,
      r = b + n,
      q = f ? 0 : 1;
    d = f ? d - e : e - d;
    (1e-6 < Math.abs(g - p) || 1e-6 < Math.abs(h - r)) &&
      this.path.push(["L", p, +r]);
    0 > d && (d = (d % k) + k);
    d > l
      ? (this.path.push(["A", c, c, 0, 1, q, a - m, b - n]),
        this.path.push(["A", c, c, 0, 1, q, p, r]))
      : 1e-6 < d &&
        this.path.push([
          "A",
          c,
          c,
          0,
          +(d >= Math.PI),
          q,
          a + c * Math.cos(e),
          b + c * Math.sin(e),
        ]);
  };
  t.beginPath = function () {
    this.path = [];
  };
  t.bezierCurveTo = function (a, b, c, d, e, f) {
    this.path.push(["C", a, b, c, d, e, f]);
  };
  t.clearRect = function () {};
  t.clip = function () {
    this.addPath("clipPath", this.path, this.Re);
  };
  t.closePath = function () {
    this.path.push(["z"]);
  };
  t.createLinearGradient = function (a, b, c, d) {
    var e = new fm("linear");
    e.x1 = a;
    e.y1 = b;
    e.x2 = c;
    e.y2 = d;
    return e;
  };
  t.createPattern = function (a) {
    var b = "";
    a instanceof HTMLCanvasElement && (b = a.toDataURL());
    a instanceof HTMLImageElement && (b = a.getAttribute("src"));
    var c = this.MA;
    if (c[b]) return "url(#" + c[b] + ")";
    var d = "PATTERN" + pb++,
      e = { x: 0, y: 0, width: a.width, height: a.height, href: b };
    a = this.Wb("pattern", {
      width: a.width,
      height: a.height,
      id: d,
      patternUnits: "userSpaceOnUse",
    });
    a.appendChild(this.Wb(Mk, e));
    this.svg.appendChild(a);
    c[b] = d;
    return "url(#" + d + ")";
  };
  t.createRadialGradient = function (a, b, c, d, e, f) {
    var g = new fm("radial");
    g.x1 = a;
    g.y1 = b;
    g.r1 = c;
    g.x2 = d;
    g.y2 = e;
    g.r2 = f;
    return g;
  };
  t.drawImage = function (a, b, c, d, e, f, g, h, k) {
    var l = "";
    a instanceof HTMLCanvasElement && (l = a.toDataURL());
    a instanceof HTMLImageElement && (l = a.getAttribute("src"));
    var m = a instanceof HTMLImageElement ? a.naturalWidth : a.width,
      n = a instanceof HTMLImageElement ? a.naturalHeight : a.height;
    void 0 === d && ((f = b), (g = c), (h = d = m), (k = e = n));
    d = d || 0;
    e = e || 0;
    f = f || 0;
    g = g || 0;
    h = h || 0;
    k = k || 0;
    a = { x: 0, y: 0, width: m || d, height: n || e, href: l };
    L.da(d, h) && L.da(e, k)
      ? -1 === l.toLowerCase().indexOf(".svg") &&
        -1 === l.toLowerCase().indexOf("data:image/svg") &&
        (a.preserveAspectRatio = "xMidYMid slice")
      : (a.preserveAspectRatio = "none");
    l = "";
    h /= d;
    k /= e;
    if (0 !== f || 0 !== g) l += " translate(" + f + ", " + g + ")";
    if (1 !== h || 1 !== k) l += " scale(" + h + ", " + k + ")";
    if (0 !== b || 0 !== c) l += " translate(" + -b + ", " + -c + ")";
    if (0 !== b || 0 !== c || d !== m || e !== n)
      (f = "CLIP" + pb++),
        (g = this.Wb("clipPath", { id: f })),
        g.appendChild(this.Wb("rect", { x: b, y: c, width: d, height: e })),
        this.svg.appendChild(g),
        (a["clip-path"] = "url(#" + f + ")");
    im(this, Mk, a, this.Re, l);
    this.addElement(Mk, a);
  };
  t.fill = function () {
    this.addPath("fill", this.path, this.Re);
  };
  t.Gf = function () {
    this.clipInsteadOfFill ? this.clip() : this.fill();
  };
  t.fillRect = function (a, b, c, d) {
    a = [a, b, c, d];
    a = { x: a[0], y: a[1], width: a[2], height: a[3] };
    im(this, "fill", a, this.Re);
    this.addElement("rect", a);
  };
  t.fillText = function (a, b, c) {
    a = [a, b, c];
    b = this.textAlign;
    "left" === b
      ? (b = "start")
      : "right" === b
      ? (b = "end")
      : "center" === b && (b = "middle");
    b = { x: a[1], y: a[2], style: "font: " + this.font, "text-anchor": b };
    im(this, "fill", b, this.Re);
    this.addElement("text", b, a[0]);
  };
  t.lineTo = function (a, b) {
    this.path.push(["L", a, b]);
  };
  t.moveTo = function (a, b) {
    this.path.push(["M", a, b]);
  };
  t.quadraticCurveTo = function (a, b, c, d) {
    this.path.push(["Q", a, b, c, d]);
  };
  t.rect = function (a, b, c, d) {
    this.path.push(
      ["M", a, b],
      ["L", a + c, b],
      ["L", a + c, b + d],
      ["L", a, b + d],
      ["z"]
    );
  };
  t.restore = function () {
    this.Re = this.stack.pop();
    this.path = this.stack.pop();
    var a = this.stack.pop();
    this.fillStyle = a.fillStyle;
    this.font = a.font;
    this.globalAlpha = a.globalAlpha;
    this.lineCap = a.lineCap;
    this.lineDashOffset = a.lineDashOffset;
    this.lineJoin = a.lineJoin;
    this.lineWidth = a.lineWidth;
    this.miterLimit = a.miterLimit;
    this.shadowBlur = a.shadowBlur;
    this.shadowColor = a.shadowColor;
    this.shadowOffsetX = a.shadowOffsetX;
    this.shadowOffsetY = a.shadowOffsetY;
    this.strokeStyle = a.strokeStyle;
    this.textAlign = a.textAlign;
  };
  t.save = function () {
    this.stack.push({
      fillStyle: this.fillStyle,
      font: this.font,
      globalAlpha: this.globalAlpha,
      lineCap: this.lineCap,
      lineDashOffset: this.lineDashOffset,
      lineJoin: this.lineJoin,
      lineWidth: this.lineWidth,
      miterLimit: this.miterLimit,
      shadowBlur: this.shadowBlur,
      shadowColor: this.shadowColor,
      shadowOffsetX: this.shadowOffsetX,
      shadowOffsetY: this.shadowOffsetY,
      strokeStyle: this.strokeStyle,
      textAlign: this.textAlign,
    });
    for (var a = [], b = 0; b < this.path.length; b++) a.push(this.path[b]);
    this.stack.push(a);
    this.stack.push(this.Re.copy());
  };
  t.setTransform = function (a, b, c, d, e, f) {
    (1 === a && 0 === b && 0 === c && 1 === d && 0 === e && 0 === f) ||
      hm(this, a, b, c, d, e, f);
  };
  t.scale = function (a, b) {
    this.Re.scale(a, b);
  };
  t.translate = function (a, b) {
    this.Re.translate(a, b);
  };
  t.transform = function () {};
  t.Oc = function () {};
  t.stroke = function () {
    this.addPath("stroke", this.path, this.Re);
  };
  t.fj = function () {
    this.clipInsteadOfFill || this.stroke();
  };
  t.Wb = function (a, b, c) {
    return this.it.Wb(a, b, c);
  };
  t.addElement = function (a, b, c) {
    a = this.Wb(a, b, c);
    0 < this.od.length
      ? this.od[this.od.length - 1].appendChild(a)
      : this.svg.appendChild(a);
    return (this.Rs = a);
  };
  function im(a, b, c, d, e) {
    1 !== a.globalAlpha && (c.opacity = a.globalAlpha);
    "fill" === b
      ? (a.fillStyle instanceof fm
          ? (c.fill = jm(a, a.fillStyle))
          : /^rgba\(/.test(a.fillStyle)
          ? ((a =
              /^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(
                a.fillStyle
              )),
            (c.fill = "rgb(" + a[1] + "," + a[2] + "," + a[3] + ")"),
            (c["fill-opacity"] = a[4]))
          : (c.fill = a.fillStyle),
        (c.stroke = "none"))
      : "stroke" === b &&
        ((c.fill = "none"),
        a.strokeStyle instanceof fm
          ? (c.stroke = jm(a, a.strokeStyle))
          : /^rgba\(/.test(a.strokeStyle)
          ? ((b =
              /^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(
                a.strokeStyle
              )),
            (c.stroke = "rgb(" + b[1] + "," + b[2] + "," + b[3] + ")"),
            (c["stroke-opacity"] = b[4]))
          : (c.stroke = a.strokeStyle),
        (c["stroke-width"] = a.lineWidth),
        (c["stroke-linecap"] = a.lineCap),
        (c["stroke-linejoin"] = a.lineJoin),
        (c["stroke-miterlimit"] = a.miterLimit));
    d = d.Ua;
    d =
      "matrix(" +
      d[0] +
      ", " +
      d[1] +
      ", " +
      d[2] +
      ", " +
      d[3] +
      ", " +
      d[4] +
      ", " +
      d[5] +
      ")";
    void 0 !== e && (d += e);
    c.transform = d;
  }
  function jm(a, b) {
    var c = "GRAD" + pb++;
    if ("linear" === b.type)
      var d = a.Wb("linearGradient", {
        x1: b.x1,
        x2: b.x2,
        y1: b.y1,
        y2: b.y2,
        id: c,
        gradientUnits: "userSpaceOnUse",
      });
    else if ("radial" === b.type)
      d = a.Wb("radialGradient", {
        x1: b.x1,
        x2: b.x2,
        y1: b.y1,
        y2: b.y2,
        r1: b.r1,
        r2: b.r2,
        id: c,
      });
    else throw Error("invalid gradient");
    var e = b.Ix;
    b = e.length;
    for (var f = [], g = 0; g < b; g++) {
      var h = e[g],
        k = h.color;
      h = { offset: h.offset, "stop-color": k };
      /^rgba\(/.test(k) &&
        ((k =
          /^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(
            k
          )),
        (h["stop-color"] = "rgb(" + k[1] + "," + k[2] + "," + k[3] + ")"),
        (h["stop-opacity"] = k[4]));
      f.push(h);
    }
    f.sort(function (a, b) {
      return a.offset > b.offset ? 1 : -1;
    });
    for (e = 0; e < b; e++) d.appendChild(a.Wb("stop", f[e]));
    a.svg.appendChild(d);
    return "url(#" + c + ")";
  }
  t.addPath = function (a, b, c) {
    for (var d = [], e = 0; e < b.length; e++) {
      var f = Ja(b[e]),
        g = [f.shift()];
      if ("A" === g[0])
        g.push(
          f.shift() + "," + f.shift(),
          f.shift(),
          f.shift() + "," + f.shift(),
          f.shift() + "," + f.shift()
        );
      else for (; f.length; ) g.push(f.shift() + "," + f.shift());
      d.push(g.join(" "));
    }
    b = { d: d.join(" ") };
    "stroke" === a &&
      this.Xt &&
      ((b["stroke-dasharray"] = this.sh.toString()),
      (b["stroke-dashoffset"] = this.ak));
    im(this, a, b, c);
    "clipPath" === a
      ? ((a = "CLIP" + pb++),
        (c = this.Wb("clipPath", { id: a })),
        c.appendChild(this.Wb("path", b)),
        this.svg.appendChild(c),
        0 < this.od.length &&
          this.od[this.od.length - 1].setAttributeNS(
            null,
            "clip-path",
            "url(#" + a + ")"
          ))
      : this.addElement("path", b);
  };
  function hm(a, b, c, d, e, f, g) {
    var h = new em();
    h.Ua = [b, c, d, e, f, g];
    b = {};
    im(a, "g", b, h);
    h = a.addElement("g", b);
    a.od.push(h);
  }
  t.Mm = function (a) {
    if (
      0 !== this.shadowOffsetX ||
      0 !== this.shadowOffsetY ||
      0 !== this.shadowBlur
    ) {
      var b = "SHADOW" + pb++,
        c = this.addElement(
          "filter",
          { id: b, x: "-100%", y: "-100%", width: "300%", height: "300%" },
          null
        ),
        d = a.computePixelRatio();
      a = this.Wb("feGaussianBlur", {
        in: "SourceAlpha",
        result: "blur",
        stdDeviation: this.shadowBlur / 2 / d,
      });
      var e = this.Wb("feFlood", {
          in: "blur",
          result: "flood",
          "flood-color": this.shadowColor,
        }),
        f = this.Wb("feComposite", {
          in: "flood",
          in2: "blur",
          operator: "in",
          result: "comp",
        });
      d = this.Wb("feOffset", {
        in: "comp",
        result: "offsetBlur",
        dx: this.shadowOffsetX / d,
        dy: this.shadowOffsetY / d,
      });
      var g = this.Wb("feMerge", {});
      g.appendChild(this.Wb("feMergeNode", { in: "offsetBlur" }));
      g.appendChild(this.Wb("feMergeNode", { in: "SourceGraphic" }));
      c.appendChild(a);
      c.appendChild(e);
      c.appendChild(f);
      c.appendChild(d);
      c.appendChild(g);
      0 < this.od.length &&
        this.od[this.od.length - 1].setAttributeNS(
          null,
          "filter",
          "url(#" + b + ")"
        );
    }
  };
  t.bw = function (a, b, c) {
    this.ds = a;
    this.es = b;
    this.mg = c;
  };
  function El(a) {
    a.shadowOffsetX = 0;
    a.shadowOffsetY = 0;
    a.shadowBlur = 0;
  }
  function Dl(a) {
    a.shadowOffsetX = a.ds;
    a.shadowOffsetY = a.es;
    a.shadowBlur = a.mg;
  }
  t.As = function (a, b) {
    this.Xt = !0;
    this.sh = a;
    this.ak = b;
  };
  t.ys = function () {
    this.Xt = !1;
  };
  t.Nc = function () {};
  t.Ey = function () {};
  gm.prototype.rotate = function () {};
  gm.prototype.getImageData = function () {
    return null;
  };
  gm.prototype.measureText = function () {
    return null;
  };
  gm.className = "SVGContext";
  Q.prototype.Vs = function (a) {
    var b = new Kj(this, sa.document);
    void 0 === a && (a = new eb());
    var c = this;
    return Kk(
      this,
      function (a, e) {
        a = Lk(c, a, "SVG", b);
        a = null !== a ? a.svg : null;
        return "function" === typeof e ? (e(a), null) : a;
      },
      a
    );
  };
  Q.prototype.makeSvg = Q.prototype.Vs;
  Q.prototype.Gv = function (a) {
    return this.Vs(a);
  };
  Q.prototype.makeSVG = Q.prototype.Gv;
  O.prototype.Px = function (a, b) {
    if (!(a instanceof gm)) return !1;
    var c = null,
      d = a.Rs,
      e = this.transform,
      f = this.panel;
    (0 !== (this.A & 4096)) === !0 && Cl(this);
    var g = this.Db,
      h = 0 !== (this.A & 256);
    a.clipInsteadOfFill && (h = !1);
    var k = !1;
    this instanceof Yg && (a.font = this.font);
    if (h) {
      k = f.oe() ? f.naturalBounds : f.actualBounds;
      if (null !== this.kb) {
        var l = this.kb;
        var m = l.x;
        var n = l.y;
        var p = l.width;
        l = l.height;
      } else
        (m = Math.max(g.x, k.x)),
          (n = Math.max(g.y, k.y)),
          (p = Math.min(g.right, k.right) - m),
          (l = Math.min(g.bottom, k.bottom) - n);
      if (
        m > g.width + g.x ||
        g.x > k.width + k.x ||
        n > g.height + g.y ||
        g.y > k.height + k.y
      )
        return !0;
      k = !0;
      hm(a, 1, 0, 0, 1, 0, 0);
      a.save();
      a.beginPath();
      a.rect(m, n, p, l);
      a.clip();
    }
    if (this.$i() && !this.isVisible()) return !0;
    a.Re.Ua = [1, 0, 0, 1, 0, 0];
    ((this instanceof Yg && 1 < this.lineCount) ||
      (this instanceof Hf && 1 < this.geometry.figures.length)) &&
      hm(a, 1, 0, 0, 1, 0, 0);
    m = !1;
    this.$i() &&
      this.isShadowed &&
      b.Se("drawShadows") &&
      ((n = this.shadowOffset),
      a.bw(n.x * b.scale * b.jc, n.y * b.scale * b.jc, this.shadowBlur),
      Dl(a),
      (a.shadowColor = this.shadowColor));
    n = !1;
    this.part && b.Se("drawShadows") && (n = this.part.isShadowed);
    a.clipInsteadOfFill && (n = !1);
    !0 === this.shadowVisible
      ? (Dl(a), !1 === m && n && (hm(a, 1, 0, 0, 1, 0, 0), a.Mm(b), (m = !0)))
      : !1 === this.shadowVisible && El(a);
    p = this.naturalBounds;
    null !== this.areaBackground &&
      (pi(this, a, this.areaBackground, !0, !0, p, g),
      !1 === m && n && (hm(a, 1, 0, 0, 1, 0, 0), a.Mm(b), (m = !0)),
      this.areaBackground instanceof Al && this.areaBackground.type === Bl
        ? (a.beginPath(),
          a.rect(g.x, g.y, g.width, g.height),
          a.Gf(this.areaBackground))
        : a.fillRect(g.x, g.y, g.width, g.height));
    l = !1;
    this instanceof W
      ? hm(a, e.m11, e.m12, e.m21, e.m22, e.dx, e.dy)
      : ((a.Re.Ua = [e.m11, e.m12, e.m21, e.m22, e.dx, e.dy]),
        !1 === m && n && (l = !0));
    null !== this.background &&
      (!1 === m && n && (hm(a, 1, 0, 0, 1, 0, 0), a.Mm(b), (m = !0)),
      Fl(this, a, p, g));
    n &&
    (null !== this.background ||
      null !== this.areaBackground ||
      (null !== f && 0 !== (f.A & 512)) ||
      (null !== f &&
        (f.type === W.Auto || f.type === W.Spot) &&
        f.vb() !== this))
      ? (Gl(this, !0), null === this.shadowVisible && El(a), (l = !1))
      : Gl(this, !1);
    l && !1 === m && (hm(a, 1, 0, 0, 1, 0, 0), a.Mm(b), (m = !0));
    this.Ni(a, b);
    n && (0 !== (this.A & 512)) === !0 && Dl(a);
    this.$i() && n && El(a);
    h && (a.restore(), k && a.od.pop());
    this instanceof W && (c = a.od.pop());
    !0 === m && a.od.pop();
    if (
      (this instanceof Yg && 1 < this.lineCount) ||
      (this instanceof Hf && 1 < this.geometry.figures.length)
    )
      c = a.od.pop();
    null !== a.it.cq &&
      (null === c &&
        (d === a.Rs ? (hm(a, 1, 0, 0, 1, 0, 0), (c = a.od.pop())) : (c = a.Rs)),
      a.it.cq(this, c));
    this.svg = c;
    return !0;
  };
  function Nk(a, b) {
    this.ownerDocument = b = void 0 === b ? sa.document : b;
    this.cq = null;
    b = b.createElement("canvas");
    b.tabIndex = 0;
    this.Sa = b;
    this.Sa.innerHTML =
      "This text is displayed if your browser does not support the Canvas HTML element.";
    this.context = new Il(b);
    b.G = a;
  }
  Nk.prototype.resize = function (a, b, c, d) {
    return this.width !== a || this.height !== b
      ? ((this.width = a),
        (this.height = b),
        (this.style.width = c + "px"),
        (this.style.height = d + "px"),
        !0)
      : !1;
  };
  Nk.prototype.toDataURL = function (a, b) {
    return this.Sa.toDataURL(a, b);
  };
  Nk.prototype.getBoundingClientRect = function () {
    return this.Sa.getBoundingClientRect();
  };
  Nk.prototype.focus = function () {
    this.Sa.focus();
  };
  Nk.prototype.Ox = function () {
    this.ownerDocument = this.Sa.G = null;
  };
  oa.Object.defineProperties(Nk.prototype, {
    width: {
      configurable: !0,
      get: function () {
        return this.Sa.width;
      },
      set: function (a) {
        this.Sa.width = a;
      },
    },
    height: {
      configurable: !0,
      get: function () {
        return this.Sa.height;
      },
      set: function (a) {
        this.Sa.height = a;
      },
    },
    style: {
      configurable: !0,
      get: function () {
        return this.Sa.style;
      },
    },
  });
  Nk.className = "CanvasSurface";
  function Il(a) {
    (a.getContext && a.getContext("2d")) ||
      v("Browser does not support HTML Canvas Element");
    this.aa = a.getContext("2d");
    this.wt = this.yt = this.xt = "";
    this.kn = !1;
    this.mg = this.es = this.ds = 0;
    this.gm = new Kb();
  }
  t = Il.prototype;
  t.Ey = function (a) {
    this.aa.imageSmoothingEnabled = a;
  };
  t.arc = function (a, b, c, d, e, f) {
    this.aa.arc(a, b, c, d, e, f);
  };
  t.beginPath = function () {
    this.aa.beginPath();
  };
  t.bezierCurveTo = function (a, b, c, d, e, f) {
    this.aa.bezierCurveTo(a, b, c, d, e, f);
  };
  t.clearRect = function (a, b, c, d) {
    this.Oc();
    this.aa.clearRect(a, b, c, d);
  };
  t.clip = function () {
    this.aa.clip();
  };
  t.closePath = function () {
    this.aa.closePath();
  };
  t.createLinearGradient = function (a, b, c, d) {
    return this.aa.createLinearGradient(a, b, c, d);
  };
  t.createPattern = function (a, b) {
    return this.aa.createPattern(a, b);
  };
  t.createRadialGradient = function (a, b, c, d, e, f) {
    return this.aa.createRadialGradient(a, b, c, d, e, f);
  };
  t.drawImage = function (a, b, c, d, e, f, g, h, k) {
    void 0 === d
      ? this.aa.drawImage(a, b, c)
      : this.aa.drawImage(a, b, c, d, e, f, g, h, k);
  };
  t.fill = function () {
    this.aa.fill();
  };
  t.fillRect = function (a, b, c, d) {
    this.aa.fillRect(a, b, c, d);
  };
  t.fillText = function (a, b, c) {
    this.aa.fillText(a, b, c);
  };
  t.getImageData = function (a, b, c, d) {
    return this.aa.getImageData(a, b, c, d);
  };
  t.lineTo = function (a, b) {
    this.aa.lineTo(a, b);
  };
  t.measureText = function (a) {
    return this.aa.measureText(a);
  };
  t.moveTo = function (a, b) {
    this.aa.moveTo(a, b);
  };
  t.quadraticCurveTo = function (a, b, c, d) {
    this.aa.quadraticCurveTo(a, b, c, d);
  };
  t.rect = function (a, b, c, d) {
    this.aa.rect(a, b, c, d);
  };
  t.restore = function () {
    this.aa.restore();
  };
  t.save = function () {
    this.Oc();
    this.aa.save();
  };
  Il.prototype.rotate = function (a) {
    this.gm.rotate(57.2958 * a, 0, 0);
  };
  t = Il.prototype;
  t.setTransform = function (a, b, c, d, e, f) {
    this.gm.setTransform(a, b, c, d, e, f);
  };
  t.scale = function (a, b) {
    this.gm.scale(a, b);
  };
  t.translate = function (a, b) {
    this.gm.translate(a, b);
  };
  t.stroke = function () {
    this.aa.stroke();
  };
  t.transform = function (a, b, c, d, e, f) {
    if (1 !== a || 0 !== b || 0 !== c || 1 !== d || 0 !== e || 0 !== f) {
      var g = this.gm,
        h = g.m11 * a + g.m21 * b;
      a = g.m12 * a + g.m22 * b;
      b = g.m11 * c + g.m21 * d;
      c = g.m12 * c + g.m22 * d;
      g.dx = g.m11 * e + g.m21 * f + g.dx;
      g.dy = g.m12 * e + g.m22 * f + g.dy;
      g.m11 = h;
      g.m12 = a;
      g.m21 = b;
      g.m22 = c;
    }
  };
  t.Oc = function () {
    var a = this.gm;
    this.aa.setTransform(a.m11, a.m12, a.m21, a.m22, a.dx, a.dy);
  };
  t.Gf = function (a) {
    if (a instanceof Al && a.type === Bl) {
      var b = a.Xk;
      a = a.zt;
      a > b
        ? (this.scale(b / a, 1), this.translate((a - b) / 2, 0))
        : b > a && (this.scale(1, a / b), this.translate(0, (b - a) / 2));
      this.kn ? this.clip() : this.fill();
      a > b
        ? (this.translate(-(a - b) / 2, 0), this.scale(1 / (b / a), 1))
        : b > a &&
          (this.translate(0, -(b - a) / 2), this.scale(1, 1 / (a / b)));
    } else this.kn ? this.clip() : this.fill();
  };
  t.fj = function () {
    this.kn || this.stroke();
  };
  t.bw = function (a, b, c) {
    this.ds = a;
    this.es = b;
    this.mg = c;
  };
  t.As = function (a, b) {
    var c = this.aa;
    void 0 !== c.setLineDash && (c.setLineDash(a), (c.lineDashOffset = b));
  };
  t.ys = function () {
    var a = this.aa;
    void 0 !== a.setLineDash && (a.setLineDash(km), (a.lineDashOffset = 0));
  };
  t.Nc = function (a) {
    a && (this.xt = "");
    this.wt = this.yt = "";
  };
  oa.Object.defineProperties(Il.prototype, {
    fillStyle: {
      configurable: !0,
      get: function () {
        return this.aa.fillStyle;
      },
      set: function (a) {
        this.wt !== a && (this.wt = this.aa.fillStyle = a);
      },
    },
    font: {
      configurable: !0,
      get: function () {
        return this.aa.font;
      },
      set: function (a) {
        this.xt !== a && (this.xt = this.aa.font = a);
      },
    },
    globalAlpha: {
      configurable: !0,
      get: function () {
        return this.aa.globalAlpha;
      },
      set: function (a) {
        this.aa.globalAlpha = a;
      },
    },
    lineCap: {
      configurable: !0,
      get: function () {
        return this.aa.lineCap;
      },
      set: function (a) {
        this.aa.lineCap = a;
      },
    },
    lineDashOffset: {
      configurable: !0,
      get: function () {
        return this.aa.lineDashOffset;
      },
      set: function (a) {
        this.aa.lineDashOffset = a;
      },
    },
    lineJoin: {
      configurable: !0,
      get: function () {
        return this.aa.lineJoin;
      },
      set: function (a) {
        this.aa.lineJoin = a;
      },
    },
    lineWidth: {
      configurable: !0,
      get: function () {
        return this.aa.lineWidth;
      },
      set: function (a) {
        this.aa.lineWidth = a;
      },
    },
    miterLimit: {
      configurable: !0,
      get: function () {
        return this.aa.miterLimit;
      },
      set: function (a) {
        this.aa.miterLimit = a;
      },
    },
    shadowBlur: {
      configurable: !0,
      get: function () {
        return this.aa.shadowBlur;
      },
      set: function (a) {
        this.aa.shadowBlur = a;
      },
    },
    shadowColor: {
      configurable: !0,
      get: function () {
        return this.aa.shadowColor;
      },
      set: function (a) {
        this.aa.shadowColor = a;
      },
    },
    shadowOffsetX: {
      configurable: !0,
      get: function () {
        return this.aa.shadowOffsetX;
      },
      set: function (a) {
        this.aa.shadowOffsetX = a;
      },
    },
    shadowOffsetY: {
      configurable: !0,
      get: function () {
        return this.aa.shadowOffsetY;
      },
      set: function (a) {
        this.aa.shadowOffsetY = a;
      },
    },
    strokeStyle: {
      configurable: !0,
      get: function () {
        return this.aa.strokeStyle;
      },
      set: function (a) {
        this.yt !== a && (this.yt = this.aa.strokeStyle = a);
      },
    },
    textAlign: {
      configurable: !0,
      get: function () {
        return this.aa.textAlign;
      },
      set: function (a) {
        this.aa.textAlign = a;
      },
    },
    imageSmoothingEnabled: {
      configurable: !0,
      get: function () {
        return this.aa.imageSmoothingEnabled;
      },
      set: function (a) {
        this.aa.imageSmoothingEnabled = a;
      },
    },
    clipInsteadOfFill: {
      configurable: !0,
      get: function () {
        return this.kn;
      },
      set: function (a) {
        this.kn = a;
      },
    },
  });
  var km = Object.freeze([]);
  Il.className = "CanvasSurfaceContext";
  function lm() {
    this.M = this.o = this.B = this.j = 0;
  }
  lm.className = "ColorNumbers";
  function Al(a, b) {
    mm || (nm(), (mm = !0));
    ab(this);
    this.u = !1;
    void 0 === a
      ? ((this.pa = Hl), (this.Wk = "black"))
      : "string" === typeof a
      ? ((this.pa = Hl),
        G &&
          !om(a) &&
          v(
            'Color "' +
              a +
              '" is not a valid color string for Brush constructor'
          ),
        (this.Wk = a))
      : (G && cb(a, Al, Al, "constructor:type"),
        (this.pa = a),
        (this.Wk = "black"));
    a = this.pa;
    a === Kl
      ? ((this.Kd = Gc), (this.jl = Nc))
      : (this.jl = a === Bl ? (this.Kd = Kc) : (this.Kd = Ec));
    this.hs = 0;
    this.hr = NaN;
    this.te = this.Sr = this.se = null;
    this.zt = this.Xk = 0;
    b && Object.assign(this, b);
  }
  Al.prototype.copy = function () {
    var a = new Al();
    a.pa = this.pa;
    a.Wk = this.Wk;
    a.Kd = this.Kd.L();
    a.jl = this.jl.L();
    a.hs = this.hs;
    a.hr = this.hr;
    null !== this.se && (a.se = this.se.copy());
    a.Sr = this.Sr;
    return a;
  };
  t = Al.prototype;
  t.freeze = function () {
    this.u = !0;
    null !== this.se && this.se.freeze();
    return this;
  };
  t.la = function () {
    Object.isFrozen(this) && v("cannot thaw constant: " + this);
    this.u = !1;
    null !== this.se && this.se.la();
    return this;
  };
  t.pb = function (a) {
    a.classType === Al ? (this.type = a) : Ea(this, a);
  };
  t.toString = function () {
    var a = "Brush(";
    if (this.type === Hl) a += this.color;
    else if (
      ((a =
        this.type === Kl
          ? a + "Linear "
          : this.type === Bl
          ? a + "Radial "
          : this.type === Jl
          ? a + "Pattern "
          : a + "(unknown) "),
      (a += this.start + " " + this.end),
      null !== this.colorStops)
    )
      for (var b = this.colorStops.iterator; b.next(); )
        a += " " + b.key + ":" + b.value;
    return a + ")";
  };
  t.addColorStop = function (a, b) {
    this.u && xa(this);
    ("number" !== typeof a || !isFinite(a) || 1 < a || 0 > a) &&
      Aa(a, "0 <= loc <= 1", Al, "addColorStop:loc");
    A(b, "string", Al, "addColorStop:color");
    G &&
      !om(b) &&
      v('Color "' + b + '" is not a valid color string for Brush.addColorStop');
    null === this.se && (this.se = new xb());
    this.se.add(a, b);
    this.pa === Hl && (this.type = Kl);
    this.te = null;
    return this;
  };
  function om(a) {
    if ("black" === a) return !0;
    if ("" === a) return !1;
    G && A(a, "string", Al, "isValidColor");
    mm || (nm(), (mm = !0));
    var b = pm;
    if (null === b) return !0;
    b.fillStyle = "#000000";
    var c = b.fillStyle;
    b.fillStyle = a;
    if (b.fillStyle !== c) return !0;
    b.fillStyle = "#FFFFFF";
    c = b.fillStyle;
    b.fillStyle = a;
    return b.fillStyle !== c;
  }
  t.DA = function (a, b) {
    this.u && xa(this);
    a = void 0 === a || "number" !== typeof a ? 0.2 : a;
    b = void 0 === b ? qm : b;
    if (this.type === Hl) ci(this.color), (this.color = rm(a, b));
    else if ((this.type === Kl || this.type === Bl) && null !== this.colorStops)
      for (var c = this.colorStops.iterator; c.next(); )
        ci(c.value), this.addColorStop(c.key, rm(a, b));
    return this;
  };
  function sm(a, b, c) {
    b = void 0 === b || "number" !== typeof b ? 0.2 : b;
    c = void 0 === c ? qm : c;
    ci(a);
    return rm(b, c);
  }
  t.Dz = function (a, b) {
    this.u && xa(this);
    a = void 0 === a || "number" !== typeof a ? 0.2 : a;
    b = void 0 === b ? qm : b;
    if (this.type === Hl) ci(this.color), (this.color = rm(-a, b));
    else if ((this.type === Kl || this.type === Bl) && null !== this.colorStops)
      for (var c = this.colorStops.iterator; c.next(); )
        ci(c.value), this.addColorStop(c.key, rm(-a, b));
    return this;
  };
  function tm(a, b, c) {
    b = void 0 === b || "number" !== typeof b ? 0.2 : b;
    c = void 0 === c ? qm : c;
    ci(a);
    return rm(-b, c);
  }
  function um(a, b, c) {
    ci(a);
    a = vm.j;
    var d = vm.B,
      e = vm.o,
      f = vm.M;
    ci(b);
    void 0 === c && (c = 0.5);
    return (
      "rgba(" +
      Math.round((vm.j - a) * c + a) +
      ", " +
      Math.round((vm.B - d) * c + d) +
      ", " +
      Math.round((vm.o - e) * c + e) +
      ", " +
      Math.round((vm.M - f) * c + f) +
      ")"
    );
  }
  t.ly = function () {
    if (this.type === Hl) return wm(this.color);
    if ((this.type === Kl || this.type === Bl) && null !== this.colorStops) {
      var a = this.colorStops;
      if (this.type === Bl) return wm(a.first().value);
      if (null !== a.get(0.5)) return wm(a.get(0.5));
      if (2 === a.count) return (a = a.Ga()), wm(um(a[0].value, a[1].value));
      for (var b = a.iterator, c = -1, d = -1, e = 1, f = 1; b.next(); ) {
        var g = b.key,
          h = Math.abs(0.5 - b.key);
        e > f && h < e
          ? ((c = g), (e = h))
          : f >= e && h < f && ((d = g), (f = h));
      }
      c > d && ((f = c), (c = d), (d = f), (f = e));
      e = d - c;
      return wm(um(a.get(c), a.get(d), 1 - f / e));
    }
    return !1;
  };
  function wm(a) {
    if (!a) return !1;
    if (a instanceof Al) return a.ly();
    ci(a);
    return 128 > (299 * vm.j + 587 * vm.B + 114 * vm.o) / 1e3;
  }
  function rm(a, b) {
    switch (b) {
      case qm:
        b = 100 * xm(vm.j);
        var c = 100 * xm(vm.B),
          d = 100 * xm(vm.o);
        ym.j = 0.4124564 * b + 0.3575761 * c + 0.1804375 * d;
        ym.B = 0.2126729 * b + 0.7151522 * c + 0.072175 * d;
        ym.o = 0.0193339 * b + 0.119192 * c + 0.9503041 * d;
        ym.M = vm.M;
        b = zm(ym.j / Am[0]);
        c = zm(ym.B / Am[1]);
        d = zm(ym.o / Am[2]);
        Bm.j = 116 * c - 16;
        Bm.B = 500 * (b - c);
        Bm.o = 200 * (c - d);
        Bm.M = ym.M;
        Bm.j = Math.min(100, Math.max(0, Bm.j + 100 * a));
        a = (Bm.j + 16) / 116;
        b = a - Bm.o / 200;
        ym.j = Am[0] * Cm(Bm.B / 500 + a);
        ym.B = Am[1] * (Bm.j > Dm * Em ? Math.pow(a, 3) : Bm.j / Dm);
        ym.o = Am[2] * Cm(b);
        ym.M = Bm.M;
        a = -0.969266 * ym.j + 1.8760108 * ym.B + 0.041556 * ym.o;
        b = 0.0556434 * ym.j + -0.2040259 * ym.B + 1.0572252 * ym.o;
        vm.j =
          255 *
          Fm((3.2404542 * ym.j + -1.5371385 * ym.B + -0.4985314 * ym.o) / 100);
        vm.B = 255 * Fm(a / 100);
        vm.o = 255 * Fm(b / 100);
        vm.M = ym.M;
        vm.j = Math.round(vm.j);
        255 < vm.j ? (vm.j = 255) : 0 > vm.j && (vm.j = 0);
        vm.B = Math.round(vm.B);
        255 < vm.B ? (vm.B = 255) : 0 > vm.B && (vm.B = 0);
        vm.o = Math.round(vm.o);
        255 < vm.o ? (vm.o = 255) : 0 > vm.o && (vm.o = 0);
        return "rgba(" + vm.j + ", " + vm.B + ", " + vm.o + ", " + vm.M + ")";
      case Gm:
        return (
          di(),
          (ei.o = Math.min(100, Math.max(0, ei.o + 100 * a))),
          "hsla(" + ei.j + ", " + ei.B + "%, " + ei.o + "%, " + ei.M + ")"
        );
      default:
        v("Unknown color space: " + b);
    }
  }
  function ci(a) {
    mm || (nm(), (mm = !0));
    var b = pm;
    if (null !== b) {
      b.clearRect(0, 0, 1, 1);
      b.fillStyle = "#000000";
      var c = b.fillStyle;
      b.fillStyle = a;
      b.fillStyle !== c
        ? (b.fillRect(0, 0, 1, 1),
          (a = b.getImageData(0, 0, 1, 1).data),
          (vm.j = a[0]),
          (vm.B = a[1]),
          (vm.o = a[2]),
          (vm.M = a[3] / 255))
        : ((b.fillStyle = "#FFFFFF"),
          (c = b.fillStyle),
          (b.fillStyle = a),
          b.fillStyle === c &&
            G &&
            v(
              'Color "' +
                a +
                '" is not a valid color string for RGBA color conversion'
            ),
          (vm.j = 0),
          (vm.B = 0),
          (vm.o = 0),
          (vm.M = 1));
    }
  }
  function di() {
    var a = vm.j / 255,
      b = vm.B / 255,
      c = vm.o / 255,
      d = Math.max(a, b, c),
      e = Math.min(a, b, c),
      f = d - e;
    e = (d + e) / 2;
    if (0 === f) var g = (a = 0);
    else {
      switch (d) {
        case a:
          g = ((b - c) / f) % 6;
          break;
        case b:
          g = (c - a) / f + 2;
          break;
        case c:
          g = (a - b) / f + 4;
      }
      g *= 60;
      0 > g && (g += 360);
      a = f / (1 - Math.abs(2 * e - 1));
    }
    ei.j = Math.round(g);
    ei.B = Math.round(100 * a);
    ei.o = Math.round(100 * e);
    ei.M = vm.M;
  }
  function xm(a) {
    a /= 255;
    return 0.04045 >= a ? a / 12.92 : Math.pow((a + 0.055) / 1.055, 2.4);
  }
  function Fm(a) {
    return 0.0031308 >= a ? 12.92 * a : 1.055 * Math.pow(a, 1 / 2.4) - 0.055;
  }
  function zm(a) {
    return a > Em ? Math.pow(a, 1 / 3) : (Dm * a + 16) / 116;
  }
  function Cm(a) {
    var b = a * a * a;
    return b > Em ? b : (116 * a - 16) / Dm;
  }
  function bm(a, b) {
    "string" === typeof a
      ? G &&
        !om(a) &&
        v('Color "' + a + '" is not a valid color string for ' + b)
      : a instanceof Al ||
        v("Value for " + b + " must be a color string or a Brush, not " + a);
  }
  function nm() {
    pm = Wg ? new Nk(null).context : null;
  }
  oa.Object.defineProperties(Al.prototype, {
    type: {
      configurable: !0,
      get: function () {
        return this.pa;
      },
      set: function (a) {
        this.u && xa(this, a);
        cb(a, Al, Al, "type");
        this.pa = a;
        this.start.ec() &&
          (a === Kl ? (this.start = Gc) : a === Bl && (this.start = Kc));
        this.end.ec() &&
          (a === Kl ? (this.end = Nc) : a === Bl && (this.end = Kc));
        this.te = null;
      },
    },
    color: {
      configurable: !0,
      get: function () {
        return this.Wk;
      },
      set: function (a) {
        this.u && xa(this, a);
        G &&
          !om(a) &&
          v('Color "' + a + '" is not a valid color string for Brush.color');
        this.Wk = a;
        this.te = null;
      },
    },
    start: {
      configurable: !0,
      get: function () {
        return this.Kd;
      },
      set: function (a) {
        this.u && xa(this, a);
        x(a, Ib, Al, "start");
        this.Kd = a.L();
        this.te = null;
      },
    },
    end: {
      configurable: !0,
      get: function () {
        return this.jl;
      },
      set: function (a) {
        this.u && xa(this, a);
        x(a, Ib, Al, "end");
        this.jl = a.L();
        this.te = null;
      },
    },
    startRadius: {
      configurable: !0,
      get: function () {
        return this.hs;
      },
      set: function (a) {
        this.u && xa(this, a);
        D(a, Al, "startRadius");
        0 > a && Aa(a, ">= zero", Al, "startRadius");
        this.hs = a;
        this.te = null;
      },
    },
    endRadius: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.hr;
      },
      set: function (a) {
        this.u && xa(this, a);
        D(a, Al, "endRadius");
        0 > a && Aa(a, ">= zero", Al, "endRadius");
        this.hr = a;
        this.te = null;
      },
    },
    colorStops: {
      configurable: !0,
      get: function () {
        return this.se;
      },
      set: function (a) {
        this.u && xa(this, a);
        G && x(a, xb, Al, "colorStops");
        this.se = a;
        this.te = null;
      },
    },
    pattern: {
      configurable: !0,
      get: function () {
        return this.Sr;
      },
      set: function (a) {
        this.u && xa(this, a);
        this.Sr = a;
        this.te = null;
      },
    },
  });
  Al.prototype.isDark = Al.prototype.ly;
  Al.prototype.darkenBy = Al.prototype.Dz;
  Al.prototype.lightenBy = Al.prototype.DA;
  Al.prototype.addColorStop = Al.prototype.addColorStop;
  var Em = 216 / 24389,
    Dm = 24389 / 27,
    Am = [95.047, 100, 108.883],
    pm = null,
    vm = new lm(),
    ei = new lm(),
    ym = new lm(),
    Bm = new lm(),
    mm = !1;
  Al.className = "Brush";
  var Hl;
  Al.Solid = Hl = new F(Al, "Solid", 0);
  var Kl;
  Al.Linear = Kl = new F(Al, "Linear", 1);
  var Bl;
  Al.Radial = Bl = new F(Al, "Radial", 2);
  var Jl;
  Al.Pattern = Jl = new F(Al, "Pattern", 4);
  var qm;
  Al.Lab = qm = new F(Al, "Lab", 5);
  var Gm;
  Al.HSL = Gm = new F(Al, "HSL", 6);
  Al.randomColor = function (a, b) {
    void 0 === a && (a = 128);
    G &&
      (D(a, Al, "randomColor:min"),
      (0 > a || 255 < a) && Aa(a, "0 <= min <= 255", Al, "randomColor:min"));
    void 0 === b && (b = Math.max(a, 255));
    G &&
      (D(b, Al, "randomColor:max"),
      (b < a || 255 < b) && Aa(b, "min <= max <= 255", Al, "randomColor:max"));
    var c = Math.abs(b - a);
    b = Math.floor(a + Math.random() * c).toString(16);
    var d = Math.floor(a + Math.random() * c).toString(16);
    a = Math.floor(a + Math.random() * c).toString(16);
    2 > b.length && (b = "0" + b);
    2 > d.length && (d = "0" + d);
    2 > a.length && (a = "0" + a);
    return "#" + b + d + a;
  };
  Al.isValidColor = om;
  Al.lighten = function (a) {
    return sm(a);
  };
  Al.lightenBy = sm;
  Al.darken = function (a) {
    return tm(a);
  };
  Al.darkenBy = tm;
  Al.mix = um;
  Al.isDark = wm;
  function Yl() {
    this.ua = "Base";
  }
  Yl.prototype.measure = function () {};
  Yl.prototype.GA = function (a, b, c, d, e) {
    a.measure(b, c, d, e);
  };
  Yl.prototype.arrange = function () {};
  Yl.prototype.pz = function (a, b, c, d, e, f) {
    a.arrange(b, c, d, e, f);
  };
  Yl.prototype.QA = function (a) {
    a.uk();
  };
  Yl.prototype.uc = function () {};
  oa.Object.defineProperties(Yl.prototype, {
    name: {
      configurable: !0,
      get: function () {
        return this.ua;
      },
      set: function (a) {
        this.ua = a;
      },
    },
    classType: {
      configurable: !0,
      get: function () {
        return W;
      },
    },
  });
  Yl.prototype.remeasureObject = Yl.prototype.QA;
  Yl.prototype.arrangeElement = Yl.prototype.pz;
  Yl.prototype.measureElement = Yl.prototype.GA;
  Yl.className = "PanelLayout";
  function Hm() {
    this.ua = "Base";
  }
  na(Hm, Yl);
  Hm.prototype.measure = function (a, b, c, d, e, f, g) {
    var h = d.length;
    a = Im(a);
    for (var k = 0; k < h; k++) {
      var l = d[k];
      if (l.visible || l === a) {
        var m = l.margin,
          n = m.right + m.left;
        m = m.top + m.bottom;
        l.measure(b, c, f, g);
        var p = l.measuredBounds;
        n = Math.max(p.width + n, 0);
        m = Math.max(p.height + m, 0);
        p = l.position.x;
        var r = l.position.y;
        isFinite(p) || (p = 0);
        isFinite(r) || (r = 0);
        l instanceof Hf &&
          l.isGeometryPositioned &&
          ((l = l.strokeWidth / 2), (p -= l), (r -= l));
        mc(e, p, r, n, m);
      }
    }
  };
  Hm.prototype.arrange = function (a, b, c) {
    var d = b.length,
      e = a.padding;
    a = c.x - e.left;
    c = c.y - e.top;
    for (e = 0; e < d; e++) {
      var f = b[e],
        g = f.measuredBounds,
        h = f.margin,
        k = f.position.x,
        l = f.position.y;
      k = isNaN(k) ? -a : k - a;
      l = isNaN(l) ? -c : l - c;
      if (f instanceof Hf && f.isGeometryPositioned) {
        var m = f.strokeWidth / 2;
        k -= m;
        l -= m;
      }
      f.visible && f.arrange(k + h.left, l + h.top, g.width, g.height);
    }
  };
  function Jm() {
    this.ua = "Base";
  }
  na(Jm, Yl);
  Jm.prototype.measure = function (a, b, c, d, e, f, g) {
    var h = d.length;
    b = Ma();
    f = Im(a);
    for (var k = 0; k < h; k++) {
      var l = d[k];
      if (l.visible || l === f) {
        var m = vl(l, !1);
        if (m !== tg && m !== il) b.push(l);
        else {
          l.measure(Infinity, c, 0, g);
          m = l.margin;
          l = l.measuredBounds;
          var n = Math.max(l.height + m.top + m.bottom, 0);
          e.width += Math.max(l.width + m.right + m.left, 0);
          e.height = Math.max(e.height, n);
        }
      }
    }
    d = b.length;
    a.desiredSize.height
      ? (c = Math.min(a.desiredSize.height, a.maxSize.height))
      : 0 !== e.height && (c = Math.min(e.height, a.maxSize.height));
    for (a = 0; a < d; a++)
      if (((k = b[a]), k.visible || k === f))
        (m = k.margin),
          (h = m.right + m.left),
          (m = m.top + m.bottom),
          k.measure(Infinity, c, 0, g),
          (k = k.measuredBounds),
          (m = Math.max(k.height + m, 0)),
          (e.width += Math.max(k.width + h, 0)),
          (e.height = Math.max(e.height, m));
    Pa(b);
  };
  Jm.prototype.arrange = function (a, b, c) {
    for (
      var d = b.length,
        e = a.padding,
        f = e.top,
        g = a.isOpposite,
        h = g ? c.width : e.left,
        k = 0;
      k < d;
      k++
    ) {
      var l = f,
        m = b[k];
      if (m.visible) {
        var n = m.measuredBounds,
          p = m.margin,
          r = p.top + p.bottom,
          q = f + e.bottom,
          u = n.height,
          w = vl(m, !1);
        if ((isNaN(m.desiredSize.height) && w === Fd) || w === jl)
          u = Math.max(c.height - r - q, 0);
        r = u + r + q;
        q = m.alignment;
        q.Nb() && (q = a.defaultAlignment);
        q.ib() || (q = Kc);
        g && (h -= n.width + p.left + p.right);
        m.arrange(
          h + q.offsetX + p.left,
          l + q.offsetY + p.top + (c.height * q.y - r * q.y),
          n.width,
          u
        );
        g || (h += n.width + p.left + p.right);
      }
    }
  };
  function Km() {
    this.ua = "Base";
  }
  na(Km, Yl);
  Km.prototype.measure = function (a, b, c, d, e, f) {
    var g = d.length;
    c = Ma();
    for (var h = Im(a), k = 0; k < g; k++) {
      var l = d[k];
      if (l.visible || l === h) {
        var m = vl(l, !1);
        if (m !== tg && m !== jl) c.push(l);
        else {
          var n = l.margin;
          m = n.right + n.left;
          n = n.top + n.bottom;
          l.measure(b, Infinity, f, 0);
          l = l.measuredBounds;
          dc(
            e,
            Math.max(e.width, Math.max(l.width + m, 0)),
            e.height + Math.max(l.height + n, 0)
          );
        }
      }
    }
    d = c.length;
    if (0 !== d) {
      a.desiredSize.width
        ? (b = Math.min(a.desiredSize.width, a.maxSize.width))
        : 0 !== e.width && (b = Math.min(e.width, a.maxSize.width));
      for (a = 0; a < d; a++)
        if (((k = c[a]), k.visible || k === h))
          (l = k.margin),
            (g = l.right + l.left),
            (l = l.top + l.bottom),
            k.measure(b, Infinity, f, 0),
            (k = k.measuredBounds),
            (l = Math.max(k.height + l, 0)),
            (e.width = Math.max(e.width, Math.max(k.width + g, 0))),
            (e.height += l);
      Pa(c);
    }
  };
  Km.prototype.arrange = function (a, b, c) {
    for (
      var d = b.length,
        e = a.padding,
        f = e.left,
        g = a.isOpposite,
        h = g ? c.height : e.top,
        k = 0;
      k < d;
      k++
    ) {
      var l = f,
        m = b[k];
      if (m.visible) {
        var n = m.measuredBounds,
          p = m.margin,
          r = p.left + p.right,
          q = f + e.right,
          u = n.width,
          w = vl(m, !1);
        if ((isNaN(m.desiredSize.width) && w === Fd) || w === il)
          u = Math.max(c.width - r - q, 0);
        r = u + r + q;
        q = m.alignment;
        q.Nb() && (q = a.defaultAlignment);
        q.ib() || (q = Kc);
        g && (h -= n.height + p.bottom + p.top);
        m.arrange(
          l + q.offsetX + p.left + (c.width * q.x - r * q.x),
          h + q.offsetY + p.top,
          u,
          n.height
        );
        g || (h += n.height + p.bottom + p.top);
      }
    }
  };
  function Lm() {
    this.ua = "Base";
  }
  na(Lm, Yl);
  Lm.prototype.measure = function (a, b, c, d, e, f, g) {
    var h = d.length,
      k = a.vb(),
      l = k.margin,
      m = l.right + l.left,
      n = l.top + l.bottom;
    k.measure(b, c, f, g);
    var p = k.measuredBounds;
    f = p.width;
    g = p.height;
    var r = Math.max(f + m, 0);
    var q = Math.max(g + n, 0);
    var u = a.isClipping,
      w = M.allocAt(-l.left, -l.top, r, q),
      y = M.allocAt(0, 0, f, g);
    Mm(k, y, !0);
    f = y.width;
    g = y.height;
    for (var z = !0, B = Im(a), C = 0; C < h; C++) {
      var E = d[C],
        J = b,
        S = c;
      if (E !== k && (E.visible || E === B)) {
        l = E.margin;
        r = l.right + l.left;
        q = l.top + l.bottom;
        p = vl(E, !1);
        switch (p) {
          case Fd:
            J = f;
            S = g;
            break;
          case il:
            J = f;
            break;
          case jl:
            S = g;
        }
        E.measure(J, S, 0, 0);
        p = E.measuredBounds;
        r = Math.max(p.width + r, 0);
        q = Math.max(p.height + q, 0);
        J = E.alignment;
        J.Nb() && (J = a.defaultAlignment);
        J.ib() || (J = Kc);
        var aa = E.alignmentFocus;
        aa.Nb() && (aa = Kc);
        S = null;
        E instanceof W &&
          "" !== E.$e &&
          ((S = E.hb(E.$e)), S === E && (S = null));
        var Y = y.x,
          T = y.y;
        if (null !== S) {
          E.arrange(0, 0, p.width, p.height);
          l = S.actualBounds;
          l = K.allocAt(
            l.x + (aa.x * l.width - aa.offsetX),
            l.y + (aa.y * l.height - aa.offsetY)
          );
          for (S = S.panel; S !== E; ) S.transform.Ha(l), (S = S.panel);
          Y += J.x * f + J.offsetX - l.x;
          T += J.y * g + J.offsetY - l.y;
          K.free(l);
        } else
          (Y += J.x * f + J.offsetX - (aa.x * p.width + aa.offsetX) - l.left),
            (T += J.y * g + J.offsetY - (aa.y * p.height + aa.offsetY) - l.top);
        z ? ((z = !1), e.h(Y, T, r, q)) : mc(e, Y, T, r, q);
      }
    }
    z
      ? e.assign(w)
      : u
      ? e.Av(y.x, y.y, y.width, y.height)
      : mc(e, w.x, w.y, w.width, w.height);
    M.free(w);
    M.free(y);
    p = k.stretch;
    p === hl && (p = vl(k, !1));
    switch (p) {
      case tg:
        return;
      case Fd:
        if (!isFinite(b) && !isFinite(c)) return;
        break;
      case il:
        if (!isFinite(b)) return;
        break;
      case jl:
        if (!isFinite(c)) return;
    }
    p = k.measuredBounds;
    f = p.width;
    g = p.height;
    r = Math.max(f + m, 0);
    q = Math.max(g + n, 0);
    l = k.margin;
    y = M.allocAt(-l.left, -l.top, r, q);
    Mm(k, y, !0);
    f = y.width;
    g = y.height;
    for (b = 0; b < h; b++)
      (c = d[b]),
        c === k ||
          (!c.visible && c !== B) ||
          ((l = c.margin),
          (r = l.right + l.left),
          (q = l.top + l.bottom),
          (p = c.measuredBounds),
          (r = Math.max(p.width + r, 0)),
          (q = Math.max(p.height + q, 0)),
          (m = c.alignment),
          m.Nb() && (m = a.defaultAlignment),
          m.ib() || (m = Kc),
          (c = c.alignmentFocus),
          c.Nb() && (c = Kc),
          z
            ? ((z = !1),
              e.h(
                m.x * f + m.offsetX - (c.x * p.width + c.offsetX) - l.left,
                m.y * g + m.offsetY - (c.y * p.height + c.offsetY) - l.top,
                r,
                q
              ))
            : mc(
                e,
                m.x * f + m.offsetX - (c.x * p.width + c.offsetX) - l.left,
                m.y * g + m.offsetY - (c.y * p.height + c.offsetY) - l.top,
                r,
                q
              ));
    z
      ? e.assign(w)
      : u
      ? e.Av(y.x, y.y, y.width, y.height)
      : mc(e, w.x, w.y, w.width, w.height);
    M.free(y);
  };
  Lm.prototype.arrange = function (a, b, c) {
    var d = b.length,
      e = a.vb(),
      f = e.measuredBounds,
      g = f.width,
      h = f.height,
      k = a.padding;
    f = k.left;
    k = k.top;
    var l = f - c.x,
      m = k - c.y;
    e.arrange(l, m, g, h);
    g = M.allocAt(0, 0, g, h);
    Mm(e, g, !1);
    for (h = 0; h < d; h++) {
      var n = b[h];
      if (n !== e) {
        l = n.measuredBounds;
        var p = l.width,
          r = l.height;
        m = n.alignment;
        m.Nb() && (m = a.defaultAlignment);
        m.ib() || (m = Kc);
        var q = n.alignmentFocus;
        q.Nb() && (q = Kc);
        l = null;
        n instanceof W &&
          "" !== n.$e &&
          ((l = n.hb(n.$e)), l === n && (l = null));
        if (null !== l) {
          var u = l.actualBounds;
          q = K.allocAt(
            u.x + (q.x * u.width - q.offsetX),
            u.y + (q.y * u.height - q.offsetY)
          );
          for (l = l.panel; l !== n; ) l.transform.Ha(q), (l = l.panel);
          l = m.x * g.width + m.offsetX - q.x;
          m = m.y * g.height + m.offsetY - q.y;
          K.free(q);
        } else
          (l = m.x * g.width + m.offsetX - (q.x * p + q.offsetX)),
            (m = m.y * g.height + m.offsetY - (q.y * r + q.offsetY));
        l += g.x - c.x;
        m += g.y - c.y;
        n.visible && n.arrange(f + l, k + m, p, r);
      }
    }
    M.free(g);
  };
  function Mm(a, b, c) {
    var d = null;
    a instanceof W && "" !== a.$e && ((d = a.hb(a.$e)), d === a && (d = null));
    if (null !== d)
      for (
        c && a.arrange(0, 0, b.width, b.height),
          b.assign(d.actualBounds),
          d = d.panel;
        d !== a;

      )
        d.transform.Hq(b), (d = d.panel);
  }
  function Nm() {
    this.ua = "Base";
  }
  na(Nm, Yl);
  Nm.prototype.measure = function (a, b, c, d, e, f, g) {
    var h = d.length,
      k = a.vb(),
      l = k.margin,
      m = b,
      n = c,
      p = l.right + l.left,
      r = l.top + l.bottom;
    k.measure(b, c, f, g);
    l = k.measuredBounds;
    var q = 0,
      u = null;
    k instanceof Hf && ((u = k), (q = u.strokeWidth * u.scale));
    var w = Math.max(l.width + p, 0);
    l = Math.max(l.height + r, 0);
    var y = Om(k),
      z = y.x * w + y.offsetX;
    y = y.y * l + y.offsetY;
    var B = Pm(k),
      C = B.x * w + B.offsetX;
    B = B.y * l + B.offsetY;
    isFinite(b) && (m = Math.max(Math.abs(z - C) - q, 0));
    isFinite(c) && (n = Math.max(Math.abs(y - B) - q, 0));
    q = Gb.alloc();
    q.h(0, 0);
    a = Im(a);
    for (B = 0; B < h; B++)
      (y = d[B]),
        y === k ||
          (!y.visible && y !== a) ||
          ((l = y.margin),
          (w = l.right + l.left),
          (z = l.top + l.bottom),
          y.measure(m, n, 0, 0),
          (l = y.measuredBounds),
          (w = Math.max(l.width + w, 0)),
          (l = Math.max(l.height + z, 0)),
          q.h(Math.max(w, q.width), Math.max(l, q.height)));
    if (1 === h) (e.width = w), (e.height = l), Gb.free(q);
    else {
      y = Om(k);
      B = Pm(k);
      h = d = 0;
      B.x !== y.x &&
        B.y !== y.y &&
        ((d = q.width / Math.abs(B.x - y.x)),
        (h = q.height / Math.abs(B.y - y.y)));
      Gb.free(q);
      q = 0;
      null !== u &&
        ((q = u.strokeWidth * u.scale),
        ug(u) === vg && (d = h = Math.max(d, h)));
      d += Math.abs(y.offsetX) + Math.abs(B.offsetX) + q;
      h += Math.abs(y.offsetY) + Math.abs(B.offsetY) + q;
      u = k.stretch;
      u === hl && (u = vl(k, !1));
      switch (u) {
        case tg:
          g = f = 0;
          break;
        case Fd:
          isFinite(b) && (d = b);
          isFinite(c) && (h = c);
          break;
        case il:
          isFinite(b) && (d = b);
          g = 0;
          break;
        case jl:
          (f = 0), isFinite(c) && (h = c);
      }
      k.uk();
      k.measure(d, h, f, g);
      e.width = k.measuredBounds.width + p;
      e.height = k.measuredBounds.height + r;
    }
  };
  Nm.prototype.arrange = function (a, b) {
    var c = b.length,
      d = a.vb(),
      e = d.measuredBounds,
      f = M.alloc();
    f.h(0, 0, 1, 1);
    var g = d.margin,
      h = g.left;
    g = g.top;
    var k = a.padding,
      l = k.left;
    k = k.top;
    d.arrange(l + h, k + g, e.width, e.height);
    var m = Om(d),
      n = Pm(d),
      p = m.y * e.height + m.offsetY,
      r = n.x * e.width + n.offsetX;
    n = n.y * e.height + n.offsetY;
    f.x = m.x * e.width + m.offsetX;
    f.y = p;
    mc(f, r, n, 0, 0);
    f.x += h + l;
    f.y += g + k;
    for (e = 0; e < c; e++)
      (h = b[e]),
        h !== d &&
          ((l = h.measuredBounds),
          (g = h.margin),
          (k = Math.max(l.width + g.right + g.left, 0)),
          (m = Math.max(l.height + g.top + g.bottom, 0)),
          (p = h.alignment),
          p.Nb() && (p = a.defaultAlignment),
          p.ib() || (p = Kc),
          (k = f.width * p.x + p.offsetX - k * p.x + g.left + f.x),
          (g = f.height * p.y + p.offsetY - m * p.y + g.top + f.y),
          h.visible &&
            (nc(f.x, f.y, f.width, f.height, k, g, l.width, l.height)
              ? h.arrange(k, g, l.width, l.height)
              : h.arrange(
                  k,
                  g,
                  l.width,
                  l.height,
                  new M(f.x, f.y, f.width, f.height)
                )));
    M.free(f);
  };
  function Qm() {
    this.ua = "Base";
    this.name = "Table";
  }
  na(Qm, Yl);
  Qm.prototype.measure = function (a, b, c, d, e) {
    for (var f = d.length, g = Ma(), h = Ma(), k = 0; k < f; k++) {
      var l = d[k],
        m = l instanceof W ? l : null;
      if (
        null === m ||
        (m.type !== W.TableRow && m.type !== W.TableColumn) ||
        !l.visible
      )
        g.push(l);
      else {
        G &&
          (m.desiredSize.s() &&
            v(
              m.toString() +
                " TableRow/TableColumn Panels cannot set a desiredSize: " +
                m.desiredSize.toString()
            ),
          m.minSize.D(Rb) ||
            v(
              m.toString() +
                " TableRow/TableColumn Panels cannot set a minSize: " +
                m.minSize.toString()
            ),
          m.maxSize.D(Zb) ||
            v(
              m.toString() +
                " TableRow/TableColumn Panels cannot set a maxSize: " +
                m.maxSize.toString()
            ));
        h.push(m);
        for (var n = m.W.m, p = n.length, r = 0; r < p; r++) {
          var q = n[r];
          m.type === W.TableRow
            ? (q.row = l.row)
            : m.type === W.TableColumn && (q.column = l.column);
          g.push(q);
        }
      }
    }
    f = g.length;
    0 === f && (a.getRowDefinition(0), a.getColumnDefinition(0));
    for (var u = [], w = 0; w < f; w++) {
      var y = g[w];
      vj(y, !0);
      wl(y, !0);
      u[y.row] || (u[y.row] = []);
      u[y.row][y.column] || (u[y.row][y.column] = []);
      u[y.row][y.column].push(y);
    }
    Pa(g);
    var z = Ma(),
      B = Ma(),
      C = Ma(),
      E = { count: 0 },
      J = { count: 0 },
      S = b,
      aa = c,
      Y = a.Lb;
    f = Y.length;
    for (var T = 0; T < f; T++) {
      var P = Y[T];
      void 0 !== P && (P.actual = 0);
    }
    Y = a.Gb;
    f = Y.length;
    for (var ma = 0; ma < f; ma++) (P = Y[ma]), void 0 !== P && (P.actual = 0);
    for (var ia = u.length, Ba = 0, Na = 0; Na < ia; Na++)
      u[Na] && (Ba = Math.max(Ba, u[Na].length));
    var sb = Math.min(a.topIndex, ia - 1),
      tb = Math.min(a.leftIndex, Ba - 1),
      Xa = 0;
    ia = u.length;
    for (var Qb = Im(a), Ub = 0; Ub < ia; Ub++)
      if (u[Ub]) {
        Ba = u[Ub].length;
        var jd = a.getRowDefinition(Ub);
        jd.actual = 0;
        for (var jc = (jd.ic = 0); jc < Ba; jc++)
          if (u[Ub][jc]) {
            var yc = a.getColumnDefinition(jc);
            void 0 === z[jc] && ((yc.actual = 0), (yc.ic = 0), (z[jc] = !0));
            for (var Oc = u[Ub][jc], ze = Oc.length, Pf = 0; Pf < ze; Pf++) {
              var Jb = Oc[Pf];
              if (Jb.visible || Jb === Qb) {
                var Ae = 1 < Jb.rowSpan || 1 < Jb.columnSpan;
                Ae && (Ub < sb || jc < tb || B.push(Jb));
                var Bg = Jb.margin,
                  Ih = Bg.right + Bg.left,
                  Jh = Bg.top + Bg.bottom;
                var fb = Ol(Jb, jd, yc, !1);
                var Pi = Jb.desiredSize,
                  wk = !isNaN(Pi.height),
                  Cg = !isNaN(Pi.width) && wk;
                Ae ||
                  fb === tg ||
                  Cg ||
                  Ub < sb ||
                  jc < tb ||
                  (void 0 !== E[jc] ||
                    (fb !== Fd && fb !== il) ||
                    ((E[jc] = -1), E.count++),
                  void 0 !== J[Ub] ||
                    (fb !== Fd && fb !== jl) ||
                    ((J[Ub] = -1), J.count++),
                  C.push(Jb));
                Jb.measure(Infinity, Infinity, 0, 0);
                if (!(Ub < sb || jc < tb)) {
                  var Bd = Jb.measuredBounds,
                    zc = Math.max(Bd.width + Ih, 0),
                    Qf = Math.max(Bd.height + Jh, 0);
                  if (1 === Jb.rowSpan && (fb === tg || fb === il)) {
                    P = a.getRowDefinition(Ub);
                    var Ac = P.Pc();
                    Xa = Math.max(Qf - P.actual, 0);
                    Xa + Ac > aa && (Xa = Math.max(aa - Ac, 0));
                    var Dg = 0 === P.na;
                    P.ic = P.ic + Xa;
                    P.actual = P.na + Xa;
                    aa = Math.max(aa - (Xa + (Dg ? Ac : 0)), 0);
                  }
                  if (1 === Jb.columnSpan && (fb === tg || fb === jl)) {
                    P = a.getColumnDefinition(jc);
                    var Kh = P.Pc();
                    Xa = Math.max(zc - P.actual, 0);
                    Xa + Kh > S && (Xa = Math.max(S - Kh, 0));
                    var Un = 0 === P.na;
                    P.ic = P.ic + Xa;
                    P.actual = P.na + Xa;
                    S = Math.max(S - (Xa + (Un ? Kh : 0)), 0);
                  }
                  Ae && Jb.uk();
                }
              }
            }
          }
      }
    Pa(z);
    var Wd = 0,
      Be = 0;
    f = a.columnCount;
    for (var Eg = 0; Eg < f; Eg++) {
      var of = a.Gb[Eg];
      void 0 !== of &&
        ((Wd += isNaN(of.Bc) ? of.ic : of.Bc), 0 !== of.ic && (Wd += of.Pc()));
    }
    f = a.rowCount;
    for (var Xd = 0; Xd < f; Xd++) {
      var Od = a.Lb[Xd];
      void 0 !== Od &&
        ((Be += isNaN(Od.Bc) ? Od.ic : Od.Bc), 0 !== Od.ic && (Be += Od.Pc()));
    }
    S = Math.max(b - Wd, 0);
    var rc = (aa = Math.max(c - Be, 0)),
      Lh = S;
    f = C.length;
    for (var Mh = 0; Mh < f; Mh++) {
      var sc = C[Mh],
        Qi = a.getRowDefinition(sc.row),
        Ce = a.getColumnDefinition(sc.column),
        pf = sc.measuredBounds,
        $c = sc.margin,
        Ri = $c.right + $c.left,
        xk = $c.top + $c.bottom;
      E[sc.column] =
        0 === Ce.ic && void 0 !== E[sc.column]
          ? Math.max(pf.width + Ri, E[sc.column])
          : null;
      J[sc.row] =
        0 === Qi.ic && void 0 !== J[sc.row]
          ? Math.max(pf.height + xk, J[sc.row])
          : null;
    }
    var Yd = 0,
      Nh = 0,
      Rf;
    for (Rf in J) "count" !== Rf && (Yd += J[Rf]);
    for (Rf in E) "count" !== Rf && (Nh += E[Rf]);
    for (var qb = Gb.alloc(), Vb = 0; Vb < f; Vb++) {
      var Wb = C[Vb];
      if (Wb.visible || Wb === Qb) {
        var Bc = a.getRowDefinition(Wb.row),
          Hc = a.getColumnDefinition(Wb.column),
          Zd = 0;
        isFinite(Hc.width)
          ? (Zd = Hc.width)
          : (isFinite(S) && null !== E[Wb.column]
              ? 0 === Nh
                ? (Zd = Hc.actual + S)
                : (Zd = (E[Wb.column] / Nh) * Lh)
              : null !== E[Wb.column]
              ? (Zd = S)
              : (Zd = Hc.actual || S),
            (Zd = Math.max(0, Zd - Hc.Pc())));
        var Ve = 0;
        isFinite(Bc.height)
          ? (Ve = Bc.height)
          : (isFinite(aa) && null !== J[Wb.row]
              ? 0 === Yd
                ? (Ve = Bc.actual + aa)
                : (Ve = (J[Wb.row] / Yd) * rc)
              : null !== J[Wb.row]
              ? (Ve = aa)
              : (Ve = Bc.actual || aa),
            (Ve = Math.max(0, Ve - Bc.Pc())));
        qb.h(
          Math.max(Hc.minimum, Math.min(Zd, Hc.maximum)),
          Math.max(Bc.minimum, Math.min(Ve, Bc.maximum))
        );
        fb = Ol(Wb, Bc, Hc, !1);
        switch (fb) {
          case il:
            qb.height = Math.max(qb.height, Bc.actual + aa);
            break;
          case jl:
            qb.width = Math.max(qb.width, Hc.actual + S);
        }
        var Fg = Wb.margin,
          Si = Fg.right + Fg.left,
          Ti = Fg.top + Fg.bottom;
        Wb.uk();
        Wb.measure(qb.width, qb.height, Hc.minimum, Bc.minimum);
        var Ui = Wb.measuredBounds,
          tc = Math.max(Ui.width + Si, 0),
          qf = Math.max(Ui.height + Ti, 0);
        isFinite(S) && (tc = Math.min(tc, qb.width));
        isFinite(aa) && (qf = Math.min(qf, qb.height));
        var rf = 0;
        rf = Bc.actual;
        Bc.actual = Math.max(Bc.actual, qf);
        Bc.ic = Math.max(Bc.ic, qf);
        Xa = Bc.actual - rf;
        aa = Math.max(aa - Xa, 0);
        null === J[Wb.row] && (rc = Math.max(rc - Xa, 0));
        rf = Hc.actual;
        Hc.actual = Math.max(Hc.actual, tc);
        Hc.ic = Math.max(Hc.ic, tc);
        Xa = Hc.actual - rf;
        S = Math.max(S - Xa, 0);
        null === E[Wb.column] && (Lh = Math.max(Lh - Xa, 0));
      }
    }
    Pa(C);
    var ad = Gb.alloc(),
      De = Ma(),
      Cd = Ma();
    f = B.length;
    if (0 !== f)
      for (var Ee = 0; Ee < ia; Ee++)
        if (u[Ee]) {
          Ba = u[Ee].length;
          var yk = a.getRowDefinition(Ee);
          De[Ee] = yk.actual;
          for (var Sf = 0; Sf < Ba; Sf++)
            if (u[Ee][Sf]) {
              var zk = a.getColumnDefinition(Sf);
              Cd[Sf] = zk.actual;
            }
        }
    for (var Tf = 0; Tf < f; Tf++) {
      var Za = B[Tf];
      if (Za.visible || Za === Qb) {
        var $d = a.getRowDefinition(Za.row),
          Hb = a.getColumnDefinition(Za.column);
        qb.h(
          Math.max(Hb.minimum, Math.min(b, Hb.maximum)),
          Math.max($d.minimum, Math.min(c, $d.maximum))
        );
        fb = Ol(Za, $d, Hb, !1);
        switch (fb) {
          case Fd:
            0 !== Cd[Hb.index] && (qb.width = Math.min(qb.width, Cd[Hb.index]));
            0 !== De[$d.index] &&
              (qb.height = Math.min(qb.height, De[$d.index]));
            break;
          case il:
            0 !== Cd[Hb.index] && (qb.width = Math.min(qb.width, Cd[Hb.index]));
            break;
          case jl:
            0 !== De[$d.index] &&
              (qb.height = Math.min(qb.height, De[$d.index]));
        }
        isFinite(Hb.width) && (qb.width = Hb.width);
        isFinite($d.height) && (qb.height = $d.height);
        ad.h(0, 0);
        for (
          var Oh = Hb.minimum, ae = $d.minimum, Uf = 1;
          Uf < Za.rowSpan && !(Za.row + Uf >= a.rowCount);
          Uf++
        )
          (P = a.getRowDefinition(Za.row + Uf)),
            (Xa = 0),
            (Xa =
              fb === Fd || fb === jl
                ? Math.max(
                    P.minimum,
                    0 === De[Za.row + Uf]
                      ? P.maximum
                      : Math.min(De[Za.row + Uf], P.maximum)
                  )
                : Math.max(
                    P.minimum,
                    isNaN(P.Bc) ? P.maximum : Math.min(P.Bc, P.maximum)
                  )),
            (ad.height += Xa),
            (ae += P.minimum);
        for (
          var Dd = 1;
          Dd < Za.columnSpan && !(Za.column + Dd >= a.columnCount);
          Dd++
        )
          (P = a.getColumnDefinition(Za.column + Dd)),
            (Xa = 0),
            (Xa =
              fb === Fd || fb === il
                ? Math.max(
                    P.minimum,
                    0 === Cd[Za.column + Dd]
                      ? P.maximum
                      : Math.min(Cd[Za.column + Dd], P.maximum)
                  )
                : Math.max(
                    P.minimum,
                    isNaN(P.Bc) ? P.maximum : Math.min(P.Bc, P.maximum)
                  )),
            (ad.width += Xa),
            (Oh += P.minimum);
        qb.width += ad.width;
        qb.height += ad.height;
        var Vf = Za.margin,
          Vi = Vf.right + Vf.left,
          Fe = Vf.top + Vf.bottom;
        Za.measure(qb.width, qb.height, Oh, ae);
        for (
          var Gg = Za.measuredBounds,
            Wf = Math.max(Gg.width + Vi, 0),
            Wi = Math.max(Gg.height + Fe, 0),
            sf = 0,
            kd = 0;
          kd < Za.rowSpan && !(Za.row + kd >= a.rowCount);
          kd++
        )
          (P = a.getRowDefinition(Za.row + kd)), (sf += P.total || 0);
        if (sf < Wi) {
          var Ed = Wi - sf,
            Xf = Wi - sf;
          if (null !== Za.spanAllocation)
            for (
              var Yf = Za.spanAllocation, Ge = 0;
              Ge < Za.rowSpan && !(0 >= Ed) && !(Za.row + Ge >= a.rowCount);
              Ge++
            ) {
              P = a.getRowDefinition(Za.row + Ge);
              var Pd = P.na || 0,
                Ph = Yf(Za, P, Xf);
              G &&
                "number" !== typeof Ph &&
                v(Za + " spanAllocation does not return a number: " + Ph);
              P.actual = Math.min(P.maximum, Pd + Ph);
              P.na !== Pd && (Ed -= P.na - Pd);
            }
          for (; 0 < Ed; ) {
            var We = P.na || 0;
            isNaN(P.height) &&
              P.maximum > We &&
              ((P.actual = Math.min(P.maximum, We + Ed)),
              P.na !== We && (Ed -= P.na - We));
            if (0 === P.index) break;
            P = a.getRowDefinition(P.index - 1);
          }
        }
        for (
          var Qh = 0, Rh = 0;
          Rh < Za.columnSpan && !(Za.column + Rh >= a.columnCount);
          Rh++
        )
          (P = a.getColumnDefinition(Za.column + Rh)), (Qh += P.total || 0);
        if (Qh < Wf) {
          var ld = Wf - Qh,
            Xi = Wf - Qh;
          if (null !== Za.spanAllocation)
            for (
              var Vn = Za.spanAllocation, Sh = 0;
              Sh < Za.columnSpan &&
              !(0 >= ld) &&
              !(Za.column + Sh >= a.columnCount);
              Sh++
            ) {
              P = a.getColumnDefinition(Za.column + Sh);
              var Wn = P.na || 0,
                Xn = Vn(Za, P, Xi);
              G &&
                "number" !== typeof Xn &&
                v(Za + " spanAllocation does not return a number: " + Xn);
              P.actual = Math.min(P.maximum, Wn + Xn);
              P.na !== Wn && (ld -= P.na - Wn);
            }
          for (; 0 < ld; ) {
            var Ak = P.na || 0;
            isNaN(P.width) &&
              P.maximum > Ak &&
              ((P.actual = Math.min(P.maximum, Ak + ld)),
              P.na !== Ak && (ld -= P.na - Ak));
            if (0 === P.index) break;
            P = a.getColumnDefinition(P.index - 1);
          }
        }
      }
    }
    Pa(B);
    Gb.free(ad);
    Gb.free(qb);
    void 0 !== De && Pa(De);
    void 0 !== Cd && Pa(Cd);
    var Hg = 0,
      Ig = 0,
      Bk = a.desiredSize,
      zr = a.maxSize;
    fb = vl(a, !0);
    var Yi = (Be = Wd = 0),
      Zi = 0;
    f = a.columnCount;
    for (var Ck = 0; Ck < f; Ck++)
      void 0 !== a.Gb[Ck] &&
        ((P = a.getColumnDefinition(Ck)),
        isFinite(P.width)
          ? ((Yi += P.width), (Yi += P.Pc()))
          : Rm(P) === Sm
          ? ((Yi += P.na), (Yi += P.Pc()))
          : 0 !== P.na && ((Wd += P.na), (Wd += P.Pc())));
    isFinite(Bk.width)
      ? (Hg = Math.min(Bk.width, zr.width))
      : (Hg = fb !== tg && isFinite(b) ? b : Wd);
    Hg = Math.max(Hg, a.minSize.width);
    Hg = Math.max(Hg - Yi, 0);
    for (var vu = 0 === Wd ? 1 : Math.max(Hg / Wd, 1), Ek = 0; Ek < f; Ek++)
      void 0 !== a.Gb[Ek] &&
        ((P = a.getColumnDefinition(Ek)),
        isFinite(P.width) || Rm(P) === Sm || (P.actual = P.na * vu),
        (P.position = e.width),
        0 !== P.na && ((e.width += P.na), (e.width += P.Pc())));
    f = a.rowCount;
    for (var Fk = 0; Fk < f; Fk++)
      void 0 !== a.Lb[Fk] &&
        ((P = a.getRowDefinition(Fk)),
        isFinite(P.height)
          ? ((Zi += P.height), (Zi += P.Pc()))
          : Rm(P) === Sm
          ? ((Zi += P.na), (Zi += P.Pc()))
          : 0 !== P.na && ((Be += P.na), 0 !== P.na && (Be += P.Pc())));
    isFinite(Bk.height)
      ? (Ig = Math.min(Bk.height, zr.height))
      : (Ig = fb !== tg && isFinite(c) ? c : Be);
    Ig = Math.max(Ig, a.minSize.height);
    Ig = Math.max(Ig - Zi, 0);
    for (var wu = 0 === Be ? 1 : Math.max(Ig / Be, 1), Gk = 0; Gk < f; Gk++)
      void 0 !== a.Lb[Gk] &&
        ((P = a.getRowDefinition(Gk)),
        isFinite(P.height) || Rm(P) === Sm || (P.actual = P.na * wu),
        (P.position = e.height),
        0 !== P.na && ((e.height += P.na), 0 !== P.na && (e.height += P.Pc())));
    f = h.length;
    for (var Yn = 0; Yn < f; Yn++) {
      var $i = h[Yn],
        Zn = 0,
        $n = 0;
      $i.type === W.TableRow
        ? ((Zn = e.width), (P = a.getRowDefinition($i.row)), ($n = P.actual))
        : ((P = a.getColumnDefinition($i.column)),
          (Zn = P.actual),
          ($n = e.height));
      $i.measuredBounds.h(0, 0, Zn, $n);
      vj($i, !1);
    }
    Pa(h);
    a.np = u;
  };
  Qm.prototype.arrange = function (a, b, c) {
    var d = b.length,
      e = a.padding,
      f = e.left;
    e = e.top;
    for (var g = a.np, h, k, l = g.length, m = 0, n = 0; n < l; n++)
      g[n] && (m = Math.max(m, g[n].length));
    k = a.Lb;
    h = a.Gb;
    for (
      n = Math.min(a.topIndex, l - 1);
      n !== l && (void 0 === k[n] || 0 === k[n].na);

    )
      n++;
    n = Math.max(Math.min(n, l - 1), 0);
    n = -k[n].position;
    for (
      var p = Math.min(a.leftIndex, m - 1);
      p !== m && (void 0 === h[p] || 0 === h[p].na);

    )
      p++;
    p = Math.max(Math.min(p, m - 1), 0);
    p = -h[p].position;
    for (var r = 0, q = 0; r !== l && void 0 === k[r]; ) r++;
    for (; q !== l && void 0 === h[q]; ) q++;
    m = a.part;
    a.getRowDefinition(r);
    a.getColumnDefinition(q);
    for (var u = 0; u < b.length; u++) {
      var w = b[u];
      if (
        w instanceof W &&
        w.visible &&
        (w.type === W.TableRow || w.type === W.TableColumn)
      ) {
        if (w.type === W.TableRow) {
          h = a.getRowDefinition(w.row);
          var y = a.getColumnDefinition(q);
        } else
          (h = a.getRowDefinition(r)), (y = a.getColumnDefinition(w.column));
        k = h.position + n + e;
        0 !== h.na && (k += h.$p(r));
        h = y.position + p + f;
        0 !== y.na && (h += y.$p(q));
        y = w.measuredBounds;
        w.tl();
        w.actualBounds.la();
        var z = w.actualBounds,
          B = M.allocAt(z.x, z.y, z.width, z.height);
        z.x = w.type === W.TableRow ? f : h;
        z.y = w.type === W.TableColumn ? e : k;
        z.width = y.width;
        z.height = y.height;
        w.actualBounds.freeze();
        wl(w, !1);
        gc(B, z) || null === m || (m.Lh(), w.Po(m));
        M.free(B);
      }
    }
    u = Gb.alloc();
    for (w = 0; w < l; w++)
      if (g[w])
        for (
          m = g[w].length,
            y = a.getRowDefinition(w),
            k = y.position + n + e,
            0 !== y.na && (k += y.$p(r)),
            z = 0;
          z < m;
          z++
        )
          if (g[w][z]) {
            B = a.getColumnDefinition(z);
            h = B.position + p + f;
            0 !== B.na && (h += B.$p(q));
            for (var C = g[w][z], E = C.length, J = 0; J < E; J++) {
              var S = C[J],
                aa = S.measuredBounds;
              u.h(0, 0);
              for (var Y = 1; Y < S.rowSpan && !(w + Y >= a.rowCount); Y++) {
                var T = a.getRowDefinition(w + Y);
                0 !== T.na && (u.height += T.total);
              }
              for (Y = 1; Y < S.columnSpan && !(z + Y >= a.columnCount); Y++)
                (T = a.getColumnDefinition(z + Y)),
                  0 !== T.na && (u.width += T.total);
              var P = B.na + u.width,
                ma = y.na + u.height;
              Y = h;
              T = k;
              var ia = P,
                Ba = ma,
                Na = h,
                sb = k,
                tb = P,
                Xa = ma;
              h + P > c.width && (tb = Math.max(c.width - h, 0));
              k + ma > c.height && (Xa = Math.max(c.height - k, 0));
              var Qb = S.alignment;
              if (Qb.Nb()) {
                Qb = a.defaultAlignment;
                Qb.ib() || (Qb = Kc);
                var Ub = Qb.x;
                var jd = Qb.y;
                var jc = Qb.offsetX;
                Qb = Qb.offsetY;
                var yc = B.alignment,
                  Oc = y.alignment;
                yc.ib() && ((Ub = yc.x), (jc = yc.offsetX));
                Oc.ib() && ((jd = Oc.y), (Qb = Oc.offsetY));
              } else
                (Ub = Qb.x), (jd = Qb.y), (jc = Qb.offsetX), (Qb = Qb.offsetY);
              if (isNaN(Ub) || isNaN(jd)) (jd = Ub = 0.5), (Qb = jc = 0);
              yc = aa.width;
              Oc = aa.height;
              var ze = S.margin,
                Pf = ze.left + ze.right,
                Jb = ze.top + ze.bottom,
                Ae = Ol(S, y, B, !1);
              !isNaN(S.desiredSize.width) ||
                (Ae !== Fd && Ae !== il) ||
                (yc = Math.max(P - Pf, 0));
              !isNaN(S.desiredSize.height) ||
                (Ae !== Fd && Ae !== jl) ||
                (Oc = Math.max(ma - Jb, 0));
              P = S.maxSize;
              ma = S.minSize;
              yc = Math.min(P.width, yc);
              Oc = Math.min(P.height, Oc);
              yc = Math.max(ma.width, yc);
              Oc = Math.max(ma.height, Oc);
              P = Oc + Jb;
              Y += ia * Ub - (yc + Pf) * Ub + jc + ze.left;
              T += Ba * jd - P * jd + Qb + ze.top;
              S.visible &&
                (nc(Na, sb, tb, Xa, Y, T, aa.width, aa.height)
                  ? S.arrange(Y, T, yc, Oc)
                  : S.arrange(Y, T, yc, Oc, new M(Na, sb, tb, Xa)));
            }
          }
    Gb.free(u);
    for (a = 0; a < d; a++)
      (c = b[a]),
        (f = c instanceof W ? c : null),
        null === f ||
          (f.type !== W.TableRow && f.type !== W.TableColumn) ||
          ((f = c.actualBounds),
          c.naturalBounds.la(),
          c.naturalBounds.h(0, 0, f.width, f.height),
          c.naturalBounds.freeze());
  };
  function Tm() {
    this.ua = "Base";
  }
  na(Tm, Yl);
  Tm.prototype.measure = function () {};
  Tm.prototype.arrange = function () {};
  function Um() {
    this.ua = "Base";
  }
  na(Um, Yl);
  Um.prototype.measure = function () {};
  Um.prototype.arrange = function () {};
  function Vm() {
    this.ua = "Base";
  }
  na(Vm, Yl);
  Vm.prototype.measure = function (a, b, c, d, e, f, g) {
    1 < d.length &&
      v("Viewbox Panel cannot contain more than one GraphObject.");
    d = d[0];
    d.Aa = 1;
    d.uk();
    d.measure(Infinity, Infinity, f, g);
    var h = d.measuredBounds,
      k = d.margin,
      l = k.right + k.left;
    k = k.top + k.bottom;
    if (isFinite(b) || isFinite(c)) {
      var m = d.scale,
        n = h.width;
      h = h.height;
      var p = Math.max(b - l, 0),
        r = Math.max(c - k, 0),
        q = 1;
      a.viewboxStretch === vg
        ? 0 !== n && 0 !== h && (q = Math.min(p / n, r / h))
        : 0 !== n && 0 !== h && (q = Math.max(p / n, r / h));
      0 === q && (q = 1e-4);
      d.Aa *= q;
      m !== d.scale && (vj(d, !0), d.measure(Infinity, Infinity, f, g));
    }
    h = d.measuredBounds;
    e.width = isFinite(b) ? b : Math.max(h.width + l, 0);
    e.height = isFinite(c) ? c : Math.max(h.height + k, 0);
  };
  Vm.prototype.arrange = function (a, b, c) {
    b = b[0];
    var d = b.measuredBounds,
      e = b.margin,
      f = Math.max(d.width + (e.right + e.left), 0);
    e = Math.max(d.height + (e.top + e.bottom), 0);
    var g = b.alignment;
    g.Nb() && (g = a.defaultAlignment);
    g.ib() || (g = Kc);
    b.arrange(
      c.width * g.x - f * g.x + g.offsetX,
      c.height * g.y - e * g.y + g.offsetY,
      d.width,
      d.height
    );
  };
  function Wm() {
    this.ua = "Base";
  }
  na(Wm, Yl);
  Wm.prototype.measure = function () {};
  Wm.prototype.arrange = function () {};
  Wm.prototype.uc = function (a, b, c) {
    c = a.If() * c.scale;
    0 >= c && (c = 1);
    var d = a.gridCellSize,
      e = d.width;
    d = d.height;
    var f = a.naturalBounds,
      g = a.actualBounds,
      h = f.width,
      k = f.height,
      l = Math.ceil(h / e),
      m = Math.ceil(k / d),
      n = a.gridOrigin,
      p = n.x;
    n = n.y;
    b.save();
    b.beginPath();
    b.rect(0, 0, h, k);
    b.clip();
    for (var r = [], q = a.W.m, u = q.length, w = 0; w < u; w++) {
      var y = q[w],
        z = [];
      r.push(z);
      if (y.visible) {
        var B = y.interval;
        if (!(0 > B)) {
          y = fk(y.figure);
          for (var C = 0; C < u; C++)
            if (C !== w) {
              var E = q[C];
              E.visible &&
                fk(E.figure) === y &&
                ((E = E.interval), E > B && z.push(E));
            }
        }
      }
    }
    q = a.W.m;
    u = q.length;
    for (w = 0; w < u; w++) {
      var J = q[w];
      if (
        J.visible &&
        ((z = J.interval || 1), (y = Math.abs(z)), !(2 > e * y * c))
      ) {
        B = J.segmentIndex;
        if (!isFinite(B) || isNaN(B)) B = 0;
        0 > B && (B = y - Math.min(-B, y));
        B = Math.round(B % y);
        y = J.opacity;
        C = 1;
        if (1 !== y) {
          if (0 === y) continue;
          C = b.globalAlpha;
          b.globalAlpha = C * y;
        }
        E = r[w];
        var S = !1,
          aa = J.strokeDashArray;
        null !== aa && ((S = !0), b.As(aa, J.strokeDashOffset));
        if ("LineV" === J.figure && null !== J.stroke && 0 < J.strokeWidth) {
          b.lineWidth = J.strokeWidth;
          pi(a, b, J.stroke, !1, !1, f, g);
          b.beginPath();
          for (aa = J = Math.floor((p - e) / e); aa <= J + l; aa++) {
            var Y = aa * e + p;
            0 <= Y &&
              Y <= h &&
              Xm(aa, z, B, E) &&
              (b.moveTo(Y, 0), b.lineTo(Y, k));
          }
          b.stroke();
        } else if (
          "LineH" === J.figure &&
          null !== J.stroke &&
          0 < J.strokeWidth
        ) {
          b.lineWidth = J.strokeWidth;
          pi(a, b, J.stroke, !1, !1, f, g);
          b.beginPath();
          for (aa = J = Math.floor((n - d) / d); aa <= J + m; aa++)
            (Y = aa * d + n),
              0 <= Y &&
                Y <= k &&
                Xm(aa, z, B, E) &&
                (b.moveTo(0, Y), b.lineTo(h, Y));
          b.stroke();
        } else if ("BarV" === J.figure && null !== J.fill)
          for (
            pi(a, b, J.fill, !0, !1, f, g),
              J = J.width,
              isNaN(J) && (J = e),
              Y = aa = Math.floor((p - e) / e);
            Y <= aa + l;
            Y++
          ) {
            var T = Y * e + p;
            0 <= T + J && T <= h && Xm(Y, z, B, E) && b.fillRect(T, 0, J, k);
          }
        else if ("BarH" === J.figure && null !== J.fill)
          for (
            pi(a, b, J.fill, !0, !1, f, g),
              J = J.height,
              isNaN(J) && (J = d),
              Y = aa = Math.floor((n - d) / d);
            Y <= aa + m;
            Y++
          )
            (T = Y * d + n),
              0 <= T + J && T <= k && Xm(Y, z, B, E) && b.fillRect(0, T, h, J);
        S && b.ys();
        1 !== y && (b.globalAlpha = C);
      }
    }
    b.restore();
    b.Nc(!1);
  };
  function Xm(a, b, c, d) {
    if (0 > b) return a % b === c;
    if (a % b !== c) return !1;
    b = d.length;
    for (var e = 0; e < b; e++) if (a % d[e] === c) return !1;
    return !0;
  }
  function Ym() {
    this.ua = "Base";
  }
  na(Ym, Yl);
  Ym.prototype.measure = function (a, b, c, d, e) {
    var f = d.length;
    if (a instanceof Je || a instanceof R) {
      var g = null,
        h = null;
      a instanceof R && (g = a);
      a instanceof Je &&
        ((h = a), (g = h.adornedPart), null === a.j && (a.j = []));
      if (g instanceof R) {
        var k = g;
        if (0 === f) dc(a.naturalBounds, 0, 0), a.measuredBounds.h(0, 0, 0, 0);
        else {
          var l = a instanceof Je ? null : g.path;
          b = g.routeBounds;
          c = a.og;
          c.h(0, 0, b.width, b.height);
          var m = k.points,
            n = g.pointsCount;
          null !== h ? h.yk(!1) : null !== g && g.yk(!1);
          h = b.width;
          var p = b.height,
            r = a.j;
          r.length = 0;
          if (null !== l) {
            Zm(a, h, p, l);
            var q = l.measuredBounds;
            c.Xc(q);
            r.push(q);
          }
          q = Kb.alloc();
          for (var u = K.alloc(), w = K.alloc(), y = 0; y < f; y++) {
            var z = d[y];
            if (z !== l)
              if (z.isPanelMain && z instanceof Hf) {
                Zm(a, h, p, z);
                var B = z.measuredBounds;
                c.Xc(B);
                r.push(B);
              } else if (2 > n)
                z.measure(Infinity, Infinity, 0, 0),
                  (B = z.measuredBounds),
                  c.Xc(B),
                  r.push(B);
              else {
                var C = z.segmentIndex,
                  E = z.segmentFraction,
                  J = z.alignmentFocus;
                J.ec() && (J = Kc);
                var S = z.segmentOrientation,
                  aa = z.segmentOffset;
                if (isNaN(C)) {
                  var Y = k.ta;
                  B = Ma();
                  Y.wv(E, B);
                  var T = K.allocAt(B[0], B[1]);
                  T.add(k.i(0));
                  Y.type === N.j
                    ? T.offset(-Y.startX, -Y.startY)
                    : ((Y = Y.figures.first()),
                      null !== Y && T.offset(-Y.startX, -Y.startY));
                  Y = B[2];
                  if (S !== hg) {
                    var P = k.computeAngle(z, S, Y);
                    z.Fb = P;
                  }
                  P = T.x - b.x;
                  var ma = T.y - b.y;
                  K.free(T);
                  Pa(B);
                } else if (C < -n || C >= n)
                  (B = K.alloc()),
                    k.Ag(),
                    k.computeMidPoint(B),
                    (Y = k.midAngle),
                    S !== hg && ((P = k.computeAngle(z, S, Y)), (z.Fb = P)),
                    (P = B.x - b.x),
                    (ma = B.y - b.y),
                    K.free(B);
                else {
                  P = 0;
                  0 <= C
                    ? ((ma = m.N(C)), (B = C < n - 1 ? m.N(C + 1) : ma))
                    : ((P = n + C),
                      (ma = m.N(P)),
                      (B = 0 < P ? m.N(P - 1) : ma));
                  if (ma.$a(B)) {
                    0 <= C
                      ? ((Y = 0 < C ? m.N(C - 1) : ma),
                        (P = C < n - 2 ? m.N(C + 2) : B))
                      : ((Y = P < n - 1 ? m.N(P + 1) : ma),
                        (P = 1 < P ? m.N(P - 2) : B));
                    T = Y.Ff(ma);
                    var ia = B.Ff(P);
                    Y =
                      T > ia + 10
                        ? 0 <= C
                          ? Y.Ya(ma)
                          : ma.Ya(Y)
                        : ia > T + 10
                        ? 0 <= C
                          ? B.Ya(P)
                          : P.Ya(B)
                        : 0 <= C
                        ? Y.Ya(P)
                        : P.Ya(Y);
                  } else Y = 0 <= C ? ma.Ya(B) : B.Ya(ma);
                  S !== hg && ((P = k.computeAngle(z, S, Y)), (z.Fb = P));
                  P = ma.x + (B.x - ma.x) * E - b.x;
                  ma = ma.y + (B.y - ma.y) * E - b.y;
                }
                z.measure(Infinity, Infinity, 0, 0);
                B = z.measuredBounds;
                T = z.naturalBounds;
                var Ba = 0;
                z instanceof Hf && (Ba = z.strokeWidth);
                ia = T.width + Ba;
                var Na = T.height + Ba;
                q.reset();
                q.translate(-B.x, -B.y);
                q.scale(z.scale, z.scale);
                q.rotate(S === hg ? z.angle : Y, ia / 2, Na / 2);
                (S !== $m && S !== an) || q.rotate(90, ia / 2, Na / 2);
                (S !== bn && S !== cn) || q.rotate(-90, ia / 2, Na / 2);
                S === dn &&
                  ((45 < Y && 135 > Y) || (225 < Y && 315 > Y)) &&
                  q.rotate(-Y, ia / 2, Na / 2);
                T = new M(0, 0, ia, Na);
                u.cj(T, J);
                q.Ha(u);
                J = -u.x + (Ba / 2) * z.scale;
                z = -u.y + (Ba / 2) * z.scale;
                w.assign(aa);
                Ba = isNaN(aa.x);
                var sb = isNaN(aa.y);
                if (Ba || sb) {
                  ia = ia / 2 + 3;
                  Na = Na / 2 + 3;
                  var tb = 45 <= Y && 135 >= Y,
                    Xa = 225 <= Y && 315 >= Y;
                  S === hg && (tb || Xa)
                    ? ((w.x = sb ? ia : aa.y),
                      (w.y = Ba ? Na : aa.x),
                      tb
                        ? 0 <= C || (isNaN(C) && 0.5 > E) || !Ba || (w.y = -Na)
                        : Xa &&
                          ((0 <= C || (isNaN(C) && 0.5 > E)) &&
                            Ba &&
                            (w.y = -Na),
                          sb && (w.x = -ia)))
                    : (Ba && (w.x = 0 <= C || (isNaN(C) && 0.5 > E) ? ia : -ia),
                      sb && (w.y = -Na),
                      w.rotate(Y));
                } else w.rotate(Y);
                P += w.x;
                ma += w.y;
                T.set(B);
                T.h(P + J, ma + z, B.width, B.height);
                r.push(T);
                c.Xc(T);
              }
          }
          if (null !== g)
            for (d = g.labelNodes; d.next(); )
              d.value.measure(Infinity, Infinity);
          a.og = c;
          a.position.h(b.x + c.x, b.y + c.y);
          a.location.h(NaN, NaN);
          dc(e, c.width || 0, c.height || 0);
          Kb.free(q);
          K.free(u);
          K.free(w);
        }
      }
    }
  };
  Ym.prototype.arrange = function (a, b) {
    var c = b.length;
    if (a instanceof Je || a instanceof R) {
      var d = a,
        e = null;
      a instanceof Je && ((e = a), (d = e.adornedPart));
      var f = a instanceof Je ? null : d.path,
        g = a.j;
      if (0 !== g.length) {
        var h = 0;
        if (null !== f && h < g.length) {
          var k = g[h];
          h++;
          f.arrange(k.x - a.og.x, k.y - a.og.y, k.width, k.height);
        }
        for (k = 0; k < c; k++) {
          var l = b[k];
          if (l !== f && h < g.length) {
            var m = g[h];
            h++;
            l.arrange(m.x - a.og.x, m.y - a.og.y, m.width, m.height);
          }
        }
      }
      b = d.points;
      c = b.count;
      if (2 <= c && a instanceof R)
        for (f = a.labelNodes; f.next(); ) {
          var n = a;
          g = f.value;
          h = g.segmentIndex;
          k = g.segmentFraction;
          var p = g.alignmentFocus;
          l = g.segmentOrientation;
          m = g.segmentOffset;
          if (isNaN(h)) {
            var r = n.ta;
            var q = Ma();
            r.wv(k, q);
            var u = K.allocAt(q[0], q[1]);
            u.add(n.i(0));
            r.type === N.j
              ? u.offset(-r.startX, -r.startY)
              : ((r = r.figures.first()), u.offset(-r.startX, -r.startY));
            r = q[2];
            l !== hg && ((n = n.computeAngle(g, l, r)), (g.angle = n));
            n = u.x;
            var w = u.y;
            K.free(u);
            Pa(q);
          } else if (h < -c || h >= c)
            (q = K.alloc()),
              (r = n),
              (w = q),
              r.Ag(),
              r.computeMidPoint(w),
              (r = n.midAngle),
              l !== hg && ((n = n.computeAngle(g, l, r)), (g.angle = n)),
              (n = q.x),
              (w = q.y),
              K.free(q);
          else {
            u = 0;
            0 <= h
              ? ((q = b.m[h]), (w = h < c - 1 ? b.m[h + 1] : q))
              : ((u = c + h), (q = b.m[u]), (w = 0 < u ? b.m[u - 1] : q));
            if (q.$a(w)) {
              0 <= h
                ? ((r = 0 < h ? b.m[h - 1] : q),
                  (u = h < c - 2 ? b.m[h + 2] : w))
                : ((r = u < c - 1 ? b.m[u + 1] : q),
                  (u = 1 < u ? b.m[u - 2] : w));
              var y = r.Ff(q),
                z = w.Ff(u);
              r =
                y > z + 10
                  ? 0 <= h
                    ? r.Ya(q)
                    : q.Ya(r)
                  : z > y + 10
                  ? 0 <= h
                    ? w.Ya(u)
                    : u.Ya(w)
                  : 0 <= h
                  ? r.Ya(u)
                  : u.Ya(r);
            } else r = 0 <= h ? q.Ya(w) : w.Ya(q);
            l !== hg && ((n = n.computeAngle(g, l, r)), (g.angle = n));
            n = q.x + (w.x - q.x) * k;
            w = q.y + (w.y - q.y) * k;
          }
          if (p.pq()) g.location = new K(n, w);
          else {
            p.ec() && (p = Kc);
            q = Kb.alloc();
            q.reset();
            q.scale(g.scale, g.scale);
            q.rotate(g.angle, 0, 0);
            var B = g.naturalBounds;
            u = M.allocAt(0, 0, B.width, B.height);
            y = K.alloc();
            y.cj(u, p);
            q.Ha(y);
            p = -y.x;
            z = -y.y;
            var C = B.width,
              E = B.height;
            B = K.alloc();
            B.assign(m);
            var J = isNaN(m.x),
              S = isNaN(m.y);
            if (J || S) {
              C = C / 2 + 3;
              E = E / 2 + 3;
              var aa = 45 <= r && 135 >= r,
                Y = 225 <= r && 315 >= r;
              l === hg && (aa || Y)
                ? ((B.x = S ? C : m.y),
                  (B.y = J ? E : m.x),
                  aa
                    ? 0 <= h || (isNaN(h) && 0.5 > k) || !J || (B.y = -E)
                    : Y &&
                      ((0 <= h || (isNaN(h) && 0.5 > k)) && J && (B.y = -E),
                      S && (B.x = -C)))
                : (J && (B.x = 0 <= h || (isNaN(h) && 0.5 > k) ? C : -C),
                  S && (B.y = -E),
                  B.rotate(r));
            } else B.rotate(r);
            n += B.x;
            w += B.y;
            q.Hq(u);
            p += u.x;
            z += u.y;
            h = K.allocAt(n + p, w + z);
            g.move(h);
            K.free(h);
            K.free(B);
            K.free(y);
            M.free(u);
            Kb.free(q);
          }
        }
      null !== e ? e.yk(!1) : d.yk(!1);
    }
  };
  function Zm(a, b, c, d) {
    if (!1 !== Aj(d)) {
      var e = d.strokeWidth;
      0 === e &&
        a instanceof Je &&
        a.type === W.Link &&
        a.adornedObject instanceof Hf &&
        (e = a.adornedObject.strokeWidth);
      e *= d.Aa;
      a instanceof R && null !== a.ta
        ? ((a = a.ta.bounds),
          d.Ee(a.x - e / 2, a.y - e / 2, a.width + e, a.height + e))
        : a instanceof Je && null !== a.adornedPart.ta
        ? ((a = a.adornedPart.ta.bounds),
          d.Ee(a.x - e / 2, a.y - e / 2, a.width + e, a.height + e))
        : d.Ee(-(e / 2), -(e / 2), b + e, c + e);
      vj(d, !1);
    }
  }
  function en() {
    this.ua = "Base";
  }
  na(en, Yl);
  en.prototype.measure = function (a, b, c, d, e, f, g) {
    var h = a.vb();
    a.Vg = [];
    var k = h.margin,
      l = k.right + k.left,
      m = k.top + k.bottom;
    h.measure(b, c, f, g);
    var n = h.measuredBounds,
      p = new M(
        -k.left,
        -k.top,
        Math.max(n.width + l, 0),
        Math.max(n.height + m, 0)
      );
    a.Vg.push(p);
    e.assign(p);
    for (
      var r = h.geometry,
        q = h.strokeWidth,
        u = r.flattenedSegments,
        w = r.flattenedLengths,
        y = r.flattenedTotalLength,
        z = u.length,
        B = 0,
        C = 0,
        E = Ma(),
        J = 0;
      J < z;
      J++
    ) {
      var S = u[J],
        aa = [];
      C = B = 0;
      for (var Y = S.length, T = 0; T < Y; T += 2) {
        var P = S[T],
          ma = S[T + 1];
        if (0 !== T) {
          var ia = (180 * Math.atan2(ma - C, P - B)) / Math.PI;
          0 > ia && (ia += 360);
          aa.push(ia);
        }
        B = P;
        C = ma;
      }
      E.push(aa);
    }
    if (null === a.Zf) {
      for (var Ba = [], Na = a.W.m, sb = Na.length, tb = 0; tb < sb; tb++) {
        var Xa = Na[tb],
          Qb = [];
        Ba.push(Qb);
        if (Xa.visible) {
          var Ub = Xa.interval;
          if (!(0 > Ub))
            for (var jd = 0; jd < sb; jd++)
              if (jd !== tb) {
                var jc = Na[jd];
                if (jc.visible && Xa.constructor === jc.constructor) {
                  var yc = jc.interval;
                  yc > Ub && Qb.push(yc);
                }
              }
        }
      }
      a.Zf = Ba;
    }
    var Oc = a.Zf;
    var ze = a.W.m,
      Pf = ze.length,
      Jb = 0,
      Ae = 0,
      Bg = y;
    a.Bj = [];
    for (var Ih, Jh = 0; Jh < Pf; Jh++) {
      var fb = ze[Jh];
      Ih = [];
      if (fb.visible && fb !== h) {
        var Pi = Math.abs(fb.interval),
          wk = a.graduatedTickUnit;
        if (
          !(2 > (wk * Pi * y) / a.graduatedRange && null === fb.graduatedSkip)
        ) {
          var Cg = w[0][0],
            Bd = 0,
            zc = 0;
          Ae = y * fb.graduatedStart - 1e-4;
          Bg = y * fb.graduatedEnd + 1e-4;
          var Qf = wk * Pi,
            Ac = a.graduatedTickBase;
          if (Ac < a.graduatedMin) {
            var Dg = (a.graduatedMin - Ac) / Qf;
            Dg = 0 === Dg % 1 ? Dg : Math.floor(Dg + 1);
            Ac += Dg * Qf;
          } else
            Ac > a.graduatedMin + Qf &&
              (Ac -= Math.floor((Ac - a.graduatedMin) / Qf) * Qf);
          for (
            var Kh = Oc[Jh], Un = Ac, Wd = 1;
            Ac <= a.graduatedMax + 5e-8;
            Wd++
          ) {
            a: {
              for (var Be = Kh.length, Eg = 0; Eg < Be; Eg++)
                if (
                  L.da(
                    (Ac - a.graduatedTickBase) % (Kh[Eg] * a.graduatedTickUnit),
                    0
                  )
                ) {
                  var of = !1;
                  break a;
                }
              of = !0;
            }
            if (
              of &&
              (null === fb.graduatedSkip ||
                (fb instanceof Yg && !fb.graduatedSkip(Ac, fb)) ||
                (fb instanceof Hf && !fb.graduatedSkip(Ac, fb))) &&
              ((Jb = ((Ac - a.graduatedMin) * y) / a.graduatedRange),
              Jb > y && (Jb = y),
              Ae <= Jb && Jb <= Bg)
            ) {
              for (var Xd = E[Bd][zc], Od = w[Bd][zc]; Bd < w.length; ) {
                for (; Jb > Cg && zc < w[Bd].length - 1; )
                  zc++, (Xd = E[Bd][zc]), (Od = w[Bd][zc]), (Cg += Od);
                if (Jb <= Cg) break;
                Bd++;
                zc = 0;
                Xd = E[Bd][zc];
                Od = w[Bd][zc];
                Cg += Od;
              }
              var rc = u[Bd],
                Lh = rc[2 * zc],
                Mh = rc[2 * zc + 1],
                sc = (Jb - (Cg - Od)) / Od,
                Qi = new K(
                  Lh + (rc[2 * zc + 2] - Lh) * sc + q / 2 - r.bounds.x,
                  Mh + (rc[2 * zc + 3] - Mh) * sc + q / 2 - r.bounds.y
                );
              Qi.scale(h.scale, h.scale);
              a: {
                var Ce = Xd,
                  pf = E[Bd];
                if (!(0.5005 > sc && 0.4995 < sc)) {
                  var $c = Ce;
                  0.5 > sc
                    ? 0 < zc
                      ? ($c = pf[zc - 1])
                      : L.da(rc[0], rc[rc.length - 2]) &&
                        L.da(rc[1], rc[rc.length - 1]) &&
                        ($c = pf[pf.length - 1])
                    : 0.5 < sc &&
                      (zc + 1 < pf.length
                        ? ($c = pf[zc + 1])
                        : L.da(rc[0], rc[rc.length - 2]) &&
                          L.da(rc[1], rc[rc.length - 1]) &&
                          ($c = pf[0]));
                  if (Ce !== $c) {
                    var Ri = Math.abs(Ce - $c);
                    180 < Ri &&
                      (Ce < $c ? (Ce += 360) : ($c += 360),
                      (Ri = Math.abs(Ce - $c)));
                    if (5e-4 > sc || 0.9995 < sc) {
                      Xd = ((Ce + $c) / 2) % 360;
                      break a;
                    }
                    if (10 > Ri) {
                      var xk = 1 - Math.abs(0.5 - sc);
                      Xd = (Ce * xk + $c * (1 - xk)) % 360;
                      break a;
                    }
                  }
                }
                Xd = Ce;
              }
              if (fb instanceof Yg) {
                var Yd = "";
                null !== fb.graduatedFunction
                  ? ((Yd = fb.graduatedFunction(Ac, fb)),
                    (Yd = null !== Yd && void 0 !== Yd ? Yd.toString() : ""))
                  : (Yd = (+Ac.toFixed(2)).toString());
                "" !== Yd && Ih.push({ wm: Qi, angle: Xd, text: Yd });
              } else Ih.push({ wm: Qi, angle: Xd });
            }
            Ac = Un + Wd * Qf;
          }
        }
      }
      a.Bj.push(Ih);
    }
    Pa(E);
    var Nh = a.Bj;
    if (null !== Nh)
      for (var Rf = d.length, qb = 0; qb < Rf; qb++) {
        var Vb = d[qb],
          Wb = Nh[qb];
        if (Vb.visible && Vb !== h && 0 !== Wb.length) {
          if (Vb instanceof Hf) {
            var Bc = a,
              Hc = e,
              Zd = Vb.alignmentFocus;
            Zd.ec() && (Zd = Gc);
            var Ve = Vb.angle;
            Vb.Fb = 0;
            Vb.measure(Infinity, Infinity, 0, 0);
            Vb.Fb = Ve;
            var Fg = Vb.measuredBounds,
              Si = Fg.width,
              Ti = Fg.height,
              Ui = M.allocAt(0, 0, Si, Ti),
              tc = K.alloc();
            tc.cj(Ui, Zd);
            M.free(Ui);
            for (
              var qf = -tc.x, rf = -tc.y, ad = new M(), De = Wb.length, Cd = 0;
              Cd < De;
              Cd++
            )
              for (
                var Ee = Wb[Cd],
                  yk = Ee.wm.x,
                  Sf = Ee.wm.y,
                  zk = Ee.angle,
                  Tf = 0;
                4 > Tf;
                Tf++
              ) {
                switch (Tf) {
                  case 0:
                    tc.h(qf, rf);
                    break;
                  case 1:
                    tc.h(qf + Si, rf);
                    break;
                  case 2:
                    tc.h(qf, rf + Ti);
                    break;
                  case 3:
                    tc.h(qf + Si, rf + Ti);
                }
                tc.rotate(zk + Vb.angle);
                tc.offset(yk, Sf);
                0 === Cd && 0 === Tf ? ad.h(tc.x, tc.y, 0, 0) : ad.Ye(tc);
                tc.offset(-yk, -Sf);
                tc.rotate(-zk - Vb.angle);
              }
            K.free(tc);
            null !== Bc.Vg && Bc.Vg.push(ad);
            mc(Hc, ad.x, ad.y, ad.width, ad.height);
          } else if (Vb instanceof Yg) {
            var Za = a,
              $d = e;
            null === Za.vh && (Za.vh = new Yg());
            var Hb = Za.vh;
            fn(Hb, Vb);
            var Oh = Vb.alignmentFocus;
            Oh.ec() && (Oh = Gc);
            for (
              var ae = Vb.segmentOrientation,
                Uf = Vb.segmentOffset,
                Dd = new M(),
                Vf = 0,
                Vi = 0,
                Fe = 0,
                Gg = 0,
                Wf = 0,
                Wi = Wb.length,
                sf = 0;
              sf < Wi;
              sf++
            ) {
              var kd = Wb[sf];
              Vf = kd.wm.x;
              Vi = kd.wm.y;
              Fe = kd.angle;
              Wf = Gg = Vb.angle;
              ae !== hg &&
                ((Wf = ae === gn || ae === hn ? Fe + Vb.angle : Fe),
                (Gg = R.computeAngle(ae, Wf)));
              Hb.Fb = Gg;
              Hb.text = kd.text || "";
              Hb.measure(Infinity, Infinity, 0, 0);
              var Ed = Hb.measuredBounds,
                Xf = Hb.naturalBounds,
                Yf = Xf.width,
                Ge = Xf.height,
                Pd = Kb.alloc();
              Pd.reset();
              Pd.translate(-Ed.x, -Ed.y);
              Pd.scale(Hb.scale, Hb.scale);
              Pd.rotate(Wf, Yf / 2, Ge / 2);
              (ae !== $m && ae !== an) || Pd.rotate(90, Yf / 2, Ge / 2);
              (ae !== bn && ae !== cn) || Pd.rotate(-90, Yf / 2, Ge / 2);
              ae === dn &&
                ((45 < Fe && 135 > Fe) || (225 < Fe && 315 > Fe)) &&
                Pd.rotate(-Fe, Yf / 2, Ge / 2);
              var Ph = M.allocAt(0, 0, Yf, Ge),
                We = K.alloc();
              We.cj(Ph, Oh);
              Pd.Ha(We);
              var Qh = -We.x,
                Rh = -We.y,
                ld = K.alloc();
              ld.assign(Uf);
              isNaN(ld.x) && (ld.x = Yf / 2 + 3);
              isNaN(ld.y) && (ld.y = -(Ge / 2 + 3));
              ld.rotate(Fe);
              Vf += ld.x + Qh;
              Vi += ld.y + Rh;
              var Xi = new M(Vf, Vi, Ed.width, Ed.height),
                Vn = new M(Ed.x, Ed.y, Ed.width, Ed.height),
                Sh = new M(Xf.x, Xf.y, Xf.width, Xf.height);
              kd.BA = Gg;
              kd.lineCount = Hb.lineCount;
              kd.lines = [Hb.yb, Hb.li, Hb.xe, Hb.Je, Hb.Ic, Hb.Xb, Hb.ve];
              kd.actualBounds = Xi;
              kd.measuredBounds = Vn;
              kd.naturalBounds = Sh;
              0 === sf ? Dd.assign(Xi) : Dd.Xc(Xi);
              K.free(ld);
              K.free(We);
              M.free(Ph);
              Kb.free(Pd);
            }
            null !== Za.Vg && Za.Vg.push(Dd);
            mc($d, Dd.x, Dd.y, Dd.width, Dd.height);
          }
          vj(Vb, !1);
        }
      }
  };
  en.prototype.arrange = function (a, b, c) {
    if (null !== a.Vg) {
      var d = a.vb(),
        e = a.Bj;
      if (null !== e) {
        var f = a.Vg,
          g = 0,
          h = f[g];
        g++;
        null !== d && d.arrange(h.x - c.x, h.y - c.y, h.width, h.height);
        for (var k = b.length, l = 0; l < k; l++) {
          var m = b[l];
          h = e[l];
          m.visible &&
            m !== d &&
            0 !== h.length &&
            ((h = f[g]),
            g++,
            m.arrange(h.x - c.x, h.y - c.y, h.width, h.height));
        }
        a.Vg = null;
      }
    }
  };
  en.prototype.uc = function (a, b, c) {
    var d = c.Hj;
    c.Hj = !0;
    var e = a.naturalBounds,
      f = e.width;
    e = e.height;
    b.save();
    b.beginPath();
    b.rect(-1, -1, f + 1, e + 1);
    b.clip();
    f = a.vb();
    f.uc(b, c);
    e = a.If() * c.scale;
    0 >= e && (e = 1);
    for (
      var g = f.actualBounds, h = a.W.m, k = a.Bj, l = h.length, m = 0;
      m < l;
      m++
    ) {
      var n = h[m],
        p = k[m],
        r = p.length;
      if (n.visible && n !== f && 0 !== p.length)
        if (n instanceof Hf) {
          if (
            !(
              2 >
                ((a.graduatedTickUnit *
                  n.interval *
                  f.geometry.flattenedTotalLength) /
                  a.graduatedRange) *
                  e && null === n.graduatedSkip
            )
          ) {
            var q = n.measuredBounds,
              u = n.strokeWidth * n.scale,
              w = n.alignmentFocus;
            w.ec() && (w = Gc);
            for (var y = 0; y < r; y++) {
              var z = p[y].wm,
                B = p[y].angle,
                C = w,
                E = n.Bb;
              E.reset();
              E.translate(z.x + g.x, z.y + g.y);
              E.rotate(B + n.angle, 0, 0);
              E.translate(
                -q.width * C.x + C.offsetX + u / 2,
                -q.height * C.y + C.offsetY + u / 2
              );
              E.scale(n.scale, n.scale);
              Ll(n, !1);
              n.Vh.set(n.Bb);
              n.il = n.scale;
              Ml(n, !1);
              n.uc(b, c);
              n.Bb.reset();
            }
          }
        } else if (n instanceof Yg)
          for (
            null === a.vh && (a.vh = new Yg()), q = a.vh, fn(q, n), n = 0;
            n < r;
            n++
          )
            (u = p[n]),
              u.actualBounds &&
                u.measuredBounds &&
                u.naturalBounds &&
                ((q.bc = u.text || ""),
                (q.Fb = u.BA || 0),
                (q.fd = u.lineCount || 0),
                (w = u.lines),
                void 0 !== w &&
                  ((q.yb = w[0]),
                  (q.li = w[1]),
                  (q.xe = w[2]),
                  (q.Je = w[3]),
                  (q.Ic = w[4]),
                  (q.Xb = w[5]),
                  (q.ve = w[6])),
                u.naturalBounds && (q.zc = u.naturalBounds),
                u.actualBounds &&
                  ((w = u.actualBounds),
                  q.arrange(w.x, w.y, w.width, w.height)),
                (w = u.actualBounds),
                q.arrange(w.x, w.y, w.width, w.height),
                (y = u.measuredBounds),
                (u = u.naturalBounds),
                (z = q.Bb),
                z.reset(),
                z.translate(w.x + g.x, w.y + g.y),
                z.translate(-y.x, -y.y),
                q.wp(z, u.x, u.y, u.width, u.height),
                Ll(q, !1),
                q.Vh.set(q.Bb),
                (q.il = q.scale),
                Ml(q, !1),
                q.uc(b, c));
    }
    c.Hj = d;
    b.restore();
    b.Nc(!0);
  };
  function W(a, b) {
    O.call(this);
    this.pa = null;
    if (void 0 === a) this.pa = W.Position;
    else if ("string" === typeof a) {
      var c = Xl.K(a);
      null !== c && (this.pa = c);
    } else
      a instanceof Yl ? (this.pa = a) : a && ((this.pa = W.Position), (b = a));
    null === this.pa &&
      v("Panel type not specified or PanelLayout not loaded: " + a);
    this.A |= 4194304;
    this.W = new H();
    this.ub = Cc;
    this.pa === W.Grid && (this.A |= 1048576);
    this.yn = gd;
    this.Wf = hl;
    this.pa === W.Table && jn(this);
    this.Pp = vg;
    this.Vn = Yb;
    this.Wn = yb;
    this.Sn = 0;
    this.Rn = 100;
    this.Un = 10;
    this.Tn = 0;
    this.Yh = this.qb = this.Zf = this.Vg = this.Bj = null;
    this.no = NaN;
    this.Be = this.ji = null;
    this.xl = "category";
    this.be = null;
    this.og = new M(NaN, NaN, NaN, NaN);
    this.vh = this.np = this.uh = null;
    this.$e = "";
    b && Object.assign(this, b);
  }
  na(W, O);
  function jn(a) {
    a.xj = Cc;
    a.Mg = 1;
    a.di = null;
    a.ci = null;
    a.Lg = 1;
    a.Kg = null;
    a.bi = null;
    a.Lb = [];
    a.Gb = [];
    a.Wj = kn;
    a.wj = kn;
    a.Ei = 0;
    a.ni = 0;
  }
  W.prototype.cloneProtected = function (a) {
    O.prototype.cloneProtected.call(this, a);
    a.pa = this.pa;
    a.ub = this.ub.L();
    a.yn = this.yn.L();
    a.Wf = this.Wf;
    if (a.pa === W.Table) {
      a.xj = this.xj.L();
      a.Mg = this.Mg;
      a.di = this.di;
      a.ci = this.ci;
      a.Lg = this.Lg;
      a.Kg = this.Kg;
      a.bi = this.bi;
      var b = [];
      if (0 < this.Lb.length)
        for (var c = this.Lb, d = c.length, e = 0; e < d; e++)
          if (void 0 !== c[e]) {
            var f = c[e].copy();
            f.bj(a);
            b[e] = f;
          }
      a.Lb = b;
      b = [];
      if (0 < this.Gb.length)
        for (c = this.Gb, d = c.length, e = 0; e < d; e++)
          void 0 !== c[e] && ((f = c[e].copy()), f.bj(a), (b[e] = f));
      a.Gb = b;
      a.Wj = this.Wj;
      a.wj = this.wj;
      a.Ei = this.Ei;
      a.ni = this.ni;
    }
    a.Pp = this.Pp;
    a.Vn = this.Vn.L();
    a.Wn = this.Wn.L();
    a.Sn = this.Sn;
    a.Rn = this.Rn;
    a.Un = this.Un;
    a.Tn = this.Tn;
    a.Bj = this.Bj;
    a.Zf = this.Zf;
    a.qb = this.qb;
    a.Yh = this.Yh;
    a.no = this.no;
    a.ji = this.ji;
    a.Be = this.Be;
    a.xl = this.xl;
    a.og.assign(this.og);
    a.$e = this.$e;
    null !== this.np && (a.np = this.np);
  };
  W.prototype.Ef = function (a) {
    O.prototype.Ef.call(this, a);
    a.W = this.W;
    for (var b = a.W.m, c = b.length, d = 0; d < c; d++) b[d].ig = a;
    a.uh = null;
  };
  W.prototype.copy = function () {
    var a = O.prototype.copy.call(this);
    if (null !== a) {
      for (var b = this.W.m, c = b.length, d = 0; d < c; d++) {
        var e = b[d].copy();
        e.bj(a);
        e.Uj = null;
        var f = a.W,
          g = f.count;
        f.Cb(g, e);
        f = a.part;
        if (null !== f) {
          f.ui = null;
          null !== e.portId && f instanceof V && (f.Te = !0);
          var h = a.diagram;
          (null !== h && h.undoManager.isUndoingRedoing) ||
            f.cb(re, "elements", a, null, e, null, g);
        }
      }
      return a;
    }
    return null;
  };
  t = W.prototype;
  t.toString = function () {
    return "Panel(" + this.type.name + ")#" + lb(this);
  };
  t.Po = function (a) {
    O.prototype.Po.call(this, a);
    for (var b = this.W.m, c = b.length, d = 0; d < c; d++) b[d].Po(a);
  };
  t.Ni = function (a, b) {
    if (this.pa === W.Grid) a.Oc(), this.pa.uc(this, a, b);
    else if (this.pa === W.Graduated) a.Oc(), this.pa.uc(this, a, b);
    else {
      this.pa === W.Table &&
        (a.Oc(),
        (a.lineCap = "butt"),
        ln(this, a, !0, this.Lb, !0),
        ln(this, a, !1, this.Gb, !0),
        mn(this, a, !0, this.Lb),
        mn(this, a, !1, this.Gb),
        ln(this, a, !0, this.Lb, !1),
        ln(this, a, !1, this.Gb, !1));
      var c = this.isClipping && this.pa === W.Spot;
      c && a.save();
      for (var d = this.vb(), e = this.W.m, f = e.length, g = 0; g < f; g++) {
        var h = e[g];
        c && h === d && (a.clipInsteadOfFill = !0);
        h.uc(a, b);
        c && h === d && (a.clipInsteadOfFill = !1);
      }
      c && (a.restore(), a.Nc(!0));
    }
  };
  function mn(a, b, c, d) {
    for (
      var e = d.length, f = a.actualBounds, g = a.naturalBounds, h = !0, k = 0;
      k < e;
      k++
    ) {
      var l = d[k];
      if (void 0 !== l)
        if (h) h = !1;
        else if (0 !== l.actual) {
          if (c) {
            if (l.position > f.height) continue;
          } else if (l.position > f.width) continue;
          var m = l.separatorStrokeWidth;
          isNaN(m) && (m = c ? a.Mg : a.Lg);
          var n = l.separatorStroke;
          null === n && (n = c ? a.di : a.Kg);
          if (0 !== m && null !== n) {
            pi(a, b, n, !1, !1, g, f);
            n = !1;
            var p = l.separatorDashArray;
            null === p && (p = c ? a.ci : a.bi);
            null !== p && ((n = !0), b.As(p, 0));
            b.beginPath();
            p = l.position + m;
            c
              ? p > f.height && (m -= p - f.height)
              : p > f.width && (m -= p - f.width);
            l = l.position + m / 2;
            b.lineWidth = m;
            m = a.ub;
            c
              ? ((l += m.top),
                (p = f.width - m.right),
                b.moveTo(m.left, l),
                b.lineTo(p, l))
              : ((l += m.left),
                (p = f.height - m.bottom),
                b.moveTo(l, m.top),
                b.lineTo(l, p));
            b.stroke();
            n && b.ys();
          }
        }
    }
  }
  function ln(a, b, c, d, e) {
    for (
      var f = d.length,
        g = a.actualBounds,
        h = a.naturalBounds,
        k = nn(a, !0),
        l = nn(a, !1),
        m = 0;
      m < f;
      m++
    ) {
      var n = d[m];
      if (
        void 0 !== n &&
        null !== n.background &&
        n.coversSeparators !== e &&
        0 !== n.actual
      ) {
        var p = c ? g.height : g.width;
        if (!(n.position > p)) {
          var r = n.Pc(),
            q = n.separatorStrokeWidth;
          isNaN(q) && (q = c ? a.Mg : a.Lg);
          var u = n.separatorStroke;
          null === u && (u = c ? a.di : a.Kg);
          if (null === u || n.index === (c ? k : l)) q = 0;
          r -= q;
          q = n.position + q;
          r += n.actual;
          q + r > p && (r = p - q);
          0 >= r ||
            ((p = a.ub),
            pi(a, b, n.background, !0, !1, h, g),
            c
              ? b.fillRect(p.left, q + p.top, g.width - (p.left + p.right), r)
              : b.fillRect(
                  q + p.left,
                  p.top,
                  r,
                  g.height - (p.top + p.bottom)
                ));
        }
      }
    }
  }
  function nn(a, b) {
    for (var c = b ? a.Lb.length : a.Gb.length, d = 0; d < c; d++) {
      var e = b ? a.Lb[d] : a.Gb[d];
      if (void 0 !== e) return e.index;
    }
    return 0;
  }
  function fk(a) {
    return "LineV" === a || "BarV" === a;
  }
  t.sk = function (a, b, c, d, e) {
    var f = this.oe(),
      g = this.transform,
      h = 1 / (g.m11 * g.m22 - g.m12 * g.m21),
      k = g.m22 * h,
      l = -g.m12 * h,
      m = -g.m21 * h,
      n = g.m11 * h,
      p = h * (g.m21 * g.dy - g.m22 * g.dx),
      r = h * (g.m12 * g.dx - g.m11 * g.dy);
    if (null !== this.areaBackground)
      return (
        (g = this.actualBounds),
        L.Kf(g.left, g.top, g.right, g.bottom, a, b, c, d, e)
      );
    if (null !== this.background)
      return (
        (f = a * k + b * m + p),
        (h = a * l + b * n + r),
        (a = c * k + d * m + p),
        (k = c * l + d * n + r),
        e.h(0, 0),
        (c = this.naturalBounds),
        (f = L.Kf(0, 0, c.width, c.height, f, h, a, k, e)),
        e.transform(g),
        f
      );
    f || ((k = 1), (m = l = 0), (n = 1), (r = p = 0));
    h = a * k + b * m + p;
    a = a * l + b * n + r;
    k = c * k + d * m + p;
    c = c * l + d * n + r;
    e.h(k, c);
    d = (k - h) * (k - h) + (c - a) * (c - a);
    l = !1;
    n = this.W.m;
    r = n.length;
    m = K.alloc();
    p = null;
    b = Infinity;
    var q = null,
      u = this.isClipping && this.pa === W.Spot;
    u &&
      ((q = K.alloc()),
      (p = this.vb()),
      (l = p.sk(h, a, k, c, q)) &&
        (b = (h - q.x) * (h - q.x) + (a - q.y) * (a - q.y)));
    for (var w = 0; w < r; w++) {
      var y = n[w];
      y.visible &&
        y !== p &&
        y.sk(h, a, k, c, m) &&
        ((l = !0),
        (y = (h - m.x) * (h - m.x) + (a - m.y) * (a - m.y)),
        y < d && ((d = y), e.set(m)));
    }
    u && (b > d && e.set(q), K.free(q));
    K.free(m);
    f && e.transform(g);
    return l;
  };
  t.v = function (a) {
    if (!Aj(this)) {
      O.prototype.v.call(this, a);
      a = null;
      if (this.pa === W.Auto || this.pa === W.Link) a = this.vb();
      for (var b = this.W.m, c = b.length, d = 0; d < c; d++) {
        var e = b[d];
        (e === a || e.isPanelMain) && e.v(!0);
        if (!e.desiredSize.s()) {
          var f = vl(e, !1);
          (e instanceof rg || e instanceof W || e instanceof Yg || f !== tg) &&
            e.v(!0);
        }
      }
    }
  };
  t.uk = function () {
    if (!Aj(this)) {
      vj(this, !0);
      wl(this, !0);
      for (var a = this.W.m, b = a.length, c = 0; c < b; c++) a[c].uk();
    }
  };
  t.tl = function () {
    if ((0 !== (this.A & 2048)) === !1) {
      Ll(this, !0);
      Ml(this, !0);
      for (var a = this.W.m, b = a.length, c = 0; c < b; c++) a[c].Cv();
    }
  };
  t.Cv = function () {
    Ml(this, !0);
    for (var a = this.W.m, b = a.length, c = 0; c < b; c++) a[c].Cv();
  };
  t.tm = function (a, b, c, d) {
    var e = this.og;
    e.h(0, 0, 0, 0);
    var f = this.desiredSize,
      g = this.minSize;
    void 0 === c && ((c = g.width), (d = g.height));
    c = Math.max(c, g.width);
    d = Math.max(d, g.height);
    var h = this.maxSize;
    isNaN(f.width) || (a = Math.min(f.width, h.width));
    isNaN(f.height) || (b = Math.min(f.height, h.height));
    a = Math.max(c, a);
    b = Math.max(d, b);
    var k = this.ub;
    a = Math.max(a - k.left - k.right, 0);
    b = Math.max(b - k.top - k.bottom, 0);
    var l = this.W.m;
    0 !== l.length && this.pa.measure(this, a, b, l, e, c, d);
    a = e.width + k.left + k.right;
    k = e.height + k.top + k.bottom;
    isFinite(f.width) && (a = f.width);
    isFinite(f.height) && (k = f.height);
    a = Math.min(h.width, a);
    k = Math.min(h.height, k);
    a = Math.max(g.width, a);
    k = Math.max(g.height, k);
    a = Math.max(c, a);
    k = Math.max(d, k);
    dc(e, a, k);
    dc(this.naturalBounds, a, k);
    this.Ee(0, 0, a, k);
  };
  t.vb = function () {
    if (null === this.uh) {
      var a = this.W.m,
        b = a.length;
      if (0 === b) return null;
      for (var c = 0; c < b; c++) {
        var d = a[c];
        if (!0 === d.isPanelMain) return (this.uh = d);
      }
      this.uh = a[0];
    }
    return this.uh;
  };
  function Im(a) {
    return null !== a.part ? a.part.locationObject : null;
  }
  t.Eh = function (a, b, c, d) {
    var e = this.W.m;
    this.actualBounds.h(a, b, c, d);
    if (0 !== e.length) {
      if (!this.desiredSize.s()) {
        a = vl(this, !0);
        var f = this.measuredBounds;
        b = f.width;
        f = f.height;
        var g = this.$g,
          h = g.left + g.right;
        g = g.top + g.bottom;
        b === c && f === d && (a = tg);
        switch (a) {
          case tg:
            if (b > c || f > d)
              this.v(), this.measure(b > c ? c : b, f > d ? d : f, 0, 0);
            break;
          case Fd:
            this.v(!0);
            this.measure(c + h, d + g, 0, 0);
            break;
          case il:
            this.v(!0);
            this.measure(c + h, f + g, 0, 0);
            break;
          case jl:
            this.v(!0), this.measure(b + h, d + g, 0, 0);
        }
      }
      this.pa.arrange(this, e, this.og);
    }
  };
  t.Gh = function (a) {
    var b = this.naturalBounds,
      c = Im(this);
    if (nc(0, 0, b.width, b.height, a.x, a.y)) {
      b = this.W.m;
      for (var d = b.length, e = K.allocAt(0, 0); d--; ) {
        var f = b[d];
        if (f.visible || f === c)
          if ((Lb(e.set(a), f.transform), f.ca(e))) return K.free(e), !0;
      }
      K.free(e);
      return null === this.Zb && null === this.qd ? !1 : !0;
    }
    return !1;
  };
  t.Bs = function (a) {
    if (this.Uk === a) return this;
    for (var b = this.W.m, c = b.length, d = 0; d < c; d++) {
      var e = b[d].Bs(a);
      if (null !== e) return e;
    }
    return null;
  };
  t.Jk = function (a, b) {
    b(this, a);
    if (a instanceof W) {
      a = a.W.m;
      for (var c = a.length, d = 0; d < c; d++) this.Jk(a[d], b);
    }
  };
  function Nj(a, b) {
    on(a, a, b);
  }
  function on(a, b, c) {
    c(b);
    b = b.W.m;
    for (var d = b.length, e = 0; e < d; e++) {
      var f = b[e];
      f instanceof W && on(a, f, c);
    }
  }
  function pn(a, b) {
    qn(a, a, b);
  }
  function qn(a, b, c) {
    c(b);
    if (b instanceof W) {
      b = b.W.m;
      for (var d = b.length, e = 0; e < d; e++) qn(a, b[e], c);
    }
  }
  t.km = function (a) {
    return rn(this, this, a);
  };
  function rn(a, b, c) {
    if (c(b)) return b;
    if (b instanceof W) {
      b = b.W.m;
      for (var d = b.length, e = 0; e < d; e++) {
        var f = rn(a, b[e], c);
        if (null !== f) return f;
      }
    }
    return null;
  }
  t.hb = function (a) {
    if (this.name === a) return this;
    var b = this.W.m,
      c = b.length;
    (null === this.ji && null === this.Be) || (c = sn(this));
    for (var d = 0; d < c; d++) {
      var e = b[d];
      if (e instanceof W) {
        var f = e.hb(a);
        if (null !== f) return f;
      }
      if (e.name === a) return e;
    }
    return null;
  };
  function tn(a) {
    a = a.W.m;
    for (var b = a.length, c = 0, d = 0; d < b; d++) {
      var e = a[d];
      e instanceof W
        ? (c = Math.max(c, tn(e)))
        : e instanceof Hf &&
          (c = Math.max(c, (e.ng / 2) * e.strokeMiterLimit * e.If()));
    }
    return c;
  }
  t.oe = function () {
    return !(this.type === W.TableRow || this.type === W.TableColumn);
  };
  t.dc = function (a, b, c) {
    if (!1 === this.pickable) return null;
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    if (Bj(this)) return null;
    var d = this.naturalBounds,
      e = 1 / this.If(),
      f = this.oe(),
      g = f ? a : Lb(K.allocAt(a.x, a.y), this.transform),
      h = this.diagram,
      k = 10,
      l = 5;
    null !== h && ((k = h.nm("extraTouchArea")), (l = k / 2));
    if (nc(-(l * e), -(l * e), d.width + k * e, d.height + k * e, g.x, g.y)) {
      if (!this.isAtomic) {
        e = this.W.m;
        var m = e.length;
        h = K.alloc();
        l = (k = this.isClipping && this.pa === W.Spot) ? this.vb() : null;
        if (k && (l.oe() ? Lb(h.set(a), l.transform) : h.set(a), !l.ca(h)))
          return K.free(h), f || K.free(g), null;
        for (var n = Im(this); m--; ) {
          var p = e[m];
          if (p.visible || p === n)
            if (
              (p.oe() ? Lb(h.set(a), p.transform) : h.set(a), !k || p !== l)
            ) {
              var r = null;
              p instanceof W
                ? (r = p.dc(h, b, c))
                : !0 === p.pickable && p.ca(h) && (r = p);
              if (
                null !== r &&
                (null !== b && (r = b(r)), null !== r && (null === c || c(r)))
              )
                return K.free(h), f || K.free(g), r;
            }
        }
        K.free(h);
      }
      if (null === this.background && null === this.areaBackground)
        return f || K.free(g), null;
      a = nc(0, 0, d.width, d.height, g.x, g.y) ? this : null;
      f || K.free(g);
      return a;
    }
    f || K.free(g);
    return null;
  };
  t.Qi = function (a, b, c, d) {
    if (!1 === this.pickable) return !1;
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    var e = this.naturalBounds,
      f = this.oe(),
      g = f ? a : Lb(K.allocAt(a.x, a.y), this.transform),
      h = this.type === W.TableRow || this.type === W.TableColumn;
    e = nc(0, 0, e.width, e.height, g.x, g.y);
    if (h || e) {
      if (!this.isAtomic) {
        h = this.W.m;
        for (var k = h.length, l = K.alloc(), m = Im(this); k--; ) {
          var n = h[k];
          if (n.visible || n === m) {
            n.oe() ? Lb(l.set(a), n.transform) : l.set(a);
            var p = n;
            n = n instanceof W ? n : null;
            (null !== n ? n.Qi(l, b, c, d) : p.ca(l)) &&
              !1 !== p.pickable &&
              (null !== b && (p = b(p)),
              null === p || (null !== c && !c(p)) || d.add(p));
          }
        }
        K.free(l);
      }
      f || K.free(g);
      return e && (null !== this.background || null !== this.areaBackground);
    }
    f || K.free(g);
    return !1;
  };
  t.Hf = function (a, b, c, d, e, f) {
    if (!1 === this.pickable) return !1;
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    var g = f;
    void 0 === f && ((g = Kb.alloc()), g.reset());
    g.multiply(this.transform);
    if (this.Fh(a, g)) return un(this, b, c, e), void 0 === f && Kb.free(g), !0;
    if (this.Sc(a, g)) {
      if (!this.isAtomic)
        for (var h = Im(this), k = this.W.m, l = k.length; l--; ) {
          var m = k[l];
          if (m.visible || m === h) {
            var n = m.actualBounds,
              p = this.naturalBounds;
            if (
              !(
                n.x > p.width ||
                n.y > p.height ||
                0 > n.x + n.width ||
                0 > n.y + n.height
              )
            ) {
              n = m;
              m = m instanceof W ? m : null;
              p = Kb.alloc();
              p.set(g);
              if (null !== m ? m.Hf(a, b, c, d, e, p) : ul(n, a, d, p))
                null !== b && (n = b(n)),
                  null === n || (null !== c && !c(n)) || e.add(n);
              Kb.free(p);
            }
          }
        }
      void 0 === f && Kb.free(g);
      return d;
    }
    void 0 === f && Kb.free(g);
    return !1;
  };
  function un(a, b, c, d) {
    for (var e = a.W.m, f = e.length; f--; ) {
      var g = e[f];
      if (g.visible) {
        var h = g.actualBounds,
          k = a.naturalBounds;
        h.x > k.width ||
          h.y > k.height ||
          0 > h.x + h.width ||
          0 > h.y + h.height ||
          (g instanceof W && un(g, b, c, d),
          null !== b && (g = b(g)),
          null === g || (null !== c && !c(g)) || d.add(g));
      }
    }
  }
  t.vg = function (a, b, c, d, e, f) {
    if (!1 === this.pickable) return !1;
    void 0 === c && (c = null);
    void 0 === d && (d = null);
    var g = this.naturalBounds,
      h = this.oe(),
      k = h ? a : Lb(K.allocAt(a.x, a.y), this.transform),
      l = h ? b : Lb(K.allocAt(b.x, b.y), this.transform),
      m = k.Ff(l),
      n =
        (0 < k.x && k.x < g.width && 0 < k.y && k.y < g.height) ||
        Mb(k.x, k.y, 0, 0, 0, g.height) <= m ||
        Mb(k.x, k.y, 0, g.height, g.width, g.height) <= m ||
        Mb(k.x, k.y, g.width, g.height, g.width, 0) <= m ||
        Mb(k.x, k.y, g.width, 0, 0, 0) <= m;
    g =
      k.xd(0, 0) <= m &&
      k.xd(0, g.height) <= m &&
      k.xd(g.width, 0) <= m &&
      k.xd(g.width, g.height) <= m;
    h || (K.free(k), K.free(l));
    if (n) {
      if (!this.isAtomic) {
        k = K.alloc();
        l = K.alloc();
        m = Im(this);
        for (var p = this.W.m, r = p.length; r--; ) {
          var q = p[r];
          if (q.visible || q === m) {
            var u = q.actualBounds,
              w = this.naturalBounds;
            if (
              !h ||
              !(
                u.x > w.width ||
                u.y > w.height ||
                0 > u.x + u.width ||
                0 > u.y + u.height
              )
            )
              if (
                (q.oe()
                  ? ((u = q.transform), Lb(k.set(a), u), Lb(l.set(b), u))
                  : (k.set(a), l.set(b)),
                (u = q),
                (q = q instanceof W ? q : null),
                null !== q ? q.vg(k, l, c, d, e, f) : u.Vx(k, l, e))
              )
                null !== c && (u = c(u)),
                  null === u || (null !== d && !d(u)) || f.add(u);
          }
        }
        K.free(k);
        K.free(l);
      }
      return e ? n : g;
    }
    return !1;
  };
  function Om(a) {
    var b = null;
    a instanceof Hf &&
      ((b = a.spot1),
      b === gd && (b = null),
      (a = a.geometry),
      null !== a && null === b && (b = a.spot1));
    null === b && (b = Fc);
    return b;
  }
  function Pm(a) {
    var b = null;
    a instanceof Hf &&
      ((b = a.spot2),
      b === gd && (b = null),
      (a = a.geometry),
      null !== a && null === b && (b = a.spot2));
    null === b && (b = Pc);
    return b;
  }
  t.add = function (a) {
    for (var b = [], c = 0; c < arguments.length; ++c) b[c] = arguments[c];
    for (c = 0; c < b.length; c++) this.Cb(this.W.count, b[c]);
    return this;
  };
  t.N = function (a) {
    return this.W.N(a);
  };
  t.Cb = function (a, b) {
    b instanceof U &&
      v("Cannot add a Part to a Panel: " + b + "; use a Panel instead");
    if (this === b || this.xg(b))
      this === b && v("Cannot make a Panel contain itself: " + this.toString()),
        v(
          "Cannot make a Panel indirectly contain itself: " +
            this.toString() +
            " already contains " +
            b.toString()
        );
    var c = b.panel;
    null !== c &&
      c !== this &&
      v(
        "Cannot add a GraphObject that already belongs to another Panel to this Panel: " +
          b.toString() +
          ", already contained by " +
          c.toString() +
          ", cannot be shared by this Panel: " +
          this.toString()
      );
    this.pa !== W.Grid ||
      b instanceof Hf ||
      v("Can only add Shapes to a Grid Panel, not: " + b);
    this.pa !== W.Graduated ||
      b instanceof Hf ||
      b instanceof Yg ||
      v("Can only add Shapes or TextBlocks to a Graduated Panel, not: " + b);
    b.bj(this);
    b.Uj = null;
    if (null !== this.itemArray) {
      var d = b.data;
      null !== d &&
        "object" === typeof d &&
        (null === this.be && (this.be = new xb()), this.be.add(d, b));
    }
    var e = this.W;
    d = -1;
    if (c === this) {
      for (var f = -1, g = this.W.m, h = g.length, k = 0; k < h; k++)
        if (g[k] === b) {
          f = k;
          break;
        }
      if (-1 !== f) {
        if (f === a || (f + 1 >= e.count && a >= e.count)) return;
        e.nb(f);
        d = f;
      } else
        v(
          "element " +
            b.toString() +
            " has panel " +
            c.toString() +
            " but is not contained by it."
        );
    }
    if (0 > a || a > e.count) a = e.count;
    e.Cb(a, b);
    if (0 === a || b.isPanelMain) this.uh = null;
    Aj(this) || this.v();
    b.v(!1);
    null !== b.portId
      ? (this.Te = !0)
      : b instanceof W && !0 === b.Te && (this.Te = !0);
    this.Zf = null;
    this.Mf() || vn(this, b, !1);
    c = this.part;
    null !== c &&
      ((c.ui = null),
      (c.dg = NaN),
      this.Te && c instanceof V && (c.Te = !0),
      c.Te && c instanceof V && (c.tc = null),
      (e = this.diagram),
      (null !== e && e.undoManager.isUndoingRedoing) ||
        (-1 !== d && c.cb(se, "elements", this, b, null, d, null),
        c.cb(re, "elements", this, null, b, null, a)));
  };
  function wn(a, b) {
    a.A = b ? a.A | 16777216 : a.A & -16777217;
  }
  t.remove = function (a) {
    x(a, O, W, "remove:element");
    for (var b = this.W.m, c = b.length, d = -1, e = 0; e < c; e++)
      if (b[e] === a) {
        d = e;
        break;
      }
    -1 !== d && this.kc(d, !0);
  };
  t.nb = function (a) {
    G && D(a, W, "removeAt:idx");
    0 <= a && this.kc(a, !0);
  };
  t.kc = function (a, b) {
    var c = this.W,
      d = c.N(a);
    d.Uj = null;
    d.bj(null);
    if (null !== this.be) {
      var e = d.data;
      "object" === typeof e && this.be.remove(e);
    }
    c.nb(a);
    vj(this, !1);
    this.v();
    this.uh === d && (this.uh = null);
    this.Zf = null;
    var f = this.part;
    null !== f &&
      ((f.ui = null),
      (f.dg = NaN),
      f.Tb(),
      f instanceof V &&
        (d instanceof W
          ? d.Jk(d, function (a, c) {
              cm(f, c, b);
            })
          : cm(f, d, b)),
      (c = this.diagram),
      (null !== c && c.undoManager.isUndoingRedoing) ||
        f.cb(se, "elements", this, d, null, a, null));
  };
  W.prototype.getRowDefinition = function (a) {
    G && D(a, W, "getRowDefinition:idx");
    0 > a && Aa(a, ">= 0", W, "getRowDefinition:idx");
    a = Math.round(a);
    var b = this.Lb;
    if (void 0 === b) return null;
    if (void 0 === b[a]) {
      var c = new bk();
      c.bj(this);
      c.isRow = !0;
      c.index = a;
      b[a] = c;
      this.cb(re, "rowdefs", this, null, c, null, a);
    }
    return b[a];
  };
  W.prototype.WA = function (a) {
    G && D(a, W, "removeRowDefinition:idx");
    0 > a && Aa(a, ">= 0", W, "removeRowDefinition:idx");
    a = Math.round(a);
    var b = this.Lb;
    if (void 0 !== b) {
      var c = b[a];
      if (c) {
        b[a] = void 0;
        for (var d = b.length - 1; 0 <= d && void 0 === b[d--]; ) b.length--;
        this.cb(se, "rowdefs", this, c, null, a, null);
        this.v();
      }
    }
  };
  function ck(a, b, c) {
    var d = a.Lb;
    if (d && !(0 > b)) {
      d[b] = c instanceof bk ? c : void 0;
      if (!c) for (b = d.length - 1; 0 <= b && void 0 === d[b--]; ) d.length--;
      a.v();
    }
  }
  W.prototype.getColumnDefinition = function (a) {
    G && D(a, W, "getColumnDefinition:idx");
    0 > a && Aa(a, ">= 0", W, "getColumnDefinition:idx");
    a = Math.round(a);
    var b = this.Gb;
    if (void 0 === b) return null;
    if (void 0 === b[a]) {
      var c = new bk();
      c.bj(this);
      c.isRow = !1;
      c.index = a;
      b[a] = c;
      this.cb(re, "coldefs", this, null, c, null, a);
    }
    return b[a];
  };
  t = W.prototype;
  t.RA = function (a) {
    G && D(a, W, "removeColumnDefinition:idx");
    0 > a && Aa(a, ">= 0", W, "removeColumnDefinition:idx");
    a = Math.round(a);
    var b = this.Gb;
    if (void 0 !== b) {
      var c = b[a];
      if (c) {
        b[a] = void 0;
        for (var d = b.length - 1; 0 <= d && void 0 === b[d--]; ) b.length--;
        this.cb(se, "coldefs", this, c, null, a, null);
        this.v();
      }
    }
  };
  function dk(a, b, c) {
    var d = a.Gb;
    if (d && !(0 > b)) {
      d[b] = c instanceof bk ? c : void 0;
      if (!c) for (b = d.length - 1; 0 <= b && void 0 === d[b--]; ) d.length--;
      a.v();
    }
  }
  t.Yz = function (a) {
    if (0 > a || this.type !== W.Table) return -1;
    for (var b = 0, c = this.Lb, d = c.length, e = this.Ei; e < d; e++) {
      var f = c[e];
      if (void 0 !== f && ((b += f.total), a < b)) break;
    }
    return e;
  };
  t.Qz = function (a) {
    if (0 > a || this.type !== W.Table) return -1;
    for (var b = 0, c = this.Gb, d = c.length, e = this.ni; e < d; e++) {
      var f = c[e];
      if (void 0 !== f && ((b += f.total), a < b)) break;
    }
    return e;
  };
  t.oA = function (a, b) {
    void 0 === b && (b = new K(NaN, NaN));
    if (this.type !== W.Graduated) return b.h(NaN, NaN), b;
    a = Math.min(Math.max(a, this.graduatedMin), this.graduatedMax);
    var c = this.vb();
    c.geometry.vv((a - this.graduatedMin) / this.graduatedRange, b);
    return c.transform.Ha(b);
  };
  t.pA = function (a) {
    if (this.type !== W.Graduated) return NaN;
    var b = this.vb();
    b.transform.Od(a);
    return b.geometry.Zx(a) * this.graduatedRange + this.graduatedMin;
  };
  function Tl(a) {
    a = a.Yh;
    return null !== a && a.u;
  }
  function sg(a) {
    var b = a.Yh;
    if (null === b)
      null !== a.data && v("Template cannot have .data be non-null: " + a),
        (a.Yh = b = new H());
    else if (b.u) return;
    var c = new H();
    wn(a, !1);
    a.Jk(a, function (a, d) {
      var e = d.ob;
      if (null !== e)
        for (Ql(d, !1), e = e.iterator; e.next(); ) {
          var f = e.value;
          f.mode === xn && Ql(d, !0);
          var g = f.sourceName;
          null !== g &&
            ("/" === g && wn(a, !0),
            (g = tl(f, a, d)),
            null !== g &&
              (c.add(g), null === g.Wl && (g.Wl = new H()), g.Wl.add(f)));
          b.add(f);
        }
      if (d instanceof W && d.type === W.Table) {
        if (0 < d.Lb.length)
          for (a = d.Lb, e = a.length, f = 0; f < e; f++)
            if (((g = a[f]), void 0 !== g && null !== g.ob))
              for (var h = g.ob.iterator; h.next(); ) {
                var k = h.value;
                k.wd = g;
                k.Gp = 2;
                k.$l = g.index;
                b.add(k);
              }
        if (0 < d.Gb.length)
          for (d = d.Gb, a = d.length, e = 0; e < a; e++)
            if (((f = d[e]), void 0 !== f && null !== f.ob))
              for (g = f.ob.iterator; g.next(); )
                (h = g.value),
                  (h.wd = f),
                  (h.Gp = 1),
                  (h.$l = f.index),
                  b.add(h);
      }
    });
    for (var d = c.iterator; d.next(); ) {
      var e = d.value;
      if (null !== e.Wl) {
        Ql(e, !0);
        for (var f = e.Wl.iterator; f.next(); ) {
          var g = f.value;
          null === e.ob && (e.ob = new H());
          e.ob.add(g);
        }
      }
      e.Wl = null;
    }
    for (var h = b.iterator; h.next(); )
      if (((d = h.value), (e = d.wd), null !== e)) {
        d.wd = null;
        g = d.targetProperty;
        var k = g.indexOf(".");
        0 < k &&
          e instanceof W &&
          ((f = g.substring(0, k)),
          (g = g.substr(k + 1)),
          (k = e.hb(f)),
          null !== k
            ? ((e = k), (d.targetProperty = g))
            : Fa(
                'Warning: unable to find GraphObject named "' +
                  f +
                  '" for Binding: ' +
                  d.toString()
              ));
        e instanceof bk
          ? ((f = lb(e.panel)),
            (d.gj = void 0 === f ? -1 : f),
            (e.panel.Uk = d.gj))
          : e instanceof O
          ? ((f = lb(e)), (d.gj = void 0 === f ? -1 : f), (e.Uk = d.gj))
          : v("Unknown type of binding target: " + e);
      }
    b.freeze();
    a instanceof U &&
      (a.Tc() && a.Za(),
      G &&
        !yn &&
        a.Jk(a, function (a, c) {
          if (
            c instanceof W &&
            (c.type === W.Auto ||
              c.type === W.Spot ||
              c.type === W.Graduated) &&
            1 >= c.elements.count &&
            !(c instanceof U)
          ) {
            var d = !1;
            if (1 === c.elements.count && ((d = null !== c.itemArray), !d))
              for (h = b.iterator; h.next(); )
                if ("itemArray" === h.value.targetProperty) {
                  d = !0;
                  break;
                }
            d ||
              (Fa(
                "Auto, Spot, or Graduated Panel should not have zero or one elements: " +
                  c.toString() +
                  " in " +
                  a.toString()
              ),
              (yn = !0));
          }
        }));
  }
  t.Bz = function (a) {
    void 0 === a && (a = !1);
    var b = this.copy();
    pn(b, function (a) {
      a instanceof W && ((a.Yh = null), (a.qb = null));
      var b = a.ob;
      null !== b &&
        ((a.ob = null),
        b.each(function (b) {
          a.bind(b.copy());
        }));
      b = a.Cg;
      null !== b &&
        ((a.Cg = null),
        b.each(function (b) {
          a.fw(b.value.copy());
        }));
    });
    a && sg(b);
    return b;
  };
  t.Ka = function (a) {
    var b = this.Yh;
    if (null !== b)
      for (void 0 === a && (a = ""), b = b.iterator; b.next(); ) {
        var c = b.value,
          d = c.sourceProperty;
        if ("" === a || "" === d || d === a)
          if (((d = c.targetProperty), null !== c.converter || "" !== d)) {
            d = this.data;
            var e = c.sourceName;
            if (null !== e)
              if ("" === e) d = this;
              else if ("/" === e) d = this;
              else if ("." === e) d = this;
              else if (".." === e) d = this;
              else {
                if (((d = this.hb(e)), null === d)) {
                  G &&
                    Fa(
                      "Binding error: missing GraphObject named " +
                        e +
                        " in " +
                        this.toString()
                    );
                  continue;
                }
              }
            else if (c.isToModel)
              if (((d = this.diagram), null !== d)) d = d.model.modelData;
              else continue;
            var f = this,
              g = c.gj;
            if (-1 !== g) {
              if (((f = this.Bs(g)), null === f)) continue;
            } else null !== c.wd && (f = c.wd);
            "/" === e
              ? (d = f.part)
              : "." === e
              ? (d = f)
              : ".." === e && (d = f.panel);
            e = c.Gp;
            if (0 !== e) {
              if (!(f instanceof W)) continue;
              1 === e
                ? (f = f.getColumnDefinition(c.$l))
                : 2 === e && (f = f.getRowDefinition(c.$l));
            }
            void 0 !== f && c.iw(f, d);
          }
      }
  };
  t.Ux = function (a) {
    if (void 0 === a || null === a || null === this.be) return null;
    A(a, "object", W, "findItemPanelForData");
    return this.be.K(a);
  };
  function zn(a, b) {
    a = a.W.m;
    for (
      var c = a.length, d = b.length, e = 0, f = null;
      e < c && !((f = a[e]), f instanceof W && null !== f.data);

    )
      e++, (f = a[e]);
    if (c - e !== d) return !0;
    if (null === f) return 0 < d;
    for (var g = 0; e < c && g < d; ) {
      f = a[e];
      if (!(f instanceof W) || f.data !== b[g]) return !0;
      e++;
      g++;
    }
    return !1;
  }
  function sn(a) {
    if (a.type === W.Spot || a.type === W.Auto) return Math.min(a.W.length, 1);
    if (a.type === W.Link) {
      a = a.W;
      for (var b = a.length, c = 0; c < b; c++) {
        var d = a.N(c);
        if (!(d instanceof Hf && d.isPanelMain)) break;
      }
      return c;
    }
    return a.type === W.Table &&
      0 < a.W.length &&
      ((a = a.W.N(0)),
      a.isPanelMain &&
        a instanceof W &&
        (a.type === W.TableRow || a.type === W.TableColumn))
      ? 1
      : 0;
  }
  t.Ov = function () {
    for (var a = sn(this); this.W.length > a; ) this.kc(this.W.length - 1, !1);
    An(this, this.itemArray);
  };
  function An(a, b) {
    var c = sn(a);
    if (null === b || 0 === b.length)
      for (; a.W.length > c; ) a.kc(a.W.length - 1, !1);
    else if (a.W.length <= c) {
      c = b.length;
      for (var d = 0; d < c; d++) Bn(a, b[d], d, !0);
    } else {
      d = c;
      for (var e = 0; e < b.length; e++, d++) {
        var f = b[e],
          g = d < a.W.length ? a.W.N(d) : null;
        if (g instanceof W) {
          if (g.data !== f) {
            var h = Cn(a, g.data),
              k = Cn(a, f),
              l = k !== h;
            l || ((h = Dn(a, h)), (l = Dn(a, k) !== h));
            l ? (a.kc(d, !1), Bn(a, f, e, !1)) : (g.data = f);
          }
        } else Bn(a, f, e, !1);
      }
      for (; d < a.W.length; ) a.kc(d, !1);
      a.uh = null;
      En(a, c, 0);
      Aj(a) || a.v();
      a.Zf = null;
      a.Mf() || vn(a, a, !1);
      b = a.part;
      null !== b &&
        ((b.ui = null),
        (b.dg = NaN),
        a.Te && b instanceof V && (b.Te = !0),
        b.Te && b instanceof V && (b.tc = null));
    }
  }
  function Bn(a, b, c, d) {
    if (!(void 0 === b || null === b || 0 > c)) {
      var e = Cn(a, b);
      e = Dn(a, e);
      if (null !== e) {
        sg(e);
        e = e.copy();
        if (0 !== (e.A & 16777216)) {
          var f = a.Hh();
          null !== f && wn(f, !0);
        }
        "object" === typeof b &&
          (null === a.be && (a.be = new xb()), a.be.add(b, e));
        f = c + sn(a);
        a.Cb(f, e);
        d && ((e.qb = b), En(a, f, c), (e.qb = null));
        e.data = b;
      }
    }
  }
  function En(a, b, c) {
    for (a = a.W; b < a.length; ) {
      var d = a.N(b);
      if (d instanceof W) {
        var e = b,
          f = c;
        d.type === W.TableRow
          ? (d.row = e)
          : d.type === W.TableColumn && (d.column = e);
        d.itemIndex = f;
      }
      b++;
      c++;
    }
  }
  function Cn(a, b) {
    if (null === b) return "";
    a = a.xl;
    if ("function" === typeof a) a = a(b);
    else if ("string" === typeof a && "object" === typeof b) {
      if ("" === a) return "";
      a = Fn(b, a);
    } else return "";
    if (void 0 === a) return "";
    if ("string" === typeof a) return a;
    v(
      "Panel.getCategoryForItemData found a non-string category for " +
        b +
        ": " +
        a
    );
  }
  function Dn(a, b) {
    var c = a.itemTemplateMap,
      d = null;
    null !== c && (d = c.K(b));
    null === d &&
      (null !== c && (d = c.K("")),
      null === d &&
        (Gn ||
          ((Gn = !0),
          Fa('No item template Panel found for category "' + b + '" on ' + a),
          Fa("  Using default item template."),
          (a = new W()),
          (b = new Yg()),
          b.bind(new Fi("text", "", Ra)),
          a.add(b),
          (Hn = a)),
        (d = Hn)));
    return d;
  }
  function vn(a, b, c) {
    var d = b.enabledChanged;
    null !== d && d(b, c);
    if (b instanceof W) {
      b = b.W.m;
      d = b.length;
      for (var e = 0; e < d; e++) {
        var f = b[e];
        (c && f instanceof W && !f.isEnabled) || vn(a, f, c);
      }
    }
  }
  function In(a, b) {
    b.name = a;
    Xl.add(a, b);
  }
  oa.Object.defineProperties(W.prototype, {
    type: {
      configurable: !0,
      get: function () {
        return this.pa;
      },
      set: function (a) {
        var b = this.pa;
        b !== a &&
          ((this.pa = a),
          this.pa === W.Grid
            ? (this.isAtomic = !0)
            : this.pa === W.Table && jn(this),
          this.v(),
          this.g("type", b, a));
      },
    },
    elements: {
      configurable: !0,
      get: function () {
        return this.W.iterator;
      },
    },
    naturalBounds: {
      configurable: !0,
      get: function () {
        return this.zc;
      },
    },
    padding: {
      configurable: !0,
      get: function () {
        return this.ub;
      },
      set: function (a) {
        "number" === typeof a
          ? (0 > a && Aa(a, ">= 0", W, "padding"), (a = new ic(a)))
          : (x(a, ic, W, "padding"),
            0 > a.left && Aa(a.left, ">= 0", W, "padding:value.left"),
            0 > a.right && Aa(a.right, ">= 0", W, "padding:value.right"),
            0 > a.top && Aa(a.top, ">= 0", W, "padding:value.top"),
            0 > a.bottom && Aa(a.bottom, ">= 0", W, "padding:value.bottom"));
        var b = this.ub;
        b.D(a) || ((this.ub = a = a.L()), this.v(), this.g("padding", b, a));
      },
    },
    defaultAlignment: {
      configurable: !0,
      get: function () {
        return this.yn;
      },
      set: function (a) {
        var b = this.yn;
        b.D(a) ||
          (G && x(a, Ib, W, "defaultAlignment"),
          (this.yn = a = a.L()),
          this.v(),
          this.g("defaultAlignment", b, a));
      },
    },
    defaultStretch: {
      configurable: !0,
      get: function () {
        return this.Wf;
      },
      set: function (a) {
        var b = this.Wf;
        b !== a &&
          (cb(a, O, W, "defaultStretch"),
          (this.Wf = a),
          this.v(),
          this.g("defaultStretch", b, a));
      },
    },
    defaultSeparatorPadding: {
      configurable: !0,
      get: function () {
        return void 0 === this.xj ? Cc : this.xj;
      },
      set: function (a) {
        if (void 0 !== this.xj) {
          "number" === typeof a
            ? (a = new ic(a))
            : G && x(a, ic, W, "defaultSeparatorPadding");
          var b = this.xj;
          b.D(a) ||
            ((this.xj = a = a.L()),
            this.v(),
            this.g("defaultSeparatorPadding", b, a));
        }
      },
    },
    defaultRowSeparatorStroke: {
      configurable: !0,
      get: function () {
        return void 0 === this.di ? null : this.di;
      },
      set: function (a) {
        var b = this.di;
        b !== a &&
          (null === a || "string" === typeof a || a instanceof Al) &&
          (a instanceof Al && a.freeze(),
          (this.di = a),
          this.R(),
          this.g("defaultRowSeparatorStroke", b, a));
      },
    },
    defaultRowSeparatorStrokeWidth: {
      configurable: !0,
      get: function () {
        return void 0 === this.Mg ? 1 : this.Mg;
      },
      set: function (a) {
        if (void 0 !== this.Mg) {
          var b = this.Mg;
          b !== a &&
            isFinite(a) &&
            0 <= a &&
            ((this.Mg = a),
            this.v(),
            this.g("defaultRowSeparatorStrokeWidth", b, a));
        }
      },
    },
    defaultRowSeparatorDashArray: {
      configurable: !0,
      get: function () {
        return void 0 === this.ci ? null : this.ci;
      },
      set: function (a) {
        if (void 0 !== this.ci) {
          var b = this.ci;
          if (b !== a) {
            null === a ||
              Array.isArray(a) ||
              za(a, "Array", W, "defaultRowSeparatorDashArray:value");
            if (null !== a) {
              for (var c = a.length, d = 0, e = 0; e < c; e++) {
                var f = a[e];
                ("number" === typeof f && 0 <= f && isFinite(f)) ||
                  v(
                    "defaultRowSeparatorDashArray value " +
                      f +
                      " at index " +
                      e +
                      " must be a positive number or zero."
                  );
                d += f;
              }
              if (0 === d) {
                if (null === b) return;
                a = null;
              }
            }
            this.ci = a;
            this.R();
            this.g("defaultRowSeparatorDashArray", b, a);
          }
        }
      },
    },
    defaultColumnSeparatorStroke: {
      configurable: !0,
      get: function () {
        return void 0 === this.Kg ? null : this.Kg;
      },
      set: function (a) {
        if (void 0 !== this.Kg) {
          var b = this.Kg;
          b !== a &&
            (null === a || "string" === typeof a || a instanceof Al) &&
            (a instanceof Al && a.freeze(),
            (this.Kg = a),
            this.R(),
            this.g("defaultColumnSeparatorStroke", b, a));
        }
      },
    },
    defaultColumnSeparatorStrokeWidth: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return void 0 === this.Lg ? 1 : this.Lg;
      },
      set: function (a) {
        if (void 0 !== this.Lg) {
          var b = this.Lg;
          b !== a &&
            isFinite(a) &&
            0 <= a &&
            ((this.Lg = a),
            this.v(),
            this.g("defaultColumnSeparatorStrokeWidth", b, a));
        }
      },
    },
    defaultColumnSeparatorDashArray: {
      configurable: !0,
      get: function () {
        return void 0 === this.bi ? null : this.bi;
      },
      set: function (a) {
        if (void 0 !== this.bi) {
          var b = this.bi;
          if (b !== a) {
            null === a ||
              Array.isArray(a) ||
              za(a, "Array", W, "defaultColumnSeparatorDashArray:value");
            if (null !== a) {
              for (var c = a.length, d = 0, e = 0; e < c; e++) {
                var f = a[e];
                ("number" === typeof f && 0 <= f && isFinite(f)) ||
                  v(
                    "defaultColumnSeparatorDashArray value " +
                      f +
                      " at index " +
                      e +
                      " must be a positive number or zero."
                  );
                d += f;
              }
              if (0 === d) {
                if (null === b) return;
                a = null;
              }
            }
            this.bi = a;
            this.R();
            this.g("defaultColumnSeparatorDashArray", b, a);
          }
        }
      },
    },
    viewboxStretch: {
      configurable: !0,
      get: function () {
        return this.Pp;
      },
      set: function (a) {
        var b = this.Pp;
        b !== a &&
          (cb(a, O, W, "viewboxStretch"),
          (this.Pp = a),
          this.v(),
          this.g("viewboxStretch", b, a));
      },
    },
    gridCellSize: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Vn;
      },
      set: function (a) {
        var b = this.Vn;
        if (!b.D(a)) {
          x(a, Gb, W, "gridCellSize");
          (a.s() && 0 !== a.width && 0 !== a.height) ||
            v("Invalid Panel.gridCellSize: " + a);
          this.Vn = a.L();
          var c = this.diagram;
          null !== c && this === c.grid && wj(c);
          this.R();
          this.g("gridCellSize", b, a);
        }
      },
    },
    gridOrigin: {
      configurable: !0,
      get: function () {
        return this.Wn;
      },
      set: function (a) {
        var b = this.Wn;
        if (!b.D(a)) {
          x(a, K, W, "gridOrigin");
          a.s() || v("Invalid Panel.gridOrigin: " + a);
          this.Wn = a.L();
          var c = this.diagram;
          null !== c && this === c.grid && wj(c);
          this.R();
          this.g("gridOrigin", b, a);
        }
      },
    },
    graduatedMin: {
      configurable: !0,
      get: function () {
        return this.Sn;
      },
      set: function (a) {
        D(a, W, "graduatedMin");
        var b = this.Sn;
        b !== a &&
          ((this.Sn = a),
          this.v(),
          this.g("graduatedMin", b, a),
          rl(this) &&
            ((a = this.part), null !== a && sl(this, a, "graduatedRange")));
      },
    },
    graduatedMax: {
      configurable: !0,
      get: function () {
        return this.Rn;
      },
      set: function (a) {
        D(a, W, "graduatedMax");
        var b = this.Rn;
        b !== a &&
          ((this.Rn = a),
          this.v(),
          this.g("graduatedMax", b, a),
          rl(this) &&
            ((a = this.part), null !== a && sl(this, a, "graduatedRange")));
      },
    },
    graduatedRange: {
      configurable: !0,
      get: function () {
        return this.graduatedMax - this.graduatedMin;
      },
    },
    graduatedTickUnit: {
      configurable: !0,
      get: function () {
        return this.Un;
      },
      set: function (a) {
        D(a, W, "graduatedTickUnit");
        var b = this.Un;
        b !== a &&
          0 < a &&
          ((this.Un = a), this.v(), this.g("graduatedTickUnit", b, a));
      },
    },
    graduatedTickBase: {
      configurable: !0,
      get: function () {
        return this.Tn;
      },
      set: function (a) {
        D(a, W, "graduatedTickBase");
        var b = this.Tn;
        b !== a && ((this.Tn = a), this.v(), this.g("graduatedTickBase", b, a));
      },
    },
    Te: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 8388608);
      },
      set: function (a) {
        (0 !== (this.A & 8388608)) !== a && (this.A ^= 8388608);
      },
    },
    rowCount: {
      configurable: !0,
      get: function () {
        return void 0 === this.Lb ? 0 : this.Lb.length;
      },
    },
    columnCount: {
      configurable: !0,
      get: function () {
        return void 0 === this.Gb ? 0 : this.Gb.length;
      },
    },
    rowSizing: {
      configurable: !0,
      get: function () {
        return void 0 === this.Wj ? kn : this.Wj;
      },
      set: function (a) {
        if (void 0 !== this.Wj) {
          var b = this.Wj;
          b !== a &&
            (G &&
              a !== kn &&
              a !== Sm &&
              v(
                "Panel.rowSizing must be RowColumnDefinition.ProportionalExtra or RowColumnDefinition.None, not: " +
                  a
              ),
            (this.Wj = a),
            this.v(),
            this.g("rowSizing", b, a));
        }
      },
    },
    columnSizing: {
      configurable: !0,
      get: function () {
        return void 0 === this.wj ? kn : this.wj;
      },
      set: function (a) {
        if (void 0 !== this.wj) {
          var b = this.wj;
          b !== a &&
            (G &&
              a !== kn &&
              a !== Sm &&
              v(
                "Panel.columnSizing must be RowColumnDefinition.ProportionalExtra or RowColumnDefinition.None, not: " +
                  a
              ),
            (this.wj = a),
            this.v(),
            this.g("columnSizing", b, a));
        }
      },
    },
    topIndex: {
      configurable: !0,
      get: function () {
        return void 0 === this.Ei ? 0 : this.Ei;
      },
      set: function (a) {
        if (void 0 !== this.Ei) {
          var b = this.Ei;
          b !== a &&
            ((!isFinite(a) || 0 > a) &&
              v(
                "Panel.topIndex must be greater than zero and a real number, not: " +
                  a
              ),
            (this.Ei = a),
            this.v(),
            this.g("topIndex", b, a));
        }
      },
    },
    leftIndex: {
      configurable: !0,
      get: function () {
        return void 0 === this.ni ? 0 : this.ni;
      },
      set: function (a) {
        if (void 0 !== this.ni) {
          var b = this.ni;
          b !== a &&
            ((!isFinite(a) || 0 > a) &&
              v(
                "Panel.leftIndex must be greater than zero and a real number, not: " +
                  a
              ),
            (this.ni = a),
            this.v(),
            this.g("leftIndex", b, a));
        }
      },
    },
    data: {
      configurable: !0,
      get: function () {
        return this.qb;
      },
      set: function (a) {
        var b = this.qb;
        if (b !== a) {
          var c = this instanceof U && !(this instanceof Je);
          c && A(a, "object", W, "data");
          sg(this);
          this.qb = a;
          var d = this.diagram;
          null !== d &&
            (c
              ? ((c = d.partManager),
                this instanceof R
                  ? (null !== b && c.bf.remove(b),
                    null !== a && c.bf.add(a, this))
                  : this instanceof U &&
                    (null !== b && c.cf.remove(b),
                    null !== a && c.cf.add(a, this)))
              : ((c = this.panel),
                null !== c &&
                  null !== c.be &&
                  (null !== b && c.be.remove(b),
                  null !== a && c.be.add(a, this))));
          this.g("data", b, a);
          (null !== d && d.undoManager.isUndoingRedoing) ||
            (null !== a && this.Ka());
        }
      },
    },
    itemIndex: {
      configurable: !0,
      get: function () {
        return this.no;
      },
      set: function (a) {
        var b = this.no;
        b !== a && ((this.no = a), this.g("itemIndex", b, a));
      },
    },
    itemArray: {
      configurable: !0,
      get: function () {
        return this.ji;
      },
      set: function (a) {
        G &&
          null !== a &&
          !Array.isArray(a) &&
          v("Panel.itemArray must be an Array-like object or null, not: " + a);
        var b = this.ji;
        if (b !== a || (null !== a && zn(this, a))) {
          var c = this.diagram;
          b !== a &&
            (null !== c && null !== b && Sj(c.partManager, this, c),
            (this.ji = a),
            null !== c && null !== a && Pj(c.partManager, this));
          this.g("itemArray", b, a);
          (null !== c && c.undoManager.isUndoingRedoing) || An(this, a);
        }
      },
    },
    itemTemplate: {
      configurable: !0,
      get: function () {
        return null === this.Be ? null : this.Be.K("");
      },
      set: function (a) {
        if (null === this.Be) {
          if (null === a) return;
          this.Be = new xb();
        }
        var b = this.Be.K("");
        b !== a &&
          (x(a, W, W, "itemTemplate"),
          (a instanceof U || a.isPanelMain) &&
            v(
              "Panel.itemTemplate must not be a Part or be Panel.isPanelMain: " +
                a
            ),
          this.Be.add("", a),
          this.g("itemTemplate", b, a),
          (a = this.diagram),
          (null !== a && a.undoManager.isUndoingRedoing) || this.Ov());
      },
    },
    itemTemplateMap: {
      configurable: !0,
      get: function () {
        return this.Be;
      },
      set: function (a) {
        var b = this.Be;
        if (b !== a) {
          x(a, xb, W, "itemTemplateMap");
          for (var c = a.iterator; c.next(); ) {
            var d = c.value;
            G &&
              (d instanceof U || d.isPanelMain) &&
              v(
                "Template in Panel.itemTemplateMap must not be a Part or be Panel.isPanelMain: " +
                  d
              );
          }
          this.Be = a;
          this.g("itemTemplateMap", b, a);
          a = this.diagram;
          (null !== a && a.undoManager.isUndoingRedoing) || this.Ov();
        }
      },
    },
    itemCategoryProperty: {
      configurable: !0,
      get: function () {
        return this.xl;
      },
      set: function (a) {
        var b = this.xl;
        b !== a &&
          ("string" !== typeof a &&
            "function" !== typeof a &&
            za(a, "string or function", W, "itemCategoryProperty"),
          (this.xl = a),
          this.g("itemCategoryProperty", b, a));
      },
    },
    isAtomic: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 1048576);
      },
      set: function (a) {
        var b = 0 !== (this.A & 1048576);
        b !== a &&
          (A(a, "boolean", W, "isAtomic"),
          (this.A ^= 1048576),
          this.g("isAtomic", b, a));
      },
    },
    isClipping: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return 0 !== (this.A & 2097152);
      },
      set: function (a) {
        var b = 0 !== (this.A & 2097152);
        b !== a &&
          (G &&
            (A(a, "boolean", W, "isClipping"),
            !a ||
              this.type === W.Spot ||
              this instanceof vf ||
              Fa(
                "Warning: Panel.isClipping set on non-Spot Panel: " +
                  this.toString()
              )),
          (this.A ^= 2097152),
          this instanceof vf && (this.kb = null),
          this.v(),
          this.g("isClipping", b, a));
      },
    },
    isOpposite: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 33554432);
      },
      set: function (a) {
        var b = 0 !== (this.A & 33554432);
        b !== a &&
          (A(a, "boolean", W, "isOpposite"),
          (this.A ^= 33554432),
          this.v(),
          this.g("isOpposite", b, a));
      },
    },
    isEnabled: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 4194304);
      },
      set: function (a) {
        var b = 0 !== (this.A & 4194304);
        if (b !== a) {
          A(a, "boolean", W, "isEnabled");
          var c = null === this.panel || this.panel.Mf();
          this.A ^= 4194304;
          this.g("isEnabled", b, a);
          b = this.diagram;
          (null !== b && b.undoManager.isUndoingRedoing) ||
            (c && vn(this, this, a));
        }
      },
    },
    alignmentFocusName: {
      configurable: !0,
      get: function () {
        return this.$e;
      },
      set: function (a) {
        var b = this.$e;
        b !== a &&
          (G && A(a, "string", W, "alignmentFocusName"),
          (this.$e = a),
          this.v(),
          this.g("alignmentFocusName", b, a));
      },
    },
  });
  oa.Object.defineProperties(W, {
    Position: {
      configurable: !0,
      get: function () {
        return Xl.K("Position");
      },
    },
    Horizontal: {
      configurable: !0,
      get: function () {
        return Xl.K("Horizontal");
      },
    },
    Vertical: {
      configurable: !0,
      get: function () {
        return Xl.K("Vertical");
      },
    },
    Spot: {
      configurable: !0,
      get: function () {
        return Xl.K("Spot");
      },
    },
    Auto: {
      configurable: !0,
      get: function () {
        return Xl.K("Auto");
      },
    },
    Table: {
      configurable: !0,
      get: function () {
        return Xl.K("Table");
      },
    },
    Viewbox: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return Xl.K("Viewbox");
      },
    },
    TableRow: {
      configurable: !0,
      get: function () {
        return Xl.K("TableRow");
      },
    },
    TableColumn: {
      configurable: !0,
      get: function () {
        return Xl.K("TableColumn");
      },
    },
    Link: {
      configurable: !0,
      get: function () {
        return Xl.K("Link");
      },
    },
    Grid: {
      configurable: !0,
      get: function () {
        return Xl.K("Grid");
      },
    },
    Graduated: {
      configurable: !0,
      get: function () {
        return Xl.K("Graduated");
      },
    },
  });
  W.prototype.rebuildItemElements = W.prototype.Ov;
  W.prototype.findItemPanelForData = W.prototype.Ux;
  W.prototype.updateTargetBindings = W.prototype.Ka;
  W.prototype.copyTemplate = W.prototype.Bz;
  W.prototype.graduatedValueForPoint = W.prototype.pA;
  W.prototype.graduatedPointForValue = W.prototype.oA;
  W.prototype.findColumnForLocalX = W.prototype.Qz;
  W.prototype.findRowForLocalY = W.prototype.Yz;
  W.prototype.removeColumnDefinition = W.prototype.RA;
  W.prototype.removeRowDefinition = W.prototype.WA;
  W.prototype.removeAt = W.prototype.nb;
  W.prototype.remove = W.prototype.remove;
  W.prototype.insertAt = W.prototype.Cb;
  W.prototype.elt = W.prototype.N;
  W.prototype.add = W.prototype.add;
  W.prototype.findObject = W.prototype.hb;
  W.prototype.findInVisualTree = W.prototype.km;
  W.prototype.walkVisualTreeFrom = W.prototype.Jk;
  W.prototype.findMainElement = W.prototype.vb;
  var yn = !1,
    Gn = !1,
    Hn = null,
    Xl = new xb();
  W.className = "Panel";
  W.definePanelLayout = In;
  In("Position", new Hm());
  In("Vertical", new Km());
  In("Auto", new Nm());
  In("Link", new Ym());
  function bk() {
    ab(this);
    this.ig = null;
    this.zr = !0;
    this.Xa = 0;
    this.Bc = NaN;
    this.Pj = 0;
    this.Oj = Infinity;
    this.Eb = gd;
    this.ra = this.ic = this.na = 0;
    this.ob = null;
    this.zp = Jn;
    this.Ne = hl;
    this.tp = this.kg = null;
    this.vp = NaN;
    this.Zb = this.$j = null;
    this.un = !1;
  }
  bk.prototype.copy = function () {
    var a = new bk();
    a.zr = this.zr;
    a.Xa = this.Xa;
    a.Bc = this.Bc;
    a.Pj = this.Pj;
    a.Oj = this.Oj;
    a.Eb = this.Eb;
    a.na = this.na;
    a.ic = this.ic;
    a.ra = this.ra;
    a.Ne = this.Ne;
    a.zp = this.zp;
    null === this.kg ? (a.kg = null) : (a.kg = this.kg.L());
    a.tp = this.tp;
    a.vp = this.vp;
    a.$j = null;
    null !== this.$j && (a.separatorDashArray = Ja(this.separatorDashArray));
    a.Zb = this.Zb;
    a.un = this.un;
    a.ob = this.ob;
    return a;
  };
  t = bk.prototype;
  t.pb = function (a) {
    a.classType === bk ? (this.sizing = a) : Ea(this, a);
  };
  t.toString = function () {
    return (
      "RowColumnDefinition " +
      (this.isRow ? "(Row " : "(Column ") +
      this.index +
      ") #" +
      lb(this)
    );
  };
  t.bj = function (a) {
    this.ig = a;
  };
  t.$p = function (a) {
    var b = 0,
      c = this.ig;
    this.index !== a &&
      ((a = this.separatorStroke),
      null === a &&
        null !== c &&
        (a = this.isRow
          ? c.defaultRowSeparatorStroke
          : c.defaultColumnSeparatorStroke),
      null !== a &&
        ((b = this.separatorStrokeWidth),
        isNaN(b) &&
          (null !== c
            ? (b = this.isRow
                ? c.defaultRowSeparatorStrokeWidth
                : c.defaultColumnSeparatorStrokeWidth)
            : (b = 0))));
    a = this.kg;
    if (null === a)
      if (null !== c) a = c.defaultSeparatorPadding;
      else return b;
    return b + (this.isRow ? a.top : a.left);
  };
  t.Pc = function () {
    var a = 0,
      b = this.ig,
      c = 0,
      d = this.isRow;
    if (null !== b && b.type === W.Table)
      for (var e = d ? b.Lb.length : b.Gb.length, f = 0; f < e; f++) {
        var g = d ? b.Lb[f] : b.Gb[f];
        if (void 0 !== g) {
          c = g.index;
          break;
        }
      }
    this.index !== c &&
      ((c = this.separatorStroke),
      null === c &&
        null !== b &&
        (c = d ? b.defaultRowSeparatorStroke : b.defaultColumnSeparatorStroke),
      null !== c &&
        ((a = this.separatorStrokeWidth),
        isNaN(a) &&
          (null !== b
            ? (a = d
                ? b.defaultRowSeparatorStrokeWidth
                : b.defaultColumnSeparatorStrokeWidth)
            : (a = 0))));
    d = this.kg;
    if (null === d)
      if (null !== b) d = b.defaultSeparatorPadding;
      else return a;
    return a + (this.isRow ? d.top + d.bottom : d.left + d.right);
  };
  t.Kb = function (a, b, c) {
    var d = this.ig;
    if (
      null !== d &&
      (d.cb(pe, a, this, b, c, void 0, void 0),
      null !== this.ob &&
        ((b = d.diagram),
        null !== b &&
          !b.skipsModelSourceBindings &&
          ((d = d.Hh()), null !== d && ((b = d.data), null !== b))))
    )
      for (c = this.ob.iterator; c.next(); ) c.value.Kq(this, b, a, d);
  };
  function Rm(a) {
    if (a.sizing === Jn) {
      var b = a.ig;
      return a.isRow ? b.rowSizing : b.columnSizing;
    }
    return a.sizing;
  }
  t.bind = function (a, b, c, d) {
    var e = null;
    "string" === typeof a ? (e = new Fi(a, b, c, d)) : (e = a);
    e.wd = this;
    a = this.panel;
    null !== a &&
      ((b = a.Hh()),
      null !== b &&
        Tl(b) &&
        v(
          "Cannot add a Binding to a RowColumnDefinition that is already frozen: " +
            e +
            " on " +
            a
        ));
    null === this.ob && (this.ob = new H());
    this.ob.add(e);
    return this;
  };
  oa.Object.defineProperties(bk.prototype, {
    panel: {
      configurable: !0,
      get: function () {
        return this.ig;
      },
    },
    isRow: {
      configurable: !0,
      get: function () {
        return this.zr;
      },
      set: function (a) {
        this.zr = a;
      },
    },
    index: {
      configurable: !0,
      get: function () {
        return this.Xa;
      },
      set: function (a) {
        this.Xa = a;
      },
    },
    height: {
      configurable: !0,
      get: function () {
        return this.Bc;
      },
      set: function (a) {
        var b = this.Bc;
        b !== a &&
          (G && A(a, "number", bk, "height"),
          0 > a && Aa(a, ">= 0", bk, "height"),
          (this.Bc = a),
          (this.actual = this.na),
          null !== this.panel && this.panel.v(),
          this.Kb("height", b, a));
      },
    },
    width: {
      configurable: !0,
      get: function () {
        return this.Bc;
      },
      set: function (a) {
        var b = this.Bc;
        b !== a &&
          (G && A(a, "number", bk, "width"),
          0 > a && Aa(a, ">= 0", bk, "width"),
          (this.Bc = a),
          (this.actual = this.na),
          null !== this.panel && this.panel.v(),
          this.Kb("width", b, a));
      },
    },
    minimum: {
      configurable: !0,
      get: function () {
        return this.Pj;
      },
      set: function (a) {
        var b = this.Pj;
        b !== a &&
          (G && A(a, "number", bk, "minimum"),
          (0 > a || !isFinite(a)) && Aa(a, ">= 0", bk, "minimum"),
          (this.Pj = a),
          (this.actual = this.na),
          null !== this.panel && this.panel.v(),
          this.Kb("minimum", b, a));
      },
    },
    maximum: {
      configurable: !0,
      get: function () {
        return this.Oj;
      },
      set: function (a) {
        var b = this.Oj;
        b !== a &&
          (G && A(a, "number", bk, "maximum"),
          0 > a && Aa(a, ">= 0", bk, "maximum"),
          (this.Oj = a),
          (this.actual = this.na),
          null !== this.panel && this.panel.v(),
          this.Kb("maximum", b, a));
      },
    },
    alignment: {
      configurable: !0,
      get: function () {
        return this.Eb;
      },
      set: function (a) {
        var b = this.Eb;
        b.D(a) ||
          (G && x(a, Ib, bk, "alignment"),
          (this.Eb = a.L()),
          null !== this.panel && this.panel.v(),
          this.Kb("alignment", b, a));
      },
    },
    stretch: {
      configurable: !0,
      get: function () {
        return this.Ne;
      },
      set: function (a) {
        var b = this.Ne;
        b !== a &&
          (G && cb(a, O, bk, "stretch"),
          (this.Ne = a),
          null !== this.panel && this.panel.v(),
          this.Kb("stretch", b, a));
      },
    },
    separatorPadding: {
      configurable: !0,
      get: function () {
        return this.kg;
      },
      set: function (a) {
        "number" === typeof a
          ? (a = new ic(a))
          : null !== a && G && x(a, ic, bk, "separatorPadding");
        var b = this.kg;
        (null !== a && null !== b && b.D(a)) ||
          (null !== a && (a = a.L()),
          (this.kg = a),
          null !== this.panel && this.panel.v(),
          this.Kb("separatorPadding", b, a));
      },
    },
    separatorStroke: {
      configurable: !0,
      get: function () {
        return this.tp;
      },
      set: function (a) {
        var b = this.tp;
        b !== a &&
          (null !== a && bm(a, "RowColumnDefinition.separatorStroke"),
          a instanceof Al && a.freeze(),
          (this.tp = a),
          null !== this.panel && this.panel.v(),
          this.Kb("separatorStroke", b, a));
      },
    },
    separatorStrokeWidth: {
      configurable: !0,
      get: function () {
        return this.vp;
      },
      set: function (a) {
        var b = this.vp;
        b !== a &&
          ((this.vp = a),
          null !== this.panel && this.panel.v(),
          this.Kb("separatorStrokeWidth", b, a));
      },
    },
    separatorDashArray: {
      configurable: !0,
      get: function () {
        return this.$j;
      },
      set: function (a) {
        var b = this.$j;
        if (b !== a) {
          null === a ||
            Array.isArray(a) ||
            za(a, "Array", bk, "separatorDashArray:value");
          if (null !== a) {
            for (var c = a.length, d = 0, e = 0; e < c; e++) {
              var f = a[e];
              ("number" === typeof f && 0 <= f && isFinite(f)) ||
                v(
                  "separatorDashArray value " +
                    f +
                    " at index " +
                    e +
                    " must be a positive number or zero."
                );
              d += f;
            }
            if (0 === d) {
              if (null === b) return;
              a = null;
            }
          }
          this.$j = a;
          null !== this.panel && this.panel.R();
          this.Kb("separatorDashArray", b, a);
        }
      },
    },
    background: {
      configurable: !0,
      get: function () {
        return this.Zb;
      },
      set: function (a) {
        var b = this.Zb;
        b !== a &&
          (null !== a && bm(a, "RowColumnDefinition.background"),
          a instanceof Al && a.freeze(),
          (this.Zb = a),
          null !== this.panel && this.panel.R(),
          this.Kb("background", b, a));
      },
    },
    coversSeparators: {
      configurable: !0,
      get: function () {
        return this.un;
      },
      set: function (a) {
        var b = this.un;
        b !== a &&
          (A(a, "boolean", bk, "coversSeparators"),
          (this.un = a),
          null !== this.panel && this.panel.R(),
          this.Kb("coversSeparators", b, a));
      },
    },
    sizing: {
      configurable: !0,
      get: function () {
        return this.zp;
      },
      set: function (a) {
        var b = this.zp;
        b !== a &&
          (G && cb(a, bk, bk, "sizing"),
          (this.zp = a),
          null !== this.panel && this.panel.v(),
          this.Kb("sizing", b, a));
      },
    },
    actual: {
      configurable: !0,
      get: function () {
        return this.na;
      },
      set: function (a) {
        this.na = isNaN(this.Bc)
          ? Math.max(Math.min(this.Oj, a), this.Pj)
          : Math.max(Math.min(this.Oj, this.Bc), this.Pj);
      },
    },
    measured: {
      configurable: !0,
      get: function () {
        return this.ic;
      },
      set: function (a) {
        this.ic = a;
      },
    },
    total: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.na + this.Pc();
      },
    },
    position: {
      configurable: !0,
      get: function () {
        return this.ra;
      },
      set: function (a) {
        this.ra = a;
      },
    },
  });
  bk.prototype.computeEffectiveSpacing = bk.prototype.Pc;
  bk.prototype.computeEffectiveSpacingTop = bk.prototype.$p;
  var Jn = new F(bk, "Default", 0),
    Sm = new F(bk, "None", 1),
    kn = new F(bk, "ProportionalExtra", 2);
  bk.className = "RowColumnDefinition";
  bk.Default = Jn;
  bk.None = Sm;
  bk.ProportionalExtra = kn;
  function Hf(a, b) {
    O.call(this);
    this.Ld = this.ta = null;
    this.In = "None";
    this.Pn = hl;
    this.Mc = this.kl = "black";
    this.ng = 1;
    this.sh = this.fb = null;
    this.wf = this.vf = gd;
    this.Wo = this.Vo = NaN;
    this.ja = null;
    "string" === typeof a ? (this.figure = a) : a && Object.assign(this, a);
    b && Object.assign(this, b);
  }
  na(Hf, O);
  Hf.prototype.cloneProtected = function (a) {
    O.prototype.cloneProtected.call(this, a);
    a.ta = this.ta;
    a.In = this.In;
    a.Pn = this.Pn;
    a.Ld = this.Ld;
    a.kl = this.kl;
    a.Mc = this.Mc;
    a.ng = this.ng;
    null !== this.fb && (a.fb = this.fb.copy());
    null !== this.sh && (a.sh = Ja(this.sh));
    a.vf = this.vf.L();
    a.wf = this.wf.L();
    a.Vo = this.Vo;
    a.Wo = this.Wo;
    null !== this.ja && (a.ja = this.ja.copy());
  };
  t = Hf.prototype;
  t.pb = function (a) {
    a === tg || a === vg || a === kl || a === hl
      ? (this.geometryStretch = a)
      : O.prototype.pb.call(this, a);
  };
  t.toString = function () {
    return (
      "Shape(" +
      ("None" !== this.figure
        ? this.figure
        : "None" !== this.toArrow
        ? this.toArrow
        : this.fromArrow) +
      ")#" +
      lb(this)
    );
  };
  function Kn(a, b, c, d) {
    var e = c.length;
    if (!(4 > e)) {
      var f = d.measuredBounds,
        g = Math.max(1, f.width);
      f = f.height;
      for (
        var h = c[0], k = c[1], l, m, n, p, r, q, u = 0, w = Ma(), y = 2;
        y < e;
        y += 2
      )
        (l = c[y]),
          (m = c[y + 1]),
          (n = l - h),
          (h = m - k),
          0 === n && (n = 0.001),
          (p = h / n),
          (r = Math.atan2(h, n)),
          (q = Math.sqrt(n * n + h * h)),
          w.push([n, r, p, q]),
          (u += q),
          (h = l),
          (k = m);
      h = c[0];
      k = c[1];
      n = d.measuredBounds.width;
      d instanceof Hf && (n -= d.strokeWidth);
      1 > n && (n = 1);
      e = c = n;
      l = g / 2;
      m = 0 === l ? !1 : !0;
      y = 0;
      q = w[y];
      n = q[0];
      r = q[1];
      p = q[2];
      q = q[3];
      for (var z = 0; 0.1 <= u; ) {
        0 === z &&
          (m ? ((e = c), (e -= l), (u -= l), (m = !1)) : (e = c),
          0 === e && (e = 1));
        if (e > u) {
          Pa(w);
          return;
        }
        e > q ? ((z = e - q), (e = q)) : (z = 0);
        var B = Math.sqrt((e * e) / (1 + p * p));
        0 > n && (B = -B);
        h += B;
        k += p * B;
        a.translate(h, k);
        a.rotate(r);
        a.translate(-(g / 2), -(f / 2));
        0 === z && d.Ni(a, b);
        a.translate(g / 2, f / 2);
        a.rotate(-r);
        a.translate(-h, -k);
        u -= e;
        q -= e;
        if (0 !== z) {
          y++;
          if (y === w.length) {
            Pa(w);
            return;
          }
          q = w[y];
          n = q[0];
          r = q[1];
          p = q[2];
          q = q[3];
          e = z;
        }
      }
      Pa(w);
    }
  }
  t.Ni = function (a, b) {
    var c = this.Mc,
      d = this.kl;
    if (null !== c || null !== d) {
      var e = this.ta;
      if (null !== e) {
        a.Oc();
        var f = this.actualBounds,
          g = this.naturalBounds;
        null !== d && pi(this, a, d, !0, !1, g, f);
        var h = this.part,
          k = this.ng;
        null === c ||
          0 !== k ||
          null === h ||
          (!this.isPanelMain && h.vb() !== this) ||
          (k =
            h.type === W.Link &&
            h instanceof Je &&
            "Selection" === h.category &&
            h.adornedObject instanceof Hf &&
            h.adornedPart.vb() === h.adornedObject
              ? h.adornedObject.strokeWidth
              : 0);
        0 === k && (c = null);
        null !== c &&
          0 !== k &&
          (pi(this, a, c, !1, !1, g, f),
          (a.lineWidth = k),
          (a.lineJoin = this.strokeJoin),
          (a.lineCap = this.strokeCap),
          (a.miterLimit = this.strokeMiterLimit));
        f = !1;
        h && b.Se("drawShadows") && (f = h.isShadowed);
        h = !0;
        null === c || (null !== d && "transparent" !== d) || (h = !1);
        g = !1;
        k = this.strokeDashArray;
        null !== k && ((g = !0), a.As(k, this.strokeDashOffset));
        if (e.type === N.j)
          a.beginPath(),
            a.moveTo(e.startX, e.startY),
            a.lineTo(e.endX, e.endY),
            null !== c && a.fj();
        else if (e.type === N.B) {
          var l = e.startX;
          k = e.startY;
          var m = e.endX,
            n = e.endY;
          e = Math.min(l, m);
          var p = Math.min(k, n);
          l = Math.abs(m - l);
          k = Math.abs(n - k);
          a.beginPath();
          a.rect(e, p, l, k);
          null !== d && a.Gf(d);
          if (null !== c) {
            h && f && El(a);
            if (0 === l || 0 === k)
              a.beginPath(), a.rect(e, p, Math.max(l, 0.1), Math.max(k, 0.1));
            a.fj();
            h && f && Dl(a);
          }
        } else if (e.type === N.M)
          (l = e.startX),
            (k = e.startY),
            (m = e.endX),
            (n = e.endY),
            (e = Math.abs(m - l) / 2),
            (p = Math.abs(n - k) / 2),
            (l = Math.min(l, m) + e),
            (k = Math.min(k, n) + p),
            a.beginPath(),
            a.moveTo(l, k - p),
            a.bezierCurveTo(l + L.Bg * e, k - p, l + e, k - L.Bg * p, l + e, k),
            a.bezierCurveTo(l + e, k + L.Bg * p, l + L.Bg * e, k + p, l, k + p),
            a.bezierCurveTo(l - L.Bg * e, k + p, l - e, k + L.Bg * p, l - e, k),
            a.bezierCurveTo(l - e, k - L.Bg * p, l - L.Bg * e, k - p, l, k - p),
            a.closePath(),
            null !== d && a.Gf(d),
            null !== c && (h && f ? (El(a), a.fj(), Dl(a)) : a.fj());
        else if (e.type === N.o)
          for (e = e.figures, k = e.length, p = 0; p < k; p++) {
            l = e.m[p];
            a.beginPath();
            a.moveTo(l.startX, l.startY);
            m = l.segments.m;
            n = m.length;
            for (var r = null, q = 0; q < n; q++) {
              var u = m[q];
              switch (u.type) {
                case Sd:
                  a.moveTo(u.endX, u.endY);
                  break;
                case Hd:
                  a.lineTo(u.endX, u.endY);
                  break;
                case Td:
                  a.bezierCurveTo(
                    u.point1X,
                    u.point1Y,
                    u.point2X,
                    u.point2Y,
                    u.endX,
                    u.endY
                  );
                  break;
                case Ud:
                  a.quadraticCurveTo(u.point1X, u.point1Y, u.endX, u.endY);
                  break;
                case Vd:
                  if (u.radiusX === u.radiusY) {
                    var w = Math.PI / 180;
                    a.arc(
                      u.point1X,
                      u.point1Y,
                      u.radiusX,
                      u.startAngle * w,
                      (u.startAngle + u.sweepAngle) * w,
                      0 > u.sweepAngle,
                      null !== r ? r.endX : l.startX,
                      null !== r ? r.endY : l.startY
                    );
                  } else if (((r = ce(u, l)), (w = r.length), 0 === w))
                    a.lineTo(u.centerX, u.centerY);
                  else
                    for (var y = 0; y < w; y++) {
                      var z = r[y];
                      0 === y && a.lineTo(z[0], z[1]);
                      a.bezierCurveTo(z[2], z[3], z[4], z[5], z[6], z[7]);
                    }
                  break;
                case be:
                  y = w = 0;
                  if (null !== r && r.type === Vd) {
                    r = ce(r, l);
                    z = r.length;
                    if (0 === z) {
                      a.lineTo(u.endX, u.endY);
                      break;
                    }
                    r = r[z - 1] || null;
                    null !== r && ((w = r[6]), (y = r[7]));
                  } else
                    (w = null !== r ? r.endX : l.startX),
                      (y = null !== r ? r.endY : l.startY);
                  r = de(u, l, w, y);
                  w = r.length;
                  if (0 === w) {
                    a.lineTo(u.endX, u.endY);
                    break;
                  }
                  for (y = 0; y < w; y++)
                    (z = r[y]),
                      a.bezierCurveTo(z[2], z[3], z[4], z[5], z[6], z[7]);
                  break;
                default:
                  v("Segment not of valid type: " + u.type);
              }
              u.isClosed && a.closePath();
              r = u;
            }
            m = l.isFilled;
            f
              ? l.isShadowed
                ? (!0 === m && "transparent" !== d && null !== d && a.Gf(d),
                  null !== c && (m && h && El(a), a.fj(), m && h && Dl(a)))
                : (El(a),
                  m && "transparent" !== d && null !== d && a.Gf(d),
                  null !== c && a.fj(),
                  Dl(a))
              : (m && null !== d && a.Gf(d), null !== c && a.fj());
          }
        g && a.ys();
        if (null !== this.pathPattern) {
          c = this.pathPattern;
          c.measure(Infinity, Infinity);
          d = c.measuredBounds;
          c.arrange(0, 0, d.width, d.height);
          f = this.geometry;
          a.save();
          a.beginPath();
          d = Ma();
          if (f.type === N.j)
            d.push(f.startX),
              d.push(f.startY),
              d.push(f.endX),
              d.push(f.endY),
              Kn(a, b, d, c);
          else if (f.type === N.o)
            for (f = f.figures.iterator; f.next(); ) {
              h = f.value;
              d.length = 0;
              d.push(h.startX);
              d.push(h.startY);
              g = h.startX;
              e = h.startY;
              k = g;
              p = e;
              l = h.segments.m;
              m = l.length;
              for (n = 0; n < m; n++) {
                q = l[n];
                switch (q.type) {
                  case Sd:
                    Kn(a, b, d, c);
                    d.length = 0;
                    d.push(q.endX);
                    d.push(q.endY);
                    g = q.endX;
                    e = q.endY;
                    k = g;
                    p = e;
                    break;
                  case Hd:
                    d.push(q.endX);
                    d.push(q.endY);
                    g = q.endX;
                    e = q.endY;
                    break;
                  case Td:
                    L.Pe(
                      g,
                      e,
                      q.point1X,
                      q.point1Y,
                      q.point2X,
                      q.point2Y,
                      q.endX,
                      q.endY,
                      0.5,
                      d
                    );
                    g = q.endX;
                    e = q.endY;
                    break;
                  case Ud:
                    L.vq(g, e, q.point1X, q.point1Y, q.endX, q.endY, 0.5, d);
                    g = q.endX;
                    e = q.endY;
                    break;
                  case Vd:
                    u = ce(q, h);
                    r = u.length;
                    if (0 === r) {
                      d.push(q.centerX);
                      d.push(q.centerY);
                      g = q.centerX;
                      e = q.centerY;
                      break;
                    }
                    for (w = 0; w < r; w++)
                      (y = u[w]),
                        L.Pe(g, e, y[2], y[3], y[4], y[5], y[6], y[7], 0.5, d),
                        (g = y[6]),
                        (e = y[7]);
                    break;
                  case be:
                    u = de(q, h, g, e);
                    r = u.length;
                    if (0 === r) {
                      d.push(q.endX);
                      d.push(q.endY);
                      g = q.endX;
                      e = q.endY;
                      break;
                    }
                    for (w = 0; w < r; w++)
                      (y = u[w]),
                        L.Pe(g, e, y[2], y[3], y[4], y[5], y[6], y[7], 0.5, d),
                        (g = y[6]),
                        (e = y[7]);
                    break;
                  default:
                    v("Segment not of valid type: " + q.type);
                }
                q.isClosed && (d.push(k), d.push(p), Kn(a, b, d, c));
              }
              Kn(a, b, d, c);
            }
          else if (f.type === N.B)
            d.push(f.startX),
              d.push(f.startY),
              d.push(f.endX),
              d.push(f.startY),
              d.push(f.endX),
              d.push(f.endY),
              d.push(f.startX),
              d.push(f.endY),
              d.push(f.startX),
              d.push(f.startY),
              Kn(a, b, d, c);
          else if (f.type === N.M) {
            e = new ie();
            e.startX = f.endX;
            e.startY = (f.startY + f.endY) / 2;
            g = new je(Vd);
            g.startAngle = 0;
            g.sweepAngle = 360;
            g.centerX = (f.startX + f.endX) / 2;
            g.centerY = (f.startY + f.endY) / 2;
            g.radiusX = Math.abs(f.startX - f.endX) / 2;
            g.radiusY = Math.abs(f.startY - f.endY) / 2;
            e.add(g);
            f = ce(g, e);
            h = f.length;
            if (0 === h) d.push(g.centerX), d.push(g.centerY);
            else
              for (g = e.startX, e = e.startY, k = 0; k < h; k++)
                (p = f[k]),
                  L.Pe(g, e, p[2], p[3], p[4], p[5], p[6], p[7], 0.5, d),
                  (g = p[6]),
                  (e = p[7]);
            Kn(a, b, d, c);
          }
          Pa(d);
          a.restore();
          a.Nc(!1);
        }
      }
    }
  };
  t.ka = function (a, b) {
    void 0 === b && (b = new K());
    if (a instanceof Ib) {
      a.ec() &&
        v(
          "getDocumentPoint Spot must be a real, specific Spot, not: " +
            a.toString()
        );
      var c = this.naturalBounds,
        d = this.strokeWidth;
      b.h(
        a.x * (c.width + d) - d / 2 + c.x + a.offsetX,
        a.y * (c.height + d) - d / 2 + c.y + a.offsetY
      );
    } else b.set(a);
    this.ke.Ha(b);
    return b;
  };
  t.Ui = function (a) {
    void 0 === a && (a = new M());
    var b = this.naturalBounds,
      c = this.ke;
    b = M.allocAt(b.x, b.y, b.width, b.height);
    var d = this.strokeWidth;
    b.Qc(d / 2, d / 2);
    d = K.allocAt(b.x, b.y).transform(c);
    a.h(d.x, d.y, 0, 0);
    d.h(b.right, b.y).transform(c);
    mc(a, d.x, d.y, 0, 0);
    d.h(b.right, b.bottom).transform(c);
    mc(a, d.x, d.y, 0, 0);
    d.h(b.x, b.bottom).transform(c);
    mc(a, d.x, d.y, 0, 0);
    M.free(b);
    K.free(d);
    return a;
  };
  t.Gh = function (a, b) {
    var c = this.geometry;
    if (null === c || (null === this.fill && null === this.stroke)) return !1;
    var d = c.bounds,
      e = this.strokeWidth / 2;
    c.type !== N.j || b || (e += 2);
    var f = M.alloc();
    f.assign(d);
    f.Qc(e + 2, e + 2);
    if (!f.ca(a)) return M.free(f), !1;
    d = e + 1e-4;
    if (c.type === N.j) {
      if (null === this.stroke) return !1;
      d =
        (c.endX - c.startX) * (a.x - c.startX) +
        (c.endY - c.startY) * (a.y - c.startY);
      if (
        0 >
          (c.startX - c.endX) * (a.x - c.endX) +
            (c.startY - c.endY) * (a.y - c.endY) ||
        0 > d
      )
        return !1;
      M.free(f);
      return L.Ub(c.startX, c.startY, c.endX, c.endY, e, a.x, a.y);
    }
    if (c.type === N.B) {
      b = c.startX;
      var g = c.startY,
        h = c.endX;
      c = c.endY;
      f.x = Math.min(b, h);
      f.y = Math.min(g, c);
      f.width = Math.abs(h - b);
      f.height = Math.abs(c - g);
      if (null === this.fill) {
        f.Qc(-d, -d);
        if (f.ca(a)) return M.free(f), !1;
        f.Qc(d, d);
      }
      null !== this.stroke && f.Qc(e, e);
      a = f.ca(a);
      M.free(f);
      return a;
    }
    if (c.type === N.M) {
      g = c.startX;
      e = c.startY;
      h = c.endX;
      var k = c.endY;
      c = Math.min(g, h);
      b = Math.min(e, k);
      g = Math.abs(h - g) / 2;
      e = Math.abs(k - e) / 2;
      c = a.x - (c + g);
      b = a.y - (b + e);
      if (null === this.fill) {
        g -= d;
        e -= d;
        if (0 >= g || 0 >= e || 1 >= (c * c) / (g * g) + (b * b) / (e * e))
          return M.free(f), !1;
        g += d;
        e += d;
      }
      null !== this.stroke && ((g += d), (e += d));
      M.free(f);
      return 0 >= g || 0 >= e ? !1 : 1 >= (c * c) / (g * g) + (b * b) / (e * e);
    }
    if (c.type === N.o)
      return (
        M.free(f),
        null === this.fill
          ? ge(c, a.x, a.y, e)
          : ee(c, a, e, 1 < this.strokeWidth, b)
      );
    v("Unknown Geometry type: " + c.type);
  };
  t.tm = function (a, b, c, d) {
    var e = this.desiredSize,
      f = this.ng;
    a = Math.max(a, 0);
    b = Math.max(b, 0);
    if (null !== this.Ld) var g = this.geometry.bounds;
    else {
      var h = this.figure,
        k = Ln[h];
      if (void 0 === k) {
        var l = L.pe[h];
        "string" === typeof l && (l = L.pe[l]);
        "function" === typeof l
          ? ((k = l(null, 100, 100)), (Ln[h] = k))
          : v("Unsupported Figure: " + h);
      }
      g = k.bounds;
    }
    h = g.width;
    k = g.height;
    l = g.width;
    var m = g.height;
    switch (vl(this, !0)) {
      case tg:
        d = c = 0;
        break;
      case Fd:
        l = Math.max(a - f, 0);
        m = Math.max(b - f, 0);
        break;
      case il:
        l = Math.max(a - f, 0);
        d = 0;
        break;
      case jl:
        (c = 0), (m = Math.max(b - f, 0));
    }
    isFinite(e.width) && (l = e.width);
    isFinite(e.height) && (m = e.height);
    e = this.maxSize;
    g = this.minSize;
    c = Math.max(c - f, g.width);
    d = Math.max(d - f, g.height);
    l = Math.min(e.width, l);
    m = Math.min(e.height, m);
    l = isFinite(l) ? Math.max(c, l) : Math.max(h, c);
    m = isFinite(m) ? Math.max(d, m) : Math.max(k, d);
    c = ug(this);
    switch (c) {
      case tg:
        break;
      case Fd:
        h = l;
        k = m;
        break;
      case vg:
        c = Math.min(l / h, m / k);
        isFinite(c) || (c = 1);
        h *= c;
        k *= c;
        break;
      default:
        v(c + " is not a valid geometryStretch.");
    }
    null !== this.Ld
      ? (0 === h && (h = 0.001),
        0 === k && (k = 0.001),
        (c = null !== this.Ld ? this.Ld : this.ta),
        (e = c.bounds),
        (d = h / e.width),
        (e = k / e.height),
        isFinite(d) || (d = 1),
        isFinite(e) || (e = 1),
        (c = 1 === d && 1 === e ? c : c.copy().scale(d, e)),
        G && c.freeze(),
        (this.ta = c))
      : (null !== this.ta &&
          L.da(this.ta.rl, a - f) &&
          L.da(this.ta.ql, b - f)) ||
        (this.ta = Hf.makeGeometry(this, h, k));
    g = this.ta.bounds;
    Infinity === a || Infinity === b
      ? this.Ee(
          g.x - f / 2,
          g.y - f / 2,
          0 === a && 0 === h ? 0 : g.width + f,
          0 === b && 0 === k ? 0 : g.height + f
        )
      : this.Ee(-(f / 2), -(f / 2), l + f, m + f);
  };
  function ug(a) {
    var b = a.geometryStretch;
    return null !== a.Ld
      ? b === hl
        ? Fd
        : b
      : b === hl
      ? Ln[a.figure].defaultStretch
      : b;
  }
  t.Eh = function (a, b, c, d) {
    xl(this, a, b, c, d);
  };
  t.Is = function (a, b, c) {
    return this.sk(a.x, a.y, b.x, b.y, c);
  };
  t.sk = function (a, b, c, d, e) {
    var f = this.transform,
      g = 1 / (f.m11 * f.m22 - f.m12 * f.m21),
      h = f.m22 * g,
      k = -f.m12 * g,
      l = -f.m21 * g,
      m = f.m11 * g,
      n = g * (f.m21 * f.dy - f.m22 * f.dx),
      p = g * (f.m12 * f.dx - f.m11 * f.dy);
    f = a * h + b * l + n;
    g = a * k + b * m + p;
    h = c * h + d * l + n;
    k = c * k + d * m + p;
    n = this.ng / 2;
    l = this.ta;
    null === l && (this.measure(Infinity, Infinity), (l = this.ta));
    var r = l.bounds;
    m = !1;
    if (l.type === N.j)
      if (1.5 >= this.strokeWidth)
        m = L.Ve(l.startX, l.startY, l.endX, l.endY, f, g, h, k, e);
      else {
        l.startX === l.endX
          ? ((d = n), (m = 0))
          : ((b = (l.endY - l.startY) / (l.endX - l.startX)),
            (m = n / Math.sqrt(1 + b * b)),
            (d = m * b));
        b = Ma();
        a = new K();
        L.Ve(
          l.startX + d,
          l.startY + m,
          l.endX + d,
          l.endY + m,
          f,
          g,
          h,
          k,
          a
        ) && b.push(a);
        a = new K();
        L.Ve(
          l.startX - d,
          l.startY - m,
          l.endX - d,
          l.endY - m,
          f,
          g,
          h,
          k,
          a
        ) && b.push(a);
        a = new K();
        L.Ve(
          l.startX + d,
          l.startY + m,
          l.startX - d,
          l.startY - m,
          f,
          g,
          h,
          k,
          a
        ) && b.push(a);
        a = new K();
        L.Ve(l.endX + d, l.endY + m, l.endX - d, l.endY - m, f, g, h, k, a) &&
          b.push(a);
        h = b.length;
        if (0 === h) return Pa(b), !1;
        m = !0;
        k = Infinity;
        for (d = 0; d < h; d++)
          (a = b[d]),
            (c = (a.x - f) * (a.x - f) + (a.y - g) * (a.y - g)),
            c < k && ((k = c), (e.x = a.x), (e.y = a.y));
        Pa(b);
      }
    else if (l.type === N.B)
      m = L.Kf(
        r.x - n,
        r.y - n,
        r.x + r.width + n,
        r.y + r.height + n,
        f,
        g,
        h,
        k,
        e
      );
    else if (l.type === N.M) {
      b = M.allocAt(r.x, r.y, r.width, r.height).Qc(n, n);
      a: if (0 === b.width)
        m = L.Ve(b.x, b.y, b.x, b.y + b.height, f, g, h, k, e);
      else if (0 === b.height)
        m = L.Ve(b.x, b.y, b.x + b.width, b.y, f, g, h, k, e);
      else {
        a = b.width / 2;
        l = b.height / 2;
        d = b.x + a;
        m = b.y + l;
        c = 9999;
        f !== h && (c = (g - k) / (f - h));
        if (9999 > Math.abs(c)) {
          k = g - m - c * (f - d);
          if (0 > a * a * c * c + l * l - k * k) {
            e.x = NaN;
            e.y = NaN;
            m = !1;
            break a;
          }
          n = Math.sqrt(a * a * c * c + l * l - k * k);
          h = (-(a * a * c * k) + a * l * n) / (l * l + a * a * c * c) + d;
          a = (-(a * a * c * k) - a * l * n) / (l * l + a * a * c * c) + d;
          l = c * (h - d) + k + m;
          k = c * (a - d) + k + m;
          Math.abs((f - h) * (f - h)) + Math.abs((g - l) * (g - l)) <
          Math.abs((f - a) * (f - a)) + Math.abs((g - k) * (g - k))
            ? ((e.x = h), (e.y = l))
            : ((e.x = a), (e.y = k));
        } else {
          h = l * l;
          k = f - d;
          h -= (h / (a * a)) * k * k;
          if (0 > h) {
            e.x = NaN;
            e.y = NaN;
            m = !1;
            break a;
          }
          k = Math.sqrt(h);
          h = m + k;
          k = m - k;
          Math.abs(h - g) < Math.abs(k - g)
            ? ((e.x = f), (e.y = h))
            : ((e.x = f), (e.y = k));
        }
        m = !0;
      }
      M.free(b);
    } else if (l.type === N.o) {
      p = K.alloc();
      var q = h - f;
      var u = k - g,
        w = q * q + u * u,
        y = f,
        z = g;
      if (0 < w && r.contains(y, z) && ((p.x = y), (p.y = z), this.ca(p)))
        for (
          0 !== q && 0.5 > Math.abs(q)
            ? ((u *= 0.5 / q), (q = 0.5))
            : 0 !== u && 0.5 > Math.abs(u) && ((q *= 0.5 / u), (u = 0.5)),
            y -= q,
            z -= u;
          r.contains(y, z);

        )
          (y -= q), (z -= u);
      e.x = h;
      e.y = k;
      for (u = 0; u < l.figures.count; u++) {
        var B = l.figures.m[u],
          C = B.isFilled ? y : f,
          E = B.isFilled ? z : g,
          J = B.segments;
        r = B.startX;
        q = B.startY;
        for (var S = r, aa = q, Y = 0; Y < J.count; Y++) {
          var T = J.m[Y],
            P = T.type;
          var ma = T.endX;
          var ia = T.endY;
          var Ba = !1;
          switch (P) {
            case Sd:
              S = ma;
              aa = ia;
              break;
            case Hd:
              Ba = Mn(r, q, ma, ia, C, E, h, k, p);
              break;
            case Td:
              Ba = L.Wp(
                r,
                q,
                T.point1X,
                T.point1Y,
                T.point2X,
                T.point2Y,
                ma,
                ia,
                C,
                E,
                h,
                k,
                0.6,
                p
              );
              break;
            case Ud:
              Ba = L.Wp(
                r,
                q,
                r + (2 / 3) * (T.point1X - r),
                q + (2 / 3) * (T.point1Y - q),
                ma + (2 / 3) * (T.point1X - ma),
                ia + (2 / 3) * (T.point1Y - ia),
                ma,
                ia,
                C,
                E,
                h,
                k,
                0.6,
                p
              );
              break;
            case Vd:
            case be:
              P = T.type === Vd ? ce(T, B) : de(T, B, r, q);
              var Na = P.length;
              if (0 === Na) {
                Ba = Mn(
                  r,
                  q,
                  T.type === Vd ? T.centerX : T.endX,
                  T.type === Vd ? T.centerY : T.endY,
                  C,
                  E,
                  h,
                  k,
                  p
                );
                break;
              }
              ia = null;
              for (ma = 0; ma < Na; ma++) {
                ia = P[ma];
                if (0 === ma && Mn(r, q, ia[0], ia[1], C, E, h, k, p)) {
                  var sb = Nn(C, E, p, w, e);
                  sb < w && ((w = sb), (m = !0));
                }
                L.Wp(
                  ia[0],
                  ia[1],
                  ia[2],
                  ia[3],
                  ia[4],
                  ia[5],
                  ia[6],
                  ia[7],
                  C,
                  E,
                  h,
                  k,
                  0.6,
                  p
                ) && ((sb = Nn(C, E, p, w, e)), sb < w && ((w = sb), (m = !0)));
              }
              ma = ia[6];
              ia = ia[7];
              break;
            default:
              v("Unknown Segment type: " + P);
          }
          r = ma;
          q = ia;
          Ba && ((Ba = Nn(C, E, p, w, e)), Ba < w && ((w = Ba), (m = !0)));
          T.isClosed &&
            ((ma = S),
            (ia = aa),
            Mn(r, q, ma, ia, C, E, h, k, p) &&
              ((T = Nn(C, E, p, w, e)), T < w && ((w = T), (m = !0))));
        }
      }
      f = c - a;
      g = d - b;
      h = Math.sqrt(f * f + g * g);
      0 !== h && ((f /= h), (g /= h));
      e.x -= f * n;
      e.y -= g * n;
      K.free(p);
    } else v("Unknown Geometry type: " + l.type);
    if (!m) return !1;
    this.transform.Ha(e);
    return !0;
  };
  function Nn(a, b, c, d, e) {
    a = c.x - a;
    b = c.y - b;
    b = a * a + b * b;
    return b < d ? ((e.x = c.x), (e.y = c.y), b) : d;
  }
  function Mn(a, b, c, d, e, f, g, h, k) {
    var l = !1,
      m = (e - g) * (b - d) - (f - h) * (a - c);
    if (0 === m) return !1;
    k.x = ((e * h - f * g) * (a - c) - (e - g) * (a * d - b * c)) / m;
    k.y = ((e * h - f * g) * (b - d) - (f - h) * (a * d - b * c)) / m;
    (a > c ? a - c : c - a) < (b > d ? b - d : d - b)
      ? ((a = b < d ? b : d),
        (b = b < d ? d : b),
        (k.y > a || L.da(k.y, a)) && (k.y < b || L.da(k.y, b)) && (l = !0))
      : ((b = a < c ? a : c),
        (a = a < c ? c : a),
        (k.x > b || L.da(k.x, b)) && (k.x < a || L.da(k.x, a)) && (l = !0));
    return l;
  }
  t.Fh = function (a, b) {
    if (void 0 === b) return a.Qe(this.actualBounds);
    var c = this.ta;
    null === c && (this.measure(Infinity, Infinity), (c = this.ta));
    c = c.bounds;
    var d = this.strokeWidth / 2,
      e = !1,
      f = K.alloc();
    f.h(c.x - d, c.y - d);
    a.ca(b.Ha(f)) &&
      (f.h(c.x - d, c.bottom + d),
      a.ca(b.Ha(f)) &&
        (f.h(c.right + d, c.bottom + d),
        a.ca(b.Ha(f)) &&
          (f.h(c.right + d, c.y - d), a.ca(b.Ha(f)) && (e = !0))));
    K.free(f);
    return e;
  };
  t.Sc = function (a, b) {
    if (
      this.Fh(a, b) ||
      (void 0 === b && ((b = this.transform), a.Qe(this.actualBounds)))
    )
      return !0;
    var c = Kb.alloc();
    c.set(b);
    c.Ns();
    var d = a.left,
      e = a.right,
      f = a.top;
    a = a.bottom;
    var g = K.alloc();
    g.h(d, f);
    c.Ha(g);
    if (this.Gh(g, !0)) return K.free(g), !0;
    g.h(e, f);
    c.Ha(g);
    if (this.Gh(g, !0)) return K.free(g), !0;
    g.h(d, a);
    c.Ha(g);
    if (this.Gh(g, !0)) return K.free(g), !0;
    g.h(e, a);
    c.Ha(g);
    if (this.Gh(g, !0)) return K.free(g), !0;
    var h = K.alloc(),
      k = K.alloc();
    c.set(b);
    c.Hv(this.transform);
    c.Ns();
    h.x = e;
    h.y = f;
    h.transform(c);
    g.x = d;
    g.y = f;
    g.transform(c);
    b = !1;
    On(this, g, h, k)
      ? (b = !0)
      : ((g.x = e),
        (g.y = a),
        g.transform(c),
        On(this, g, h, k)
          ? (b = !0)
          : ((h.x = d),
            (h.y = a),
            h.transform(c),
            On(this, g, h, k)
              ? (b = !0)
              : ((g.x = d),
                (g.y = f),
                g.transform(c),
                On(this, g, h, k) && (b = !0))));
    K.free(g);
    Kb.free(c);
    K.free(h);
    K.free(k);
    return b;
  };
  function On(a, b, c, d) {
    if (!a.Is(b, c, d)) return !1;
    a = b.x;
    b = b.y;
    var e = c.x,
      f = c.y;
    c = d.x;
    d = d.y;
    if (a === e) return b < f ? ((a = b), (b = f)) : (a = f), d >= a && d <= b;
    a < e ? ((d = a), (a = e)) : (d = e);
    return c >= d && c <= a;
  }
  t.Vx = function (a, b, c) {
    function d(a, b) {
      for (var c = a.length, d = 0; d < c; d += 2)
        if (b.xd(a[d], a[d + 1]) > e) return !0;
      return !1;
    }
    if (c && null !== this.fill && this.Gh(a, !0)) return !0;
    var e = a.Ff(b),
      f = e;
    1.5 < this.strokeWidth &&
      ((e = this.strokeWidth / 2 + Math.sqrt(e)), (e *= e));
    b = this.ta;
    if (
      null === b &&
      (this.measure(Infinity, Infinity), (b = this.ta), null === b)
    )
      return !1;
    if (!c) {
      var g = b.bounds,
        h = g.x,
        k = g.y,
        l = g.x + g.width;
      g = g.y + g.height;
      if (
        Nb(a.x, a.y, h, k) <= e &&
        Nb(a.x, a.y, l, k) <= e &&
        Nb(a.x, a.y, h, g) <= e &&
        Nb(a.x, a.y, l, g) <= e
      )
        return !0;
    }
    h = b.startX;
    k = b.startY;
    l = b.endX;
    g = b.endY;
    if (b.type === N.j) {
      if (
        ((c = Mb(a.x, a.y, h, k, l, g)),
        (b = (h - l) * (a.x - l) + (k - g) * (a.y - g)),
        c <= (0 <= (l - h) * (a.x - h) + (g - k) * (a.y - k) && 0 <= b ? e : f))
      )
        return !0;
    } else {
      if (b.type === N.B)
        return (
          (b = !1),
          c &&
            (b =
              Mb(a.x, a.y, h, k, h, g) <= e ||
              Mb(a.x, a.y, h, k, l, k) <= e ||
              Mb(a.x, a.y, l, k, l, g) <= e ||
              Mb(a.x, a.y, h, g, l, g) <= e),
          b
        );
      if (b.type === N.M) {
        b = a.x - (h + l) / 2;
        f = a.y - (k + g) / 2;
        var m = Math.abs(l - h) / 2,
          n = Math.abs(g - k) / 2;
        if (0 === m || 0 === n) return Mb(a.x, a.y, h, k, l, g) <= e ? !0 : !1;
        if (c) {
          if (((a = L.Hz(m, n, b, f)), a * a <= e)) return !0;
        } else
          return Nb(b, f, -m, 0) >= e ||
            Nb(b, f, 0, -n) >= e ||
            Nb(b, f, 0, n) >= e ||
            Nb(b, f, m, 0) >= e
            ? !1
            : !0;
      } else if (b.type === N.o) {
        l = b.bounds;
        f = l.x;
        h = l.y;
        k = l.x + l.width;
        l = l.y + l.height;
        if (
          a.x > k &&
          a.x < f &&
          a.y > l &&
          a.y < h &&
          Mb(a.x, a.y, f, h, f, l) > e &&
          Mb(a.x, a.y, f, h, k, h) > e &&
          Mb(a.x, a.y, k, l, f, l) > e &&
          Mb(a.x, a.y, k, l, k, h) > e
        )
          return !1;
        f = Math.sqrt(e);
        if (c) {
          if (null === this.fill ? ge(b, a.x, a.y, f) : ee(b, a, f, !0, !1))
            return !0;
        } else {
          c = b.figures;
          for (b = 0; b < c.count; b++) {
            f = c.m[b];
            g = f.startX;
            m = f.startY;
            if (a.xd(g, m) > e) return !1;
            h = f.segments.m;
            k = h.length;
            for (l = 0; l < k; l++)
              switch (((n = h[l]), n.type)) {
                case Sd:
                case Hd:
                  g = n.endX;
                  m = n.endY;
                  if (a.xd(g, m) > e) return !1;
                  break;
                case Td:
                  var p = Ma();
                  L.Pe(
                    g,
                    m,
                    n.point1X,
                    n.point1Y,
                    n.point2X,
                    n.point2Y,
                    n.endX,
                    n.endY,
                    0.8,
                    p
                  );
                  g = d(p, a);
                  Pa(p);
                  if (g) return !1;
                  g = n.endX;
                  m = n.endY;
                  if (a.xd(g, m) > e) return !1;
                  break;
                case Ud:
                  p = Ma();
                  L.vq(g, m, n.point1X, n.point1Y, n.endX, n.endY, 0.8, p);
                  g = d(p, a);
                  Pa(p);
                  if (g) return !1;
                  g = n.endX;
                  m = n.endY;
                  if (a.xd(g, m) > e) return !1;
                  break;
                case Vd:
                case be:
                  p = n.type === Vd ? ce(n, f) : de(n, f, g, m);
                  var r = p.length;
                  if (0 === r) {
                    g = n.type === Vd ? n.centerX : n.endX;
                    m = n.type === Vd ? n.centerY : n.endY;
                    if (a.xd(g, m) > e) return !1;
                    break;
                  }
                  n = null;
                  for (var q = Ma(), u = 0; u < r; u++)
                    if (
                      ((n = p[u]),
                      (q.length = 0),
                      L.Pe(
                        n[0],
                        n[1],
                        n[2],
                        n[3],
                        n[4],
                        n[5],
                        n[6],
                        n[7],
                        0.8,
                        q
                      ),
                      d(q, a))
                    )
                      return Pa(q), !1;
                  Pa(q);
                  null !== n && ((g = n[6]), (m = n[7]));
                  break;
                default:
                  v("Unknown Segment type: " + n.type);
              }
          }
          return !0;
        }
      }
    }
    return !1;
  };
  t.lc = function () {
    this.ta = null;
  };
  t.Ow = function () {
    return this.ng;
  };
  function Pn(a) {
    var b = a.diagram;
    (null !== b && b.undoManager.isUndoingRedoing) ||
      ((a.segmentOrientation = gn),
      "None" !== a.toArrow
        ? ((a.segmentIndex = -1), (a.alignmentFocus = qd))
        : "None" !== a.fromArrow &&
          ((a.segmentIndex = 0), (a.alignmentFocus = new Ib(1 - qd.x, qd.y))));
  }
  Hf.makeGeometry = function (a, b, c) {
    if ("None" !== a.toArrow) var d = Qn[a.toArrow];
    else
      "None" !== a.fromArrow
        ? (d = Qn[a.fromArrow])
        : ((d = L.pe[a.figure]),
          "string" === typeof d && (d = L.pe[d]),
          void 0 === d && v("Unknown Shape.figure: " + a.figure),
          (d = d(a, b, c)),
          (d.rl = b),
          (d.ql = c));
    if (null === d) {
      var e = L.pe.Rectangle;
      "function" === typeof e && (d = e(a, b, c));
    }
    G &&
      (d.bounds.width > b + 1e-5 || d.bounds.height > c + 1e-5) &&
      v(
        'Geometry made with figure "' +
          a.figure +
          '" has bounds ' +
          d.bounds.toString() +
          " that are too large for the given size (" +
          b +
          "," +
          c +
          "). See documentation for Shape.defineFigureGenerator."
      );
    return d;
  };
  function Rn(a) {
    var b = Qn[a];
    if (void 0 === b) {
      var c = a.toLowerCase();
      if ("none" === c) return "None";
      b = Qn[c];
      if (void 0 === b) {
        var d = null,
          e;
        for (e in L.Sm)
          if (e.toLowerCase() === c) {
            d = e;
            break;
          }
        if (null !== d)
          return (
            (a = N.parse(L.Sm[d], !1)), (Qn[d] = a), c !== d && (Qn[c] = d), d
          );
      }
    }
    return "string" === typeof b ? b : b instanceof N ? a : null;
  }
  oa.Object.defineProperties(Hf.prototype, {
    geometry: {
      configurable: !0,
      get: function () {
        return null !== this.ta ? this.ta : this.Ld;
      },
      set: function (a) {
        var b = this.ta,
          c = this.Ld;
        if (b !== a) {
          null !== a
            ? (G && x(a, N, Hf, "geometry"), (this.Ld = this.ta = a.freeze()))
            : (this.Ld = this.ta = null);
          var d = this.part;
          null !== d && (d.dg = NaN);
          this.v();
          this.g("geometry", b || c, a);
          rl(this) &&
            ((a = this.part), null !== a && sl(this, a, "geometryString"));
        }
      },
    },
    geometryString: {
      configurable: !0,
      get: function () {
        return null === this.geometry ? "" : this.geometry.toString();
      },
      set: function (a) {
        a = N.parse(a);
        var b = a.normalize();
        this.geometry = a;
        this.position = a = K.allocAt(-b.x, -b.y);
        K.free(a);
      },
    },
    isGeometryPositioned: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 1048576);
      },
      set: function (a) {
        G && A(a, "boolean", Hf, "isGeometryPositioned");
        var b = 0 !== (this.A & 1048576);
        b !== a &&
          (G && A(a, "boolean", Hf, "isGeometryPositioned"),
          (this.A ^= 1048576),
          this.v(),
          this.g("isGeometryPositioned", b, a));
      },
    },
    fill: {
      configurable: !0,
      get: function () {
        return this.kl;
      },
      set: function (a) {
        var b = this.kl;
        b !== a &&
          (null !== a && bm(a, "Shape.fill"),
          a instanceof Al && a.freeze(),
          (this.kl = a),
          this.R(),
          this.g("fill", b, a));
      },
    },
    stroke: {
      configurable: !0,
      get: function () {
        return this.Mc;
      },
      set: function (a) {
        var b = this.Mc;
        b !== a &&
          (null !== a && bm(a, "Shape.stroke"),
          a instanceof Al && a.freeze(),
          (this.Mc = a),
          this.R(),
          this.g("stroke", b, a));
      },
    },
    strokeWidth: {
      configurable: !0,
      get: function () {
        return this.ng;
      },
      set: function (a) {
        var b = this.ng;
        if (b !== a)
          if ((G && D(a, Hf, "strokeWidth"), 0 <= a)) {
            this.ng = a;
            this.v();
            var c = this.part;
            null !== c && (c.dg = NaN);
            this.g("strokeWidth", b, a);
          } else Aa(a, "value >= 0", Hf, "strokeWidth:value");
      },
    },
    strokeCap: {
      configurable: !0,
      get: function () {
        return null !== this.fb ? this.fb.js : "butt";
      },
      set: function (a) {
        var b = this.strokeCap;
        b !== a &&
          ("string" !== typeof a ||
          ("butt" !== a && "round" !== a && "square" !== a)
            ? Aa(a, '"butt", "round", or "square"', Hf, "strokeCap")
            : (null === this.fb && (this.fb = new Sn()),
              (this.fb.js = a),
              this.R(),
              this.g("strokeCap", b, a)));
      },
    },
    strokeJoin: {
      configurable: !0,
      get: function () {
        return null !== this.fb ? this.fb.o : "miter";
      },
      set: function (a) {
        var b = this.strokeJoin;
        b !== a &&
          ("string" !== typeof a ||
          ("miter" !== a && "bevel" !== a && "round" !== a)
            ? Aa(a, '"miter", "bevel", or "round"', Hf, "strokeJoin")
            : (null === this.fb && (this.fb = new Sn()),
              (this.fb.o = a),
              this.R(),
              this.g("strokeJoin", b, a)));
      },
    },
    strokeMiterLimit: {
      configurable: !0,
      get: function () {
        return null !== this.fb ? this.fb.B : 10;
      },
      set: function (a) {
        var b = this.strokeMiterLimit;
        if (b !== a)
          if ((G && D(a, Hf, "strokeMiterLimit"), 1 <= a)) {
            null === this.fb && (this.fb = new Sn());
            this.fb.B = a;
            this.R();
            var c = this.part;
            null !== c && (c.dg = NaN);
            this.g("strokeMiterLimit", b, a);
          } else G && Aa(a, "value >= 1", Hf, "strokeWidth:value");
      },
    },
    strokeDashArray: {
      configurable: !0,
      get: function () {
        return this.sh;
      },
      set: function (a) {
        var b = this.sh;
        if (b !== a) {
          null === a ||
            Array.isArray(a) ||
            za(a, "Array", Hf, "strokeDashArray:value");
          if (null !== a) {
            for (var c = a.length, d = 0, e = 0; e < c; e++) {
              var f = a[e];
              ((!G || "number" === typeof f) && 0 <= f && isFinite(f)) ||
                v(
                  "strokeDashArray:value " +
                    f +
                    " at index " +
                    e +
                    " must be a positive number or zero."
                );
              d += f;
            }
            if (0 === d) {
              if (null === b) return;
              a = null;
            }
          }
          this.sh = a;
          this.R();
          this.g("strokeDashArray", b, a);
        }
      },
    },
    strokeDashOffset: {
      configurable: !0,
      get: function () {
        return null !== this.fb ? this.fb.ak : 0;
      },
      set: function (a) {
        var b = this.strokeDashOffset;
        b !== a &&
          (G && D(a, Hf, "strokeDashOffset"),
          0 <= a &&
            (null === this.fb && (this.fb = new Sn()),
            (this.fb.ak = a),
            this.R(),
            this.g("strokeDashOffset", b, a)));
      },
    },
    figure: {
      configurable: !0,
      get: function () {
        return this.In;
      },
      set: function (a) {
        var b = this.In;
        if (b !== a) {
          G && A(a, "string", Hf, "figure");
          var c = L.pe[a];
          "function" === typeof c
            ? (c = a)
            : (c = L.pe[a.toLowerCase()]) || v("Unknown Shape.figure: " + a);
          b !== c &&
            ((a = this.part),
            null !== a && (a.dg = NaN),
            (this.In = c),
            (this.Ld = null),
            this.lc(),
            this.v(),
            this.g("figure", b, c));
        }
      },
    },
    toArrow: {
      configurable: !0,
      get: function () {
        return null !== this.Ra ? this.Ra.Ba : "None";
      },
      set: function (a) {
        var b = this.toArrow;
        !0 === a ? (a = "Standard") : !1 === a && (a = "");
        if (b !== a) {
          G && A(a, "string", Hf, "toArrow");
          var c = Rn(a);
          null === c
            ? v("Unknown Shape.toArrow: " + a)
            : b !== c &&
              (null === this.Ra && (this.Ra = new am()),
              (this.Ra.Ba = c),
              (this.Ld = null),
              this.lc(),
              this.v(),
              Pn(this),
              this.g("toArrow", b, c));
        }
      },
    },
    fromArrow: {
      configurable: !0,
      get: function () {
        return null !== this.Ra ? this.Ra.j : "None";
      },
      set: function (a) {
        var b = this.fromArrow;
        !0 === a ? (a = "Standard") : !1 === a && (a = "");
        if (b !== a) {
          G && A(a, "string", Hf, "fromArrow");
          var c = Rn(a);
          null === c
            ? v("Unknown Shape.fromArrow: " + a)
            : b !== c &&
              (null === this.Ra && (this.Ra = new am()),
              (this.Ra.j = c),
              (this.Ld = null),
              this.lc(),
              this.v(),
              Pn(this),
              this.g("fromArrow", b, c));
        }
      },
    },
    spot1: {
      configurable: !0,
      get: function () {
        return this.vf;
      },
      set: function (a) {
        x(a, Ib, Hf, "spot1");
        var b = this.vf;
        b.D(a) || ((this.vf = a = a.L()), this.v(), this.g("spot1", b, a));
      },
    },
    spot2: {
      configurable: !0,
      get: function () {
        return this.wf;
      },
      set: function (a) {
        x(a, Ib, Hf, "spot2");
        var b = this.wf;
        b.D(a) || ((this.wf = a = a.L()), this.v(), this.g("spot2", b, a));
      },
    },
    parameter1: {
      configurable: !0,
      get: function () {
        return this.Vo;
      },
      set: function (a) {
        var b = this.Vo;
        b !== a &&
          ((this.Vo = a), this.lc(), this.v(), this.g("parameter1", b, a));
      },
    },
    parameter2: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Wo;
      },
      set: function (a) {
        var b = this.Wo;
        b !== a &&
          ((this.Wo = a), this.lc(), this.v(), this.g("parameter2", b, a));
      },
    },
    naturalBounds: {
      configurable: !0,
      get: function () {
        var a = this.desiredSize;
        return a.s() || null === this.ta
          ? new M(0, 0, a.width, a.height)
          : (this.zc.assign(this.ta.bounds), this.zc);
      },
    },
    pathPattern: {
      configurable: !0,
      get: function () {
        return null !== this.fb ? this.fb.j : null;
      },
      set: function (a) {
        var b = this.pathPattern;
        b !== a &&
          (G && null !== a && x(a, O, Hf, "pathPattern"),
          null === this.fb && (this.fb = new Sn()),
          (this.fb.j = a),
          this.R(),
          this.g("pathPattern", b, a));
      },
    },
    geometryStretch: {
      configurable: !0,
      get: function () {
        return this.Pn;
      },
      set: function (a) {
        var b = this.Pn;
        b !== a &&
          (cb(a, O, Hf, "geometryStretch"),
          (this.Pn = a),
          this.v(),
          this.g("geometryStretch", b, a));
      },
    },
    interval: {
      configurable: !0,
      get: function () {
        return null !== this.ja ? this.ja.sl : 1;
      },
      set: function (a) {
        var b = this.interval;
        G && D(a, Hf, "interval");
        a = Math.round(a);
        if (b !== a && 0 !== a && isFinite(a)) {
          null === this.ja && (this.ja = new Tn());
          this.ja.sl = a;
          var c = this.diagram;
          null !== c && this.panel === c.grid && wj(c);
          this.v();
          c = this.panel;
          null !== c && (c.Zf = null);
          this.g("interval", b, a);
        }
      },
    },
    graduatedStart: {
      configurable: !0,
      get: function () {
        return null !== this.ja ? this.ja.B : 0;
      },
      set: function (a) {
        var b = this.graduatedStart;
        G && D(a, Hf, "graduatedStart");
        b !== a &&
          (0 > a ? (a = 0) : 1 < a && (a = 1),
          null === this.ja && (this.ja = new Tn()),
          (this.ja.B = a),
          this.v(),
          this.g("graduatedStart", b, a));
      },
    },
    graduatedEnd: {
      configurable: !0,
      get: function () {
        return null !== this.ja ? this.ja.j : 1;
      },
      set: function (a) {
        var b = this.graduatedEnd;
        G && D(a, Hf, "graduatedEnd");
        b !== a &&
          (0 > a ? (a = 0) : 1 < a && (a = 1),
          null === this.ja && (this.ja = new Tn()),
          (this.ja.j = a),
          this.v(),
          this.g("graduatedEnd", b, a));
      },
    },
    graduatedSkip: {
      configurable: !0,
      get: function () {
        return null !== this.ja ? this.ja.o : null;
      },
      set: function (a) {
        var b = this.graduatedSkip;
        b !== a &&
          (null !== a && A(a, "function", Hf, "graduatedSkip"),
          null === this.ja && (this.ja = new Tn()),
          (this.ja.o = a),
          this.v(),
          this.g("graduatedSkip", b, a));
      },
    },
  });
  Hf.prototype.intersectsRect = Hf.prototype.Sc;
  Hf.prototype.containedInRect = Hf.prototype.Fh;
  Hf.prototype.getNearestIntersectionPoint = Hf.prototype.Is;
  Hf.prototype.getDocumentBounds = Hf.prototype.Ui;
  Hf.prototype.getDocumentPoint = Hf.prototype.ka;
  var Qn = new eb(),
    Ln = new eb();
  Hf.className = "Shape";
  Hf.getFigureGenerators = function () {
    var a = new xb(),
      b;
    for (b in L.pe) b !== b.toLowerCase() && a.add(b, L.pe[b]);
    a.freeze();
    return a;
  };
  Hf.defineFigureGenerator = function (a, b) {
    A(a, "string", Hf, "defineFigureGenerator:name");
    "string" === typeof b
      ? !G ||
        ("" !== b && L.pe[b]) ||
        v(
          "Shape.defineFigureGenerator synonym must not be empty or None or not a defined figure name: " +
            b
        )
      : A(b, "function", Hf, "defineFigureGenerator:func");
    var c = a.toLowerCase();
    !G ||
      ("" !== a && a !== c) ||
      v(
        "Shape.defineFigureGenerator name must not be empty or all-lower-case: " +
          a
      );
    var d = L.pe;
    d[a] = b;
    d[c] = a;
  };
  Hf.getArrowheadGeometries = function () {
    var a = new xb();
    for (d in L.Sm)
      if (void 0 === Qn[d]) {
        var b = N.parse(L.Sm[d], !1);
        Qn[d] = b;
        b = d.toLowerCase();
        b !== d && (Qn[b] = d);
      }
    for (var c in Qn)
      if (c !== c.toLowerCase()) {
        var d = Qn[c];
        d instanceof N && a.add(c, d);
      }
    a.freeze();
    return a;
  };
  Hf.defineArrowheadGeometry = function (a, b) {
    A(a, "string", Hf, "defineArrowheadGeometry:name");
    "string" === typeof b
      ? (A(b, "string", Hf, "defineArrowheadGeometry:pathstr"),
        (b = N.parse(b, !1)))
      : x(b, N, Hf, "defineArrowheadGeometry:pathstr");
    var c = a.toLowerCase();
    ((G && "" === a) || "none" === c || a === c) &&
      v(
        "Shape.defineArrowheadGeometry name must not be empty or None or all-lower-case: " +
          a
      );
    var d = Qn;
    d[a] = b;
    d[c] = a;
  };
  function Sn() {
    this.js = "butt";
    this.o = "miter";
    this.B = 10;
    this.ak = 0;
    this.j = null;
  }
  Sn.prototype.copy = function () {
    var a = new Sn();
    a.js = this.js;
    a.o = this.o;
    a.B = this.B;
    a.ak = this.ak;
    a.j = this.j;
    return a;
  };
  Sn.className = "StrokeSettings";
  function Yg(a, b) {
    O.call(this);
    ao || ((bo = Wg ? new Nk(null).context : null), (ao = !0));
    this.bc = "";
    this.Mc = "black";
    this.we = "13px sans-serif";
    this.Ci = "start";
    this.$d = tg;
    this.Ji = md;
    this.A |= 2097152;
    this.gg = co;
    this.rg = eo;
    this.Gr = this.yb = this.fd = 0;
    this.ud = this.jn = this.Hp = this.Di = this.Ip = this.ju = this.ku = null;
    this.uf = this.tf = 0;
    this.gi = fo;
    this.De = Infinity;
    this.ja = null;
    this.li = 0;
    this.xe = null;
    this.Je = 0;
    this.ve = this.Xb = this.Ic = null;
    "string" === typeof a ? (this.text = a) : a && Object.assign(this, a);
    b && Object.assign(this, b);
    return this;
  }
  na(Yg, O);
  Yg.prototype.cloneProtected = function (a) {
    O.prototype.cloneProtected.call(this, a);
    a.bc = this.bc;
    a.Mc = this.Mc;
    a.we = this.we;
    a.Ci = this.Ci;
    a.$d = this.$d;
    a.Ji = this.Ji;
    a.gg = this.gg;
    a.rg = this.rg;
    a.fd = this.fd;
    a.Gr = this.Gr;
    a.yb = this.yb;
    a.ku = this.ku;
    a.ju = this.ju;
    a.Ip = this.Ip;
    a.Di = this.Di;
    a.Hp = this.Hp;
    a.jn = this.jn;
    a.ud = this.ud;
    a.tf = this.tf;
    a.uf = this.uf;
    a.gi = this.gi;
    a.De = this.De;
    null !== this.ja && (a.ja = this.ja.copy());
    a.xe = this.xe;
    a.Je = this.Je;
    a.Ic = this.Ic;
    a.Xb = this.Xb;
    a.ve = this.ve;
    a.li = this.li;
  };
  function fn(a, b) {
    a.A = b.A | 6144;
    a.tb = b.opacity;
    a.Zb = b.background;
    a.qd = b.areaBackground;
    a.bd = b.desiredSize.L();
    a.fg = b.minSize.L();
    a.eg = b.maxSize.L();
    null !== b.Ib ? (a.Ib = b.Ib.copy()) : (a.Ib = null);
    a.Aa = b.scale;
    a.Fb = b.angle;
    a.Ne = b.stretch;
    a.$g = b.margin.L();
    a.Eb = b.alignment.L();
    a.Ok = b.alignmentFocus.L();
    a.segmentFraction = b.segmentFraction;
    a.segmentOffset = b.segmentOffset.L();
    a.segmentOrientation = b.segmentOrientation;
    null !== b.kb && (a.kb = b.kb.copy());
    a.Sl = b.shadowVisible;
    a.bc = b.bc;
    a.Mc = b.Mc;
    a.we = b.we;
    a.Ci = b.Ci;
    a.$d = b.$d;
    a.Ji = b.Ji;
    a.gg = b.gg;
    a.rg = b.rg;
    a.xe = null;
    a.tf = b.tf;
    a.uf = b.uf;
    a.De = b.De;
    a.li = b.li;
    a.interval = b.interval;
    a.graduatedStart = b.graduatedStart;
    a.graduatedEnd = b.graduatedEnd;
    a.graduatedFunction = b.graduatedFunction;
    a.graduatedSkip = b.graduatedSkip;
  }
  t = Yg.prototype;
  t.pb = function (a) {
    a.classType === Yg ? (this.wrap = a) : O.prototype.pb.call(this, a);
  };
  t.toString = function () {
    return 22 < this.bc.length
      ? 'TextBlock("' + this.bc.substring(0, 20) + '"...)'
      : 'TextBlock("' + this.bc + '")';
  };
  t.v = function () {
    O.prototype.v.call(this);
    this.ju = this.ku = null;
  };
  function go(a) {
    ao || ((bo = Wg ? new Nk(null).context : null), (ao = !0));
    if (null === bo) return !0;
    var b = bo.font;
    if (a === b || "10px sans-serif" === a) return !0;
    bo.font = "10px sans-serif";
    bo.font = a;
    var c = bo.font;
    if ("10px sans-serif" !== c) return (bo.font = b), !0;
    bo.font = "19px serif";
    var d = bo.font;
    bo.font = a;
    c = bo.font;
    bo.font = b;
    return c !== d;
  }
  t.Ni = function (a, b) {
    if (null !== this.Mc && 0 !== this.bc.length && null !== this.we) {
      var c = this.naturalBounds,
        d = this.actualBounds,
        e = c.width,
        f = c.height,
        g = ho(this),
        h = (a.textAlign = this.Ci),
        k = b.ho;
      "start" === h
        ? (h = k ? "right" : "left")
        : "end" === h && (h = k ? "left" : "right");
      k = this.isUnderline;
      var l = this.isStrikethrough;
      pi(this, a, this.Mc, !0, !1, c, d);
      (k || l) && pi(this, a, this.Mc, !1, !1, c, d);
      d = 0;
      c = !1;
      var m = this.ke,
        n = m.dx - (g * m.m21 + m.dx);
      m = m.dy - (g * m.m22 + m.dy);
      var p = b.scale;
      8 > (n * n + m * m) * p * p && (c = !0);
      b.$b !== a && (c = !1);
      !1 === b.Se("textGreeking") && (c = !1);
      b = this.tf;
      n = this.uf;
      switch (this.flip) {
        case ml:
          a.translate(e, 0);
          a.scale(-1, 1);
          break;
        case ll:
          a.translate(0, f);
          a.scale(1, -1);
          break;
        case nl:
          a.translate(e, f), a.scale(-1, -1);
      }
      a.Oc();
      m = this.fd;
      p = (b + g + n) * m;
      f > p && ((d = this.Ji), (d = d.y * f - d.y * p + d.offsetY));
      if (1 === m && null !== this.ve)
        (n = this.yb),
          n > e && (n = e),
          this.Mi(this.ve, a, 0, d + b, e, g, n, c, h, k, l);
      else if (null !== this.Ic && null !== this.Xb)
        for (p = 0; p < m; p++) {
          var r = this.Ic[p];
          r > e && (r = e);
          d += b;
          this.Mi(this.Xb[p], a, 0, d, e, g, r, c, h, k, l);
          d += g + n;
        }
      switch (this.flip) {
        case ml:
          a.scale(-1, 1);
          a.translate(-e, 0);
          break;
        case ll:
          a.scale(1, -1);
          a.translate(0, -f);
          break;
        case nl:
          a.scale(-1, -1), a.translate(-e, -f);
      }
    }
  };
  t.Mi = function (a, b, c, d, e, f, g, h, k, l, m) {
    var n = 0;
    h
      ? ("left" === k
          ? (n = 0)
          : "right" === k
          ? (n = e - g)
          : "center" === k && (n = (e - g) / 2),
        b.fillRect(c + n, d + 0.25 * f, g, 1))
      : ("left" === k
          ? (n = 0)
          : "right" === k
          ? (n = e)
          : "center" === k && (n = e / 2),
        (e = null !== io ? io(this, f) : 0.75 * f),
        b.fillText(a, c + n, d + e),
        (a = (f / 20) | 0),
        0 === a && (a = 1),
        "right" === k ? (n -= g) : "center" === k && (n -= g / 2),
        l &&
          ((k = null !== jo ? jo(this, f) : 0.8 * f),
          b.beginPath(),
          (b.lineWidth = a),
          b.moveTo(c + n, d + k),
          b.lineTo(c + n + g, d + k),
          b.stroke()),
        m &&
          (b.beginPath(),
          (b.lineWidth = a),
          (d = (d + f - f / 2.2) | 0),
          0 !== a % 2 && (d += 0.5),
          b.moveTo(c + n, d),
          b.lineTo(c + n + g, d),
          b.stroke()));
  };
  t.tm = function (a, b, c, d) {
    this.li = a;
    var e = this.we;
    null !== bo && ko !== e && (ko = bo.font = e);
    this.yb = this.Je = 0;
    this.ve = this.Xb = this.Ic = this.xe = null;
    var f;
    if (isNaN(this.desiredSize.width)) {
      e = this.bc.replace(/\r\n/g, "\n").replace(/\r/g, "\n");
      if (0 === e.length) e = 0;
      else if (this.isMultiline) {
        for (var g = (f = 0), h = !1; !h; ) {
          var k = e.indexOf("\n", g);
          -1 === k && ((k = e.length), (h = !0));
          g = e.substr(g, k - g);
          this.gi === fo && (g = g.trim());
          f = Math.max(f, lo(g));
          g = k + 1;
        }
        e = f;
      } else
        (f = e.indexOf("\n", 0)), 0 <= f && (e = e.substr(0, f)), (e = lo(e));
      e = Math.min(e, a / this.scale);
      e = Math.max(8, e);
    } else e = this.desiredSize.width;
    null !== this.panel && (e = Math.min(e, this.panel.maxSize.width));
    f = mo(this, e);
    isNaN(this.desiredSize.height)
      ? (f = Math.min(f, b / this.scale))
      : (f = this.desiredSize.height);
    h = f;
    if (
      0 !== this.yb &&
      null !== this.Ic &&
      null !== this.Xb &&
      this.gg === no &&
      ((b = this.we),
      (b = this.gg === no ? oo(b) : 0),
      (k = this.tf + this.uf),
      (k = Math.max(0, ho(this) + k)),
      (h = Math.min(
        this.maxLines - 1,
        Math.max(Math.floor(h / k + 0.01) - 1, 0)
      )),
      !(h + 1 >= this.Xb.length))
    ) {
      k = this.Xb[h];
      for (b = Math.max(1, a - b); lo(k) > b && 1 < k.length; )
        k = k.substr(0, k.length - 1);
      k += po;
      b = lo(k);
      this.Xb[h] = k;
      this.Xb = this.Xb.slice(0, h + 1);
      this.Ic[h] = b;
      this.Ic = this.Ic.slice(0, h + 1);
      this.Je = this.Xb.length;
      this.yb = Math.max(this.yb, b);
      this.fd = this.Je;
      1 === this.fd && (this.ve = this.Xb[0]);
    }
    if (this.wrap === qo || isNaN(this.desiredSize.width))
      (e = isNaN(a) ? this.yb : Math.min(a, this.yb)),
        isNaN(this.desiredSize.width) && (e = Math.max(8, e));
    e = Math.max(c, e);
    f = Math.max(d, f);
    dc(this.zc, e, f);
    this.Ee(0, 0, e, f);
  };
  t.Eh = function (a, b, c, d) {
    xl(this, a, b, c, d);
  };
  function ro(a, b, c) {
    if (null === a.ve) (a.ve = b), (a.yb = c);
    else {
      if (null === a.Xb || null === a.Ic)
        (a.Xb = []), (a.Ic = []), a.Xb.push(a.ve), a.Ic.push(a.yb);
      a.Xb.push(b);
      a.Ic.push(c);
    }
  }
  function so(a, b, c, d) {
    var e = a.gi === fo;
    e && (b = b.trim());
    var f = 0,
      g = a.we,
      h = a.tf + a.uf;
    h = Math.max(0, ho(a) + h);
    var k = a.gg === no ? oo(g) : 0;
    if (a.fd >= a.De) null !== d && d.h(0, h);
    else if (((g = b), a.rg === to)) {
      a.Je = 1;
      var l = lo(b);
      if (0 === k || l <= c)
        (a.yb = Math.max(a.yb, l)), ro(a, b, a.yb), null !== d && d.h(l, h);
      else {
        f = uo(a, g);
        g = g.substr(f.length);
        b = uo(a, g);
        for (l = lo(f + b); 0 < b.length && l <= c; )
          (f += b),
            (g = g.substr(b.length)),
            (b = uo(a, g)),
            (l = f + b),
            e && (l = l.trim()),
            (l = lo(l));
        e && (b = b.trim());
        f += b;
        for (c = Math.max(1, c - k); lo(f) > c && 1 < f.length; )
          f = f.substr(0, f.length - 1);
        f += po;
        var m = lo(f);
        a.yb = m;
        ro(a, f, m);
        null !== d && d.h(m, h);
      }
    } else {
      k = 0;
      0 === g.length && ((k = 1), ro(a, g, 0));
      for (; 0 < g.length; ) {
        b = uo(a, g);
        for (g = g.substr(b.length); lo(b) > c; ) {
          var n = 1;
          l = lo(b.substr(0, n));
          for (m = 0; l <= c; ) n++, (m = l), (l = lo(b.substr(0, n)));
          if (1 === n) {
            var p = l;
            f = Math.max(f, l);
          } else (p = m), (f = Math.max(f, m));
          n--;
          1 > n && (n = 1);
          ro(a, b.substr(0, n), p);
          k++;
          b = b.substr(n);
          if (a.fd + k > a.De) break;
        }
        m = uo(a, g);
        for (l = lo(b + m); 0 < m.length && l <= c; )
          (b += m),
            (g = g.substr(m.length)),
            (m = uo(a, g)),
            (l = b + m),
            e && (l = l.trim()),
            (l = lo(l));
        e && (b = b.trim());
        if (
          "" !== b &&
          ("\u00ad" === b[b.length - 1] &&
            (b = b.substring(0, b.length - 1) + "\u2010"),
          0 === m.length
            ? ((n = l), (f = Math.max(f, l)))
            : ((n = m = lo(b)), (f = Math.max(f, m))),
          ro(a, b, n),
          k++,
          a.fd + k > a.De)
        )
          break;
      }
      a.Je = Math.min(a.De, k);
      a.yb = Math.max(a.yb, f);
      null !== d && d.h(a.yb, h * a.Je);
    }
  }
  function uo(a, b) {
    if (a.rg === vo) return b.substr(0, 1);
    for (var c = b.length, d = 0, e = wo; d < c && !e.test(b.charAt(d)); ) d++;
    for (
      a.gi === xo && (c = Math.min(c, d + 1));
      d < c && e.test(b.charAt(d));

    )
      d++;
    return d >= b.length ? b : b.substr(0, d);
  }
  function lo(a) {
    return null === bo ? 8 * a.length : bo.measureText(a).width;
  }
  function ho(a) {
    if (null !== a.xe) return a.xe;
    var b = a.we;
    if (null === bo) {
      var c = 16;
      return (a.xe = c);
    }
    void 0 !== yo[b] && 5e3 > zo
      ? (c = yo[b])
      : ((c = 1.3 * bo.measureText("M").width), (yo[b] = c), zo++);
    return (a.xe = c);
  }
  function oo(a) {
    if (null === bo) return 6;
    if (void 0 !== Ao[a] && 5e3 > Bo) var b = Ao[a];
    else (b = bo.measureText(po).width), (Ao[a] = b), Bo++;
    return b;
  }
  function mo(a, b) {
    var c = a.bc.replace(/\r\n/g, "\n").replace(/\r/g, "\n"),
      d = a.tf + a.uf;
    d = Math.max(0, ho(a) + d);
    if (0 === c.length) return (a.yb = 0), (a.fd = 1), d;
    if (!a.isMultiline) {
      var e = c.indexOf("\n", 0);
      0 <= e && (c = c.substr(0, e));
    }
    e = 0;
    for (var f = (a.fd = 0), g, h = !1; !h; ) {
      g = c.indexOf("\n", f);
      -1 === g && ((g = c.length), (h = !0));
      if (f <= g) {
        f = c.substr(f, g - f);
        if (a.rg !== to) {
          a.Je = 0;
          var k = Gb.alloc();
          so(a, f, b, k);
          e += k.height;
          Gb.free(k);
          a.fd += a.Je;
        } else so(a, f, b, null), (e += d), a.fd++;
        a.fd === a.De && (h = !0);
      }
      f = g + 1;
    }
    return (a.Gr = e);
  }
  oa.Object.defineProperties(Yg.prototype, {
    font: {
      configurable: !0,
      get: function () {
        return this.we;
      },
      set: function (a) {
        var b = this.we;
        b !== a &&
          (G &&
            (A(a, "string", Yg, "font"),
            go(a) || v('Not a valid font: "' + a + '"')),
          (this.we = a),
          (this.xe = null),
          this.v(),
          this.g("font", b, a));
      },
    },
    text: {
      configurable: !0,
      get: function () {
        return this.bc;
      },
      set: function (a) {
        var b = this.bc;
        null !== a && void 0 !== a ? (a = a.toString()) : (a = "");
        b !== a && ((this.bc = a), this.v(), this.g("text", b, a));
      },
    },
    textAlign: {
      configurable: !0,
      get: function () {
        return this.Ci;
      },
      set: function (a) {
        var b = this.Ci;
        b !== a &&
          (G && A(a, "string", Yg, "textAlign"),
          "start" === a ||
          "end" === a ||
          "left" === a ||
          "right" === a ||
          "center" === a
            ? ((this.Ci = a), this.R(), this.g("textAlign", b, a))
            : G &&
              Aa(
                a,
                '"start", "end", "left", "right", or "center"',
                Yg,
                "textAlign"
              ));
      },
    },
    flip: {
      configurable: !0,
      get: function () {
        return this.$d;
      },
      set: function (a) {
        var b = this.$d;
        b !== a &&
          (cb(a, O, Yg, "flip"), (this.$d = a), this.R(), this.g("flip", b, a));
      },
    },
    verticalAlignment: {
      configurable: !0,
      get: function () {
        return this.Ji;
      },
      set: function (a) {
        var b = this.Ji;
        b.D(a) ||
          (G &&
            (x(a, Ib, Yg, "verticalAlignment"),
            a.ec() &&
              v(
                "TextBlock.verticalAlignment for " +
                  this +
                  " must be a real Spot, not:" +
                  a
              )),
          (this.Ji = a = a.L()),
          Nl(this),
          this.g("verticalAlignment", b, a));
      },
    },
    naturalBounds: {
      configurable: !0,
      get: function () {
        if (!this.zc.s()) {
          var a = Gb.alloc();
          so(this, this.bc, 999999, a);
          var b = a.width;
          Gb.free(a);
          a = mo(this, b);
          var c = this.desiredSize;
          isNaN(c.width) || (b = c.width);
          isNaN(c.height) || (a = c.height);
          dc(this.zc, b, a);
        }
        return this.zc;
      },
    },
    isMultiline: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 2097152);
      },
      set: function (a) {
        var b = 0 !== (this.A & 2097152);
        b !== a &&
          (G && A(a, "boolean", Yg, "isMultiline"),
          (this.A ^= 2097152),
          this.v(),
          this.g("isMultiline", b, a));
      },
    },
    isUnderline: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 4194304);
      },
      set: function (a) {
        var b = 0 !== (this.A & 4194304);
        b !== a &&
          (G && A(a, "boolean", Yg, "isUnderline"),
          (this.A ^= 4194304),
          this.R(),
          this.g("isUnderline", b, a));
      },
    },
    isStrikethrough: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 8388608);
      },
      set: function (a) {
        var b = 0 !== (this.A & 8388608);
        b !== a &&
          (G && A(a, "boolean", Yg, "isStrikethrough"),
          (this.A ^= 8388608),
          this.R(),
          this.g("isStrikethrough", b, a));
      },
    },
    wrap: {
      configurable: !0,
      get: function () {
        return this.rg;
      },
      set: function (a) {
        var b = this.rg;
        b !== a &&
          (G && cb(a, Yg, Yg, "wrap"),
          (this.rg = a),
          this.v(),
          this.g("wrap", b, a));
      },
    },
    overflow: {
      configurable: !0,
      get: function () {
        return this.gg;
      },
      set: function (a) {
        var b = this.gg;
        b !== a &&
          (G && cb(a, Yg, Yg, "overflow"),
          (this.gg = a),
          this.v(),
          this.g("overflow", b, a));
      },
    },
    stroke: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Mc;
      },
      set: function (a) {
        var b = this.Mc;
        b !== a &&
          (null !== a && bm(a, "TextBlock.stroke"),
          a instanceof Al && a.freeze(),
          (this.Mc = a),
          this.R(),
          this.g("stroke", b, a));
      },
    },
    lineCount: {
      configurable: !0,
      get: function () {
        return this.fd;
      },
    },
    lineHeight: {
      configurable: !0,
      get: function () {
        return ho(this);
      },
    },
    editable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.A & 1048576);
      },
      set: function (a) {
        var b = 0 !== (this.A & 1048576);
        b !== a &&
          (G && A(a, "boolean", Yg, "editable"),
          (this.A ^= 1048576),
          this.g("editable", b, a));
      },
    },
    textEditor: {
      configurable: !0,
      get: function () {
        return this.Ip;
      },
      set: function (a) {
        var b = this.Ip;
        b !== a &&
          (!G ||
            a instanceof Oe ||
            v("TextBlock.textEditor must be an HTMLInfo."),
          (this.Ip = a),
          this.g("textEditor", b, a));
      },
    },
    errorFunction: {
      configurable: !0,
      get: function () {
        return this.ud;
      },
      set: function (a) {
        var b = this.ud;
        b !== a &&
          (null !== a && A(a, "function", Yg, "errorFunction"),
          (this.ud = a),
          this.g("errorFunction", b, a));
      },
    },
    interval: {
      configurable: !0,
      get: function () {
        return null !== this.ja ? this.ja.sl : 1;
      },
      set: function (a) {
        var b = this.interval;
        G && D(a, Yg, "interval");
        a = Math.round(a);
        if (b !== a && 0 !== a && isFinite(a)) {
          null === this.ja && (this.ja = new Tn());
          this.ja.sl = a;
          this.v();
          var c = this.panel;
          null !== c && (c.Zf = null);
          this.g("interval", b, a);
        }
      },
    },
    graduatedStart: {
      configurable: !0,
      get: function () {
        return null !== this.ja ? this.ja.B : 0;
      },
      set: function (a) {
        var b = this.graduatedStart;
        G && D(a, Yg, "graduatedStart");
        b !== a &&
          (0 > a ? (a = 0) : 1 < a && (a = 1),
          null === this.ja && (this.ja = new Tn()),
          (this.ja.B = a),
          this.v(),
          this.g("graduatedStart", b, a));
      },
    },
    graduatedEnd: {
      configurable: !0,
      get: function () {
        return null !== this.ja ? this.ja.j : 1;
      },
      set: function (a) {
        var b = this.graduatedEnd;
        G && D(a, Yg, "graduatedEnd");
        b !== a &&
          (0 > a ? (a = 0) : 1 < a && (a = 1),
          null === this.ja && (this.ja = new Tn()),
          (this.ja.j = a),
          this.v(),
          this.g("graduatedEnd", b, a));
      },
    },
    graduatedFunction: {
      configurable: !0,
      get: function () {
        return null !== this.ja ? this.ja.M : null;
      },
      set: function (a) {
        var b = this.graduatedFunction;
        b !== a &&
          (null !== a && A(a, "function", Yg, "graduatedFunction"),
          null === this.ja && (this.ja = new Tn()),
          (this.ja.M = a),
          this.v(),
          this.g("graduatedFunction", b, a));
      },
    },
    graduatedSkip: {
      configurable: !0,
      get: function () {
        return null !== this.ja ? this.ja.o : null;
      },
      set: function (a) {
        var b = this.graduatedSkip;
        b !== a &&
          (null !== a && A(a, "function", Yg, "graduatedSkip"),
          null === this.ja && (this.ja = new Tn()),
          (this.ja.o = a),
          this.v(),
          this.g("graduatedSkip", b, a));
      },
    },
    textValidation: {
      configurable: !0,
      get: function () {
        return this.Di;
      },
      set: function (a) {
        var b = this.Di;
        b !== a &&
          (null !== a && A(a, "function", Yg, "textValidation"),
          (this.Di = a),
          this.g("textValidation", b, a));
      },
    },
    textEdited: {
      configurable: !0,
      get: function () {
        return this.Hp;
      },
      set: function (a) {
        var b = this.Hp;
        b !== a &&
          (null !== a && A(a, "function", Yg, "textEdited"),
          (this.Hp = a),
          this.g("textEdited", b, a));
      },
    },
    spacingAbove: {
      configurable: !0,
      get: function () {
        return this.tf;
      },
      set: function (a) {
        var b = this.tf;
        b !== a &&
          (G && A(a, "number", Yg, "spacingAbove"),
          (this.tf = a),
          this.v(),
          this.g("spacingAbove", b, a));
      },
    },
    spacingBelow: {
      configurable: !0,
      get: function () {
        return this.uf;
      },
      set: function (a) {
        var b = this.uf;
        b !== a &&
          (G && A(a, "number", Yg, "spacingBelow"),
          (this.uf = a),
          this.v(),
          this.g("spacingBelow", b, a));
      },
    },
    formatting: {
      configurable: !0,
      get: function () {
        return this.gi;
      },
      set: function (a) {
        var b = this.gi;
        b !== a &&
          (cb(a, Yg, Yg, "formatting"),
          (this.gi = a),
          this.v(),
          this.g("formatting", b, a));
      },
    },
    maxLines: {
      configurable: !0,
      get: function () {
        return this.De;
      },
      set: function (a) {
        var b = this.De;
        b !== a &&
          (G && A(a, "number", Yg, "maxLines"),
          (a = Math.floor(a)),
          0 >= a && Aa(a, "> 0", Yg, "maxLines"),
          (this.De = a),
          this.v(),
          this.g("maxLines", b, a));
      },
    },
    metrics: {
      configurable: !0,
      get: function () {
        return {
          arrSize: null !== this.Ic ? this.Ic : [this.yb],
          arrText: null !== this.Xb ? this.Xb : [this.ve],
          maxLineWidth: this.yb,
          fontHeight: this.xe,
        };
      },
    },
    choices: {
      configurable: !0,
      get: function () {
        return this.jn;
      },
      set: function (a) {
        var b = this.jn;
        b !== a &&
          (G &&
            null !== a &&
            !Array.isArray(a) &&
            za(a, "Array", Yg, "choices:value"),
          (this.jn = a),
          this.g("choices", b, a));
      },
    },
  });
  var io = null,
    jo = null,
    to = new F(Yg, "None", 0),
    qo = new F(Yg, "WrapFit", 1),
    eo = new F(Yg, "WrapDesiredSize", 2),
    vo = new F(Yg, "WrapBreakAll", 3),
    co = new F(Yg, "OverflowClip", 0),
    no = new F(Yg, "OverflowEllipsis", 1),
    fo = new F(Yg, "FormatTrim", 0),
    xo = new F(Yg, "FormatNone", 0),
    wo = /[ \u200b\u00ad]/,
    yo = new eb(),
    zo = 0,
    Ao = new eb(),
    Bo = 0,
    po = "...",
    ko = "",
    bo = null,
    ao = !1;
  Yg.className = "TextBlock";
  Yg.getEllipsis = function () {
    return po;
  };
  Yg.setEllipsis = function (a) {
    po = a;
    Ao = new eb();
    Bo = 0;
  };
  Yg.getBaseline = function () {
    return io;
  };
  Yg.setBaseline = function (a) {
    io = a;
  };
  Yg.getUnderline = function () {
    return jo;
  };
  Yg.setUnderline = function (a) {
    jo = a;
  };
  Yg.isValidFont = go;
  Yg.FormatNone = xo;
  Yg.FormatTrim = fo;
  Yg.None = to;
  Yg.OverflowClip = co;
  Yg.OverflowEllipsis = no;
  Yg.WrapBreakAll = vo;
  Yg.WrapDesiredSize = eo;
  Yg.WrapFit = qo;
  function Tn() {
    this.sl = 1;
    this.B = 0;
    this.j = 1;
    this.o = this.M = null;
  }
  Tn.prototype.copy = function () {
    var a = new Tn();
    a.sl = this.sl;
    a.B = this.B;
    a.j = this.j;
    a.M = this.M;
    a.o = this.o;
    return a;
  };
  Tn.className = "GradElementSettings";
  function jk(a, b) {
    O.call(this);
    this.Rg = null;
    this.Bp = "";
    this.rh = uc;
    this.ml = Fd;
    this.th = this.ud = null;
    this.ll = Kc;
    this.$d = tg;
    this.Zl = null;
    this.co = !1;
    this.fi = !0;
    this.Cl = !1;
    this.Ul = null;
    "string" === typeof a ? (this.source = a) : a && Object.assign(this, a);
    b && Object.assign(this, b);
  }
  var Co;
  na(jk, O);
  jk.prototype.cloneProtected = function (a) {
    O.prototype.cloneProtected.call(this, a);
    a.element = this.Rg;
    a.Bp = this.Bp;
    a.rh = this.rh.L();
    a.ml = this.ml;
    a.$d = this.$d;
    a.ud = this.ud;
    a.th = this.th;
    a.ll = this.ll.L();
    a.fi = this.fi;
    a.Ul = this.Ul;
  };
  jk.prototype.pb = function (a) {
    a === tg || a === vg || a === kl
      ? (this.imageStretch = a)
      : O.prototype.pb.call(this, a);
  };
  jk.prototype.toString = function () {
    return "Picture(" + this.source + ")#" + lb(this);
  };
  function Ki(a) {
    void 0 === a && (a = "");
    A(a, "string", jk, "clearCache:url");
    "" !== a ? Co[a] && (delete Co[a], Do--) : ((Co = new eb()), (Do = 0));
  }
  function Eo(a, b) {
    b.Xy ||
      ((b.Fr = function (c) {
        b.xr = !0;
        b.Xn = !1;
        var d = b.Ng.copy();
        if (null !== d && void 0 !== d) {
          for (d = d.iterator; d.next(); ) {
            var e = d.value;
            var f = b.getAttribute("src") || "";
            var g = e.kh.K(f);
            if (null !== g)
              for (var h = g.length, k = 0; k < h; k++)
                (f = g[k]),
                  e.Yo.add(f),
                  e.Ob(),
                  b.Qn &&
                    (void 0 === b.Cu && (b.Cu = c),
                    null !== f.th && f.th(f, c));
          }
          b.Ng.clear();
        }
        a.desiredSize.s() || (vj(a, !1), a.v());
      }),
      (b.ir = function (a) {
        b.Xn = a;
        var c = b.Ng.copy();
        if (null !== c && void 0 !== c) {
          for (c = c.iterator; c.next(); ) {
            var e = c.value,
              f = b.getAttribute("src") || "";
            var g = e.kh.K(f);
            if (null !== g) {
              e = g.length;
              f = Ma();
              for (var h = 0; h < e; h++) f.push(g[h]);
              if (b.Qn)
                for (h = 0; h < e; h++) (g = f[h]), null !== g.ud && g.ud(g, a);
              Pa(f);
            }
          }
          b.Ng.clear();
        }
      }),
      b.addEventListener("load", b.Fr),
      b.addEventListener("error", b.ir),
      (b.Xy = !0));
  }
  function lk(a) {
    a.Fr && a.removeEventListener("load", a.Fr);
    a.ir && a.removeEventListener("error", a.ir);
    delete a.Fr;
    delete a.ir;
  }
  jk.prototype.PA = function () {
    if ("" !== this.source) {
      Ki(this.source);
      var a = this.source;
      this.source = "";
      this.source = a;
    }
  };
  jk.prototype.redraw = function () {
    this.R();
  };
  jk.prototype.Ni = function (a, b) {
    var c = this.Rg;
    if (null !== c) {
      var d = c.getAttribute("src");
      if (
        !(
          (c instanceof HTMLImageElement && (null === d || "" === d)) ||
          (c.Xn instanceof Event && a instanceof Il)
        )
      ) {
        d = this.naturalBounds;
        var e = 0,
          f = 0,
          g = this.co,
          h = g ? +c.width : c.naturalWidth;
        g = g ? +c.height : c.naturalHeight;
        void 0 === h && c.videoWidth && (h = c.videoWidth);
        void 0 === g && c.videoHeight && (g = c.videoHeight);
        h = h || d.width;
        g = g || d.height;
        if (0 !== h && 0 !== g) {
          var k = h,
            l = g;
          this.sourceRect.s() &&
            ((e = this.rh.x),
            (f = this.rh.y),
            (h = this.rh.width),
            (g = this.rh.height));
          var m = h,
            n = g,
            p = this.ml,
            r = this.ll;
          switch (p) {
            case tg:
              if (this.sourceRect.s()) break;
              m >= d.width && (e = e + r.offsetX + (m * r.x - d.width * r.x));
              n >= d.height && (f = f + r.offsetY + (n * r.y - d.height * r.y));
              h = Math.min(d.width, m);
              g = Math.min(d.height, n);
              break;
            case Fd:
              m = d.width;
              n = d.height;
              break;
            case vg:
            case kl:
              p === vg
                ? ((p = Math.min(d.height / n, d.width / m)),
                  (m *= p),
                  (n *= p))
                : p === kl &&
                  ((p = Math.max(d.height / n, d.width / m)),
                  (m *= p),
                  (n *= p),
                  m >= d.width &&
                    (e = (e + r.offsetX + (m * r.x - d.width * r.x) / m) * h),
                  n >= d.height &&
                    (f = (f + r.offsetY + (n * r.y - d.height * r.y) / n) * g),
                  (h *= 1 / (m / d.width)),
                  (g *= 1 / (n / d.height)),
                  (m = d.width),
                  (n = d.height));
          }
          p = this.If() * b.scale;
          var q = m * p * n * p,
            u = (h * g) / q,
            w = c.__goCache;
          p = null;
          var y = Fo;
          if (c.xr && void 0 !== w && 4 < q && u > y * y)
            for (
              null === w.Li && (Go(w, 4, k, l, c), Go(w, 16, k, l, c)),
                k = w.Li,
                l = k.length,
                q = 0;
              q < l;
              q++
            )
              if (k[q].ratio * k[q].ratio < u) p = k[q];
              else break;
          if (!b.Dn) {
            if (null === this.Zl)
              if (null === this.Rg) this.Zl = !1;
              else {
                k = new Nk(null).context;
                try {
                  k.drawImage(this.Rg, 0, 0);
                } catch (z) {
                  G && this.fi && Fa(z.toString()), (this.fi = !1);
                }
                try {
                  k.getImageData(0, 0, 1, 1).data[3] && (this.Zl = !1),
                    (this.Zl = !1);
                } catch (z) {
                  this.Zl = !0;
                }
              }
            if (this.Zl) return;
          }
          k = 0;
          m < d.width && (k = r.offsetX + (d.width * r.x - m * r.x));
          l = 0;
          n < d.height && (l = r.offsetY + (d.height * r.y - n * r.y));
          switch (this.flip) {
            case ml:
              a.translate(Math.min(d.width, m), 0);
              a.scale(-1, 1);
              break;
            case ll:
              a.translate(0, Math.min(d.height, n));
              a.scale(1, -1);
              break;
            case nl:
              a.translate(Math.min(d.width, m), Math.min(d.height, n)),
                a.scale(-1, -1);
          }
          a.Oc();
          if (
            b.Se("pictureRatioOptimization") &&
            !b.Hj &&
            void 0 !== w &&
            null !== p &&
            1 !== p.ratio
          ) {
            a.save();
            b = p.ratio;
            try {
              a.drawImage(
                p.source,
                e / b,
                f / b,
                Math.min(p.source.width, h / b),
                Math.min(p.source.height, g / b),
                k,
                l,
                Math.min(d.width, m),
                Math.min(d.height, n)
              );
            } catch (z) {
              G && this.fi && Fa(z.toString()), (this.fi = !1);
            }
            a.restore();
          } else
            try {
              a.drawImage(
                c,
                e,
                f,
                h,
                g,
                k,
                l,
                Math.min(d.width, m),
                Math.min(d.height, n)
              );
            } catch (z) {
              G && this.fi && Fa(z.toString()), (this.fi = !1);
            }
          switch (this.flip) {
            case ml:
              a.scale(-1, 1);
              a.translate(-Math.min(d.width, m), 0);
              break;
            case ll:
              a.scale(1, -1);
              a.translate(0, -Math.min(d.height, n));
              break;
            case nl:
              a.scale(-1, -1),
                a.translate(-Math.min(d.width, m), -Math.min(d.height, n));
          }
        }
      }
    }
  };
  jk.prototype.tm = function (a, b, c, d) {
    var e = this.desiredSize,
      f = vl(this, !0),
      g = this.Rg,
      h = this.co;
    if (h || (!this.Cl && g && g.complete)) this.Cl = !0;
    null === g && (isFinite(e.width) || (a = 0), isFinite(e.height) || (b = 0));
    isFinite(e.width) || f === Fd || f === il
      ? (isFinite(a) ||
          (this.sourceRect.s()
            ? (a = this.sourceRect.width)
            : null !== g && (a = h ? +g.width : g.naturalWidth)),
        (c = 0))
      : null !== g &&
        !1 !== this.Cl &&
        (a = this.sourceRect.s()
          ? this.sourceRect.width
          : h
          ? +g.width
          : g.naturalWidth);
    isFinite(e.height) || f === Fd || f === jl
      ? (isFinite(b) ||
          (this.sourceRect.s()
            ? (b = this.sourceRect.height)
            : null !== g && (b = h ? +g.height : g.naturalHeight)),
        (d = 0))
      : null !== g &&
        !1 !== this.Cl &&
        (b = this.sourceRect.s()
          ? this.sourceRect.height
          : h
          ? +g.height
          : g.naturalHeight);
    isFinite(e.width) && (a = e.width);
    isFinite(e.height) && (b = e.height);
    e = this.maxSize;
    f = this.minSize;
    c = Math.max(c || 0, f.width);
    d = Math.max(d || 0, f.height);
    a = Math.min(e.width, a);
    b = Math.min(e.height, b);
    a = Math.max(c, a);
    b = Math.max(d, b);
    null === g ||
      g.complete ||
      (isFinite(a) || (a = 0), isFinite(b) || (b = 0));
    dc(this.zc, a, b);
    this.Ee(0, 0, a, b);
  };
  jk.prototype.Eh = function (a, b, c, d) {
    xl(this, a, b, c, d);
  };
  oa.Object.defineProperties(jk.prototype, {
    element: {
      configurable: !0,
      get: function () {
        return this.Rg;
      },
      set: function (a) {
        var b = this.Rg;
        if (b !== a) {
          this.co = a instanceof HTMLCanvasElement;
          var c = a instanceof HTMLImageElement;
          b instanceof HTMLImageElement && lk(b);
          null === a ||
            c ||
            a instanceof HTMLVideoElement ||
            this.co ||
            v(
              "Picture.element must be an instance of Image, Canvas, or Video, not: " +
                a
            );
          var d = this.diagram;
          null !== d && kk(d, this);
          this.Rg = a;
          null !== a && c && void 0 === a.Ng && (a.Ng = new I());
          null !== d && c && ik(d, this);
          null !== a &&
            (this.co || !0 === a.complete
              ? (a.Qn &&
                  (a.Xn instanceof Event && null !== this.ud
                    ? this.ud(this, a.Xn)
                    : !0 === a.xr &&
                      !a.Xn &&
                      null !== this.th &&
                      a.Cu &&
                      this.th(this, a.Cu)),
                (a.xr = !0),
                this.desiredSize.s() || (vj(this, !1), this.v()))
              : c && Eo(this, a));
          this.g("element", b, a);
          this.R();
        }
      },
    },
    source: {
      configurable: !0,
      get: function () {
        return this.Bp;
      },
      set: function (a) {
        var b = this.Bp;
        if (b !== a) {
          A(a, "string", jk, "source");
          this.Bp = a;
          var c = Co;
          if (Wg) {
            if (void 0 !== c[a]) var d = c[a];
            else if ("" !== a) {
              30 < Do && (Ki(), (c = Co));
              d = wa("img");
              d.Qn = !0;
              Eo(this, d);
              var e = this.Ul;
              null !== e && (d.crossOrigin = e(this));
              d.src = a;
              c[a] = d;
              Do++;
            }
            this.element = d;
            null !== d && void 0 === d.__goCache && (d.__goCache = new Ho());
            this.v();
            this.R();
          }
          this.g("source", b, a);
        }
      },
    },
    sourceCrossOrigin: {
      configurable: !0,
      get: function () {
        return this.Ul;
      },
      set: function (a) {
        if (
          this.Ul !== a &&
          (null !== a && A(a, "function", jk, "sourceCrossOrigin"),
          (this.Ul = a),
          null !== this.element)
        ) {
          var b = this.element.getAttribute("src");
          null === a && "string" === typeof b
            ? (this.element.crossOrigin = null)
            : null !== a && (this.element.crossOrigin = a(this));
          this.element.src = b;
        }
      },
    },
    sourceRect: {
      configurable: !0,
      get: function () {
        return this.rh;
      },
      set: function (a) {
        var b = this.rh;
        b.D(a) ||
          (x(a, M, jk, "sourceRect"),
          (this.rh = a = a.L()),
          this.R(),
          this.g("sourceRect", b, a));
      },
    },
    imageStretch: {
      configurable: !0,
      get: function () {
        return this.ml;
      },
      set: function (a) {
        var b = this.ml;
        b !== a &&
          (cb(a, O, jk, "imageStretch"),
          (this.ml = a),
          this.R(),
          this.g("imageStretch", b, a));
      },
    },
    flip: {
      configurable: !0,
      get: function () {
        return this.$d;
      },
      set: function (a) {
        var b = this.$d;
        b !== a &&
          (cb(a, O, jk, "flip"), (this.$d = a), this.R(), this.g("flip", b, a));
      },
    },
    imageAlignment: {
      configurable: !0,
      get: function () {
        return this.ll;
      },
      set: function (a) {
        x(a, Ib, jk, "imageAlignment");
        var b = this.ll;
        b.D(a) ||
          ((this.ll = a = a.L()), this.R(), this.g("imageAlignment", b, a));
      },
    },
    errorFunction: {
      configurable: !0,
      get: function () {
        return this.ud;
      },
      set: function (a) {
        var b = this.ud;
        b !== a &&
          (null !== a && A(a, "function", jk, "errorFunction"),
          (this.ud = a),
          this.g("errorFunction", b, a));
      },
    },
    successFunction: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.th;
      },
      set: function (a) {
        var b = this.th;
        b !== a &&
          (null !== a && A(a, "function", jk, "successFunction"),
          (this.th = a),
          this.g("successFunction", b, a));
      },
    },
    naturalBounds: {
      configurable: !0,
      get: function () {
        return this.zc;
      },
    },
  });
  jk.prototype.redraw = jk.prototype.redraw;
  jk.prototype.reloadSource = jk.prototype.PA;
  var Do = 0,
    Fo = 4;
  jk.className = "Picture";
  Co = new eb();
  jk.clearCache = Ki;
  function Ho() {
    this.Li = null;
  }
  function Go(a, b, c, d, e) {
    null === a.Li && (a.Li = []);
    var f = new Nk(null),
      g = f.context,
      h = 1 / b;
    f.width = c / b;
    f.height = d / b;
    0 !== f.width &&
      0 !== f.height &&
      ((b = new Io(f.Sa, b)),
      (c = 1),
      0 < a.Li.length &&
        ((c = a.Li[a.Li.length - 1]), (e = c.source), (c = c.ratio)),
      g.setTransform(h * c, 0, 0, h * c, 0, 0),
      g.Oc(),
      g.drawImage(e, 0, 0),
      a.Li.push(b));
  }
  Ho.className = "PictureCacheArray";
  function Io(a, b) {
    this.source = a;
    this.ratio = b;
  }
  Io.className = "PictureCacheInstance";
  function Jo() {
    this.Fs = new N();
    this.pc = null;
  }
  Jo.prototype.reset = function (a) {
    null !== a
      ? (a.la(), (this.Fs = a), a.figures.clear())
      : (this.Fs = new N());
    this.pc = null;
  };
  function Jd(a, b, c, d, e) {
    a.pc = new ie();
    a.pc.startX = b;
    a.pc.startY = c;
    a.pc.isFilled = d;
    a.Fs.figures.add(a.pc);
    void 0 !== e && (a.pc.isShadowed = e);
  }
  function Nd(a) {
    var b = a.pc.segments.length;
    0 < b && a.pc.segments.N(b - 1).close();
  }
  Jo.prototype.Mm = function (a) {
    this.pc.isShadowed = a;
  };
  Jo.prototype.moveTo = function (a, b, c) {
    void 0 === c && (c = !1);
    var d = new je(Sd);
    d.endX = a;
    d.endY = b;
    c && d.close();
    this.pc.segments.add(d);
  };
  Jo.prototype.lineTo = function (a, b, c) {
    void 0 === c && (c = !1);
    var d = new je(Hd);
    d.endX = a;
    d.endY = b;
    c && d.close();
    this.pc.segments.add(d);
  };
  function Kd(a, b, c, d, e, f, g) {
    var h;
    void 0 === h && (h = !1);
    var k = new je(Td);
    k.point1X = b;
    k.point1Y = c;
    k.point2X = d;
    k.point2Y = e;
    k.endX = f;
    k.endY = g;
    h && k.close();
    a.pc.segments.add(k);
  }
  function Ld(a, b, c, d, e) {
    var f;
    void 0 === f && (f = !1);
    var g = new je(Ud);
    g.point1X = b;
    g.point1Y = c;
    g.endX = d;
    g.endY = e;
    f && g.close();
    a.pc.segments.add(g);
  }
  Jo.prototype.arcTo = function (a, b, c, d, e, f, g) {
    void 0 === f && (f = 0);
    void 0 === g && (g = !1);
    var h = new je(Vd);
    h.startAngle = a;
    h.sweepAngle = b;
    h.centerX = c;
    h.centerY = d;
    h.radiusX = e;
    h.radiusY = 0 !== f ? f : e;
    g && h.close();
    this.pc.segments.add(h);
  };
  function Md(a, b, c, d, e, f, g, h) {
    var k;
    void 0 === k && (k = !1);
    b = new je(be, g, h, b, c, d, e, f);
    k && b.close();
    a.pc.segments.add(b);
  }
  function Id(a) {
    var b = Qd;
    if (null !== b) return (Qd = null), b.reset(a), b;
    b = new Jo();
    b.reset(a);
    return b;
  }
  var Qd = null;
  Jo.className = "StreamGeometryContext";
  function Ko(a, b) {
    var c = a.toLowerCase(),
      d = L.pe;
    d[a] = b;
    d[c] = a;
  }
  Ko("Rectangle", function (a, b, c) {
    a = "r" + b + "," + c;
    var d = L.Rf[a];
    if (void 0 !== d) return d;
    d = new N(N.B);
    d.endX = b;
    d.endY = c;
    L.Sf < L.Tm && ((L.Rf[a] = d), L.Sf++);
    return d;
  });
  Ko("Square", function (a, b, c) {
    a = "s" + b + "," + c;
    var d = L.Rf[a];
    if (void 0 !== d) return d;
    d = new N(N.B);
    d.endX = b;
    d.endY = c;
    d.defaultStretch = vg;
    L.Sf < L.Tm && ((L.Rf[a] = d), L.Sf++);
    return d;
  });
  Ko("RoundedRectangle", function (a, b, c) {
    a = a ? a.parameter1 : NaN;
    if (isNaN(a) || 0 > a) a = 5;
    a = Math.min(a, b / 3);
    a = Math.min(a, c / 3);
    var d = "rr" + b + "," + c + "," + a,
      e = L.Rf[d];
    if (void 0 !== e) return e;
    var f = a * L.Bg;
    e = new N().add(
      new ie(a, 0, !0)
        .add(new je(Hd, b - a, 0))
        .add(new je(Td, b, a, b - f, 0, b, f))
        .add(new je(Hd, b, c - a))
        .add(new je(Td, b - a, c, b, c - f, b - f, c))
        .add(new je(Hd, a, c))
        .add(new je(Td, 0, c - a, f, c, 0, c - f))
        .add(new je(Hd, 0, a))
        .add(new je(Td, a, 0, 0, f, f, 0).close())
    );
    1 < f && ((e.spot1 = new Ib(0, 0, f, f)), (e.spot2 = new Ib(1, 1, -f, -f)));
    L.Sf < L.Tm && ((L.Rf[d] = e), L.Sf++);
    return e;
  });
  Ko("Border", "RoundedRectangle");
  Ko("Ellipse", function (a, b, c) {
    a = "e" + b + "," + c;
    var d = L.Rf[a];
    if (void 0 !== d) return d;
    d = new N(N.M);
    d.endX = b;
    d.endY = c;
    d.spot1 = sd;
    d.spot2 = td;
    L.Sf < L.Tm && ((L.Rf[a] = d), L.Sf++);
    return d;
  });
  Ko("Circle", function (a, b, c) {
    a = "c" + b + "," + c;
    var d = L.Rf[a];
    if (void 0 !== d) return d;
    d = new N(N.M);
    d.endX = b;
    d.endY = c;
    d.spot1 = sd;
    d.spot2 = td;
    d.defaultStretch = vg;
    L.Sf < L.Tm && ((L.Rf[a] = d), L.Sf++);
    return d;
  });
  Ko("TriangleRight", function (a, b, c) {
    return new N()
      .add(
        new ie(0, 0).add(new je(Hd, b, 0.5 * c)).add(new je(Hd, 0, c).close())
      )
      .Nm(0, 0.25, 0.5, 0.75);
  });
  Ko("TriangleDown", function (a, b, c) {
    return new N()
      .add(
        new ie(0, 0).add(new je(Hd, b, 0)).add(new je(Hd, 0.5 * b, c).close())
      )
      .Nm(0.25, 0, 0.75, 0.5);
  });
  Ko("TriangleLeft", function (a, b, c) {
    return new N()
      .add(
        new ie(b, c).add(new je(Hd, 0, 0.5 * c)).add(new je(Hd, b, 0).close())
      )
      .Nm(0.5, 0.25, 1, 0.75);
  });
  Ko("TriangleUp", function (a, b, c) {
    return new N()
      .add(
        new ie(b, c).add(new je(Hd, 0, c)).add(new je(Hd, 0.5 * b, 0).close())
      )
      .Nm(0.25, 0.5, 0.75, 1);
  });
  Ko("Triangle", "TriangleUp");
  Ko("Diamond", function (a, b, c) {
    return new N()
      .add(
        new ie(0.5 * b, 0)
          .add(new je(Hd, 0, 0.5 * c))
          .add(new je(Hd, 0.5 * b, c))
          .add(new je(Hd, b, 0.5 * c).close())
      )
      .Nm(0.25, 0.25, 0.75, 0.75);
  });
  Ko("LineH", function (a, b, c) {
    a = new N(N.j);
    a.startX = 0;
    a.startY = c / 2;
    a.endX = b;
    a.endY = c / 2;
    return a;
  });
  Ko("LineV", function (a, b, c) {
    a = new N(N.j);
    a.startX = b / 2;
    a.startY = 0;
    a.endX = b / 2;
    a.endY = c;
    return a;
  });
  Ko("None", "Rectangle");
  Ko("BarH", "Rectangle");
  Ko("BarV", "Rectangle");
  Ko("MinusLine", "LineH");
  Ko("PlusLine", function (a, b, c) {
    return new N().add(
      new ie(0, c / 2, !1)
        .add(new je(Hd, b, c / 2))
        .add(new je(Sd, b / 2, 0))
        .add(new je(Hd, b / 2, c))
    );
  });
  Ko("XLine", function (a, b, c) {
    return new N().add(
      new ie(0, c, !1)
        .add(new je(Hd, b, 0))
        .add(new je(Sd, 0, 0))
        .add(new je(Hd, b, c))
    );
  });
  L.Sm = {
    "": "",
    Standard: "F1 m 0,0 l 8,4 -8,4 2,-4 z",
    Backward: "F1 m 8,0 l -2,4 2,4 -8,-4 z",
    Triangle: "F1 m 0,0 l 8,4.62 -8,4.62 z",
    BackwardTriangle: "F1 m 8,4 l 0,4 -8,-4 8,-4 0,4 z",
    Boomerang: "F1 m 0,0 l 8,4 -8,4 4,-4 -4,-4 z",
    BackwardBoomerang: "F1 m 8,0 l -8,4 8,4 -4,-4 4,-4 z",
    SidewaysV: "m 0,0 l 8,4 -8,4 0,-1 6,-3 -6,-3 0,-1 z",
    BackwardV: "m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z",
    OpenTriangle: "m 0,0 l 8,4 -8,4",
    BackwardOpenTriangle: "m 8,0 l -8,4 8,4",
    OpenTriangleLine: "m 0,0 l 8,4 -8,4 m 8.5,0 l 0,-8",
    BackwardOpenTriangleLine: "m 8,0 l  -8,4 8,4 m -8.5,0 l 0,-8",
    OpenTriangleTop: "m 0,0 l 8,4 m 0,4",
    BackwardOpenTriangleTop: "m 8,0 l -8,4 m 0,4",
    OpenTriangleBottom: "m 0,8 l 8,-4",
    BackwardOpenTriangleBottom: "m 0,4 l 8,4",
    HalfTriangleTop: "F1 m 0,0 l 0,4 8,0 z m 0,8",
    BackwardHalfTriangleTop: "F1 m 8,0 l 0,4 -8,0 z m 0,8",
    HalfTriangleBottom: "F1 m 0,4 l 0,4 8,-4 z",
    BackwardHalfTriangleBottom: "F1 m 8,4 l 0,4 -8,-4 z",
    ForwardSemiCircle: "m 4,0 b 270 180 0 4 4",
    BackwardSemiCircle: "m 4,8 b 90 180 0 -4 4",
    Feather: "m 0,0 l 3,4 -3,4",
    BackwardFeather: "m 3,0 l -3,4 3,4",
    DoubleFeathers: "m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",
    BackwardDoubleFeathers: "m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4",
    TripleFeathers: "m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",
    BackwardTripleFeathers:
      "m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4 m 3,-8 l -3,4 3,4",
    ForwardSlash: "m 0,8 l 5,-8",
    BackSlash: "m 0,0 l 5,8",
    DoubleForwardSlash: "m 0,8 l 4,-8 m -2,8 l 4,-8",
    DoubleBackSlash: "m 0,0 l 4,8 m -2,-8 l 4,8",
    TripleForwardSlash: "m 0,8 l 4,-8 m -2,8 l 4,-8 m -2,8 l 4,-8",
    TripleBackSlash: "m 0,0 l 4,8 m -2,-8 l 4,8 m -2,-8 l 4,8",
    Fork: "m 0,4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",
    BackwardFork: "m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4",
    LineFork: "m 0,0 l 0,8 m 0,-4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",
    BackwardLineFork: "m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4 m 8,-8 l 0,8",
    CircleFork:
      "F1 m 6,4 b 0 360 -3 0 3 z m 0,0 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",
    BackwardCircleFork:
      "F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 6,0 b 0 360 -3 0 3",
    CircleLineFork:
      "F1 m 6,4 b 0 360 -3 0 3 z m 1,-4 l 0,8 m 0,-4 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",
    BackwardCircleLineFork:
      "F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 0,-4 l 0,8 m 7,-4 b 0 360 -3 0 3",
    Circle: "F1 m 8,4 b 0 360 -4 0 4 z",
    Block: "F1 m 0,0 l 0,8 8,0 0,-8 z",
    StretchedDiamond: "F1 m 0,3 l 5,-3 5,3 -5,3 -5,-3 z",
    Diamond: "F1 m 0,4 l 4,-4 4,4 -4,4 -4,-4 z",
    Chevron: "F1 m 0,0 l 5,0 3,4 -3,4 -5,0 3,-4 -3,-4 z",
    StretchedChevron: "F1 m 0,0 l 8,0 3,4 -3,4 -8,0 3,-4 -3,-4 z",
    NormalArrow: "F1 m 0,2 l 4,0 0,-2 4,4 -4,4 0,-2 -4,0 z",
    X: "m 0,0 l 8,8 m 0,-8 l -8,8",
    TailedNormalArrow:
      "F1 m 0,0 l 2,0 1,2 3,0 0,-2 2,4 -2,4 0,-2 -3,0 -1,2 -2,0 1,-4 -1,-4 z",
    DoubleTriangle: "F1 m 0,0 l 4,4 -4,4 0,-8 z  m 4,0 l 4,4 -4,4 0,-8 z",
    BigEndArrow: "F1 m 0,0 l 5,2 0,-2 3,4 -3,4 0,-2 -5,2 0,-8 z",
    ConcaveTailArrow: "F1 m 0,2 h 4 v -2 l 4,4 -4,4 v -2 h -4 l 2,-2 -2,-2 z",
    RoundedTriangle:
      "F1 m 0,1 a 1,1 0 0 1 1,-1 l 7,3 a 0.5,1 0 0 1 0,2 l -7,3 a 1,1 0 0 1 -1,-1 l 0,-6 z",
    SimpleArrow:
      "F1 m 1,2 l -1,-2 2,0 1,2 -1,2 -2,0 1,-2 5,0 0,-2 2,2 -2,2 0,-2 z",
    AccelerationArrow:
      "F1 m 0,0 l 0,8 0.2,0 0,-8 -0.2,0 z m 2,0 l 0,8 1,0 0,-8 -1,0 z m 3,0 l 2,0 2,4 -2,4 -2,0 0,-8 z",
    BoxArrow: "F1 m 0,0 l 4,0 0,2 2,0 0,-2 2,4 -2,4 0,-2 -2,0 0,2 -4,0 0,-8 z",
    TriangleLine: "F1 m 8,4 l -8,-4 0,8 8,-4 z m 0.5,4 l 0,-8",
    CircleEndedArrow:
      "F1 m 10,4 l -2,-3 0,2 -2,0 0,2 2,0 0,2 2,-3 z m -4,0 b 0 360 -3 0 3 z",
    DynamicWidthArrow:
      "F1 m 0,3 l 2,0 2,-1 2,-2 2,4 -2,4 -2,-2 -2,-1 -2,0 0,-2 z",
    EquilibriumArrow: "m 0,3 l 8,0 -3,-3 m 3,5 l -8,0 3,3",
    FastForward:
      "F1 m 0,0 l 3.5,4 0,-4 3.5,4 0,-4 1,0 0,8 -1,0 0,-4 -3.5,4 0,-4 -3.5,4 0,-8 z",
    Kite: "F1 m 0,4 l 2,-4 6,4 -6,4 -2,-4 z",
    HalfArrowTop: "F1 m 0,0 l 4,4 4,0 -8,-4 z m 0,8",
    HalfArrowBottom: "F1 m 0,8 l 4,-4 4,0 -8,4 z",
    OpposingDirectionDoubleArrow:
      "F1 m 0,4 l 2,-4 0,2 4,0 0,-2 2,4 -2,4 0,-2 -4,0 0,2 -2,-4 z",
    PartialDoubleTriangle: "F1 m 0,0 4,3 0,-3 4,4 -4,4 0,-3 -4,3 0,-8 z",
    LineCircle: "F1 m 0,0 l 0,8 m 7 -4 b 0 360 -3 0 3 z",
    DoubleLineCircle: "F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",
    TripleLineCircle:
      "F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",
    CircleLine: "F1 m 6 4 b 0 360 -3 0 3 z m 1,-4 l 0,8",
    DiamondCircle: "F1 m 8,4 l -4,4 -4,-4 4,-4 4,4 m 8,0 b 0 360 -4 0 4 z",
    PlusCircle: "F1 m 8,4 b 0 360 -4 0 4 l -8 0 z m -4 -4 l 0 8",
    OpenRightTriangleTop: "m 8,0 l 0,4 -8,0 m 0,4",
    OpenRightTriangleBottom: "m 8,8 l 0,-4 -8,0",
    Line: "m 0,0 l 0,8",
    DoubleLine: "m 0,0 l 0,8 m 2,0 l 0,-8",
    TripleLine: "m 0,0 l 0,8 m 2,0 l 0,-8 m 2,0 l 0,8",
    PentagonArrow: "F1 m 8,4 l -4,-4 -4,0 0,8 4,0 4,-4 z",
  };
  function U(a, b) {
    void 0 === a || a instanceof Yl || "string" === typeof a
      ? W.call(this, a)
      : (W.call(this), a && (b = a));
    this.H = 2408959;
    this.Zg = this.Vf = "";
    this.ip = this.ep = this.qp = this.qo = null;
    this.sp = "";
    this.Tf = this.$n = this.rp = this.ph = null;
    this.gp = "";
    this.fp = $b;
    this.bc = this.jp = "";
    this.mi = this.mn = this.Zh = null;
    this.fe = new K(NaN, NaN).freeze();
    this.wo = "";
    this.lf = null;
    this.xo = Fc;
    this.kp = gd;
    this.Fo = zb;
    this.yo = Ab;
    this.Cn = null;
    this.ro = 127;
    this.yp = Bb;
    this.xp = "gray";
    this.mg = 4;
    this.Xw = -1;
    this.Tp = NaN;
    this.Wy = new M();
    this.ui = null;
    this.dg = NaN;
    b && Object.assign(this, b);
  }
  na(U, W);
  U.prototype.cloneProtected = function (a) {
    W.prototype.cloneProtected.call(this, a);
    a.H = (this.H & -4097) | 49152;
    a.Vf = this.Vf;
    a.Zg = this.Zg;
    a.qo = this.qo;
    a.qp = this.qp;
    a.ep = this.ep;
    a.ip = this.ip;
    a.sp = this.sp;
    a.rp = this.rp;
    a.$n = this.$n;
    a.Tf = null;
    a.gp = this.gp;
    a.fp = this.fp.L();
    a.jp = this.jp;
    a.kp = this.kp.L();
    a.bc = this.bc;
    a.mn = this.mn;
    a.fe.assign(this.fe);
    a.wo = this.wo;
    a.xo = this.xo.L();
    a.Fo = this.Fo.L();
    a.yo = this.yo.L();
    a.Cn = this.Cn;
    a.ro = this.ro;
    a.yp = this.yp.L();
    a.xp = this.xp;
    a.mg = this.mg;
    a.Tp = this.Tp;
  };
  U.prototype.Ef = function (a) {
    W.prototype.Ef.call(this, a);
    a.Lh();
    a.ph = null;
    a.lf = null;
    a.ui = null;
  };
  U.prototype.toString = function () {
    var a = Qa(this.constructor) + "#" + lb(this);
    null !== this.data && (a += "(" + Ra(this.data) + ")");
    return a;
  };
  U.prototype.Hk = function (a, b, c, d, e, f, g) {
    var h = this.diagram;
    null !== h &&
      (a === re && "elements" === b
        ? e instanceof W
          ? Nj(e, function (a) {
              Pj(h.partManager, a);
              Oj(h, a);
            })
          : ik(h, e)
        : a === se &&
          "elements" === b &&
          (e instanceof W
            ? Nj(e, function (a) {
                Sj(h.partManager, a, h);
              })
            : kk(h, e)),
      h.cb(a, b, c, d, e, f, g));
  };
  U.prototype.Ka = function (a) {
    W.prototype.Ka.call(this, a);
    if (null !== this.data) {
      for (var b = this.W.m, c = b.length, d = 0; d < c; d++) {
        var e = b[d];
        e instanceof W &&
          Nj(e, function (a) {
            null !== a.data && a.Ka();
          });
      }
      for (b = this.adornments; b.next(); ) b.value.Ka(a);
    }
  };
  U.prototype.updateRelationshipsFromData = function () {
    var a;
    null !== this.data &&
      (null === (a = this.diagram) || void 0 === a
        ? void 0
        : a.partManager.updateRelationshipsFromData(this));
  };
  U.prototype.pk = function (a) {
    G && A(a, "string", U, "findAdornment:category");
    var b = this.Tf;
    return null === b ? null : b.K(a);
  };
  U.prototype.Ch = function (a, b) {
    if (null !== b) {
      G &&
        (A(a, "string", U, "addAdornment:category"),
        x(b, Je, U, "addAdornment:ad"));
      var c = null,
        d = this.Tf;
      null !== d && (c = d.K(a));
      if (c !== b) {
        if (null !== c) {
          var e = c.diagram;
          null !== e && e.remove(c);
        }
        null === d && (this.Tf = d = new xb());
        b.Vf !== a && (b.category = a);
        d.add(a, b);
        a = this.diagram;
        null !== a &&
          (a.add(b),
          (a = b.adornedObject),
          null !== a && ((a = a.Hh()), null !== a && (b.data = a.data)));
      }
    }
  };
  U.prototype.Of = function (a) {
    G && A(a, "string", U, "removeAdornment:category");
    var b = this.Tf;
    if (null !== b) {
      var c = b.K(a);
      if (null !== c) {
        var d = c.diagram;
        null !== d && d.remove(c);
      }
      b.remove(a);
      0 === b.count && (this.Tf = null);
    }
  };
  U.prototype.gk = function () {
    var a = this.Tf;
    if (null !== a) {
      var b = Ma();
      for (a = a.iterator; a.next(); ) b.push(a.key);
      a = b.length;
      for (var c = 0; c < a; c++) this.Of(b[c]);
      Pa(b);
    }
  };
  U.prototype.updateAdornments = function () {
    var a = this.diagram;
    if (null !== a) {
      for (var b = this.adornments; b.next(); ) {
        var c = b.value;
        c.v();
        c.placeholder && c.placeholder.v();
      }
      a: {
        if (
          this.isSelected &&
          this.selectionAdorned &&
          ((b = this.selectionObject),
          null !== b &&
            this.actualBounds.s() &&
            this.isVisible() &&
            b.Nf() &&
            b.actualBounds.s())
        ) {
          c = this.pk("Selection");
          if (null === c) {
            c = this.selectionAdornmentTemplate;
            null === c &&
              (c = this.Mh()
                ? a.linkSelectionAdornmentTemplate
                : this instanceof vf
                ? a.groupSelectionAdornmentTemplate
                : a.nodeSelectionAdornmentTemplate);
            if (!(c instanceof Je)) break a;
            sg(c);
            c = c.copy();
            null !== c &&
              (this.Mh() &&
                this.selectionObject === this.path &&
                (c.type = W.Link),
              (c.adornedObject = b));
          }
          if (null !== c) {
            c.type === W.Link && c.v();
            this.Ch("Selection", c);
            break a;
          }
        }
        this.Of("Selection");
      }
      Lo(this, a);
      for (b = this.adornments; b.next(); ) b.value.Ka();
    }
  };
  U.prototype.Tb = function () {
    var a = this.diagram;
    null !== a &&
      (dj(a), (0 !== (this.H & 16384)) !== !0 && ((this.H |= 16384), a.Ob()));
  };
  function ni(a) {
    (0 !== (a.H & 16384)) !== !1 && (a.updateAdornments(), (a.H &= -16385));
  }
  function Lo(a, b) {
    b.toolManager.mouseDownTools.each(function (b) {
      b.isEnabled && b.updateAdornments(a);
    });
    b.toolManager.updateAdornments(a);
  }
  function Mo(a) {
    if (!1 === Cj(a)) {
      No(a, !0);
      a.tl();
      var b = a.diagram;
      null !== b && (b.ze.add(a), b.Ob());
    }
  }
  function Oo(a) {
    a.H |= 2097152;
    if (!1 !== Cj(a)) {
      var b = a.position,
        c = a.location;
      (c.s() && b.s()) || Po(a, b, c);
      c = a.Db;
      var d = M.alloc().assign(c);
      c.la();
      c.x = b.x;
      c.y = b.y;
      c.freeze();
      a.um(d, c);
      M.free(d);
      No(a, !1);
    }
  }
  U.prototype.Ee = function (a, b, c, d) {
    var e = this.rc;
    e.h(a, b, c, d);
    null === this.Ib && (this.Ib = new Kb());
    var f = this.Ib;
    f.reset();
    this.wp(f, a, b, c, d);
    this.Ib = f;
    f.Ps() || f.Hq(e);
  };
  U.prototype.wp = function (a, b, c, d, e) {
    1 !== this.Aa && a.scale(this.Aa);
    if (0 !== this.Fb) {
      var f = Kc;
      this.locationSpot.ib() && (f = this.locationSpot);
      var g = K.alloc();
      if (this.locationObject !== this)
        for (
          b = this.locationObject,
            c = b.naturalBounds,
            g.dj(c.x, c.y, c.width, c.height, f),
            null !== b.Ib && b.Ib.Ha(g),
            g.offset(-b.measuredBounds.x, -b.measuredBounds.y),
            f = b.panel;
          null !== f && f !== this;

        )
          null !== f.Ib && f.Ib.Ha(g),
            g.offset(-f.measuredBounds.x, -f.measuredBounds.y),
            (f = f.panel);
      else g.dj(b, c, d, e, f);
      a.rotate(this.Fb, g.x, g.y);
      K.free(g);
    }
  };
  U.prototype.move = function (a, b) {
    !0 === b ? (this.location = a) : (this.position = a);
  };
  U.prototype.moveTo = function (a, b, c) {
    a = K.allocAt(a, b);
    this.move(a, c);
    K.free(a);
  };
  U.prototype.isVisible = function () {
    if (!this.visible) return !1;
    var a = this.layer;
    if (null !== a) {
      if (!a.visible) return !1;
      a = a.diagram;
      if (null !== a && a.animationManager.Ys(this)) return !0;
    }
    a = this.containingGroup;
    return null === a || (a.isSubGraphExpanded && a.isVisible()) ? !0 : !1;
  };
  U.prototype.Vb = function (a) {
    var b = this.diagram;
    a
      ? (this.F(4), this.Tb(), null !== b && b.ze.add(this))
      : (this.F(8), this.gk());
    this.Lh();
    null !== b && (b.Wa(), b.R());
  };
  U.prototype.hb = function (a) {
    if (this.name === a) return this;
    var b = this.ui;
    null === b && (this.ui = b = new xb());
    if (null !== b.K(a)) return b.K(a);
    var c = W.prototype.hb.call(this, a);
    if (null !== c) return b.set(a, c), c;
    b.set(a, null);
    return null;
  };
  function Qo(a, b, c, d) {
    void 0 === d && (d = new K());
    c = c.ec() ? Kc : c;
    var e = b.naturalBounds;
    d.h(e.width * c.x + c.offsetX, e.height * c.y + c.offsetY);
    if (null === b || b === a) return d;
    b.transform.Ha(d);
    for (b = b.panel; null !== b && b !== a; ) b.transform.Ha(d), (b = b.panel);
    null !== a.Ib && a.Ib.Ha(d);
    d.offset(-a.rc.x, -a.rc.y);
    return d;
  }
  U.prototype.Ui = function (a) {
    void 0 === a && (a = new M());
    return a.assign(this.actualBounds);
  };
  U.prototype.Za = function () {
    !0 === Aj(this) && this.measure(Infinity, Infinity);
    this.arrange();
  };
  function Lj(a, b) {
    var c = a.Wy;
    isNaN(a.dg) && (a.dg = tn(a));
    var d = a.dg;
    var e = 2 * d;
    if (!a.isShadowed)
      return (
        c.h(b.x - 1 - d, b.y - 1 - d, b.width + 2 + e, b.height + 2 + e), c
      );
    d = b.x;
    e = b.y;
    var f = b.width;
    b = b.height;
    var g = a.shadowBlur;
    a = a.shadowOffset;
    f += g;
    b += g;
    d -= g / 2;
    e -= g / 2;
    0 < a.x ? (f += a.x) : ((d += a.x), (f -= a.x));
    0 < a.y ? (b += a.y) : ((e += a.y), (b -= a.y));
    c.h(d - 1, e - 1, f + 2, b + 2);
    return c;
  }
  U.prototype.arrange = function () {
    if (!1 === Bj(this)) Oo(this);
    else {
      wl(this, !1);
      var a = this.Db,
        b = M.alloc();
      b.assign(a);
      var c = qg(this);
      this.Eh(0, 0, this.rc.width, this.rc.height);
      var d = this.position;
      Po(this, d, this.location);
      a.la();
      a.x = d.x;
      a.y = d.y;
      a.freeze();
      this.um(b, a);
      b.D(a)
        ? this.Sd(c)
        : !this.Tc() ||
          (L.C(b.width, a.width) && L.C(b.height, a.height)) ||
          (0 <= this.Xw && this.F(16));
      M.free(b);
      No(this, !1);
    }
  };
  t = U.prototype;
  t.um = function (a, b) {
    var c = this.diagram;
    if (null !== c) {
      var d = !1;
      if (!1 === c.Dj && a.s()) {
        var e = M.alloc();
        e.assign(c.documentBounds);
        e.cw(c.padding);
        a.x > e.x &&
          a.y > e.y &&
          a.right < e.right &&
          a.bottom < e.bottom &&
          b.x > e.x &&
          b.y > e.y &&
          b.right < e.right &&
          b.bottom < e.bottom &&
          (d = !0);
        M.free(e);
      }
      ((0 !== (this.H & 65536)) !== !0 && a.D(b)) || Qj(this, d, c);
      c.R();
      (!a.s() && !b.s()) ||
        gc(a, b) ||
        (this instanceof V && !c.undoManager.isUndoingRedoing && this.zd(),
        this.Lh());
    }
  };
  t.Zv = function (a, b, c) {
    if (this.Mh() || !a.s()) return !1;
    var d = this.diagram;
    null !== d && Ro(this, d, a, b, c);
    this.ra = a;
    this.H &= -2097153;
    !this.fe.s() ||
      (null !== d &&
        !d.animationManager.isTicking &&
        d.undoManager.isUndoingRedoing) ||
      ((d = this.fe),
      (this.fe = new K(d.x + (a.x - b), d.y + (a.y - c))),
      this.g("location", d, this.fe.copy()));
    !1 === Cj(this) && !1 === Bj(this) && (Mo(this), Oo(this));
    return !0;
  };
  function Ro(a, b, c, d, e) {
    null === b ||
      a instanceof Je ||
      ((b = b.animationManager), b.zb && Fh(b, a, new K(d, e), c));
  }
  t.Jm = function (a, b, c) {
    var d = this.fe,
      e = this.ra;
    if (c) {
      if (d.x === a && d.y === b) return;
      Cj(this) || Bj(this) ? e.h(NaN, NaN) : e.h(e.x + a - d.x, e.y + b - d.y);
      d.h(a, b);
    } else {
      if (e.x === a && e.y === b) return;
      Cj(this) || Bj(this) ? this.ft() : d.h(d.x + a - e.x, d.y + b - e.y);
      e.h(a, b);
    }
    Mo(this);
  };
  t.ft = function () {
    this.H &= -2097153;
    Mo(this);
  };
  function Po(a, b, c) {
    var d = K.alloc(),
      e = a.locationObject,
      f = e.naturalBounds,
      g = e instanceof Hf ? e.strokeWidth : 0;
    d.dj(0, 0, f.width + g, f.height + g, a.locationSpot);
    if (e !== a)
      for (
        d.offset(-g / 2, -g / 2), e.transform.Ha(d), e = e.panel;
        null !== e && e !== a;

      )
        e.transform.Ha(d), (e = e.panel);
    null !== a.Ib && a.Ib.Ha(d);
    d.offset(-a.rc.x, -a.rc.y);
    e = a.diagram;
    f = c.s();
    g = b.s();
    f && g
      ? 0 !== (a.H & 2097152)
        ? So(a, b, c, e, d)
        : To(a, b, c, e, d)
      : f
      ? So(a, b, c, e, d)
      : g && To(a, b, c, e, d);
    a.H |= 2097152;
    K.free(d);
    a.tl();
  }
  function So(a, b, c, d, e) {
    var f = b.x,
      g = b.y;
    b.h(c.x - e.x, c.y - e.y);
    null !== d &&
      ((c = d.animationManager),
      (d = c.defaultAnimation.isAnimating) ||
        !c.zb ||
        a instanceof Je ||
        Fh(c, a, new K(f, g), b),
      d || (b.x === f && b.y === g) || a.g("position", new K(f, g), b.copy()));
  }
  function To(a, b, c, d, e) {
    var f = c.copy();
    c.h(b.x + e.x, b.y + e.y);
    c.D(f) || null === d || a.g("location", f, c.copy());
  }
  function Qj(a, b, c) {
    yl(a, !1);
    a instanceof V && Ik(c, a);
    a.layer.isTemporary || b || c.Wa();
    b = a.Db;
    var d = c.viewportBounds;
    d.s()
      ? qg(a)
        ? (lc(b, d) || a.Sd(!1), a.updateAdornments())
        : b.Sc(d)
        ? (a.Sd(!0), a.updateAdornments())
        : a.Tb()
      : (c.Fj = !0);
  }
  t.aj = function () {
    return !0;
  };
  t.Tc = function () {
    return !0;
  };
  t.Mh = function () {
    return !1;
  };
  t.$i = function () {
    return !0;
  };
  function Uo(a, b, c, d) {
    b.constructor === a.constructor ||
      Vo ||
      ((Vo = !0),
      Fa(
        'Should not change the class of the Part when changing category from "' +
          c +
          '" to "' +
          d +
          '"'
      ),
      Fa(
        "  Old class: " +
          Qa(a.constructor) +
          ", new class: " +
          Qa(b.constructor) +
          ", part: " +
          a.toString()
      ));
    a.gk();
    var e = a.data;
    c = a.layerName;
    var f = a.isSelected,
      g = a.isHighlighted,
      h = !0,
      k = !0,
      l = !1;
    a instanceof V &&
      ((h = a.isTreeLeaf), (k = a.isTreeExpanded), (l = a.wasTreeExpanded));
    b.Ef(a);
    b.cloneProtected(a);
    a.Vf = d;
    a.v();
    a.R();
    b = a.diagram;
    d = !0;
    null !== b && ((d = b.skipsUndoManager), (b.skipsUndoManager = !0));
    a.qb = e;
    a.H = f ? a.H | 4096 : a.H & -4097;
    a.H = g ? a.H | 524288 : a.H & -524289;
    a instanceof V &&
      ((a.U = h ? a.U | 4 : a.U & -5),
      (a.U = k ? a.U | 1 : a.U & -2),
      (a.U = l ? a.U | 2 : a.U & -3));
    null !== e && a.Ka();
    e = a.layerName;
    e !== c && ((a.Zg = c), (a.layerName = e));
    null !== b && (b.skipsUndoManager = d);
    a.Tc() && a.F(64);
  }
  U.prototype.canCopy = function () {
    if (!this.copyable) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowCopy) return !1;
    a = a.diagram;
    return null === a ? !0 : a.allowCopy ? !0 : !1;
  };
  U.prototype.canDelete = function () {
    if (!this.deletable) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowDelete) return !1;
    a = a.diagram;
    return null === a ? !0 : a.allowDelete ? !0 : !1;
  };
  U.prototype.canEdit = function () {
    if (!this.textEditable) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowTextEdit) return !1;
    a = a.diagram;
    return null === a ? !0 : a.allowTextEdit ? !0 : !1;
  };
  U.prototype.canGroup = function () {
    if (!this.groupable) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowGroup) return !1;
    a = a.diagram;
    return null === a ? !0 : a.allowGroup ? !0 : !1;
  };
  U.prototype.canMove = function () {
    if (!this.movable) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowMove) return !1;
    a = a.diagram;
    return null === a ? !0 : a.allowMove ? !0 : !1;
  };
  U.prototype.canReshape = function () {
    if (!this.reshapable) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowReshape) return !1;
    a = a.diagram;
    return null === a ? !0 : a.allowReshape ? !0 : !1;
  };
  U.prototype.canResize = function () {
    if (!this.resizable) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowResize) return !1;
    a = a.diagram;
    return null === a ? !0 : a.allowResize ? !0 : !1;
  };
  U.prototype.canRotate = function () {
    if (!this.rotatable) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowRotate) return !1;
    a = a.diagram;
    return null === a ? !0 : a.allowRotate ? !0 : !1;
  };
  U.prototype.canSelect = function () {
    if (!this.selectable) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowSelect) return !1;
    a = a.diagram;
    return null === a ? !0 : a.allowSelect ? !0 : !1;
  };
  function Cj(a) {
    return 0 !== (a.H & 32768);
  }
  function No(a, b) {
    a.H = b ? a.H | 32768 : a.H & -32769;
  }
  function yl(a, b) {
    a.H = b ? a.H | 65536 : a.H & -65537;
  }
  function qg(a) {
    return 0 !== (a.H & 131072);
  }
  t = U.prototype;
  t.Sd = function (a) {
    this.H = a ? this.H | 131072 : this.H & -131073;
  };
  function Wo(a, b) {
    a.H = b ? a.H | 1048576 : a.H & -1048577;
  }
  t.Lh = function () {
    var a = this.containingGroup;
    null !== a && (a.v(), null !== a.placeholder && a.placeholder.v(), a.zd());
  };
  t.R = function () {
    var a = this.diagram;
    null !== a &&
      !Bj(this) &&
      !Cj(this) &&
      this.isVisible() &&
      this.Db.s() &&
      a.R(Lj(this, this.Db));
  };
  t.v = function () {
    W.prototype.v.call(this);
    var a = this.diagram;
    null !== a &&
      (a.ze.add(this),
      this instanceof V && null !== this.labeledLink && Nl(this.labeledLink),
      a.Ob(!0));
  };
  t.mq = function (a) {
    a || ((a = this.Zh), null !== a && Xo(a, this));
  };
  t.nq = function (a) {
    a || ((a = this.Zh), null !== a && Yo(a, this));
  };
  t.mk = function () {
    var a = this.data;
    if (null !== a) {
      var b = this.diagram;
      null !== b && ((b = b.model), null !== b && b.zm(a));
    }
  };
  t.Zz = function () {
    return Zo(this, this);
  };
  function Zo(a, b) {
    var c = b.containingGroup;
    return null !== c
      ? 1 + Zo(a, c)
      : b instanceof V && ((b = b.labeledLink), null !== b)
      ? Zo(a, b)
      : 0;
  }
  t.cA = function () {
    return $o(this, this);
  };
  function $o(a, b) {
    var c = b.containingGroup;
    return null !== c || (b instanceof V && ((c = b.labeledLink), null !== c))
      ? $o(a, c)
      : b;
  }
  t.Pd = function (a) {
    return a instanceof vf ? ap(this, this, a) : !1;
  };
  function ap(a, b, c) {
    if (b === c || null === c) return !1;
    var d = b.containingGroup;
    return null === d || (d !== c && !ap(a, d, c))
      ? b instanceof V && ((b = b.labeledLink), null !== b)
        ? ap(a, b, c)
        : !1
      : !0;
  }
  t.Sx = function (a) {
    if (null === a) return null;
    G && x(a, U, U, "findCommonContainingGroup:other");
    if (this === a) return this.containingGroup;
    for (var b = this; null !== b; ) {
      b instanceof vf && Wo(b, !0);
      if (b instanceof V) {
        var c = b.labeledLink;
        null !== c && (b = c);
      }
      b = b.containingGroup;
    }
    c = null;
    for (b = a; null !== b; ) {
      if (0 !== (b.H & 1048576)) {
        c = b;
        break;
      }
      b instanceof V && ((a = b.labeledLink), null !== a && (b = a));
      b = b.containingGroup;
    }
    for (b = this; null !== b; )
      b instanceof vf && Wo(b, !1),
        b instanceof V && ((a = b.labeledLink), null !== a && (b = a)),
        (b = b.containingGroup);
    return c;
  };
  U.prototype.canLayout = function () {
    if (!this.isLayoutPositioned || !this.isVisible()) return !1;
    var a = this.layer;
    return (null !== a && a.isTemporary) ||
      (this instanceof V && this.isLinkLabel)
      ? !1
      : !0;
  };
  U.prototype.F = function (a) {
    void 0 === a && (a = 16777215);
    if (this.isLayoutPositioned && 0 !== (a & this.layoutConditions)) {
      var b = this.layer;
      (null !== b && b.isTemporary) || (this instanceof V && this.isLinkLabel)
        ? (b = !1)
        : ((b = this.diagram),
          (b = null !== b && b.undoManager.isUndoingRedoing ? !1 : !0));
    } else b = !1;
    if (b)
      if (((b = this.Zh), null !== b)) {
        var c = b.layout;
        null !== c ? c.F() : b.F(a);
      } else
        (a = this.diagram), null !== a && ((a = a.layout), null !== a && a.F());
  };
  function Rj(a) {
    if (!a.isVisible()) return !1;
    a = a.layer;
    return null !== a && a.isTemporary ? !1 : !0;
  }
  function el(a, b, c, d, e, f) {
    void 0 === f && (f = null);
    if (!(a.contains(b) || (null !== f && !f(b)) || b instanceof Je))
      if ((a.add(b), b instanceof V)) {
        if (c && b instanceof vf)
          for (var g = b.memberParts; g.next(); ) el(a, g.value, c, d, e, f);
        if (!1 !== e)
          for (g = b.linksConnected; g.next(); ) {
            var h = g.value;
            if (!a.contains(h)) {
              var k = h.fromNode,
                l = h.toNode;
              k = null === k || a.contains(k);
              l = null === l || a.contains(l);
              (e ? k && l : k || l) && el(a, h, c, d, e, f);
            }
          }
        if (1 < d) for (b = b.uv(); b.next(); ) el(a, b.value, c, d - 1, e, f);
      } else if (b instanceof R)
        for (b = b.labelNodes; b.next(); ) el(a, b.value, c, d, e, f);
  }
  oa.Object.defineProperties(U.prototype, {
    key: {
      configurable: !0,
      get: function () {
        var a = this.diagram;
        if (null !== a) return a.model.wa(this.data);
      },
    },
    adornments: {
      configurable: !0,
      get: function () {
        return null === this.Tf ? hb : this.Tf.iteratorValues;
      },
    },
    layer: {
      configurable: !0,
      get: function () {
        return this.mi;
      },
    },
    diagram: {
      configurable: !0,
      get: function () {
        var a = this.mi;
        return null === a || void 0 === a ? null : a.diagram;
      },
    },
    layerName: {
      configurable: !0,
      get: function () {
        return this.Zg;
      },
      set: function (a) {
        var b = this.Zg;
        if (b !== a) {
          A(a, "string", U, "layerName");
          var c = this.diagram;
          if (
            null === c ||
            (null !== c.qk(a) && !c.partManager.addsToTemporaryLayer)
          )
            if (
              ((this.Zg = a),
              null !== c && c.Wa(),
              this.g("layerName", b, a),
              (b = this.layer),
              null !== b &&
                b.name !== a &&
                ((c = b.diagram),
                null !== c && ((a = c.qk(a)), null !== a && a !== b)))
            ) {
              var d = b.kc(-1, this, !0);
              0 <= d && c.cb(se, "parts", b, this, null, d, !0);
              d = a.Wi(99999999, this, !0);
              b.visible !== a.visible && this.Vb(a.visible);
              0 <= d && c.cb(re, "parts", a, null, this, !0, d);
              d = this.layerChanged;
              if (null !== d) {
                var e = c.ba;
                c.ba = !0;
                d(this, b, a);
                c.ba = e;
              }
            }
        }
      },
    },
    layerChanged: {
      configurable: !0,
      get: function () {
        return this.qo;
      },
      set: function (a) {
        var b = this.qo;
        b !== a &&
          (null !== a && A(a, "function", U, "layerChanged"),
          (this.qo = a),
          this.g("layerChanged", b, a));
      },
    },
    zOrder: {
      configurable: !0,
      get: function () {
        return this.Tp;
      },
      set: function (a) {
        var b = this.Tp;
        if (b !== a) {
          A(a, "number", U, "zOrder");
          this.Tp = a;
          var c = this.layer;
          null !== c && qi(c, -1, this);
          this.g("zOrder", b, a);
          a = this.diagram;
          null !== a && a.R();
        }
      },
    },
    locationObject: {
      configurable: !0,
      get: function () {
        if (null === this.lf) {
          var a = this.locationObjectName;
          "" !== a
            ? ((a = this.hb(a)), null !== a ? (this.lf = a) : (this.lf = this))
            : this instanceof Je
            ? this.type !== W.Link && null !== this.placeholder
              ? (this.lf = this.placeholder)
              : (this.lf = this)
            : (this.lf = this);
        }
        return this.lf.visible ? this.lf : this;
      },
    },
    minLocation: {
      configurable: !0,
      get: function () {
        return this.Fo;
      },
      set: function (a) {
        var b = this.Fo;
        b.D(a) ||
          (G && x(a, K, U, "minLocation"),
          (this.Fo = a = a.L()),
          this.g("minLocation", b, a));
      },
    },
    maxLocation: {
      configurable: !0,
      get: function () {
        return this.yo;
      },
      set: function (a) {
        var b = this.yo;
        b.D(a) ||
          (G && x(a, K, U, "maxLocation"),
          (this.yo = a = a.L()),
          this.g("maxLocation", b, a));
      },
    },
    locationObjectName: {
      configurable: !0,
      get: function () {
        return this.wo;
      },
      set: function (a) {
        var b = this.wo;
        b !== a &&
          (G && A(a, "string", U, "locationObjectName"),
          (this.wo = a),
          (this.lf = null),
          this.v(),
          this.g("locationObjectName", b, a));
      },
    },
    locationSpot: {
      configurable: !0,
      get: function () {
        return this.xo;
      },
      set: function (a) {
        var b = this.xo;
        b.D(a) ||
          (G &&
            (x(a, Ib, U, "locationSpot"),
            a.ib() ||
              v("Part.locationSpot must be a specific Spot value, not: " + a)),
          (this.xo = a = a.L()),
          this.v(),
          this.g("locationSpot", b, a));
      },
    },
    location: {
      configurable: !0,
      get: function () {
        return this.fe;
      },
      set: function (a) {
        G && x(a, K, U, "location");
        var b = a.x,
          c = a.y,
          d = this.fe;
        if (
          !(d.x === b || (isNaN(d.x) && isNaN(b))) ||
          !(d.y === c || (isNaN(d.y) && isNaN(c)))
        ) {
          a = a.copy();
          b = a;
          if (this.Mh()) b = !1;
          else {
            this.fe = b;
            this.H |= 2097152;
            if (!1 === Bj(this) && (Mo(this), (c = this.ra), c.s())) {
              var e = this.diagram;
              if (
                null === e ||
                e.animationManager.isTicking ||
                !e.undoManager.isUndoingRedoing
              ) {
                var f = c.copy();
                c.h(c.x + (b.x - d.x), c.y + (b.y - d.y));
                Ro(this, e, c, f.x, f.y);
                this.g("position", f, c.copy());
              }
            }
            b = !0;
          }
          b && this.g("location", d, a.copy());
        }
      },
    },
    category: {
      configurable: !0,
      get: function () {
        return this.Vf;
      },
      set: function (a) {
        var b = this.Vf;
        if (b !== a) {
          A(a, "string", U, "category");
          var c = this.diagram,
            d = this.data,
            e = null;
          if (null !== c && null !== d && !(this instanceof Je)) {
            var f = c.model.undoManager;
            f.isEnabled &&
              !f.isUndoingRedoing &&
              ((e = this.clone()), e.W.addAll(this.W));
          }
          this.Vf = a;
          this.g("category", b, a);
          null === c || null === d || this instanceof Je
            ? this instanceof Je &&
              ((e = this.adornedPart),
              null !== e &&
                ((a = e.Tf),
                null !== a && a.remove(b),
                e.Ch(this.category, this)))
            : ((f = c.model),
              f.undoManager.isUndoingRedoing ||
                (this.Mh()
                  ? (c.partManager.setLinkCategoryForData(d, a),
                    (c = c.partManager.findLinkTemplateForCategory(a)),
                    null !== c &&
                      (sg(c), (c = c.copy()), null !== c && Uo(this, c, b, a)))
                  : (null !== f && f.Gm(d, a),
                    (c = bp(c.partManager, d, a)),
                    null !== c &&
                      (sg(c),
                      (c = c.copy()),
                      null === c ||
                        c instanceof R ||
                        ((d = this.location.copy()),
                        Uo(this, c, b, a),
                        this.location.s() || (this.location = d)))),
                null !== e &&
                  ((b = this.clone()),
                  b.W.addAll(this.W),
                  this.g("self", e, b))));
        }
      },
    },
    self: {
      configurable: !0,
      get: function () {
        return this;
      },
      set: function (a) {
        Uo(this, a, this.category, a.category);
      },
    },
    copyable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 1);
      },
      set: function (a) {
        var b = 0 !== (this.H & 1);
        b !== a &&
          (G && A(a, "boolean", U, "copyable"),
          (this.H ^= 1),
          this.g("copyable", b, a));
      },
    },
    deletable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 2);
      },
      set: function (a) {
        var b = 0 !== (this.H & 2);
        b !== a &&
          (G && A(a, "boolean", U, "deletable"),
          (this.H ^= 2),
          this.g("deletable", b, a));
      },
    },
    textEditable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 4);
      },
      set: function (a) {
        var b = 0 !== (this.H & 4);
        b !== a &&
          (G && A(a, "boolean", U, "textEditable"),
          (this.H ^= 4),
          this.g("textEditable", b, a),
          this.Tb());
      },
    },
    groupable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 8);
      },
      set: function (a) {
        var b = 0 !== (this.H & 8);
        b !== a &&
          (G && A(a, "boolean", U, "groupable"),
          (this.H ^= 8),
          this.g("groupable", b, a));
      },
    },
    movable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 16);
      },
      set: function (a) {
        var b = 0 !== (this.H & 16);
        b !== a &&
          (G && A(a, "boolean", U, "movable"),
          (this.H ^= 16),
          this.g("movable", b, a));
      },
    },
    selectionAdorned: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 32);
      },
      set: function (a) {
        var b = 0 !== (this.H & 32);
        b !== a &&
          (G && A(a, "boolean", U, "selectionAdorned"),
          (this.H ^= 32),
          this.g("selectionAdorned", b, a),
          this.Tb());
      },
    },
    isInDocumentBounds: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 64);
      },
      set: function (a) {
        var b = 0 !== (this.H & 64);
        if (b !== a) {
          G && A(a, "boolean", U, "isInDocumentBounds");
          this.H ^= 64;
          var c = this.diagram;
          null !== c && c.Wa();
          this.g("isInDocumentBounds", b, a);
        }
      },
    },
    isLayoutPositioned: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 128);
      },
      set: function (a) {
        var b = 0 !== (this.H & 128);
        b !== a &&
          (G && A(a, "boolean", U, "isLayoutPositioned"),
          (this.H ^= 128),
          this.g("isLayoutPositioned", b, a),
          this.F(a ? 4 : 8));
      },
    },
    selectable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 256);
      },
      set: function (a) {
        var b = 0 !== (this.H & 256);
        b !== a &&
          (G && A(a, "boolean", U, "selectable"),
          (this.H ^= 256),
          this.g("selectable", b, a),
          this.Tb());
      },
    },
    reshapable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 512);
      },
      set: function (a) {
        var b = 0 !== (this.H & 512);
        b !== a &&
          (G && A(a, "boolean", U, "reshapable"),
          (this.H ^= 512),
          this.g("reshapable", b, a),
          this.Tb());
      },
    },
    resizable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 1024);
      },
      set: function (a) {
        var b = 0 !== (this.H & 1024);
        b !== a &&
          (G && A(a, "boolean", U, "resizable"),
          (this.H ^= 1024),
          this.g("resizable", b, a),
          this.Tb());
      },
    },
    rotatable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 2048);
      },
      set: function (a) {
        var b = 0 !== (this.H & 2048);
        b !== a &&
          (G && A(a, "boolean", U, "rotatable"),
          (this.H ^= 2048),
          this.g("rotatable", b, a),
          this.Tb());
      },
    },
    isSelected: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 4096);
      },
      set: function (a) {
        var b = 0 !== (this.H & 4096);
        if (b !== a) {
          G && A(a, "boolean", U, "isSelected");
          var c = this.diagram;
          if (
            !a ||
            (this.canSelect() &&
              !(null !== c && c.selection.count >= c.maxSelectionCount))
          ) {
            this.H ^= 4096;
            var d = !1;
            if (null !== c) {
              d = c.skipsUndoManager;
              c.skipsUndoManager = !0;
              var e = c.selection;
              e.la();
              a ? e.add(this) : e.remove(this);
              e.freeze();
            }
            this.g("isSelected", b, a);
            this.Tb();
            a = this.selectionChanged;
            null !== a && a(this);
            null !== c && (c.Ob(), (c.skipsUndoManager = d));
          }
        }
      },
    },
    isHighlighted: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 524288);
      },
      set: function (a) {
        var b = 0 !== (this.H & 524288);
        if (b !== a) {
          G && A(a, "boolean", U, "isHighlighted");
          this.H ^= 524288;
          var c = this.diagram;
          null !== c &&
            ((c = c.highlighteds),
            c.la(),
            a ? c.add(this) : c.remove(this),
            c.freeze());
          this.g("isHighlighted", b, a);
          this.R();
          a = this.highlightedChanged;
          null !== a && a(this);
        }
      },
    },
    isShadowed: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 8192);
      },
      set: function (a) {
        var b = 0 !== (this.H & 8192);
        b !== a &&
          (G && A(a, "boolean", U, "isShadowed"),
          (this.H ^= 8192),
          this.g("isShadowed", b, a),
          this.R());
      },
    },
    isAnimated: {
      configurable: !0,
      get: function () {
        return 0 !== (this.H & 262144);
      },
      set: function (a) {
        var b = 0 !== (this.H & 262144);
        b !== a &&
          (G && A(a, "boolean", U, "isAnimated"),
          (this.H ^= 262144),
          this.g("isAnimated", b, a));
      },
    },
    highlightedChanged: {
      configurable: !0,
      get: function () {
        return this.$n;
      },
      set: function (a) {
        var b = this.$n;
        b !== a &&
          (null !== a && A(a, "function", U, "highlightedChanged"),
          (this.$n = a),
          this.g("highlightedChanged", b, a));
      },
    },
    selectionObjectName: {
      configurable: !0,
      get: function () {
        return this.sp;
      },
      set: function (a) {
        var b = this.sp;
        b !== a &&
          (G && A(a, "string", U, "selectionObjectName"),
          (this.sp = a),
          (this.ph = null),
          this.g("selectionObjectName", b, a));
      },
    },
    selectionAdornmentTemplate: {
      configurable: !0,
      get: function () {
        return this.qp;
      },
      set: function (a) {
        var b = this.qp;
        b !== a &&
          (G && x(a, Je, U, "selectionAdornmentTemplate"),
          (this.qp = a),
          this.g("selectionAdornmentTemplate", b, a));
      },
    },
    selectionObject: {
      configurable: !0,
      get: function () {
        if (null === this.ph) {
          var a = this.selectionObjectName;
          null !== a && "" !== a
            ? ((a = this.hb(a)), null !== a ? (this.ph = a) : (this.ph = this))
            : this instanceof R
            ? ((a = this.path), null !== a ? (this.ph = a) : (this.ph = this))
            : (this.ph = this);
        }
        return this.ph;
      },
    },
    selectionChanged: {
      configurable: !0,
      get: function () {
        return this.rp;
      },
      set: function (a) {
        var b = this.rp;
        b !== a &&
          (null !== a && A(a, "function", U, "selectionChanged"),
          (this.rp = a),
          this.g("selectionChanged", b, a));
      },
    },
    resizeAdornmentTemplate: {
      configurable: !0,
      get: function () {
        return this.ep;
      },
      set: function (a) {
        var b = this.ep;
        b !== a &&
          (G && x(a, Je, U, "resizeAdornmentTemplate"),
          (this.ep = a),
          this.g("resizeAdornmentTemplate", b, a));
      },
    },
    resizeObjectName: {
      configurable: !0,
      get: function () {
        return this.gp;
      },
      set: function (a) {
        var b = this.gp;
        b !== a &&
          (G && A(a, "string", U, "resizeObjectName"),
          (this.gp = a),
          this.g("resizeObjectName", b, a));
      },
    },
    resizeObject: {
      configurable: !0,
      get: function () {
        var a = this.resizeObjectName;
        return "" !== a && ((a = this.hb(a)), null !== a) ? a : this;
      },
    },
    resizeCellSize: {
      configurable: !0,
      get: function () {
        return this.fp;
      },
      set: function (a) {
        var b = this.fp;
        b.D(a) ||
          (G && x(a, Gb, U, "resizeCellSize"),
          (this.fp = a = a.L()),
          this.g("resizeCellSize", b, a));
      },
    },
    rotateAdornmentTemplate: {
      configurable: !0,
      get: function () {
        return this.ip;
      },
      set: function (a) {
        var b = this.ip;
        b !== a &&
          (G && x(a, Je, U, "rotateAdornmentTemplate"),
          (this.ip = a),
          this.g("rotateAdornmentTemplate", b, a));
      },
    },
    rotateObjectName: {
      configurable: !0,
      get: function () {
        return this.jp;
      },
      set: function (a) {
        var b = this.jp;
        b !== a &&
          (G && A(a, "string", U, "rotateObjectName"),
          (this.jp = a),
          this.g("rotateObjectName", b, a));
      },
    },
    rotateObject: {
      configurable: !0,
      get: function () {
        var a = this.rotateObjectName;
        return "" !== a && ((a = this.hb(a)), null !== a) ? a : this;
      },
    },
    rotationSpot: {
      configurable: !0,
      get: function () {
        return this.kp;
      },
      set: function (a) {
        var b = this.kp;
        b.D(a) ||
          (G &&
            (x(a, Ib, U, "rotationSpot"),
            a === gd ||
              a.ib() ||
              v(
                "Part.rotationSpot must be a specific Spot value or Spot.Default, not: " +
                  a
              )),
          (this.kp = a = a.L()),
          this.g("rotationSpot", b, a));
      },
    },
    text: {
      configurable: !0,
      get: function () {
        return this.bc;
      },
      set: function (a) {
        var b = this.bc;
        b !== a &&
          (G && A(a, "string", U, "text"), (this.bc = a), this.g("text", b, a));
      },
    },
    containingGroup: {
      configurable: !0,
      get: function () {
        return this.Zh;
      },
      set: function (a) {
        if (this.Tc()) {
          var b = this.Zh;
          if (b !== a) {
            G && null !== a && x(a, vf, U, "containingGroup");
            null === a ||
              (this !== a && !a.Pd(this)) ||
              (this === a &&
                v("Cannot make a Group a member of itself: " + this.toString()),
              v(
                "Cannot make a Group indirectly contain itself: " +
                  this.toString() +
                  " already contains " +
                  a.toString()
              ));
            this.F(2);
            var c = this.diagram;
            null !== b
              ? Yo(b, this)
              : this instanceof vf && null !== c && c.Fi.remove(this);
            this.Zh = a;
            null !== a
              ? Xo(a, this)
              : this instanceof vf && null !== c && c.Fi.add(this);
            this.F(1);
            if (null !== c && c.ba) {
              var d = this.data,
                e = c.model;
              if (null !== d && e.Xi()) {
                var f = e.wa(null !== a ? a.data : null);
                e.Eq(d, f);
              }
            }
            d = this.containingGroupChanged;
            null !== d &&
              ((e = !0),
              null !== c && ((e = c.ba), (c.ba = !0)),
              d(this, b, a),
              null !== c && (c.ba = e));
            if (this instanceof vf)
              for (
                c = new I(), el(c, this, !0, 0, !0), c = c.iterator;
                c.next();

              )
                if (((d = c.value), d instanceof V))
                  for (d = d.linksConnected; d.next(); ) cp(d.value);
            if (this instanceof V) {
              for (c = this.linksConnected; c.next(); ) cp(c.value);
              c = this.labeledLink;
              null !== c && cp(c);
            }
            this.g("containingGroup", b, a);
            null !== a && ((b = a.layer), null !== b && qi(b, -1, a));
          }
        } else v("cannot set the Part.containingGroup of a Link or Adornment");
      },
    },
    containingGroupChanged: {
      configurable: !0,
      get: function () {
        return this.mn;
      },
      set: function (a) {
        var b = this.mn;
        b !== a &&
          (null !== a && A(a, "function", U, "containingGroupChanged"),
          (this.mn = a),
          this.g("containingGroupChanged", b, a));
      },
    },
    isTopLevel: {
      configurable: !0,
      get: function () {
        return null !== this.containingGroup ||
          (this instanceof V && null !== this.labeledLink)
          ? !1
          : !0;
      },
    },
    layoutConditions: {
      configurable: !0,
      get: function () {
        return this.ro;
      },
      set: function (a) {
        var b = this.ro;
        b !== a &&
          (G && A(a, "number", U, "layoutConditions"),
          (this.ro = a),
          this.g("layoutConditions", b, a));
      },
    },
    dragComputation: {
      configurable: !0,
      get: function () {
        return this.Cn;
      },
      set: function (a) {
        var b = this.Cn;
        b !== a &&
          (null !== a && A(a, "function", U, "dragComputation"),
          (this.Cn = a),
          this.g("dragComputation", b, a));
      },
    },
    shadowOffset: {
      configurable: !0,
      get: function () {
        return this.yp;
      },
      set: function (a) {
        var b = this.yp;
        b.D(a) ||
          (G && x(a, K, U, "shadowOffset"),
          (this.yp = a = a.L()),
          this.R(),
          this.g("shadowOffset", b, a));
      },
    },
    shadowColor: {
      configurable: !0,
      get: function () {
        return this.xp;
      },
      set: function (a) {
        var b = this.xp;
        b !== a &&
          (G && A(a, "string", U, "shadowColor"),
          (this.xp = a),
          this.R(),
          this.g("shadowColor", b, a));
      },
    },
    shadowBlur: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.mg;
      },
      set: function (a) {
        var b = this.mg;
        b !== a &&
          (G && A(a, "number", U, "shadowBlur"),
          (this.mg = a),
          this.R(),
          this.g("shadowBlur", b, a));
      },
    },
  });
  U.prototype.invalidateLayout = U.prototype.F;
  U.prototype.findCommonContainingGroup = U.prototype.Sx;
  U.prototype.isMemberOf = U.prototype.Pd;
  U.prototype.findTopLevelPart = U.prototype.cA;
  U.prototype.findSubGraphLevel = U.prototype.Zz;
  U.prototype.ensureBounds = U.prototype.Za;
  U.prototype.getDocumentBounds = U.prototype.Ui;
  U.prototype.findObject = U.prototype.hb;
  U.prototype.moveTo = U.prototype.moveTo;
  U.prototype.invalidateAdornments = U.prototype.Tb;
  U.prototype.clearAdornments = U.prototype.gk;
  U.prototype.removeAdornment = U.prototype.Of;
  U.prototype.addAdornment = U.prototype.Ch;
  U.prototype.findAdornment = U.prototype.pk;
  U.prototype.updateTargetBindings = U.prototype.Ka;
  var Vo = !1;
  U.className = "Part";
  U.LayoutNone = 0;
  U.LayoutAdded = 1;
  U.LayoutRemoved = 2;
  U.LayoutShown = 4;
  U.LayoutHidden = 8;
  U.LayoutNodeSized = 16;
  U.LayoutGroupLayout = 32;
  U.LayoutNodeReplaced = 64;
  U.LayoutStandard = 127;
  U.LayoutAll = 16777215;
  function Je(a, b) {
    void 0 === a || a instanceof Yl || "string" === typeof a
      ? U.call(this, a)
      : (U.call(this), a && (b = a));
    this.H &= -257;
    this.Zg = "Adornment";
    this.qe = null;
    this.ax = 0;
    this.xx = !1;
    this.j = this.Ta = null;
    b && Object.assign(this, b);
  }
  na(Je, U);
  Je.prototype.toString = function () {
    var a = this.adornedPart;
    return (
      "Adornment(" + this.category + ")" + (null !== a ? a.toString() : "")
    );
  };
  Je.prototype.updateRelationshipsFromData = function () {};
  Je.prototype.yk = function (a) {
    var b = this.adornedObject,
      c = null === b || void 0 === b ? void 0 : b.part;
    if (c instanceof R && b instanceof Hf) {
      b = c.path;
      c.yk(a);
      a = b.geometry;
      c = this.W.m;
      b = c.length;
      for (var d = 0; d < b; d++) {
        var e = c[d];
        e.isPanelMain && e instanceof Hf && (e.ta = a);
      }
    }
  };
  Je.prototype.aj = function () {
    var a = this.qe;
    if (null === a) return !0;
    a = a.part;
    return null === a || !Bj(a);
  };
  Je.prototype.Tc = function () {
    return !1;
  };
  Je.prototype.Hk = function (a, b, c, d, e, f, g) {
    if (a === re && "elements" === b)
      if (e instanceof rg)
        null === this.Ta
          ? (this.Ta = e)
          : G &&
            this.Ta !== e &&
            v(
              "Cannot insert a second Placeholder into the visual tree of an Adornment."
            );
      else {
        if (e instanceof W) {
          var h = e.km(function (a) {
            return a instanceof rg;
          });
          h instanceof rg &&
            (null === this.Ta
              ? (this.Ta = h)
              : G &&
                this.Ta !== h &&
                v(
                  "Cannot insert a second Placeholder into the visual tree of an Adornment."
                ));
        }
      }
    else
      a === se &&
        "elements" === b &&
        null !== this.Ta &&
        (d === this.Ta
          ? (this.Ta = null)
          : d instanceof W && this.Ta.xg(d) && (this.Ta = null));
    U.prototype.Hk.call(this, a, b, c, d, e, f, g);
  };
  Je.prototype.updateAdornments = function () {};
  Je.prototype.mk = function () {};
  oa.Object.defineProperties(Je.prototype, {
    placeholder: {
      configurable: !0,
      get: function () {
        return this.Ta;
      },
    },
    adornedObject: {
      configurable: !0,
      get: function () {
        return this.qe;
      },
      set: function (a) {
        G && null !== a && x(a, O, U, "adornedObject:value");
        var b = this.adornedPart,
          c = null;
        null !== a && (c = a.part);
        null === b || (null !== a && b === c) || b.Of(this.category);
        this.qe = a;
        null !== c && c.Ch(this.category, this);
      },
    },
    adornedPart: {
      configurable: !0,
      get: function () {
        var a = this.qe;
        return null !== a ? a.part : null;
      },
    },
    containingGroup: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return null;
      },
    },
  });
  Je.className = "Adornment";
  function V(a, b) {
    void 0 === a || a instanceof Yl || "string" === typeof a
      ? U.call(this, a)
      : (U.call(this), a && (b = a));
    this.U = 13;
    this.lb = new H();
    this.Mp = this.yl = this.ri = this.to = this.so = null;
    this.Sk = Dc;
    this.tc = this.af = null;
    this.ap = dp;
    this.Ah = !1;
    b && Object.assign(this, b);
  }
  na(V, U);
  V.prototype.cloneProtected = function (a) {
    U.prototype.cloneProtected.call(this, a);
    a.U = this.U;
    a.U = this.U & -17;
    a.so = this.so;
    a.to = this.to;
    a.ri = this.ri;
    a.Mp = this.Mp;
    a.Sk = this.Sk.L();
    a.ap = this.ap;
  };
  t = V.prototype;
  t.Ef = function (a) {
    U.prototype.Ef.call(this, a);
    a.zd();
    a.af = this.af;
    a.tc = null;
  };
  function ep(a, b) {
    null !== b && (null === a.af && (a.af = new I()), a.af.add(b));
  }
  function fp(a, b, c, d) {
    if (null === b || null === a.af) return null;
    for (var e = a.af.iterator; e.next(); ) {
      var f = e.value;
      if (
        (f.Ws === a && f.Iv === b && f.wy === c && f.xy === d) ||
        (f.Ws === b && f.Iv === a && f.wy === d && f.xy === c)
      )
        return f;
    }
    return null;
  }
  t.vA = function (a, b, c) {
    if (void 0 === b || null === b) b = "";
    if (void 0 === c || null === c) c = "";
    a = fp(this, a, b, c);
    null !== a && a.pm();
  };
  t.Hk = function (a, b, c, d, e, f, g) {
    a === re && "elements" === b
      ? (this.tc = null)
      : a === se && "elements" === b && (this.tc = null);
    U.prototype.Hk.call(this, a, b, c, d, e, f, g);
  };
  t.zd = function (a) {
    for (var b = this.linksConnected; b.next(); ) {
      var c = b.value;
      (void 0 !== a && a.contains(c)) || (gp(c.fromPort), gp(c.toPort), c.ab());
    }
  };
  function zl(a, b) {
    for (a = a.linksConnected; a.next(); ) {
      var c = a.value;
      if (c.fromPort === b || c.toPort === b)
        gp(c.fromPort), gp(c.toPort), c.ab();
    }
  }
  function gp(a) {
    if (null !== a) {
      var b = a.$o;
      null !== b && b.pm();
      a = a.part;
      b = a.containingGroup;
      null === b || a.isVisible() || gp(b.port);
    }
  }
  t.aj = function () {
    return !0;
  };
  V.prototype.getAvoidableRect = function (a) {
    a.set(this.actualBounds);
    a.Up(this.Sk);
    return a;
  };
  V.prototype.findVisibleNode = function () {
    for (var a = this; null !== a && !a.isVisible(); ) a = a.containingGroup;
    return a;
  };
  V.prototype.isVisible = function () {
    if (!U.prototype.isVisible.call(this)) return !1;
    var a = !0,
      b = Ei,
      c = this.diagram;
    if (null !== c) {
      if (c.animationManager.Ys(this)) return !0;
      a = c.isTreePathToChildren;
      b = c.treeCollapsePolicy;
    }
    if (b === Ei) {
      if (((a = this.wg()), null !== a && !a.isTreeExpanded)) return !1;
    } else if (b === Qk) {
      if (
        ((a = a ? this.rv() : this.sv()),
        0 < a.count &&
          a.all(function (a) {
            return !a.isTreeExpanded;
          }))
      )
        return !1;
    } else if (
      b === Rk &&
      ((a = a ? this.rv() : this.sv()),
      0 < a.count &&
        a.any(function (a) {
          return !a.isTreeExpanded;
        }))
    )
      return !1;
    a = this.labeledLink;
    return null !== a ? a.isVisible() : !0;
  };
  V.prototype.Vb = function (a) {
    U.prototype.Vb.call(this, a);
    for (var b = this.linksConnected; b.next(); ) {
      var c = b.value;
      if (a && null !== this.containingGroup) {
        var d = c.kq(this);
        null === d || d.Pd(this.containingGroup) || c.ab();
      }
      c.Vb(a);
    }
  };
  V.prototype.Tx = function () {
    var a = new I(),
      b = new I();
    hp(this, this, a, b);
    return b.iterator;
  };
  function hp(a, b, c, d) {
    if (null !== b && !c.has(b)) {
      c.add(b);
      var e = !0,
        f = a.diagram;
      null !== f && (e = f.isTreePathToChildren);
      b.linksConnected.each(function (f) {
        f.isTreeLink
          ? (e ? f.fromNode === b : f.toNode === b) &&
            hp(a, e ? f.toNode : f.fromNode, c, d)
          : d.add(f);
      });
    }
  }
  V.prototype.findLinksConnected = function (a) {
    void 0 === a && (a = null);
    if (null === a) return this.lb.iterator;
    G && A(a, "string", V, "findLinksConnected:pid");
    var b = new jb(this.lb),
      c = this;
    b.predicate = function (b) {
      return (
        (b.fromNode === c && b.fromPortId === a) ||
        (b.toNode === c && b.toPortId === a)
      );
    };
    return b;
  };
  t = V.prototype;
  t.fq = function (a) {
    void 0 === a && (a = null);
    G && null !== a && A(a, "string", V, "findLinksOutOf:pid");
    var b = new jb(this.lb),
      c = this;
    b.predicate = function (b) {
      return b.fromNode !== c ? !1 : null === a ? !0 : b.fromPortId === a;
    };
    return b;
  };
  t.Nd = function (a) {
    void 0 === a && (a = null);
    G && null !== a && A(a, "string", V, "findLinksInto:pid");
    var b = new jb(this.lb),
      c = this;
    b.predicate = function (b) {
      return b.toNode !== c ? !1 : null === a ? !0 : b.toPortId === a;
    };
    return b;
  };
  t.qv = function (a) {
    void 0 === a && (a = null);
    G && null !== a && A(a, "string", V, "findNodesConnected:pid");
    for (var b = null, c = null, d = this.lb.iterator; d.next(); ) {
      var e = d.value;
      if (e.fromNode === this) {
        if (null === a || e.fromPortId === a)
          (e = e.toNode),
            null !== b
              ? b.add(e)
              : null !== c && c !== e
              ? ((b = new I()), b.add(c), b.add(e))
              : (c = e);
      } else
        e.toNode !== this ||
          (null !== a && e.toPortId !== a) ||
          ((e = e.fromNode),
          null !== b
            ? b.add(e)
            : null !== c && c !== e
            ? ((b = new I()), b.add(c), b.add(e))
            : (c = e));
    }
    return null !== b ? b.iterator : null !== c ? new ib(c) : hb;
  };
  t.sv = function (a) {
    void 0 === a && (a = null);
    G && null !== a && A(a, "string", V, "findNodesOutOf:pid");
    for (var b = null, c = null, d = this.lb.iterator; d.next(); ) {
      var e = d.value;
      e.fromNode !== this ||
        (null !== a && e.fromPortId !== a) ||
        ((e = e.toNode),
        null !== b
          ? b.add(e)
          : null !== c && c !== e
          ? ((b = new I()), b.add(c), b.add(e))
          : (c = e));
    }
    return null !== b ? b.iterator : null !== c ? new ib(c) : hb;
  };
  t.rv = function (a) {
    void 0 === a && (a = null);
    G && null !== a && A(a, "string", V, "findNodesInto:pid");
    for (var b = null, c = null, d = this.lb.iterator; d.next(); ) {
      var e = d.value;
      e.toNode !== this ||
        (null !== a && e.toPortId !== a) ||
        ((e = e.fromNode),
        null !== b
          ? b.add(e)
          : null !== c && c !== e
          ? ((b = new I()), b.add(c), b.add(e))
          : (c = e));
    }
    return null !== b ? b.iterator : null !== c ? new ib(c) : hb;
  };
  t.Uz = function (a, b, c) {
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    G &&
      (x(a, V, V, "findLinksBetween:othernode"),
      null !== b && A(b, "string", V, "findLinksBetween:pid"),
      null !== c && A(c, "string", V, "findLinksBetween:otherpid"));
    var d = new jb(this.lb),
      e = this;
    d.predicate = function (d) {
      return (d.fromNode !== e ||
        d.toNode !== a ||
        (null !== b && d.fromPortId !== b) ||
        (null !== c && d.toPortId !== c)) &&
        (d.fromNode !== a ||
          d.toNode !== e ||
          (null !== c && d.fromPortId !== c) ||
          (null !== b && d.toPortId !== b))
        ? !1
        : !0;
    };
    return d;
  };
  t.Vz = function (a, b, c) {
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    G &&
      (x(a, V, V, "findLinksTo:othernode"),
      null !== b && A(b, "string", V, "findLinksTo:pid"),
      null !== c && A(c, "string", V, "findLinksTo:otherpid"));
    var d = new jb(this.lb),
      e = this;
    d.predicate = function (d) {
      return d.fromNode !== e ||
        d.toNode !== a ||
        (null !== b && d.fromPortId !== b) ||
        (null !== c && d.toPortId !== c)
        ? !1
        : !0;
    };
    return d;
  };
  function ip(a, b, c) {
    gp(c);
    var d = a.lb.contains(b);
    d || a.lb.add(b);
    if (!d || b.fromNode === b.toNode) {
      var e = a.linkConnected;
      if (null !== e) {
        var f = !0,
          g = a.diagram;
        null !== g && ((f = g.ba), (g.ba = !0));
        e(a, b, c);
        null !== g && (g.ba = f);
      }
    }
    !d &&
      b.isTreeLink &&
      ((c = b.fromNode),
      (b = b.toNode),
      null !== c &&
        null !== b &&
        c !== b &&
        ((d = !0),
        (a = a.diagram),
        null !== a && (d = a.isTreePathToChildren),
        (e = d ? b : c),
        (f = d ? c : b),
        e.Ah || (e.Ah = f),
        !f.isTreeLeaf ||
          (null !== a && a.undoManager.isUndoingRedoing) ||
          (d
            ? c === f && (f.isTreeLeaf = !1)
            : b === f && (f.isTreeLeaf = !1))));
  }
  function jp(a, b, c) {
    gp(c);
    var d = a.lb.remove(b),
      e = null;
    if (d || b.toNode === b.fromNode) {
      var f = a.linkDisconnected;
      e = a.diagram;
      if (null !== f) {
        var g = !0;
        null !== e && ((g = e.ba), (e.ba = !0));
        f(a, b, c);
        null !== e && (e.ba = g);
      }
    }
    d &&
      b.isTreeLink &&
      ((c = !0),
      null !== e && (c = e.isTreePathToChildren),
      (a = c ? b.toNode : b.fromNode),
      (b = c ? b.fromNode : b.toNode),
      null !== a && (a.Ah = !1),
      null === b ||
        b.isTreeLeaf ||
        (0 === b.lb.count
          ? ((b.Ah = null),
            (null !== e && e.undoManager.isUndoingRedoing) ||
              (b.isTreeLeaf = !0))
          : Pk(b)));
  }
  function Pk(a) {
    a.Ah = !1;
    if (0 !== a.lb.count) {
      var b = !0,
        c = a.diagram;
      if (null === c || !c.undoManager.isUndoingRedoing) {
        null !== c && (b = c.isTreePathToChildren);
        for (c = a.lb.iterator; c.next(); ) {
          var d = c.value;
          if (d.isTreeLink)
            if (b) {
              if (d.fromNode === a) {
                a.isTreeLeaf = !1;
                return;
              }
            } else if (d.toNode === a) {
              a.isTreeLeaf = !1;
              return;
            }
        }
        a.isTreeLeaf = !0;
      }
    }
  }
  V.prototype.updateRelationshipsFromData = function () {
    var a = this.diagram;
    null !== a && a.partManager.updateRelationshipsFromData(this);
  };
  t = V.prototype;
  t.mq = function (a) {
    U.prototype.mq.call(this, a);
    a || (Pk(this), (a = this.yl), null !== a && kp(a, this));
  };
  t.nq = function (a) {
    U.prototype.nq.call(this, a);
    a ||
      ((a = this.yl),
      null !== a && null !== a.vd && (a.vd.remove(this), a.v()));
  };
  t.mk = function () {
    if (0 < this.lb.count) {
      var a = this.diagram;
      if (null !== a)
        for (
          var b =
              null !== a.commandHandler
                ? a.commandHandler.deletesConnectedLinks
                : !0,
            c = this.lb.copy().iterator;
          c.next();

        ) {
          var d = c.value;
          b
            ? a.remove(d)
            : (d.fromNode === this && (d.fromNode = null),
              d.toNode === this && (d.toNode = null));
        }
    }
    this.labeledLink = null;
    U.prototype.mk.call(this);
  };
  t.Es = function (a) {
    G && A(a, "string", V, "findPort:pid");
    if (null === this.tc) {
      if ("" === a && !1 === this.Te) return this;
      lp(this);
    }
    var b = this.tc.K(a);
    return null !== b || ("" !== a && ((b = this.tc.K("")), null !== b))
      ? b
      : this;
  };
  function lp(a) {
    null === a.tc ? (a.tc = new xb()) : a.tc.clear();
    a.Jk(a, function (a, c) {
      dm(a, c);
    });
    0 === a.tc.count && a.tc.add("", a);
  }
  function dm(a, b) {
    var c = b.portId;
    null !== c && null !== a.tc && a.tc.add(c, b);
  }
  function cm(a, b, c) {
    var d = b.portId;
    if (
      null !== d &&
      (null !== a.tc && a.tc.remove(d), (b = a.diagram), null !== b && c)
    ) {
      c = null;
      for (a = a.findLinksConnected(d); a.next(); )
        (d = a.value), null === c && (c = Ma()), c.push(d);
      if (null !== c) {
        for (a = 0; a < c.length; a++) b.remove(c[a]);
        Pa(c);
      }
    }
  }
  t.xA = function (a) {
    if (null === a || a === this) return !1;
    var b = !0,
      c = this.diagram;
    null !== c && (b = c.isTreePathToChildren);
    c = this;
    if (b)
      for (; c !== a; ) {
        b = null;
        for (var d = c.lb.iterator; d.next(); ) {
          var e = d.value;
          if (e.isTreeLink && ((b = e.fromNode), b !== c && b !== this)) break;
        }
        if (b === this || null === b || b === c) return !1;
        c = b;
      }
    else
      for (; c !== a; ) {
        b = null;
        for (
          d = c.lb.iterator;
          d.next() &&
          ((e = d.value),
          !e.isTreeLink || ((b = e.toNode), b === c || b === this));

        );
        if (b === this || null === b || b === c) return !1;
        c = b;
      }
    return !0;
  };
  t.gA = function () {
    var a = !0,
      b = this.diagram;
    null !== b && (a = b.isTreePathToChildren);
    b = this;
    if (a)
      for (;;) {
        a = null;
        for (var c = b.lb.iterator; c.next(); ) {
          var d = c.value;
          if (d.isTreeLink && ((a = d.fromNode), a !== b && a !== this)) break;
        }
        if (a === this) return this;
        if (null === a || a === b) return b;
        b = a;
      }
    else
      for (;;) {
        a = null;
        for (
          c = b.lb.iterator;
          c.next() &&
          ((d = c.value),
          !d.isTreeLink || ((a = d.toNode), a === b || a === this));

        );
        if (a === this) return this;
        if (null === a || a === b) return b;
        b = a;
      }
  };
  t.Rz = function (a) {
    if (null === a) return null;
    G && x(a, V, V, "findCommonTreeParent:other");
    if (this === a) return this;
    for (var b = this; null !== b; ) Wo(b, !0), (b = b.wg());
    var c = null;
    for (b = a; null !== b; ) {
      if (0 !== (b.H & 1048576)) {
        c = b;
        break;
      }
      b = b.wg();
    }
    for (b = this; null !== b; ) Wo(b, !1), (b = b.wg());
    return c;
  };
  t.Ri = function () {
    var a = !0,
      b = this.diagram;
    null !== b && (a = b.isTreePathToChildren);
    b = this.lb.iterator;
    if (a)
      for (; b.next(); ) {
        if (((a = b.value), a.isTreeLink && a.fromNode !== this)) return a;
      }
    else
      for (; b.next(); )
        if (((a = b.value), a.isTreeLink && a.toNode !== this)) return a;
    return null;
  };
  t.wg = function () {
    var a = this.Ah;
    if (null === a) return null;
    if (a instanceof V) return a;
    var b = !0;
    a = this.diagram;
    null !== a && (b = a.isTreePathToChildren);
    a = this.lb.iterator;
    if (b)
      for (; a.next(); ) {
        if (((b = a.value), b.isTreeLink && ((b = b.fromNode), b !== this)))
          return (this.Ah = b);
      }
    else
      for (; a.next(); )
        if (((b = a.value), b.isTreeLink && ((b = b.toNode), b !== this)))
          return (this.Ah = b);
    return (this.Ah = null);
  };
  t.eA = function () {
    function a(b, d) {
      d.add(b);
      var c = b.Ri();
      null !== c && (d.add(c), (b = b.wg()), null !== b && a(b, d));
    }
    var b = new I();
    a(this, b);
    return b;
  };
  t.dA = function () {
    return mp(this, this);
  };
  function mp(a, b) {
    b = b.wg();
    return null === b ? 0 : 1 + mp(a, b);
  }
  t.hq = function () {
    var a = !0,
      b = this.diagram;
    null !== b && (a = b.isTreePathToChildren);
    b = new jb(this.lb);
    var c = this;
    b.predicate = a
      ? function (a) {
          return a.isTreeLink && a.fromNode === c ? !0 : !1;
        }
      : function (a) {
          return a.isTreeLink && a.toNode === c ? !0 : !1;
        };
    return b;
  };
  t.uv = function () {
    var a = !0,
      b = this.diagram;
    null !== b && (a = b.isTreePathToChildren);
    var c = (b = null),
      d = this.lb.iterator;
    if (a)
      for (; d.next(); )
        (a = d.value),
          a.isTreeLink &&
            a.fromNode === this &&
            ((a = a.toNode),
            null !== b
              ? b.add(a)
              : null !== c && c !== a
              ? ((b = new H()), b.add(c), b.add(a))
              : (c = a));
    else
      for (; d.next(); )
        (a = d.value),
          a.isTreeLink &&
            a.toNode === this &&
            ((a = a.fromNode),
            null !== b
              ? b.add(a)
              : null !== c && c !== a
              ? ((b = new H()), b.add(c), b.add(a))
              : (c = a));
    return null !== b ? b.iterator : null !== c ? new ib(c) : hb;
  };
  t.fA = function (a) {
    void 0 === a && (a = Infinity);
    A(a, "number", V, "findTreeParts:level");
    var b = new I();
    el(b, this, !1, a, !0);
    return b;
  };
  V.prototype.collapseTree = function (a) {
    void 0 === a && (a = 1);
    D(a, V, "collapseTree:level");
    1 > a && (a = 1);
    var b = this.diagram;
    if (null !== b && !b.Ue) {
      b.Ue = !0;
      var c = new I();
      c.add(this);
      np(
        this,
        c,
        b.isTreePathToChildren,
        a,
        b,
        this,
        b.treeCollapsePolicy === Ei
      );
      b.Ue = !1;
    }
  };
  function np(a, b, c, d, e, f, g) {
    if (1 < d)
      for (var h = c ? a.fq() : a.Nd(); h.next(); ) {
        var k = h.value;
        k.isTreeLink &&
          ((k = k.kq(a)),
          null === k ||
            k === a ||
            b.contains(k) ||
            (b.add(k), np(k, b, c, d - 1, e, f, g)));
      }
    else op(a, b, c, e, f, g);
  }
  function op(a, b, c, d, e, f) {
    for (
      var g = e === a ? !0 : a.isTreeExpanded, h = c ? a.fq() : a.Nd();
      h.next();

    ) {
      var k = h.value;
      if (k.isTreeLink && ((k = k.kq(a)), null !== k && k !== a)) {
        var l = b.contains(k);
        l || b.add(k);
        g && (f && d.ck(k, e), k.Lh(), k.Vb(!1));
        k.isTreeExpanded &&
          ((k.wasTreeExpanded = k.isTreeExpanded), l || op(k, b, c, d, e, f));
      }
    }
    a.isTreeExpanded = !1;
  }
  V.prototype.expandTree = function (a) {
    void 0 === a && (a = 2);
    D(a, V, "expandTree:level");
    2 > a && (a = 2);
    var b = this.diagram;
    if (null !== b && !b.Ue) {
      b.Ue = !0;
      var c = new I();
      c.add(this);
      pp(
        this,
        c,
        b.isTreePathToChildren,
        a,
        b,
        this,
        b.treeCollapsePolicy === Ei
      );
      b.Ue = !1;
    }
  };
  function pp(a, b, c, d, e, f, g) {
    for (
      var h = f === a ? !1 : a.isTreeExpanded, k = c ? a.fq() : a.Nd();
      k.next();

    ) {
      var l = k.value;
      l.isTreeLink &&
        (h || l.Bd || l.ab(),
        (l = l.kq(a)),
        null !== l &&
          l !== a &&
          !b.contains(l) &&
          (b.add(l),
          h || (l.Vb(!0), l.Lh(), g && e.ek(l, f)),
          2 < d || l.wasTreeExpanded)) &&
        ((l.wasTreeExpanded = !1), pp(l, b, c, d - 1, e, f, g));
    }
    a.isTreeExpanded = !0;
  }
  oa.Object.defineProperties(V.prototype, {
    portSpreading: {
      configurable: !0,
      get: function () {
        return this.ap;
      },
      set: function (a) {
        var b = this.ap;
        b !== a &&
          (G &&
            a !== qp &&
            a !== dp &&
            a !== rp &&
            v(
              "Node.portSpreading can only be set to Node.SpreadingNone, Node.SpreadingEvenly, or Node.SpreadingPacked, not: " +
                a
            ),
          (this.ap = a),
          this.g("portSpreading", b, a),
          (a = this.diagram),
          (null !== a && a.undoManager.isUndoingRedoing) || this.zd());
      },
    },
    avoidable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 8);
      },
      set: function (a) {
        var b = 0 !== (this.U & 8);
        if (b !== a) {
          G && A(a, "boolean", V, "avoidable");
          this.U ^= 8;
          var c = this.diagram;
          null !== c && Ik(c, this);
          this.g("avoidable", b, a);
        }
      },
    },
    avoidableMargin: {
      configurable: !0,
      get: function () {
        return this.Sk;
      },
      set: function (a) {
        "number" === typeof a
          ? (a = new ic(a))
          : x(a, ic, V, "avoidableMargin");
        var b = this.Sk;
        if (!b.D(a)) {
          this.Sk = a = a.L();
          var c = this.diagram;
          null !== c && Ik(c, this);
          this.g("avoidableMargin", b, a);
        }
      },
    },
    linksConnected: {
      configurable: !0,
      get: function () {
        return this.lb.iterator;
      },
    },
    linkConnected: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.so;
      },
      set: function (a) {
        var b = this.so;
        b !== a &&
          (null !== a && A(a, "function", V, "linkConnected"),
          (this.so = a),
          this.g("linkConnected", b, a));
      },
    },
    linkDisconnected: {
      configurable: !0,
      get: function () {
        return this.to;
      },
      set: function (a) {
        var b = this.to;
        b !== a &&
          (null !== a && A(a, "function", V, "linkDisconnected"),
          (this.to = a),
          this.g("linkDisconnected", b, a));
      },
    },
    linkValidation: {
      configurable: !0,
      get: function () {
        return this.ri;
      },
      set: function (a) {
        var b = this.ri;
        b !== a &&
          (null !== a && A(a, "function", V, "linkValidation"),
          (this.ri = a),
          this.g("linkValidation", b, a));
      },
    },
    isLinkLabel: {
      configurable: !0,
      get: function () {
        return null !== this.yl;
      },
    },
    labeledLink: {
      configurable: !0,
      get: function () {
        return this.yl;
      },
      set: function (a) {
        var b = this.yl;
        if (b !== a) {
          G && null !== a && x(a, R, V, "labeledLink");
          var c = this.diagram,
            d = this.data;
          if (null !== b) {
            null !== b.vd && (b.vd.remove(this), b.v());
            if (null !== c && null !== d && !c.undoManager.isUndoingRedoing) {
              var e = b.data,
                f = c.model;
              if (null !== e && f.Zi()) {
                var g = f.wa(d);
                void 0 !== g && f.yy(e, g);
              }
            }
            this.containingGroup = null;
          }
          this.yl = a;
          null !== a &&
            (kp(a, this),
            null === c ||
              null === d ||
              c.undoManager.isUndoingRedoing ||
              ((e = a.data),
              (c = c.model),
              null !== e &&
                c.Zi() &&
                ((d = c.wa(d)), void 0 !== d && c.$u(e, d))),
            (this.containingGroup = a.containingGroup));
          Nl(this);
          this.g("labeledLink", b, a);
        }
      },
    },
    port: {
      configurable: !0,
      get: function () {
        return this.Es("");
      },
    },
    ports: {
      configurable: !0,
      get: function () {
        null === this.tc && lp(this);
        return this.tc.iteratorValues;
      },
    },
    isTreeExpanded: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 1);
      },
      set: function (a) {
        var b = 0 !== (this.U & 1);
        if (b !== a) {
          G && A(a, "boolean", V, "isTreeExpanded");
          this.U ^= 1;
          var c = this.diagram;
          this.g("isTreeExpanded", b, a);
          b = this.treeExpandedChanged;
          if (null !== b) {
            var d = !0;
            null !== c && ((d = c.ba), (c.ba = !0));
            b(this);
            null !== c && (c.ba = d);
          }
          null !== c && c.undoManager.isUndoingRedoing
            ? this.Vb(a)
            : a
            ? this.expandTree()
            : this.collapseTree();
        }
      },
    },
    wasTreeExpanded: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 2);
      },
      set: function (a) {
        var b = 0 !== (this.U & 2);
        b !== a &&
          (G && A(a, "boolean", V, "wasTreeExpanded"),
          (this.U ^= 2),
          this.g("wasTreeExpanded", b, a));
      },
    },
    treeExpandedChanged: {
      configurable: !0,
      get: function () {
        return this.Mp;
      },
      set: function (a) {
        var b = this.Mp;
        b !== a &&
          (null !== a && A(a, "function", V, "treeExpandedChanged"),
          (this.Mp = a),
          this.g("treeExpandedChanged", b, a));
      },
    },
    isTreeLeaf: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 4);
      },
      set: function (a) {
        var b = 0 !== (this.U & 4);
        b !== a &&
          (G && A(a, "boolean", V, "isTreeLeaf"),
          (this.U ^= 4),
          this.g("isTreeLeaf", b, a));
      },
    },
  });
  V.prototype.expandTree = V.prototype.expandTree;
  V.prototype.collapseTree = V.prototype.collapseTree;
  V.prototype.findTreeParts = V.prototype.fA;
  V.prototype.findTreeChildrenNodes = V.prototype.uv;
  V.prototype.findTreeChildrenLinks = V.prototype.hq;
  V.prototype.findTreeLevel = V.prototype.dA;
  V.prototype.findTreeParentChain = V.prototype.eA;
  V.prototype.findTreeParentNode = V.prototype.wg;
  V.prototype.findTreeParentLink = V.prototype.Ri;
  V.prototype.findCommonTreeParent = V.prototype.Rz;
  V.prototype.findTreeRoot = V.prototype.gA;
  V.prototype.isInTreeOf = V.prototype.xA;
  V.prototype.findPort = V.prototype.Es;
  V.prototype.findLinksTo = V.prototype.Vz;
  V.prototype.findLinksBetween = V.prototype.Uz;
  V.prototype.findNodesInto = V.prototype.rv;
  V.prototype.findNodesOutOf = V.prototype.sv;
  V.prototype.findNodesConnected = V.prototype.qv;
  V.prototype.findLinksInto = V.prototype.Nd;
  V.prototype.findLinksOutOf = V.prototype.fq;
  V.prototype.findExternalTreeLinksConnected = V.prototype.Tx;
  V.prototype.invalidateConnectedLinks = V.prototype.zd;
  V.prototype.invalidateLinkBundle = V.prototype.vA;
  var qp = new F(V, "SpreadingNone", 10),
    dp = new F(V, "SpreadingEvenly", 11),
    rp = new F(V, "SpreadingPacked", 12);
  V.className = "Node";
  V.SpreadingNone = qp;
  V.SpreadingEvenly = dp;
  V.SpreadingPacked = rp;
  function vf(a, b) {
    void 0 === a || a instanceof Yl || "string" === typeof a
      ? V.call(this, a)
      : (V.call(this), a && (b = a));
    this.U |= 4608;
    this.Do = new I();
    this.Hl = new I();
    this.Ta = this.Fp = this.ti = this.Eo = this.Co = this.kb = null;
    this.Jc = new zi();
    this.Jc.group = this;
    this.kr = null;
    b && Object.assign(this, b);
  }
  na(vf, V);
  vf.prototype.cloneProtected = function (a) {
    V.prototype.cloneProtected.call(this, a);
    this.U = this.U & -32769;
    null !== this.kb && (a.kb = this.kb.copy());
    a.Co = this.Co;
    a.Eo = this.Eo;
    a.ti = this.ti;
    a.Fp = this.Fp;
    var b = a.km(function (a) {
      return a instanceof rg;
    });
    b instanceof rg ? (a.Ta = b) : (a.Ta = null);
    null !== this.Jc
      ? ((a.Jc = this.Jc.copy()), (a.Jc.group = a))
      : (null !== a.Jc && (a.Jc.group = null), (a.Jc = null));
  };
  t = vf.prototype;
  t.Ef = function (a) {
    V.prototype.Ef.call(this, a);
    var b = a.rk();
    for (a = a.memberParts; a.next(); ) {
      var c = a.value;
      c.v();
      c.F(8);
      c.gk();
      if (c instanceof V) c.zd(b);
      else if (c instanceof R) for (c = c.labelNodes; c.next(); ) c.value.zd(b);
    }
  };
  t.Hk = function (a, b, c, d, e, f, g) {
    if (a === re && "elements" === b)
      if (e instanceof rg)
        null === this.Ta
          ? (this.Ta = e)
          : this.Ta !== e &&
            v(
              "Cannot insert a second Placeholder into the visual tree of a Group."
            );
      else {
        if (e instanceof W) {
          var h = e.km(function (a) {
            return a instanceof rg;
          });
          h instanceof rg &&
            (null === this.Ta
              ? (this.Ta = h)
              : this.Ta !== h &&
                v(
                  "Cannot insert a second Placeholder into the visual tree of a Group."
                ));
        }
      }
    else
      a === se &&
        "elements" === b &&
        null !== this.Ta &&
        (d === this.Ta
          ? (this.Ta = null)
          : d instanceof W && this.Ta.xg(d) && (this.Ta = null));
    V.prototype.Hk.call(this, a, b, c, d, e, f, g);
  };
  t.um = function (a, b) {
    V.prototype.um.call(this, a, b);
    this.isClipping &&
      this.type !== W.Spot &&
      this.isSubGraphExpanded &&
      ((a = this.resizeObject),
      a instanceof W && (a = a.vb()),
      null === this.kb && (this.kb = new M()),
      a.Ui(this.kb),
      a instanceof Hf && this.kb.Qc(-a.strokeWidth, -a.strokeWidth));
  };
  t.Eh = function (a, b, c, d) {
    this.lf = this.Ta;
    V.prototype.Eh.call(this, a, b, c, d);
  };
  t.Za = function () {
    var a = this;
    a.isSubGraphExpanded &&
      this.memberParts.each(function (b) {
        (!a.computesBoundsIncludingLinks && b instanceof R) || b.Za();
      });
    V.prototype.Za.call(this);
  };
  t.aj = function () {
    if (!V.prototype.aj.call(this)) return !1;
    for (var a = this.memberParts; a.next(); ) {
      var b = a.value;
      if (b instanceof V) {
        if (b.isVisible() && Bj(b)) return !1;
      } else if (
        b instanceof R &&
        b.isVisible() &&
        Bj(b) &&
        b.fromNode !== this &&
        b.toNode !== this
      )
        return !1;
    }
    return !0;
  };
  function Xo(a, b) {
    if (a.Do.add(b)) {
      b instanceof vf && a.Hl.add(b);
      var c = a.memberAdded;
      if (null !== c) {
        var d = !0,
          e = a.diagram;
        null !== e && ((d = e.ba), (e.ba = !0));
        c(a, b);
        null !== e && (e.ba = d);
      }
      (a.isVisible() && a.isSubGraphExpanded) || b.Vb(!1);
    }
    (b instanceof R && !a.computesBoundsIncludingLinks) ||
      ((b = a.Ta), null === b && (b = a), b.v());
  }
  function Yo(a, b) {
    if (a.Do.remove(b)) {
      b instanceof vf && a.Hl.remove(b);
      var c = a.memberRemoved;
      if (null !== c) {
        var d = !0,
          e = a.diagram;
        null !== e && ((d = e.ba), (e.ba = !0));
        c(a, b);
        null !== e && (e.ba = d);
      }
      (a.isVisible() && a.isSubGraphExpanded) || b.Vb(!0);
    }
    (b instanceof R && !a.computesBoundsIncludingLinks) ||
      ((b = a.Ta), null === b && (b = a), b.v());
  }
  t.mk = function () {
    if (0 < this.Do.count) {
      var a = this.diagram;
      if (null !== a)
        for (var b = this.Do.copy().iterator; b.next(); ) a.remove(b.value);
    }
    V.prototype.mk.call(this);
  };
  vf.prototype.canAddMembers = function (a) {
    var b = this.diagram;
    if (null === b) return !1;
    b = b.commandHandler;
    for (a = gl(a).iterator; a.next(); )
      if (!b.isValidMember(this, a.value)) return !1;
    return !0;
  };
  vf.prototype.addMembers = function (a, b) {
    var c = this.diagram;
    if (null === c) return !1;
    c = c.commandHandler;
    var d = !0;
    for (a = gl(a).iterator; a.next(); ) {
      var e = a.value;
      !b || c.isValidMember(this, e) ? (e.containingGroup = this) : (d = !1);
    }
    return d;
  };
  vf.prototype.canUngroup = function () {
    if (!this.ungroupable) return !1;
    var a = this.layer;
    if (null === a || !a.allowUngroup) return !1;
    a = a.diagram;
    return null === a || a.allowUngroup ? !0 : !1;
  };
  t = vf.prototype;
  t.zd = function (a) {
    var b = 0 !== (this.U & 65536);
    V.prototype.zd.call(this, a);
    if (!b)
      for (
        (0 !== (this.U & 65536)) !== !0 && (this.U = this.U ^ 65536),
          b = this.pv();
        b.next();

      ) {
        var c = b.value;
        if (void 0 === a || !a.contains(c)) {
          var d = c.fromNode;
          null !== d && d !== this && d.Pd(this) && !d.isVisible()
            ? (gp(c.fromPort), gp(c.toPort), c.ab())
            : ((d = c.toNode),
              null !== d &&
                d !== this &&
                d.Pd(this) &&
                !d.isVisible() &&
                (gp(c.fromPort), gp(c.toPort), c.ab()));
        }
      }
  };
  t.pv = function () {
    var a = null !== this.diagram && this.diagram.tx;
    if (a && null !== this.kr) return this.kr.iterator;
    var b = this.rk();
    b.add(this);
    for (var c = new I(), d = b.iterator; d.next(); ) {
      var e = d.value;
      if (e instanceof V)
        for (e = e.linksConnected; e.next(); ) {
          var f = e.value;
          b.contains(f) || c.add(f);
        }
    }
    a && (this.kr = c);
    return c.iterator;
  };
  t.Tz = function () {
    var a = this.rk();
    a.add(this);
    for (var b = new I(), c = a.iterator; c.next(); ) {
      var d = c.value;
      if (d instanceof V)
        for (d = d.linksConnected; d.next(); ) {
          var e = d.value,
            f = e.fromNode;
          null === f || (a.contains(f) && f !== this) || b.add(f);
          e = e.toNode;
          null === e || (a.contains(e) && e !== this) || b.add(e);
        }
    }
    return b.iterator;
  };
  t.Sz = function () {
    function a(b, d) {
      null !== b && (d.add(b), a(b.containingGroup, d));
    }
    var b = new I();
    a(this, b);
    return b;
  };
  t.rk = function () {
    var a = new I();
    el(a, this, !0, 0, !0);
    a.remove(this);
    return a;
  };
  t.Vb = function (a) {
    V.prototype.Vb.call(this, a);
    for (var b = this.memberParts; b.next(); ) b.value.Vb(a);
  };
  vf.prototype.collapseSubGraph = function () {
    var a = this.diagram;
    if (null !== a && !a.Ue) {
      a.Ue = !0;
      var b = this.rk();
      sp(this, b, a, this);
      a.Ue = !1;
    }
  };
  function sp(a, b, c, d) {
    for (var e = a.memberParts; e.next(); ) {
      var f = e.value;
      f.Vb(!1);
      f instanceof vf &&
        f.isSubGraphExpanded &&
        ((f.wasSubGraphExpanded = f.isSubGraphExpanded), sp(f, b, c, d));
      if (f instanceof V) f.zd(b), c.ck(f, d);
      else if (f instanceof R) for (f = f.labelNodes; f.next(); ) f.value.zd(b);
    }
    a.isSubGraphExpanded = !1;
  }
  vf.prototype.expandSubGraph = function () {
    var a = this.diagram;
    if (null !== a && !a.Ue) {
      a.Ue = !0;
      var b = this.rk();
      tp(this, b, a, this);
      a.Ue = !1;
    }
  };
  function tp(a, b, c, d) {
    for (var e = a.memberParts; e.next(); ) {
      var f = e.value;
      f.Vb(!0);
      f instanceof vf &&
        f.wasSubGraphExpanded &&
        ((f.wasSubGraphExpanded = !1), tp(f, b, c, d));
      if (f instanceof V) f.zd(b), c.ek(f, d);
      else if (f instanceof R) for (f = f.labelNodes; f.next(); ) f.value.zd(b);
    }
    a.isSubGraphExpanded = !0;
  }
  vf.prototype.move = function (a, b) {
    void 0 === b && (b = !1);
    var c = b ? this.location : this.position,
      d = c.x;
    c = c.y;
    var e = a.x,
      f = a.y;
    if (
      !(d === e || (isNaN(d) && isNaN(e))) ||
      !(c === f || (isNaN(c) && isNaN(f)))
    ) {
      d = e - (isNaN(d) ? 0 : d);
      c = f - (isNaN(c) ? 0 : c);
      f = K.alloc();
      V.prototype.move.call(this, a, b);
      a = new I();
      for (b = this.rk().iterator; b.next(); )
        if (
          ((e = b.value),
          e instanceof R &&
            (e.suspendsRouting && a.add(e),
            e.Bd || (e.fromNode !== this && e.toNode !== this)))
        )
          e.suspendsRouting = !0;
      for (b.reset(); b.next(); )
        if (((e = b.value), !(e.Mh() || (e instanceof V && e.isLinkLabel)))) {
          var g = e.position,
            h = e.location;
          g.s()
            ? ((f.x = g.x + d), (f.y = g.y + c), (e.position = f))
            : h.s() && ((f.x = h.x + d), (f.y = h.y + c), (e.location = f));
        }
      for (b.reset(); b.next(); )
        if (
          ((e = b.value),
          e instanceof R &&
            ((e.suspendsRouting = a.contains(e)),
            e.Bd || (e.fromNode !== this && e.toNode !== this)))
        )
          (g = e.position),
            (f.x = g.x + d),
            (f.y = g.y + c),
            f.s() ? e.move(f) : e.ab(),
            Yj(e) && e.ab();
      K.free(f);
    }
  };
  oa.Object.defineProperties(vf.prototype, {
    placeholder: {
      configurable: !0,
      get: function () {
        return this.Ta;
      },
    },
    computesBoundsAfterDrag: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 2048);
      },
      set: function (a) {
        var b = 0 !== (this.U & 2048);
        b !== a &&
          (A(a, "boolean", vf, "computesBoundsAfterDrag"),
          (this.U ^= 2048),
          this.g("computesBoundsAfterDrag", b, a));
      },
    },
    computesBoundsIncludingLinks: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 4096);
      },
      set: function (a) {
        A(a, "boolean", vf, "computesBoundsIncludingLinks");
        var b = 0 !== (this.U & 4096);
        b !== a &&
          ((this.U ^= 4096), this.g("computesBoundsIncludingLinks", b, a));
      },
    },
    computesBoundsIncludingLocation: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 8192);
      },
      set: function (a) {
        A(a, "boolean", vf, "computesBoundsIncludingLocation");
        var b = 0 !== (this.U & 8192);
        b !== a &&
          ((this.U ^= 8192), this.g("computesBoundsIncludingLocation", b, a));
      },
    },
    handlesDragDropForMembers: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 16384);
      },
      set: function (a) {
        A(a, "boolean", vf, "handlesDragDropForMembers");
        var b = 0 !== (this.U & 16384);
        b !== a &&
          ((this.U ^= 16384), this.g("handlesDragDropForMembers", b, a));
      },
    },
    memberParts: {
      configurable: !0,
      get: function () {
        return this.Do.iterator;
      },
    },
    layout: {
      configurable: !0,
      get: function () {
        return this.Jc;
      },
      set: function (a) {
        var b = this.Jc;
        if (b !== a) {
          null !== a && x(a, zi, vf, "layout");
          null !== b && ((b.diagram = null), (b.group = null));
          this.Jc = a;
          var c = this.diagram;
          null !== a && ((a.diagram = c), (a.group = this));
          null !== c && (c.Wh = !0);
          this.g("layout", b, a);
          null !== c && c.Ob();
        }
      },
    },
    memberAdded: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Co;
      },
      set: function (a) {
        var b = this.Co;
        b !== a &&
          (null !== a && A(a, "function", vf, "memberAdded"),
          (this.Co = a),
          this.g("memberAdded", b, a));
      },
    },
    memberRemoved: {
      configurable: !0,
      get: function () {
        return this.Eo;
      },
      set: function (a) {
        var b = this.Eo;
        b !== a &&
          (null !== a && A(a, "function", vf, "memberRemoved"),
          (this.Eo = a),
          this.g("memberRemoved", b, a));
      },
    },
    memberValidation: {
      configurable: !0,
      get: function () {
        return this.ti;
      },
      set: function (a) {
        var b = this.ti;
        b !== a &&
          (null !== a && A(a, "function", vf, "memberValidation"),
          (this.ti = a),
          this.g("memberValidation", b, a));
      },
    },
    ungroupable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 256);
      },
      set: function (a) {
        var b = 0 !== (this.U & 256);
        b !== a &&
          (A(a, "boolean", vf, "ungroupable"),
          (this.U ^= 256),
          this.g("ungroupable", b, a));
      },
    },
    isSubGraphExpanded: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 512);
      },
      set: function (a) {
        var b = 0 !== (this.U & 512);
        if (b !== a) {
          A(a, "boolean", vf, "isSubGraphExpanded");
          this.U ^= 512;
          var c = this.diagram;
          this.g("isSubGraphExpanded", b, a);
          b = this.subGraphExpandedChanged;
          if (null !== b) {
            var d = !0;
            null !== c && ((d = c.ba), (c.ba = !0));
            b(this);
            null !== c && (c.ba = d);
          }
          null !== c && c.undoManager.isUndoingRedoing
            ? (null !== this.Ta && this.Ta.v(),
              this.memberParts.each(function (a) {
                a.updateAdornments();
              }))
            : a
            ? this.expandSubGraph()
            : this.collapseSubGraph();
        }
      },
    },
    wasSubGraphExpanded: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 1024);
      },
      set: function (a) {
        var b = 0 !== (this.U & 1024);
        b !== a &&
          (A(a, "boolean", vf, "wasSubGraphExpanded"),
          (this.U ^= 1024),
          this.g("wasSubGraphExpanded", b, a));
      },
    },
    subGraphExpandedChanged: {
      configurable: !0,
      get: function () {
        return this.Fp;
      },
      set: function (a) {
        var b = this.Fp;
        b !== a &&
          (null !== a && A(a, "function", vf, "subGraphExpandedChanged"),
          (this.Fp = a),
          this.g("subGraphExpandedChanged", b, a));
      },
    },
    Oh: {
      configurable: !0,
      get: function () {
        return 0 !== (this.U & 32768);
      },
      set: function (a) {
        (0 !== (this.U & 32768)) !== a && (this.U ^= 32768);
      },
    },
  });
  vf.prototype.expandSubGraph = vf.prototype.expandSubGraph;
  vf.prototype.collapseSubGraph = vf.prototype.collapseSubGraph;
  vf.prototype.findSubGraphParts = vf.prototype.rk;
  vf.prototype.findContainingGroupChain = vf.prototype.Sz;
  vf.prototype.findExternalNodesConnected = vf.prototype.Tz;
  vf.prototype.findExternalLinksConnected = vf.prototype.pv;
  vf.prototype.ensureBounds = vf.prototype.Za;
  vf.className = "Group";
  function rg(a) {
    O.call(this);
    this.ub = Cc;
    this.pp = new M(NaN, NaN, NaN, NaN);
    a && Object.assign(this, a);
  }
  na(rg, O);
  rg.prototype.cloneProtected = function (a) {
    O.prototype.cloneProtected.call(this, a);
    a.ub = this.ub.L();
    a.pp = this.pp.copy();
  };
  rg.prototype.Gh = function (a) {
    if (null === this.background && null === this.areaBackground) return !1;
    var b = this.naturalBounds;
    return nc(0, 0, b.width, b.height, a.x, a.y);
  };
  rg.prototype.tm = function () {
    var a = this.part;
    (null !== a && (a instanceof vf || a instanceof Je)) ||
      v("Placeholder is not inside a Group or Adornment.");
    if (a instanceof vf) {
      var b = this.computeBorder(this.pp),
        c = this.minSize,
        d = this.zc;
      dc(
        d,
        (isFinite(c.width) ? Math.max(c.width, b.width) : b.width) || 0,
        (isFinite(c.height) ? Math.max(c.height, b.height) : b.height) || 0
      );
      this.Ee(0, 0, d.width, d.height);
      d = a.memberParts;
      for (c = !1; d.next(); )
        if (d.value.isVisible()) {
          c = !0;
          break;
        }
      d = a.diagram;
      !c ||
        null === d ||
        d.animationManager.Dv(a) ||
        isNaN(b.x) ||
        isNaN(b.y) ||
        ((c = K.alloc()),
        c.cj(b, a.locationSpot),
        c.D(a.location) || (a.location = c),
        K.free(c));
    } else {
      b = this.zc;
      c = this.ub;
      d = c.left + c.right;
      var e = c.top + c.bottom,
        f = a.adornedObject;
      a.angle = f.Ti();
      var g = 0;
      f instanceof Hf && (g = f.strokeWidth);
      var h = f.If(),
        k = f.naturalBounds,
        l = (k.width + g) * h;
      g = (k.height + g) * h;
      a.type !== W.Link &&
        ((h = f.ka(
          "Selection" === a.category ? Fc : a.locationSpot,
          K.alloc()
        )),
        (a.location = h),
        K.free(h));
      isNaN(l) || isNaN(g)
        ? ((a = f.ka(Fc, K.alloc())),
          (l = M.allocAt(a.x, a.y, 0, 0)),
          l.Ye(f.ka(Pc, a)),
          l.Ye(f.ka(Ic, a)),
          l.Ye(f.ka(Mc, a)),
          dc(b, l.width + d || 0, l.height + e || 0),
          this.Ee(-c.left, -c.top, b.width, b.height),
          K.free(a),
          M.free(l))
        : (dc(b, l + d || 0, g + e || 0),
          this.Ee(-c.left, -c.top, b.width, b.height));
    }
  };
  rg.prototype.Eh = function (a, b, c, d) {
    this.actualBounds.h(a, b, c, d);
  };
  rg.prototype.computeBorder = function (a) {
    var b = this.part,
      c = b.diagram;
    if (
      null !== c &&
      b instanceof vf &&
      !b.layer.isTemporary &&
      b.computesBoundsAfterDrag &&
      this.pp.s()
    ) {
      var d = c.toolManager.findTool("Dragging");
      if (
        d === c.currentTool &&
        ((c = d.computeBorder(b, this.pp, a)), null !== c)
      )
        return c;
    }
    c = M.alloc();
    d = this.computeMemberBounds(c);
    var e = this.ub;
    b instanceof vf && !b.isSubGraphExpanded
      ? a.h(d.x - e.left, d.y - e.top, 0, 0)
      : a.h(
          d.x - e.left,
          d.y - e.top,
          Math.max(d.width + e.left + e.right, 0),
          Math.max(d.height + e.top + e.bottom, 0)
        );
    M.free(c);
    b instanceof vf &&
      b.computesBoundsIncludingLocation &&
      b.location.s() &&
      a.Ye(b.location);
    return a;
  };
  rg.prototype.computeMemberBounds = function (a) {
    if (!(this.part instanceof vf)) return a.h(0, 0, 0, 0), a;
    for (
      var b = this.part,
        c = Infinity,
        d = Infinity,
        e = -Infinity,
        f = -Infinity,
        g = b.memberParts;
      g.next();

    ) {
      var h = g.value;
      if (h.isVisible()) {
        if (h instanceof R) {
          if (!b.computesBoundsIncludingLinks) continue;
          if (Aj(h)) continue;
          if (h.fromNode === b || h.toNode === b) continue;
        }
        h = h.actualBounds;
        h.left < c && (c = h.left);
        h.top < d && (d = h.top);
        h.right > e && (e = h.right);
        h.bottom > f && (f = h.bottom);
      }
    }
    isFinite(c) && isFinite(d)
      ? a.h(c, d, e - c, f - d)
      : ((b = b.location), a.h(b.x, b.y, 0, 0));
    return a;
  };
  oa.Object.defineProperties(rg.prototype, {
    padding: {
      configurable: !0,
      get: function () {
        return this.ub;
      },
      set: function (a) {
        "number" === typeof a ? (a = new ic(a)) : x(a, ic, rg, "padding");
        var b = this.ub;
        b.D(a) || ((this.ub = a = a.L()), this.g("padding", b, a), this.v());
      },
    },
  });
  rg.className = "Placeholder";
  function R(a) {
    U.call(this, W.Link);
    this.Oa = 8;
    this.df = null;
    this.ef = "";
    this.xf = this.On = null;
    this.yf = "";
    this.Lp = null;
    this.Mk = hg;
    this.tn = 0;
    this.vn = hg;
    this.wn = NaN;
    this.Vj = up;
    this.Ap = 0.5;
    this.vd = null;
    this.Jb = new H().freeze();
    this.qf = this.Lc = null;
    this.Ol = new M();
    this.ta = new N();
    this.B = this.o = this.Uf = this.Yf = null;
    this.Qu = new K();
    this.nr = this.px = this.ox = null;
    this.Qt = NaN;
    this.T = null;
    this.j = [];
    a && Object.assign(this, a);
  }
  na(R, U);
  R.prototype.cloneProtected = function (a) {
    U.prototype.cloneProtected.call(this, a);
    a.Oa = this.Oa & -113;
    a.ef = this.ef;
    a.On = this.On;
    a.yf = this.yf;
    a.Lp = this.Lp;
    a.Mk = this.Mk;
    a.tn = this.tn;
    a.vn = this.vn;
    a.wn = this.wn;
    a.Vj = this.Vj;
    a.Ap = this.Ap;
    null !== this.T && (a.T = this.T.copy());
  };
  t = R.prototype;
  t.Ef = function (a) {
    U.prototype.Ef.call(this, a);
    this.ef = a.ef;
    this.yf = a.yf;
    a.Lc = null;
    a.ab();
    a.Uf = this.Uf;
    var b = a.fromPort;
    null !== b && gp(b);
    a = a.toPort;
    null !== a && gp(a);
  };
  t.pb = function (a) {
    a.classType === R
      ? 2 === (a.value & 2)
        ? (this.routing = a)
        : a === kg || a === gg || a === fg
        ? (this.curve = a)
        : a === vp || a === wp || a === xp
        ? (this.adjusting = a)
        : a !== up &&
          a !== hg &&
          v("Unknown Link enum value for a Link property: " + a)
      : U.prototype.pb.call(this, a);
  };
  t.Rc = function () {
    null === this.T && (this.T = new ql());
  };
  t.aj = function () {
    var a = this.fromNode;
    if (null !== a) {
      var b = a.findVisibleNode();
      null !== b && (a = b);
      if (Bj(a) || Cj(a)) return !1;
    }
    a = this.toNode;
    return null !== a &&
      ((b = a.findVisibleNode()), null !== b && (a = b), Bj(a) || Cj(a))
      ? !1
      : !0;
  };
  t.Zv = function () {
    return !1;
  };
  t.ft = function () {};
  t.Tc = function () {
    return !1;
  };
  R.prototype.computeAngle = function (a, b, c) {
    return R.computeAngle(b, c);
  };
  R.computeAngle = function (a, b) {
    switch (a) {
      default:
      case hg:
        a = 0;
        break;
      case gn:
        a = b;
        break;
      case $m:
        a = b + 90;
        break;
      case bn:
        a = b - 90;
        break;
      case yp:
        a = b + 180;
        break;
      case hn:
        a = L.tq(b);
        90 < a && 270 > a && (a -= 180);
        break;
      case an:
        a = L.tq(b + 90);
        90 < a && 270 > a && (a -= 180);
        break;
      case cn:
        a = L.tq(b - 90);
        90 < a && 270 > a && (a -= 180);
        break;
      case dn:
        a = L.tq(b);
        if ((45 < a && 135 > a) || (225 < a && 315 > a)) return 0;
        90 < a && 270 > a && (a -= 180);
    }
    return L.tq(a);
  };
  function cp(a) {
    var b = a.fromNode,
      c = a.toNode,
      d = null;
    null !== b
      ? (d = null !== c ? b.Sx(c) : b.containingGroup)
      : null !== c
      ? (d = c.containingGroup)
      : (d = null);
    b = d;
    c = a.Zh;
    if (c !== b) {
      null !== c && Yo(c, a);
      a.Zh = b;
      null !== b && Xo(b, a);
      var e = a.containingGroupChanged;
      if (null !== e) {
        var f = !0,
          g = a.diagram;
        null !== g && ((f = g.ba), (g.ba = !0));
        e(a, c, b);
        null !== g && (g.ba = f);
      }
      !a.Bd || (a.ox !== c && a.px !== c) || a.ab();
    }
    if (a.isLabeledLink)
      for (a = a.labelNodes; a.next(); ) a.value.containingGroup = d;
  }
  t = R.prototype;
  t.Lh = function () {
    var a = this.containingGroup;
    null !== a &&
      this.fromNode !== a &&
      this.toNode !== a &&
      a.computesBoundsIncludingLinks &&
      U.prototype.Lh.call(this);
  };
  t.kq = function (a) {
    G && x(a, V, R, "getOtherNode:node");
    var b = this.fromNode;
    return a === b ? this.toNode : b;
  };
  t.lA = function (a) {
    G && x(a, O, R, "getOtherPort:port");
    var b = this.fromPort;
    return a === b ? this.toPort : b;
  };
  function kp(a, b) {
    null === a.vd && (a.vd = new I());
    a.vd.add(b);
    a.v();
  }
  t.mq = function (a) {
    U.prototype.mq.call(this, a);
    zp(this) && this.oq(this.actualBounds);
    if (!a) {
      a = this.df;
      var b = null;
      null !== a && ((b = this.fromPort), ip(a, this, b));
      var c = this.xf;
      if (null !== c) {
        var d = this.toPort;
        (c === a && d === b) || ip(c, this, d);
      }
      Ap(this);
    }
  };
  t.nq = function (a) {
    U.prototype.nq.call(this, a);
    zp(this) && this.oq(this.actualBounds);
    if (!a) {
      a = this.df;
      var b = null;
      null !== a && ((b = this.fromPort), jp(a, this, b));
      var c = this.xf;
      if (null !== c) {
        var d = this.toPort;
        (c === a && d === b) || jp(c, this, d);
      }
      Bp(this);
    }
  };
  t.mk = function () {
    this.Bd = !0;
    if (null !== this.vd) {
      var a = this.diagram;
      if (null !== a)
        for (var b = this.vd.copy().iterator; b.next(); ) a.remove(b.value);
    }
    null !== this.data &&
      ((a = this.diagram), null !== a && a.partManager.removeDataForLink(this));
  };
  R.prototype.updateRelationshipsFromData = function () {
    if (null !== this.data) {
      var a = this.diagram;
      null !== a && a.partManager.updateRelationshipsFromData(this);
    }
  };
  R.prototype.move = function (a, b) {
    var c = b ? this.location : this.position,
      d = c.x;
    isNaN(d) && (d = 0);
    var e = c.y;
    isNaN(e) && (e = 0);
    d = a.x - d;
    e = a.y - e;
    !0 === b
      ? U.prototype.move.call(this, a, !1)
      : ((a = K.allocAt(c.x + d, c.y + e)),
        U.prototype.move.call(this, a, !1),
        K.free(a));
    lf(this, d, e);
    for (a = this.labelNodes; a.next(); )
      (b = a.value), (c = b.position), b.moveTo(c.x + d, c.y + e);
  };
  R.prototype.canRelinkFrom = function () {
    if (!this.relinkableFrom) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowRelink) return !1;
    a = a.diagram;
    return null === a || a.allowRelink ? !0 : !1;
  };
  R.prototype.canRelinkTo = function () {
    if (!this.relinkableTo) return !1;
    var a = this.layer;
    if (null === a) return !0;
    if (!a.allowRelink) return !1;
    a = a.diagram;
    return null === a || a.allowRelink ? !0 : !1;
  };
  R.prototype.computeMidPoint = function (a) {
    var b = this.pointsCount;
    if (0 === b) return a.assign(Cb), a;
    if (1 === b) return a.assign(this.i(0)), a;
    if (2 === b) {
      var c = this.i(0),
        d = this.i(1);
      a.h((c.x + d.x) / 2, (c.y + d.y) / 2);
      return a;
    }
    if (
      this.isOrthogonal &&
      (15 <= this.computeCorner() || this.computeCurve() === kg)
    )
      return (
        this.ta.vv(0.5, a),
        a.add(this.i(0)),
        (c = this.ta.figures.first()),
        a.offset(-c.startX, -c.startY),
        a
      );
    if (this.computeCurve() === kg) {
      if (3 === b) return this.i(1);
      d = ((b - 1) / 3) | 0;
      c = 3 * ((d / 2) | 0);
      if (1 === d % 2) {
        d = this.i(c);
        var e = this.i(c + 1),
          f = this.i(c + 2);
        c = this.i(c + 3);
        L.sz(d.x, d.y, e.x, e.y, f.x, f.y, c.x, c.y, a);
      } else a.assign(this.i(c));
      return a;
    }
    var g = this.flattenedLengths;
    c = this.flattenedTotalLength;
    for (e = f = d = 0; d < c / 2 && f < b; ) {
      e = g[f];
      if (d + e > c / 2) break;
      d += e;
      f++;
    }
    b = this.i(f);
    f = this.i(f + 1);
    1 > Math.abs(b.x - f.x)
      ? b.y > f.y
        ? a.h(b.x, b.y - (c / 2 - d))
        : a.h(b.x, b.y + (c / 2 - d))
      : 1 > Math.abs(b.y - f.y)
      ? b.x > f.x
        ? a.h(b.x - (c / 2 - d), b.y)
        : a.h(b.x + (c / 2 - d), b.y)
      : ((c = (c / 2 - d) / e),
        a.h(b.x + c * (f.x - b.x), b.y + c * (f.y - b.y)));
    return a;
  };
  R.prototype.computeMidAngle = function () {
    var a = this.pointsCount;
    if (2 > a) return NaN;
    if (2 === a) return this.i(0).Ya(this.i(1));
    if (
      this.isOrthogonal &&
      (15 <= this.computeCorner() || this.computeCurve() === kg)
    )
      return this.ta.Yx(0.5);
    if (this.computeCurve() === kg && 4 <= a) {
      var b = ((a - 1) / 3) | 0,
        c = 3 * ((b / 2) | 0);
      if (1 === b % 2) {
        c = Math.floor(c);
        a = this.i(c);
        b = this.i(c + 1);
        var d = this.i(c + 2);
        c = this.i(c + 3);
        return L.rz(a.x, a.y, b.x, b.y, d.x, d.y, c.x, c.y);
      }
      if (0 < c && c + 1 < a) return this.i(c - 1).Ya(this.i(c + 1));
    }
    b = this.flattenedLengths;
    d = this.flattenedTotalLength;
    var e = 0;
    c = 0;
    for (var f; e < d / 2 && c < a; ) {
      f = b[c];
      if (e + f > d / 2) break;
      e += f;
      c++;
    }
    b = this.i(c);
    d = this.i(c + 1);
    if (1 > Math.abs(b.x - d.x) && 1 > Math.abs(b.y - d.y)) {
      if (0 < c && c + 2 < a) return this.i(c - 1).Ya(this.i(c + 2));
    } else {
      if (1 > Math.abs(b.x - d.x)) return b.y > d.y ? 270 : 90;
      if (1 > Math.abs(b.y - d.y)) return b.x > d.x ? 180 : 0;
    }
    return b.Ya(d);
  };
  t = R.prototype;
  t.i = function (a) {
    return this.Jb.m[a];
  };
  t.Wc = function (a, b) {
    G &&
      (x(b, K, R, "setPoint"),
      b.s() ||
        v(
          "Link.setPoint called with a Point that does not have real numbers: " +
            b.toString()
        ));
    G &&
      null === this.Lc &&
      v("Call Link.startRoute before modifying the points of the route.");
    this.Jb.Vc(a, b);
  };
  t.P = function (a, b, c) {
    G && (D(b, R, "setPointAt:x"), D(c, R, "setPointAt:y"));
    G &&
      null === this.Lc &&
      v("Call Link.startRoute before modifying the points of the route.");
    this.Jb.Vc(a, new K(b, c));
  };
  t.uA = function (a, b) {
    G &&
      (x(b, K, R, "insertPoint"),
      b.s() ||
        v(
          "Link.insertPoint called with a Point that does not have real numbers: " +
            b.toString()
        ));
    G &&
      null === this.Lc &&
      v("Call Link.startRoute before modifying the points of the route.");
    this.Jb.Cb(a, b);
  };
  t.l = function (a, b, c) {
    G && (D(b, R, "insertPointAt:x"), D(c, R, "insertPointAt:y"));
    G &&
      null === this.Lc &&
      v("Call Link.startRoute before modifying the points of the route.");
    this.Jb.Cb(a, new K(b, c));
  };
  t.je = function (a) {
    G &&
      (x(a, K, R, "addPoint"),
      a.s() ||
        v(
          "Link.addPoint called with a Point that does not have real numbers: " +
            a.toString()
        ));
    G &&
      null === this.Lc &&
      v("Call Link.startRoute before modifying the points of the route.");
    this.Jb.add(a);
  };
  t.Bf = function (a, b) {
    G && (D(a, R, "insertPointAt:x"), D(b, R, "insertPointAt:y"));
    G &&
      null === this.Lc &&
      v("Call Link.startRoute before modifying the points of the route.");
    this.Jb.add(new K(a, b));
  };
  t.Rv = function (a) {
    G &&
      null === this.Lc &&
      v("Call Link.startRoute before modifying the points of the route.");
    this.Jb.nb(a);
  };
  t.hk = function () {
    G &&
      null === this.Lc &&
      v("Call Link.startRoute before modifying the points of the route.");
    this.Jb.clear();
  };
  function lf(a, b, c) {
    if (0 !== b || 0 !== c)
      if (0 === a.pointsCount)
        a.defaultFromPoint && a.defaultFromPoint.offset(b, c),
          a.defaultToPoint && a.defaultToPoint.offset(b, c);
      else {
        for (var d = a.Bd, e = new H(), f = a.Jb.iterator; f.next(); ) {
          var g = f.value;
          e.add(new K(g.x + b, g.y + c).freeze());
        }
        e.freeze();
        f = a.Jb;
        a.Jb = e;
        g = a.diagram;
        isNaN(b) || isNaN(c) || (null !== g && g.animationManager.zb)
          ? a.v()
          : (a.fe.h(a.fe.x + b, a.fe.y + c),
            a.ra.h(a.ra.x + b, a.ra.y + c),
            Nl(a));
        d
          ? Cp(a)
          : (a.defaultFromPoint && (a.defaultFromPoint = a.i(0)),
            a.defaultToPoint && (a.defaultToPoint = a.i(a.pointsCount - 1)));
        null !== g &&
          g.animationManager.zb &&
          ((b = g.animationManager), (a.qf = e), b.Ql.add(a));
        a.g("points", f, e);
      }
  }
  t.Qh = function () {
    null === this.Lc && ((this.Lc = this.Jb), (this.Jb = this.Jb.copy()));
  };
  t.Df = function () {
    if (null !== this.Lc) {
      for (
        var a = this.Lc,
          b = this.Jb,
          c = Infinity,
          d = Infinity,
          e = a.m,
          f = e.length,
          g = 0;
        g < f;
        g++
      ) {
        var h = e[g];
        c = Math.min(h.x, c);
        d = Math.min(h.y, d);
      }
      h = g = Infinity;
      for (var k = b.m, l = k.length, m = 0; m < l; m++) {
        var n = k[m];
        g = Math.min(n.x, g);
        h = Math.min(n.y, h);
        n.freeze();
      }
      b.freeze();
      if (l === f)
        for (f = 0; f < l; f++) {
          if (
            ((m = e[f]), (n = k[f]), m.x - c !== n.x - g || m.y - d !== n.y - h)
          ) {
            this.lc(!0);
            break;
          }
        }
      else this.lc(!0);
      this.Lc = null;
      c = this.diagram;
      null !== c &&
        c.animationManager.zb &&
        ((c = c.animationManager), (this.qf = b), c.Ql.add(this));
      Cp(this);
      this.g("points", a, b);
    }
  };
  t.Tv = function () {
    null !== this.Lc && ((this.Jb = this.Lc), (this.Lc = null));
  };
  function Cp(a) {
    0 === a.Jb.count
      ? (a.Bd = !1)
      : ((a.Bd = !0),
        (a.nr = null),
        (a.Qt = NaN),
        (a.defaultFromPoint = a.i(0)),
        (a.defaultToPoint = a.i(a.pointsCount - 1)),
        Dp(a, !1));
  }
  t.ab = function () {
    if (!this.suspendsRouting) {
      var a = this.diagram;
      if (a) {
        if (a.Ts.contains(this) || a.undoManager.isUndoingRedoing) return;
        a = a.animationManager;
        if (a.isTicking && !a.isAnimating) return;
        null !== this.qf && !a.isTicking && a.isAnimating && (this.qf = null);
      }
      a = this.path;
      null !== a && ((this.Bd = !1), this.v(), a.v());
    }
  };
  t.Ag = function () {
    if (!this.Bd && !this.computingPoints) {
      var a = !0;
      try {
        (this.computingPoints = !0), this.Qh(), (a = this.computePoints());
      } catch (b) {
        (this.computingPoints = !1), this.Tv();
      } finally {
        (this.computingPoints = !1), a ? this.Df() : this.Tv();
      }
    }
  };
  R.prototype.computePoints = function () {
    if (null === this.diagram) return !1;
    var a = this.fromNode,
      b = null;
    null === a
      ? (Ep || ((Ep = new V()), (Ep.desiredSize = Rb), Ep.Za()),
        this.defaultFromPoint &&
          ((Ep.location = this.defaultFromPoint), Ep.Za(), (b = a = Ep)))
      : (b = this.fromPort);
    if (null !== b && !a.isVisible()) {
      var c = a.findVisibleNode();
      null !== c && c !== a ? ((a = c), (b = c.port)) : (a = c);
    }
    this.ox = a;
    if (null === a || !a.location.s()) return !1;
    for (; !(null === b || (b.actualBounds.s() && b.Nf())); ) b = b.panel;
    if (null === b) return !1;
    var d = this.toNode,
      e = null;
    null === d
      ? (Fp || ((Fp = new V()), (Fp.desiredSize = Rb), Fp.Za()),
        this.defaultToPoint &&
          ((Fp.location = this.defaultToPoint), Fp.Za(), (e = d = Fp)))
      : (e = this.toPort);
    null === e ||
      d.isVisible() ||
      ((c = d.findVisibleNode()),
      null !== c && c !== d ? ((d = c), (e = c.port)) : (d = c));
    this.px = d;
    if (null === d || !d.location.s()) return !1;
    for (; !(null === e || (e.actualBounds.s() && e.Nf())); ) e = e.panel;
    if (null === e) return !1;
    var f = this.pointsCount,
      g = this.computeSpot(!0, b);
    c = this.computeSpot(!1, e);
    var h = Gp(g),
      k = Gp(c),
      l = b === e && null !== b,
      m = this.isOrthogonal,
      n = this.curve === kg;
    this.Yf = l && !m ? (n = !0) : !1;
    var p = this.computeAdjusting() === hg || l;
    if (!m && !l && h && k) {
      if (
        ((h = !1),
        !p &&
          3 <= f &&
          ((p = this.getLinkPoint(a, b, g, !0, !1, d, e)),
          (k = this.getLinkPoint(d, e, c, !1, !1, a, b)),
          (h = this.adjustPoints(0, p, f - 1, k))) &&
          ((p = this.getLinkPoint(a, b, g, !0, !1, d, e)),
          (k = this.getLinkPoint(d, e, c, !1, !1, a, b)),
          this.adjustPoints(0, p, f - 1, k)),
        !h)
      )
        if ((this.hk(), n)) {
          f = this.getLinkPoint(a, b, g, !0, !1, d, e);
          p = this.getLinkPoint(d, e, c, !1, !1, a, b);
          h = p.x - f.x;
          k = p.y - f.y;
          l = this.computeCurviness();
          n = m = 0;
          var r = f.x + h / 3,
            q = f.y + k / 3,
            u = r,
            w = q;
          L.C(k, 0)
            ? (w = 0 < h ? w - l : w + l)
            : ((m = -h / k),
              (n = Math.sqrt((l * l) / (m * m + 1))),
              0 > l && (n = -n),
              (u = (0 > k ? -1 : 1) * n + r),
              (w = m * (u - r) + q));
          r = f.x + (2 * h) / 3;
          q = f.y + (2 * k) / 3;
          var y = r,
            z = q;
          L.C(k, 0)
            ? (z = 0 < h ? z - l : z + l)
            : ((y = (0 > k ? -1 : 1) * n + r), (z = m * (y - r) + q));
          this.hk();
          this.je(f);
          this.Bf(u, w);
          this.Bf(y, z);
          this.je(p);
          this.Wc(0, this.getLinkPoint(a, b, g, !0, !1, d, e));
          this.Wc(3, this.getLinkPoint(d, e, c, !1, !1, a, b));
        } else if (
          ((f = d),
          (p = e),
          (d = this.getLinkPoint(a, b, g, !0, !1, f, p)),
          (e = this.getLinkPoint(f, p, c, !1, !1, a, b)),
          this.hasCurviness())
        )
          (p = e.x - d.x),
            (c = e.y - d.y),
            (g = this.computeCurviness()),
            (a = d.x + p / 2),
            (b = d.y + c / 2),
            (f = a),
            (h = b),
            L.C(c, 0)
              ? (h = 0 < p ? h - g : h + g)
              : ((p = -p / c),
                (f = Math.sqrt((g * g) / (p * p + 1))),
                0 > g && (f = -f),
                (f = (0 > c ? -1 : 1) * f + a),
                (h = p * (f - a) + b)),
            this.je(d),
            this.Bf(f, h),
            this.je(e);
        else {
          this.je(d);
          this.je(e);
          h = M.alloc();
          b.Ui(h);
          k = h.ca(e);
          p.Ui(h);
          l = h.ca(d);
          if (k || l)
            (g = b.ka(Hp(g), new K())),
              this.Wc(0, this.getLinkPointFromPoint(a, b, g, e, !0, g)),
              (c = p.ka(Hp(c), new K())),
              this.Wc(1, this.getLinkPointFromPoint(f, p, c, d, !1, c));
          M.free(h);
        }
    } else {
      n = this.isAvoiding;
      p && ((m && n) || l) && this.hk();
      var B = l ? this.computeCurviness() : 0;
      n = this.getLinkPoint(a, b, g, !0, m, d, e);
      r = u = q = 0;
      if (m || !h || l)
        (w = this.computeEndSegmentLength(a, b, g, !0)),
          (r = this.getLinkDirection(a, b, n, g, !0, m, d, e)),
          l &&
            (h || g.D(c) || (!m && 1 === g.x + c.x && 1 === g.y + c.y)) &&
            ((r -= m ? 90 : 30), 0 > B && (r -= 180)),
          0 > r ? (r += 360) : 360 <= r && (r -= 360),
          l && (w += Math.abs(B) * (m ? 1 : 2)),
          0 === r
            ? (q = w)
            : 90 === r
            ? (u = w)
            : 180 === r
            ? (q = -w)
            : 270 === r
            ? (u = -w)
            : ((q = w * Math.cos((r * Math.PI) / 180)),
              (u = w * Math.sin((r * Math.PI) / 180))),
          g.ec() &&
            l &&
            ((w = b.ka(Kc, K.alloc())),
            (y = K.allocAt(w.x + 1e3 * q, w.y + 1e3 * u)),
            this.getLinkPointFromPoint(a, b, w, y, !0, n),
            K.free(w),
            K.free(y));
      w = this.getLinkPoint(d, e, c, !1, m, a, b);
      var C = (z = y = 0);
      if (m || !k || l) {
        var E = this.computeEndSegmentLength(d, e, c, !1);
        C = this.getLinkDirection(d, e, w, c, !1, m, a, b);
        l &&
          (k || g.D(c) || (!m && 1 === g.x + c.x && 1 === g.y + c.y)) &&
          ((C += m ? 0 : 30), 0 > B && (C += 180));
        0 > C ? (C += 360) : 360 <= C && (C -= 360);
        l && (E += Math.abs(B) * (m ? 1 : 2));
        0 === C
          ? (y = E)
          : 90 === C
          ? (z = E)
          : 180 === C
          ? (y = -E)
          : 270 === C
          ? (z = -E)
          : ((y = E * Math.cos((C * Math.PI) / 180)),
            (z = E * Math.sin((C * Math.PI) / 180)));
        c.ec() &&
          l &&
          ((c = e.ka(Kc, K.alloc())),
          (g = K.allocAt(c.x + 1e3 * y, c.y + 1e3 * z)),
          this.getLinkPointFromPoint(d, e, c, g, !1, w),
          K.free(c),
          K.free(g));
      }
      c = n;
      if (m || !h || l) c = new K(n.x + q, n.y + u);
      g = w;
      if (m || !k || l) g = new K(w.x + y, w.y + z);
      !p && !m && h && 3 < f && this.adjustPoints(0, n, f - 2, g)
        ? this.Wc(f - 1, w)
        : !p && !m && k && 3 < f && this.adjustPoints(1, c, f - 1, w)
        ? this.Wc(0, n)
        : !p && (m ? 6 <= f : 4 < f) && this.adjustPoints(1, c, f - 2, g)
        ? (this.Wc(0, n), this.Wc(f - 1, w))
        : (this.hk(),
          this.je(n),
          (m || !h || l) && this.je(c),
          m && this.addOrthoPoints(c, r, g, C, a, d),
          (m || !k || l) && this.je(g),
          this.je(w));
    }
    return !0;
  };
  function Ip(a, b) {
    Math.abs(b.x - a.x) > Math.abs(b.y - a.y)
      ? (b.x >= a.x ? (b.x = a.x + 9e9) : (b.x = a.x - 9e9), (b.y = a.y))
      : (b.y >= a.y ? (b.y = a.y + 9e9) : (b.y = a.y - 9e9), (b.x = a.x));
    return b;
  }
  R.prototype.getLinkPointFromPoint = function (a, b, c, d, e, f) {
    void 0 === f && (f = new K());
    if (null === a || null === b) return f.assign(c), f;
    a.isVisible() ||
      ((e = a.findVisibleNode()), null !== e && e !== a && (b = e.port));
    a = null;
    e = b.panel;
    null === e || e.oe() || (e = e.panel);
    if (null === e) {
      e = d.x;
      d = d.y;
      var g = c.x;
      c = c.y;
    } else {
      a = e.ke;
      e = 1 / (a.m11 * a.m22 - a.m12 * a.m21);
      g = a.m22 * e;
      var h = -a.m12 * e,
        k = -a.m21 * e,
        l = a.m11 * e,
        m = e * (a.m21 * a.dy - a.m22 * a.dx),
        n = e * (a.m12 * a.dx - a.m11 * a.dy);
      e = d.x * g + d.y * k + m;
      d = d.x * h + d.y * l + n;
      g = c.x * g + c.y * k + m;
      c = c.x * h + c.y * l + n;
    }
    b.sk(e, d, g, c, f);
    null !== a && f.transform(a);
    return f;
  };
  function Jp(a, b) {
    var c = b.$o;
    null === c && ((c = new Kp()), (c.port = b), (c.node = b.part), (b.$o = c));
    return Lp(c, a);
  }
  R.prototype.getLinkPoint = function (a, b, c, d, e, f, g, h) {
    void 0 === h && (h = new K());
    if (c.ib() && !Gp(c)) return b.ka(c, h), h;
    if (c.Uc()) {
      var k = Jp(this, b);
      if (null !== k) {
        h.assign(k.rq);
        if (e && this.routing === Mp) {
          var l = Jp(this, g);
          if (null !== l && k.im < l.im) {
            k = K.alloc();
            l = K.alloc();
            var m = new M(b.ka(Fc, k), b.ka(Pc, l)),
              n = this.computeSpot(!d, g);
            a = this.getLinkPoint(f, g, n, !d, e, a, b, l);
            (c.Lf(Rc) || c.Lf(Sc)) && a.y >= m.y && a.y <= m.y + m.height
              ? (h.y = a.y)
              : (c.Lf(Qc) || c.Lf(Tc)) &&
                a.x >= m.x &&
                a.x <= m.x + m.width &&
                (h.x = a.x);
            K.free(k);
            K.free(l);
          }
        }
        return h;
      }
    }
    c = b.ka(Hp(c), K.alloc());
    this.pointsCount > (e ? 6 : 2)
      ? ((g = d ? this.i(1) : this.i(this.pointsCount - 2)),
        e && (g = Ip(c, g.copy())))
      : ((k = this.computeSpot(!d, g)),
        (f = K.alloc()),
        (g = g.ka(Hp(k), f)),
        e && (g = Ip(c, g)),
        K.free(f));
    this.getLinkPointFromPoint(a, b, c, g, d, h);
    K.free(c);
    return h;
  };
  R.prototype.getLinkDirection = function (a, b, c, d, e, f, g, h) {
    a: if (d.ib())
      var k =
        d.x > d.y
          ? d.x > 1 - d.y
            ? 0
            : d.x < 1 - d.y
            ? 270
            : 315
          : d.x < d.y
          ? d.x > 1 - d.y
            ? 90
            : d.x < 1 - d.y
            ? 180
            : 135
          : 0.5 > d.x
          ? 225
          : 0.5 < d.x
          ? 45
          : 0;
    else {
      if (d.Uc() && ((k = Jp(this, b)), null !== k))
        switch (k.Gc) {
          case 1:
            k = 270;
            break a;
          case 2:
            k = 180;
            break a;
          default:
          case 4:
            k = 0;
            break a;
          case 8:
            k = 90;
            break a;
        }
      k = b.ka(Kc, K.alloc());
      this.pointsCount > (f ? 6 : 2)
        ? ((h = e ? this.i(1) : this.i(this.pointsCount - 2)),
          (h = f ? Ip(k, h.copy()) : c))
        : ((c = K.alloc()), (h = h.ka(Kc, c)), K.free(c));
      c =
        Math.abs(h.x - k.x) > Math.abs(h.y - k.y)
          ? h.x >= k.x
            ? 0
            : 180
          : h.y >= k.y
          ? 90
          : 270;
      K.free(k);
      k = c;
    }
    d.ec() && g.Pd(a) && ((k += 180), 360 <= k && (k -= 360));
    if (Gp(d)) return k;
    a = b.Ti();
    if (0 === a) return k;
    45 <= a && 135 > a
      ? (k += 90)
      : 135 <= a && 225 > a
      ? (k += 180)
      : 225 <= a && 315 > a && (k += 270);
    360 <= k && (k -= 360);
    return k;
  };
  R.prototype.computeEndSegmentLength = function (a, b, c, d) {
    if (null !== b && c.Uc() && ((a = Jp(this, b)), null !== a)) return a.nv;
    a = d ? this.fromEndSegmentLength : this.toEndSegmentLength;
    null !== b &&
      isNaN(a) &&
      (a = d ? b.fromEndSegmentLength : b.toEndSegmentLength);
    isNaN(a) && (a = 10);
    return a;
  };
  R.prototype.computeSpot = function (a, b) {
    void 0 === b && (b = null);
    a
      ? ((a = b ? b : this.fromPort),
        null === a
          ? (a = Kc)
          : ((b = this.fromSpot),
            b.Nb() && (b = a.fromSpot),
            (a = b === gd ? Ec : b)))
      : ((a = b ? b : this.toPort),
        null === a
          ? (a = Kc)
          : ((b = this.toSpot),
            b.Nb() && (b = a.toSpot),
            (a = b === gd ? Ec : b)));
    return a;
  };
  function Gp(a) {
    return a === Ec || (0.5 === a.x && 0.5 === a.y);
  }
  function Hp(a) {
    return 0.5 === a.x && 0.5 === a.y ? a : Kc;
  }
  R.prototype.computeOtherPoint = function (a, b) {
    if (this.computeAdjusting() !== hg && 4 < this.pointsCount)
      return this.computeMidPoint(new K());
    a = b.$o;
    a = null !== a ? Lp(a, this) : null;
    return null !== a ? a.rq : b.ka(Kc);
  };
  R.prototype.computeShortLength = function (a) {
    if (a) {
      a = this.fromShortLength;
      if (isNaN(a)) {
        var b = this.fromPort;
        null !== b && (a = b.fromShortLength);
      }
      return isNaN(a) ? 0 : a;
    }
    a = this.toShortLength;
    isNaN(a) && ((b = this.toPort), null !== b && (a = b.toShortLength));
    return isNaN(a) ? 0 : a;
  };
  R.prototype.Hf = function (a, b, c, d, e, f) {
    if (!1 === this.pickable) return !1;
    void 0 === b && (b = null);
    void 0 === c && (c = null);
    var g = f;
    void 0 === f && ((g = Kb.alloc()), g.reset());
    g.multiply(this.transform);
    if (this.Fh(a, g)) return un(this, b, c, e), void 0 === f && Kb.free(g), !0;
    if (this.Sc(a, g)) {
      var h = !1;
      if (!this.isAtomic)
        for (var k = this.W.m, l = k.length; l--; ) {
          var m = k[l];
          if (m.visible || m === this.locationObject) {
            var n = m.actualBounds,
              p = this.naturalBounds;
            if (
              !(
                n.x > p.width ||
                n.y > p.height ||
                0 > n.x + n.width ||
                0 > n.y + n.height
              )
            ) {
              n = Kb.alloc();
              n.set(g);
              if (m instanceof W) h = m.Hf(a, b, c, d, e, n);
              else if (this.path === m) {
                if (m instanceof Hf)
                  if (((h = a), (p = d), !1 === m.pickable)) h = !1;
                  else if ((n.multiply(m.transform), p))
                    b: {
                      var r = h,
                        q = n;
                      if (m.Fh(r, q)) h = !0;
                      else {
                        if (
                          void 0 === q &&
                          ((q = m.transform), r.Qe(m.actualBounds))
                        ) {
                          h = !0;
                          break b;
                        }
                        h = r.left;
                        p = r.right;
                        var u = r.top;
                        r = r.bottom;
                        var w = K.alloc(),
                          y = K.alloc(),
                          z = K.alloc(),
                          B = Kb.alloc();
                        B.set(q);
                        B.Hv(m.transform);
                        B.Ns();
                        y.x = p;
                        y.y = u;
                        y.transform(B);
                        w.x = h;
                        w.y = u;
                        w.transform(B);
                        q = !1;
                        On(m, w, y, z)
                          ? (q = !0)
                          : ((w.x = p),
                            (w.y = r),
                            w.transform(B),
                            On(m, w, y, z)
                              ? (q = !0)
                              : ((y.x = h),
                                (y.y = r),
                                y.transform(B),
                                On(m, w, y, z)
                                  ? (q = !0)
                                  : ((w.x = h),
                                    (w.y = u),
                                    w.transform(B),
                                    On(m, w, y, z) && (q = !0))));
                        Kb.free(B);
                        K.free(w);
                        K.free(y);
                        K.free(z);
                        h = q;
                      }
                    }
                  else h = m.Fh(h, n);
              } else h = ul(m, a, d, n);
              h &&
                ((p = m),
                null !== b && (p = b(m)),
                p && (null === c || c(p)) && e.add(p));
              Kb.free(n);
            }
          }
        }
      void 0 === f && Kb.free(g);
      return h || null !== this.background || null !== this.areaBackground;
    }
    void 0 === f && Kb.free(g);
    return !1;
  };
  R.prototype.computeCurve = function () {
    if (null === this.Yf) {
      var a = this.fromPort,
        b = this.isOrthogonal;
      this.Yf = null !== a && a === this.toPort && !b;
    }
    return this.Yf ? kg : this.curve;
  };
  R.prototype.computeCorner = function () {
    if (this.curve === kg) return 0;
    var a = this.corner;
    if (isNaN(a) || 0 > a) a = 10;
    return a;
  };
  R.prototype.findMidLabel = function () {
    for (var a = this.path, b = this.W.m, c = b.length, d = 0; d < c; d++) {
      var e = b[d];
      if (
        e !== a &&
        !e.isPanelMain &&
        (-Infinity === e.segmentIndex || isNaN(e.segmentIndex))
      )
        return e;
    }
    for (a = this.labelNodes; a.next(); )
      if (
        ((b = a.value), -Infinity === b.segmentIndex || isNaN(b.segmentIndex))
      )
        return b;
    return null;
  };
  R.prototype.computeSpacing = function () {
    if (!this.isVisible()) return 0;
    var a = Np;
    a = Math.max(a, this.computeThickness());
    var b = this.fromPort,
      c = this.toPort;
    if (null !== b && null !== c) {
      var d = this.findMidLabel();
      if (null !== d) {
        var e = d.naturalBounds,
          f = d.margin,
          g = isNaN(e.width) ? 30 : e.width * d.scale + f.left + f.right;
        e = isNaN(e.height) ? 14 : e.height * d.scale + f.top + f.bottom;
        d = d.segmentOrientation;
        d === gn || d === hn || d === yp
          ? (a = Math.max(a, e))
          : d === bn || d === cn || d === $m || d === an
          ? (a = Math.max(a, g))
          : ((b = (b.ka(Kc).Ya(c.ka(Kc)) / 180) * Math.PI),
            (a = Math.max(
              a,
              Math.abs(Math.sin(b) * g) + Math.abs(Math.cos(b) * e) + 1
            )));
        this.curve === kg && (a *= 1.333);
      }
    }
    return a;
  };
  R.prototype.arrangeBundledLinks = function (a, b) {
    if (b)
      for (b = 0; b < a.length; b++) {
        var c = a[b];
        c.computeAdjusting() === hg && c.ab();
      }
  };
  R.prototype.computeCurviness = function () {
    var a = this.curviness;
    if (isNaN(a)) {
      a = Op;
      var b = this.Uf;
      if (null !== b) {
        for (var c = Ma(), d = 0, e = b.links, f = 0; f < e.length; f++) {
          var g = e[f].computeSpacing();
          c.push(g);
          d += g;
        }
        d = -d / 2;
        for (f = 0; f < e.length; f++) {
          if (e[f] === this) {
            a = d + c[f] / 2;
            break;
          }
          d += c[f];
        }
        b.Ws === this.fromNode && (a = -a);
        Pa(c);
      }
    }
    return a;
  };
  R.prototype.computeThickness = function () {
    if (!this.isVisible()) return 0;
    var a = this.path;
    return null !== a ? Math.max(a.strokeWidth, 1) : 1;
  };
  R.prototype.hasCurviness = function () {
    return !isNaN(this.curviness) || null !== this.Uf;
  };
  R.prototype.adjustPoints = function (a, b, c, d) {
    var e = this.computeAdjusting();
    if (this.isOrthogonal) {
      if (e === wp) return !1;
      e === xp && (e = vp);
    }
    switch (e) {
      case wp:
        var f = this.i(a),
          g = this.i(c);
        if (!f.$a(b) || !g.$a(d)) {
          e = f.x;
          f = f.y;
          var h = g.x - e,
            k = g.y - f,
            l = Math.sqrt(h * h + k * k);
          if (!L.da(l, 0)) {
            if (L.da(h, 0)) var m = 0 > k ? -Math.PI / 2 : Math.PI / 2;
            else (m = Math.atan(k / Math.abs(h))), 0 > h && (m = Math.PI - m);
            g = b.x;
            var n = b.y;
            h = d.x - g;
            var p = d.y - n;
            k = Math.sqrt(h * h + p * p);
            L.da(h, 0)
              ? (p = 0 > p ? -Math.PI / 2 : Math.PI / 2)
              : ((p = Math.atan(p / Math.abs(h))), 0 > h && (p = Math.PI - p));
            l = k / l;
            m = p - m;
            this.Wc(a, b);
            for (a += 1; a < c; a++)
              (b = this.i(a)),
                (h = b.x - e),
                (k = b.y - f),
                (b = Math.sqrt(h * h + k * k)),
                L.da(b, 0) ||
                  (L.da(h, 0)
                    ? (k = 0 > k ? -Math.PI / 2 : Math.PI / 2)
                    : ((k = Math.atan(k / Math.abs(h))),
                      0 > h && (k = Math.PI - k)),
                  (h = k + m),
                  (b *= l),
                  this.P(a, g + b * Math.cos(h), n + b * Math.sin(h)));
            this.Wc(c, d);
          }
        }
        return !0;
      case xp:
        f = this.i(a);
        n = this.i(c);
        if (!f.$a(b) || !n.$a(d)) {
          e = f.x;
          f = f.y;
          g = n.x;
          n = n.y;
          l = (g - e) * (g - e) + (n - f) * (n - f);
          h = b.x;
          m = b.y;
          k = d.x;
          p = d.y;
          var r = 1;
          if (0 !== k - h) {
            var q = (p - m) / (k - h);
            r = Math.sqrt(1 + 1 / (q * q));
          } else q = 9e9;
          this.Wc(a, b);
          for (a += 1; a < c; a++) {
            b = this.i(a);
            var u = b.x,
              w = b.y,
              y = 0.5;
            0 !== l && (y = ((e - u) * (e - g) + (f - w) * (f - n)) / l);
            var z = e + y * (g - e),
              B = f + y * (n - f);
            b = Math.sqrt((u - z) * (u - z) + (w - B) * (w - B));
            w < q * (u - z) + B && (b = -b);
            0 < q && (b = -b);
            u = h + y * (k - h);
            y = m + y * (p - m);
            0 !== q
              ? ((b = u + b / r), this.P(a, b, y - (b - u) / q))
              : this.P(a, u, y + b);
          }
          this.Wc(c, d);
        }
        return !0;
      case vp:
        a: {
          if (
            this.isOrthogonal &&
            ((e = this.i(a)),
            (f = this.i(a + 1)),
            (g = this.i(a + 2)),
            (h = f.x),
            (m = f.y),
            (n = h),
            (l = m),
            L.C(e.y, f.y)
              ? L.C(f.x, g.x)
                ? (m = b.y)
                : L.C(f.y, g.y) && (h = b.x)
              : L.C(e.x, f.x) &&
                (L.C(f.y, g.y) ? (h = b.x) : L.C(f.x, g.x) && (m = b.y)),
            this.P(a + 1, h, m),
            (e = this.i(c)),
            (f = this.i(c - 1)),
            (g = this.i(c - 2)),
            (h = f.x),
            (m = f.y),
            (k = h),
            (p = m),
            L.C(e.y, f.y)
              ? L.C(f.x, g.x)
                ? (m = d.y)
                : L.C(f.y, g.y) && (h = d.x)
              : L.C(e.x, f.x) &&
                (L.C(f.y, g.y) ? (h = d.x) : L.C(f.x, g.x) && (m = d.y)),
            this.P(c - 1, h, m),
            Yj(this))
          ) {
            this.P(a + 1, n, l);
            this.P(c - 1, k, p);
            c = !1;
            break a;
          }
          this.Wc(a, b);
          this.Wc(c, d);
          c = !0;
        }
        return c;
      default:
        return !1;
    }
  };
  R.prototype.addOrthoPoints = function (a, b, c, d, e, f) {
    0 > b ? (b += 360) : 360 <= b && (b -= 360);
    0 > d ? (d += 360) : 360 <= d && (d -= 360);
    var g = d;
    b =
      315 <= b || 45 > b
        ? 0
        : 45 <= b && 135 > b
        ? 90
        : 135 <= b && 225 > b
        ? 180
        : 270;
    d =
      315 <= d || 45 > d
        ? 0
        : 45 <= d && 135 > d
        ? 90
        : 135 <= d && 225 > d
        ? 180
        : 270;
    var h = e.actualBounds.copy(),
      k = f.actualBounds.copy();
    if (h.s() && k.s()) {
      h.Qc(Pp, Pp);
      k.Qc(Pp, Pp);
      h.Ye(a);
      k.Ye(c);
      var l = K.alloc(),
        m = K.alloc();
      if (0 === b)
        if (
          c.x > a.x ||
          (270 === d && c.y < a.y && k.right > a.x) ||
          (90 === d && c.y > a.y && k.right > a.x)
        )
          l.h(c.x, a.y),
            m.h(c.x, (a.y + c.y) / 2),
            180 === d
              ? ((l.x = this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !1)),
                (m.x = l.x),
                (m.y = c.y))
              : (270 === d && c.y < a.y) || (90 === d && c.y > a.y)
              ? ((l.x =
                  a.x < k.left
                    ? this.computeMidOrthoPosition(a.x, a.y, k.left, c.y, !1)
                    : a.x < k.right &&
                      ((270 === d && a.y < k.top) ||
                        (90 === d && a.y > k.bottom))
                    ? this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !1)
                    : k.right),
                (m.x = l.x),
                (m.y = c.y))
              : 0 === d &&
                a.x < k.left &&
                a.y > k.top &&
                a.y < k.bottom &&
                ((l.x = a.x),
                (l.y =
                  a.y < c.y ? Math.min(c.y, k.top) : Math.max(c.y, k.bottom)),
                (m.y = l.y));
        else {
          l.h(a.x, c.y);
          m.h((a.x + c.x) / 2, c.y);
          if (
            180 === d ||
            (90 === d && c.y < h.top) ||
            (270 === d && c.y > h.bottom)
          )
            180 === d && (k.ca(a) || h.ca(c))
              ? (l.y = this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !0))
              : c.y < a.y && (180 === d || 90 === d)
              ? (l.y = this.computeMidOrthoPosition(
                  a.x,
                  h.top,
                  c.x,
                  Math.max(c.y, k.bottom),
                  !0
                ))
              : c.y > a.y &&
                (180 === d || 270 === d) &&
                (l.y = this.computeMidOrthoPosition(
                  a.x,
                  h.bottom,
                  c.x,
                  Math.min(c.y, k.top),
                  !0
                )),
              (m.x = c.x),
              (m.y = l.y);
          if (l.y > h.top && l.y < h.bottom)
            if (
              (c.x >= h.left && c.x <= a.x) ||
              (a.x <= k.right && a.x >= c.x)
            ) {
              if (90 === d || 270 === d)
                l.h(Math.max((a.x + c.x) / 2, a.x), a.y), m.h(l.x, c.y);
            } else
              (l.y =
                270 === d || ((0 === d || 180 === d) && c.y < a.y)
                  ? Math.min(c.y, 0 === d ? h.top : Math.min(h.top, k.top))
                  : Math.max(
                      c.y,
                      0 === d ? h.bottom : Math.max(h.bottom, k.bottom)
                    )),
                (m.x = c.x),
                (m.y = l.y);
        }
      else if (180 === b)
        if (
          c.x < a.x ||
          (270 === d && c.y < a.y && k.left < a.x) ||
          (90 === d && c.y > a.y && k.left < a.x)
        )
          l.h(c.x, a.y),
            m.h(c.x, (a.y + c.y) / 2),
            0 === d
              ? ((l.x = this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !1)),
                (m.x = l.x),
                (m.y = c.y))
              : (270 === d && c.y < a.y) || (90 === d && c.y > a.y)
              ? ((l.x =
                  a.x > k.right
                    ? this.computeMidOrthoPosition(a.x, a.y, k.right, c.y, !1)
                    : a.x > k.left &&
                      ((270 === d && a.y < k.top) ||
                        (90 === d && a.y > k.bottom))
                    ? this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !1)
                    : k.left),
                (m.x = l.x),
                (m.y = c.y))
              : 180 === d &&
                a.x > k.right &&
                a.y > k.top &&
                a.y < k.bottom &&
                ((l.x = a.x),
                (l.y =
                  a.y < c.y ? Math.min(c.y, k.top) : Math.max(c.y, k.bottom)),
                (m.y = l.y));
        else {
          l.h(a.x, c.y);
          m.h((a.x + c.x) / 2, c.y);
          if (
            0 === d ||
            (90 === d && c.y < h.top) ||
            (270 === d && c.y > h.bottom)
          )
            0 === d && (k.ca(a) || h.ca(c))
              ? (l.y = this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !0))
              : c.y < a.y && (0 === d || 90 === d)
              ? (l.y = this.computeMidOrthoPosition(
                  a.x,
                  h.top,
                  c.x,
                  Math.max(c.y, k.bottom),
                  !0
                ))
              : c.y > a.y &&
                (0 === d || 270 === d) &&
                (l.y = this.computeMidOrthoPosition(
                  a.x,
                  h.bottom,
                  c.x,
                  Math.min(c.y, k.top),
                  !0
                )),
              (m.x = c.x),
              (m.y = l.y);
          if (l.y > h.top && l.y < h.bottom)
            if (
              (c.x <= h.right && c.x >= a.x) ||
              (a.x >= k.left && a.x <= c.x)
            ) {
              if (90 === d || 270 === d)
                l.h(Math.min((a.x + c.x) / 2, a.x), a.y), m.h(l.x, c.y);
            } else
              (l.y =
                270 === d || ((0 === d || 180 === d) && c.y < a.y)
                  ? Math.min(c.y, 180 === d ? h.top : Math.min(h.top, k.top))
                  : Math.max(
                      c.y,
                      180 === d ? h.bottom : Math.max(h.bottom, k.bottom)
                    )),
                (m.x = c.x),
                (m.y = l.y);
        }
      else if (90 === b)
        if (
          c.y > a.y ||
          (180 === d && c.x < a.x && k.bottom > a.y) ||
          (0 === d && c.x > a.x && k.bottom > a.y)
        )
          l.h(a.x, c.y),
            m.h((a.x + c.x) / 2, c.y),
            270 === d
              ? ((l.y = this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !0)),
                (m.x = c.x),
                (m.y = l.y))
              : (180 === d && c.x < a.x) || (0 === d && c.x > a.x)
              ? ((l.y =
                  a.y < k.top
                    ? this.computeMidOrthoPosition(a.x, a.y, c.x, k.top, !0)
                    : a.y < k.bottom &&
                      ((180 === d && a.x < k.left) ||
                        (0 === d && a.x > k.right))
                    ? this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !0)
                    : k.bottom),
                (m.x = c.x),
                (m.y = l.y))
              : 90 === d &&
                a.y < k.top &&
                a.x > k.left &&
                a.x < k.right &&
                ((l.x =
                  a.x < c.x ? Math.min(c.x, k.left) : Math.max(c.x, k.right)),
                (l.y = a.y),
                (m.x = l.x));
        else {
          l.h(c.x, a.y);
          m.h(c.x, (a.y + c.y) / 2);
          if (
            270 === d ||
            (0 === d && c.x < h.left) ||
            (180 === d && c.x > h.right)
          )
            270 === d && (k.ca(a) || h.ca(c))
              ? (l.x = this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !1))
              : c.x < a.x && (270 === d || 0 === d)
              ? (l.x = this.computeMidOrthoPosition(
                  h.left,
                  a.y,
                  Math.max(c.x, k.right),
                  c.y,
                  !1
                ))
              : c.x > a.x &&
                (270 === d || 180 === d) &&
                (l.x = this.computeMidOrthoPosition(
                  h.right,
                  a.y,
                  Math.min(c.x, k.left),
                  c.y,
                  !1
                )),
              (m.x = l.x),
              (m.y = c.y);
          if (l.x > h.left && l.x < h.right)
            if (
              (c.y >= h.top && c.y <= a.y) ||
              (a.y <= k.bottom && a.y >= c.y)
            ) {
              if (0 === d || 180 === d)
                l.h(a.x, Math.max((a.y + c.y) / 2, a.y)), m.h(c.x, l.y);
            } else
              (l.x =
                180 === d || ((90 === d || 270 === d) && c.x < a.x)
                  ? Math.min(c.x, 90 === d ? h.left : Math.min(h.left, k.left))
                  : Math.max(
                      c.x,
                      90 === d ? h.right : Math.max(h.right, k.right)
                    )),
                (m.x = l.x),
                (m.y = c.y);
        }
      else if (
        c.y < a.y ||
        (180 === d && c.x < a.x && k.top < a.y) ||
        (0 === d && c.x > a.x && k.top < a.y)
      )
        l.h(a.x, c.y),
          m.h((a.x + c.x) / 2, c.y),
          90 === d
            ? ((l.y = this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !0)),
              (m.x = c.x),
              (m.y = l.y))
            : (180 === d && c.x < a.x) || (0 === d && c.x >= a.x)
            ? ((l.y =
                a.y > k.bottom
                  ? this.computeMidOrthoPosition(a.x, a.y, c.x, k.bottom, !0)
                  : a.y > k.top &&
                    ((180 === d && a.x < k.left) || (0 === d && a.x > k.right))
                  ? this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !0)
                  : k.top),
              (m.x = c.x),
              (m.y = l.y))
            : 270 === d &&
              a.y > k.bottom &&
              a.x > k.left &&
              a.x < k.right &&
              ((l.x =
                a.x < c.x ? Math.min(c.x, k.left) : Math.max(c.x, k.right)),
              (l.y = a.y),
              (m.x = l.x));
      else {
        l.h(c.x, a.y);
        m.h(c.x, (a.y + c.y) / 2);
        if (
          90 === d ||
          (0 === d && c.x < h.left) ||
          (180 === d && c.x > h.right)
        )
          90 === d && (k.ca(a) || h.ca(c))
            ? (l.x = this.computeMidOrthoPosition(a.x, a.y, c.x, c.y, !1))
            : c.x < a.x && (90 === d || 0 === d)
            ? (l.x = this.computeMidOrthoPosition(
                h.left,
                a.y,
                Math.max(c.x, k.right),
                c.y,
                !1
              ))
            : c.x > a.x &&
              (90 === d || 180 === d) &&
              (l.x = this.computeMidOrthoPosition(
                h.right,
                a.y,
                Math.min(c.x, k.left),
                c.y,
                !1
              )),
            (m.x = l.x),
            (m.y = c.y);
        if (l.x > h.left && l.x < h.right)
          if ((c.y <= h.bottom && c.y >= a.y) || (a.y >= k.top && a.y <= c.y)) {
            if (0 === d || 180 === d)
              l.h(a.x, Math.min((a.y + c.y) / 2, a.y)), m.h(c.x, l.y);
          } else
            (l.x =
              180 === d || ((90 === d || 270 === d) && c.x < a.x)
                ? Math.min(c.x, 270 === d ? h.left : Math.min(h.left, k.left))
                : Math.max(
                    c.x,
                    270 === d ? h.right : Math.max(h.right, k.right)
                  )),
              (m.x = l.x),
              (m.y = c.y);
      }
      var n = c;
      if (this.isAvoiding) {
        var p = this.diagram;
        if (
          null === p ||
          e === f ||
          this.layer.isTemporary ||
          !qk(p) ||
          (h.ca(n) && !f.Pd(e)) ||
          (k.ca(a) && !e.Pd(f))
        )
          b = !1;
        else {
          var r = rk(p, !0, this.containingGroup, null);
          if (
            17 !== this.segmentIndex &&
            r.wk(
              Math.min(a.x, l.x),
              Math.min(a.y, l.y),
              Math.abs(a.x - l.x),
              Math.abs(a.y - l.y)
            ) &&
            r.wk(
              Math.min(l.x, m.x),
              Math.min(l.y, m.y),
              Math.abs(l.x - m.x),
              Math.abs(l.y - m.y)
            ) &&
            r.wk(
              Math.min(m.x, n.x),
              Math.min(m.y, n.y),
              Math.abs(m.x - n.x),
              Math.abs(m.y - n.y)
            )
          )
            b = !1;
          else {
            e = a;
            f = n;
            var q = (c = null);
            if (p.isVirtualized) {
              p = r.bounds.copy();
              p.Qc(-r.Zp, -r.Yp);
              var u = K.alloc();
              Dk(r, a.x, a.y) ||
                (L.Kf(
                  p.x,
                  p.y,
                  p.x + p.width,
                  p.y + p.height,
                  a.x,
                  a.y,
                  l.x,
                  l.y,
                  u
                )
                  ? ((c = a = u.copy()), (b = u.Ya(l)))
                  : L.Kf(
                      p.x,
                      p.y,
                      p.x + p.width,
                      p.y + p.height,
                      l.x,
                      l.y,
                      m.x,
                      m.y,
                      u
                    )
                  ? ((c = a = u.copy()), (b = u.Ya(m)))
                  : L.Kf(
                      p.x,
                      p.y,
                      p.x + p.width,
                      p.y + p.height,
                      m.x,
                      m.y,
                      n.x,
                      n.y,
                      u
                    ) && ((c = a = u.copy()), (b = u.Ya(n))));
              Dk(r, n.x, n.y) ||
                (L.Kf(
                  p.x,
                  p.y,
                  p.x + p.width,
                  p.y + p.height,
                  n.x,
                  n.y,
                  m.x,
                  m.y,
                  u
                )
                  ? ((q = n = u.copy()), (d = m.Ya(u)))
                  : L.Kf(
                      p.x,
                      p.y,
                      p.x + p.width,
                      p.y + p.height,
                      m.x,
                      m.y,
                      l.x,
                      l.y,
                      u
                    )
                  ? ((q = n = u.copy()), (d = l.Ya(u)))
                  : L.Kf(
                      p.x,
                      p.y,
                      p.x + p.width,
                      p.y + p.height,
                      l.x,
                      l.y,
                      a.x,
                      a.y,
                      u
                    ) && ((q = n = u.copy()), (d = a.Ya(u))));
              K.free(u);
            }
            h = h.copy().Xc(k);
            h.Qc(r.Zp * r.ht, r.Yp * r.ht);
            Qp(r, a, b, n, d, h, !0);
            k = Rp(r, n.x, n.y);
            !r.abort &&
              k >= Sp &&
              (vk(r),
              h.Qc(r.Zp * r.ny, r.Yp * r.oy),
              Qp(r, a, b, n, d, h, !1),
              (k = Rp(r, n.x, n.y)));
            if (!r.abort && k < Sp && Rp(r, n.x, n.y) !== Hk) {
              Tp(this, r, n.x, n.y, d, !0, g);
              h = this.i(2);
              if (4 > this.pointsCount)
                0 === b || 180 === b
                  ? ((h.x = a.x), (h.y = n.y))
                  : ((h.x = n.x), (h.y = a.y)),
                  this.P(2, h.x, h.y),
                  this.l(3, h.x, h.y);
              else if (((g = this.i(3)), 0 === b || 180 === b))
                L.C(h.x, g.x)
                  ? ((h = 0 === b ? Math.max(h.x, a.x) : Math.min(h.x, a.x)),
                    this.P(2, h, a.y),
                    this.P(3, h, g.y))
                  : L.C(h.y, g.y)
                  ? (Math.abs(a.y - h.y) <= r.Yp / 2 &&
                      (this.P(2, h.x, a.y), this.P(3, g.x, a.y)),
                    this.l(2, h.x, a.y))
                  : this.P(2, a.x, h.y);
              else if (90 === b || 270 === b)
                L.C(h.y, g.y)
                  ? ((h = 90 === b ? Math.max(h.y, a.y) : Math.min(h.y, a.y)),
                    this.P(2, a.x, h),
                    this.P(3, g.x, h))
                  : L.C(h.x, g.x)
                  ? (Math.abs(a.x - h.x) <= r.Zp / 2 &&
                      (this.P(2, a.x, h.y), this.P(3, a.x, g.y)),
                    this.l(2, a.x, h.y))
                  : this.P(2, h.x, a.y);
              null !== c &&
                ((a = this.i(1)),
                (g = this.i(2)),
                a.x !== g.x && a.y !== g.y
                  ? 0 === b || 180 === b
                    ? this.l(2, a.x, g.y)
                    : this.l(2, g.x, a.y)
                  : 0 === b || 180 === b
                  ? this.l(2, e.x, c.y)
                  : this.l(2, c.x, e.y));
              null !== q &&
                (0 === d || 180 === d ? this.Bf(f.x, q.y) : this.Bf(q.x, f.y));
              b = !0;
            } else b = !1;
          }
        }
      } else b = !1;
      b || (this.je(l.copy()), this.je(m.copy()));
      K.free(l);
      K.free(m);
    }
  };
  R.prototype.computeMidOrthoPosition = function (a, b, c, d, e) {
    var f = 0;
    !this.hasCurviness() ||
      this.computeSpot(!0, this.fromPort).Uc() ||
      this.computeSpot(!1, this.toPort).Uc() ||
      (f = this.computeCurviness());
    return e ? (b + d) / 2 + f : (a + c) / 2 + f;
  };
  function Yj(a) {
    if (null === a.diagram || !a.isAvoiding || !qk(a.diagram)) return !1;
    var b = a.points.m,
      c = b.length;
    if (4 > c) return !1;
    a = rk(a.diagram, !0, a.containingGroup, null);
    for (var d = 1; d < c - 2; d++) {
      var e = b[d],
        f = b[d + 1];
      if (
        !a.wk(
          Math.min(e.x, f.x),
          Math.min(e.y, f.y),
          Math.abs(e.x - f.x),
          Math.abs(e.y - f.y)
        )
      )
        return !0;
    }
    return !1;
  }
  function Tp(a, b, c, d, e, f, g) {
    var h = b.Zp,
      k = b.Yp,
      l = Rp(b, c, d),
      m = c,
      n = d;
    0 === e ? (m += h) : 90 === e ? (n += k) : 180 === e ? (m -= h) : (n -= k);
    e !== g &&
      l > Up &&
      Rp(b, m, n) !== l - 1 &&
      (Rp(b, c - h, d) === l - 1
        ? ((e = 180), (m = c - h), (n = d))
        : Rp(b, c + h, d) === l - 1
        ? ((e = 0), (m = c + h), (n = d))
        : Rp(b, c, d - k) === l - 1
        ? ((e = 270), (m = c), (n = d - k))
        : Rp(b, c, d + k) === l - 1 && ((e = 90), (m = c), (n = d + k)));
    for (; l > Up && Rp(b, m, n) === l - 1; )
      (c = m),
        (d = n),
        0 === e
          ? (m += h)
          : 90 === e
          ? (n += k)
          : 180 === e
          ? (m -= h)
          : (n -= k),
        --l;
    if (f) {
      if (l > Up)
        if (180 === e || 0 === e) c = Math.floor(c / h) * h + h / 2;
        else if (90 === e || 270 === e) d = Math.floor(d / k) * k + k / 2;
    } else
      (c = Math.floor(c / h) * h + h / 2), (d = Math.floor(d / k) * k + k / 2);
    l > Up &&
      ((f = e),
      (g = c),
      (m = d),
      0 === e
        ? ((f = 90), (m += k))
        : 90 === e
        ? ((f = 180), (g -= h))
        : 180 === e
        ? ((f = 270), (m -= k))
        : 270 === e && ((f = 0), (g += h)),
      Rp(b, g, m) === l - 1
        ? Tp(a, b, g, m, f, !1, f)
        : ((g = c),
          (m = d),
          0 === e
            ? ((f = 270), (m -= k))
            : 90 === e
            ? ((f = 0), (g += h))
            : 180 === e
            ? ((f = 90), (m += k))
            : 270 === e && ((f = 180), (g -= h)),
          Rp(b, g, m) === l - 1 && Tp(a, b, g, m, f, !1, f)));
    a.Bf(c, d);
  }
  R.prototype.Pz = function (a) {
    G && x(a, K, R, "findClosestSegment:p");
    var b = a.x;
    a = a.y;
    for (
      var c = this.i(0),
        d = this.i(1),
        e = Mb(b, a, c.x, c.y, d.x, d.y),
        f = 0,
        g = 1;
      g < this.pointsCount - 1;
      g++
    ) {
      c = this.i(g + 1);
      var h = Mb(b, a, d.x, d.y, c.x, c.y);
      d = c;
      h < e && ((f = g), (e = h));
    }
    return f;
  };
  R.prototype.lc = function (a) {
    this.Om = !1;
    a && this.v();
  };
  R.prototype.yk = function (a) {
    if (!a) {
      if (!1 === this.Bd) return;
      a = this.vb();
      if (this.Om && (null === a || null !== a.geometry)) return;
    }
    this.ta = this.makeGeometry();
    a = this.path;
    if (null !== a) {
      a.ta = this.ta;
      for (var b = this.W.m, c = b.length, d = 0; d < c; d++) {
        var e = b[d];
        e !== a && e.isPanelMain && e instanceof Hf && (e.ta = this.ta);
      }
    }
  };
  R.prototype.makeGeometry = function () {
    var a = this.ta,
      b = this.pointsCount;
    if (2 > b) return (a.type = N.j), (this.Om = !0), a;
    var c = !1,
      d = this.diagram;
    null !== d &&
      zp(this) &&
      d.ei.contains(this) &&
      (0 !== this.Ol.width || 0 !== this.Ol.height) &&
      (c = !0);
    var e = this.i(0).copy(),
      f = e.copy();
    d = this.Jb.m;
    var g = this.computeCurve();
    if (g === kg && 3 <= b && !L.da(this.smoothness, 0))
      if (3 === b) {
        var h = this.i(1);
        d = Math.min(e.x, h.x);
        var k = Math.min(e.y, h.y);
        h = this.i(2);
        d = Math.min(d, h.x);
        k = Math.min(k, h.y);
      } else {
        if (this.isOrthogonal)
          for (k = 0; k < b; k++)
            (h = d[k]), (f.x = Math.min(h.x, f.x)), (f.y = Math.min(h.y, f.y));
        else
          for (d = 3; d < b; d += 3)
            d + 3 >= b && (d = b - 1),
              (k = this.i(d)),
              (f.x = Math.min(k.x, f.x)),
              (f.y = Math.min(k.y, f.y));
        d = f.x;
        k = f.y;
      }
    else {
      for (k = 0; k < b; k++)
        (h = d[k]), (f.x = Math.min(h.x, f.x)), (f.y = Math.min(h.y, f.y));
      d = f.x;
      k = f.y;
    }
    d -= this.Qu.x;
    k -= this.Qu.y;
    e.x -= d;
    e.y -= k;
    if (2 !== b || zp(this)) {
      a.type = N.o;
      h = Id(a);
      0 !== this.computeShortLength(!0) && (e = Vp(this, e, !0, f));
      Jd(h, e.x, e.y, !1);
      if (g === kg && 3 <= b && !L.da(this.smoothness, 0))
        if (3 === b)
          (c = this.i(1)),
            (b = c.x - d),
            (c = c.y - k),
            (e = this.i(2).copy()),
            (e.x -= d),
            (e.y -= k),
            0 !== this.computeShortLength(!1) && (e = Vp(this, e, !1, f)),
            Kd(h, b, c, b, c, e.x, e.y);
        else if (this.isOrthogonal) {
          b = K.allocAt(d, k);
          c = K.alloc();
          c.assign(this.i(1));
          f = K.allocAt(d, k);
          e = K.allocAt(d, k);
          g = this.i(0);
          for (
            var l, m = this.smoothness / 3, n = 1;
            n < this.pointsCount - 1;
            n++
          ) {
            l = this.i(n);
            var p = g,
              r = l,
              q = this.i(Wp(this, l, n, !1));
            if (!L.da(p.x, r.x) || !L.da(r.x, q.x))
              if (!L.da(p.y, r.y) || !L.da(r.y, q.y)) {
                var u = m;
                isNaN(u) && (u = this.smoothness / 3);
                var w = p.x;
                p = p.y;
                var y = r.x;
                r = r.y;
                var z = q.x;
                q = q.y;
                var B = u * Xp(w, p, y, r);
                u *= Xp(y, r, z, q);
                L.da(p, r) &&
                  L.da(y, z) &&
                  (y > w
                    ? q > r
                      ? ((f.x = y - B),
                        (f.y = r - B),
                        (e.x = y + u),
                        (e.y = r + u))
                      : ((f.x = y - B),
                        (f.y = r + B),
                        (e.x = y + u),
                        (e.y = r - u))
                    : q > r
                    ? ((f.x = y + B),
                      (f.y = r - B),
                      (e.x = y - u),
                      (e.y = r + u))
                    : ((f.x = y + B),
                      (f.y = r + B),
                      (e.x = y - u),
                      (e.y = r - u)));
                L.da(w, y) &&
                  L.da(r, q) &&
                  (r > p
                    ? (z > y
                        ? ((f.x = y - B), (f.y = r - B), (e.x = y + u))
                        : ((f.x = y + B), (f.y = r - B), (e.x = y - u)),
                      (e.y = r + u))
                    : (z > y
                        ? ((f.x = y - B), (f.y = r + B), (e.x = y + u))
                        : ((f.x = y + B), (f.y = r + B), (e.x = y - u)),
                      (e.y = r - u)));
                if ((L.da(w, y) && L.da(y, z)) || (L.da(p, r) && L.da(r, q)))
                  (w = 0.5 * (w + z)),
                    (p = 0.5 * (p + q)),
                    (f.x = w),
                    (f.y = p),
                    (e.x = w),
                    (e.y = p);
                1 === n
                  ? ((c.x = 0.5 * (g.x + l.x)), (c.y = 0.5 * (g.y + l.y)))
                  : 2 === n &&
                    L.da(g.x, this.i(0).x) &&
                    L.da(g.y, this.i(0).y) &&
                    ((c.x = 0.5 * (g.x + l.x)), (c.y = 0.5 * (g.y + l.y)));
                Kd(h, c.x - d, c.y - k, f.x - d, f.y - k, l.x - d, l.y - k);
                b.set(f);
                c.set(e);
                g = l;
              }
          }
          l = g.x;
          g = g.y;
          m = this.i(this.pointsCount - 1);
          0 !== this.computeShortLength(!1) && (m = Vp(this, m.copy(), !1, yb));
          l = 0.5 * (l + m.x);
          g = 0.5 * (g + m.y);
          Kd(h, e.x - d, e.y - k, l - d, g - k, m.x - d, m.y - k);
          K.free(b);
          K.free(c);
          K.free(f);
          K.free(e);
        } else
          for (c = 3; c < b; c += 3)
            (f = this.i(c - 2)),
              c + 3 >= b && (c = b - 1),
              (e = this.i(c - 1)),
              (g = this.i(c)),
              c === b - 1 &&
                0 !== this.computeShortLength(!1) &&
                (g = Vp(this, g.copy(), !1, yb)),
              Kd(h, f.x - d, f.y - k, e.x - d, e.y - k, g.x - d, g.y - k);
      else {
        f = K.alloc();
        f.assign(this.i(0));
        e = K.alloc();
        e.assign(f);
        g = this.computeCorner();
        n = 1;
        for (l = 0; n < b; ) {
          n = Wp(this, f, n, 1 < n);
          m = this.i(n);
          if (n >= b - 1) {
            if (!f.D(m))
              0 !== this.computeShortLength(!1) &&
                (m = Vp(this, m.copy(), !1, yb)),
                Yp(this, h, -d, -k, f, m, c);
            else if (0 === l)
              for (n = 1; n < b; )
                e.assign(f),
                  (m = this.i(n++)),
                  Yp(this, h, -d, -k, f, m, c),
                  f.assign(m);
            break;
          }
          l = Wp(this, m, n + 1, n < b - 3);
          n = -d;
          w = -k;
          p = m;
          y = this.i(l);
          u = c;
          if (L.C(f.y, p.y) && L.C(p.x, y.x))
            if (
              ((q = Math.min(g, Math.abs(p.x - e.x) / 2)),
              (q = B = Math.min(q, Math.abs(y.y - p.y) / 2)),
              L.C(q, 0))
            )
              Yp(this, h, n, w, f, p, u), f.assign(p);
            else {
              var C = p.x,
                E = p.y;
              r = C;
              z = E;
              p.x > f.x ? (C = p.x - q) : (C = p.x + q);
              y.y > p.y ? (z = p.y + B) : (z = p.y - B);
              y = K.allocAt(C, E);
              Yp(this, h, n, w, f, y, u);
              K.free(y);
              Ld(h, p.x + n, p.y + w, r + n, z + w);
              f.h(r, z);
            }
          else
            L.C(f.x, p.x) && L.C(p.y, y.y)
              ? ((q = Math.min(g, Math.abs(p.y - e.y) / 2)),
                (q = B = Math.min(q, Math.abs(y.x - p.x) / 2)),
                L.C(B, 0)
                  ? (Yp(this, h, n, w, f, p, u), f.assign(p))
                  : ((C = p.x),
                    (E = p.y),
                    (r = C),
                    (z = E),
                    p.y > f.y ? (E = p.y - q) : (E = p.y + q),
                    y.x > p.x ? (r = p.x + B) : (r = p.x - B),
                    (y = K.allocAt(C, E)),
                    Yp(this, h, n, w, f, y, u),
                    K.free(y),
                    Ld(h, p.x + n, p.y + w, r + n, z + w),
                    f.h(r, z)))
              : (Yp(this, h, n, w, f, p, u), f.assign(p));
          e.assign(m);
          n = l;
        }
        K.free(f);
      }
      Qd = h;
    } else
      (h = this.i(1).copy()),
        (h.x -= d),
        (h.y -= k),
        0 !== this.computeShortLength(!0) && (e = Vp(this, e, !0, f)),
        0 !== this.computeShortLength(!1) && (h = Vp(this, h, !1, f)),
        (a.type = N.j),
        (a.startX = e.x),
        (a.startY = e.y),
        (a.endX = h.x),
        (a.endY = h.y);
    this.Om = !0;
    return a;
  };
  function Xp(a, b, c, d) {
    a = c - a;
    if (isNaN(a) || Infinity === a || -Infinity === a) return NaN;
    0 > a && (a = -a);
    b = d - b;
    if (isNaN(b) || Infinity === b || -Infinity === b) return NaN;
    0 > b && (b = -b);
    return L.da(a, 0) ? b : L.da(b, 0) ? a : Math.sqrt(a * a + b * b);
  }
  function Vp(a, b, c, d) {
    var e = a.pointsCount;
    if (2 > e) return b;
    if (c) {
      var f = a.i(1);
      c = f.x - d.x;
      f = f.y - d.y;
      d = Xp(b.x, b.y, c, f);
      if (0 === d) return b;
      e = 2 === e ? 0.5 * d : d;
      a = a.computeShortLength(!0);
      a > e && (a = e);
      e = (a * (f - b.y)) / d;
      b.x += (a * (c - b.x)) / d;
      b.y += e;
    } else {
      f = a.i(e - 2);
      c = f.x - d.x;
      f = f.y - d.y;
      d = Xp(b.x, b.y, c, f);
      if (0 === d) return b;
      e = 2 === e ? 0.5 * d : d;
      a = a.computeShortLength(!1);
      a > e && (a = e);
      e = (a * (b.y - f)) / d;
      b.x -= (a * (b.x - c)) / d;
      b.y -= e;
    }
    return b;
  }
  function Wp(a, b, c, d) {
    for (var e = a.pointsCount, f = b; L.da(b.x, f.x) && L.da(b.y, f.y); ) {
      if (c >= e) return e - 1;
      f = a.i(c++);
    }
    if (!L.da(b.x, f.x) && !L.da(b.y, f.y)) return c - 1;
    for (
      var g = f;
      (L.da(b.x, f.x) &&
        L.da(f.x, g.x) &&
        (!d || (b.y >= f.y ? f.y >= g.y : f.y <= g.y))) ||
      (L.da(b.y, f.y) &&
        L.da(f.y, g.y) &&
        (!d || (b.x >= f.x ? f.x >= g.x : f.x <= g.x)));

    ) {
      if (c >= e) return e - 1;
      g = a.i(c++);
    }
    return c - 2;
  }
  R.prototype.computeJumpLength = function () {
    return 10;
  };
  function Yp(a, b, c, d, e, f, g) {
    if (!g && zp(a)) {
      g = a.computeJumpLength();
      var h = g / 2,
        k = [],
        l = 0;
      a.isVisible() && (l = Zp(a, e, f, k));
      if (0 < l)
        if (L.C(e.y, f.y))
          if (e.x < f.x)
            for (var m = 0; m < l; ) {
              var n = Math.max(e.x, Math.min(k[m++] - h, f.x - g));
              b.lineTo(n + c, f.y + d);
              var p = n + c;
              for (var r = Math.min(n + g, f.x); m < l; )
                if (((n = k[m]), n < r + g)) m++, (r = Math.min(n + h, f.x));
                else break;
              n = f.y - g + d;
              r += c;
              var q = f.y + d;
              a.curve === gg ? Jd(b, r, q, !1) : Kd(b, p, n, r, n, r, q);
            }
          else
            for (--l; 0 <= l; ) {
              m = Math.min(e.x, Math.max(k[l--] + h, f.x + g));
              b.lineTo(m + c, f.y + d);
              p = m + c;
              for (n = Math.max(m - g, f.x); 0 <= l; )
                if (((m = k[l]), m > n - g)) l--, (n = Math.max(m - h, f.x));
                else break;
              m = f.y - g + d;
              n += c;
              r = f.y + d;
              a.curve === gg ? Jd(b, n, r, !1) : Kd(b, p, m, n, m, n, r);
            }
        else if (L.C(e.x, f.x))
          if (e.y < f.y)
            for (m = 0; m < l; ) {
              n = Math.max(e.y, Math.min(k[m++] - h, f.y - g));
              b.lineTo(f.x + c, n + d);
              p = n + d;
              for (n = Math.min(n + g, f.y); m < l; )
                if (((r = k[m]), r < n + g)) m++, (n = Math.min(r + h, f.y));
                else break;
              r = f.x - g + c;
              q = f.x + c;
              n += d;
              a.curve === gg ? Jd(b, q, n, !1) : Kd(b, r, p, r, n, q, n);
            }
          else
            for (--l; 0 <= l; ) {
              m = Math.min(e.y, Math.max(k[l--] + h, f.y + g));
              b.lineTo(f.x + c, m + d);
              p = m + d;
              for (m = Math.max(m - g, f.y); 0 <= l; )
                if (((n = k[l]), n > m - g)) l--, (m = Math.max(n - h, f.y));
                else break;
              n = f.x - g + c;
              r = f.x + c;
              m += d;
              a.curve === gg ? Jd(b, r, m, !1) : Kd(b, n, p, n, m, r, m);
            }
    }
    b.lineTo(f.x + c, f.y + d);
  }
  function Zp(a, b, c, d) {
    var e = a.diagram;
    if (null === e || b.D(c)) return 0;
    for (e = e.layers; e.next(); ) {
      var f = e.value;
      if (null !== f && f.visible) {
        f = f.Ma.m;
        for (var g = f.length, h = 0; h < g; h++) {
          var k = f[h];
          if (k instanceof R) {
            if (k === a)
              return (
                0 < d.length &&
                  d.sort(function (a, b) {
                    return a - b;
                  }),
                d.length
              );
            if (k.isVisible() && zp(k)) {
              var l = k.routeBounds;
              l.s() &&
                a.routeBounds.Sc(l) &&
                !a.usesSamePort(k) &&
                ((l = k.path), null !== l && l.Nf() && $p(b, c, d, k));
            }
          }
        }
      }
    }
    0 < d.length &&
      d.sort(function (a, b) {
        return a - b;
      });
    return d.length;
  }
  function $p(a, b, c, d) {
    for (
      var e = L.C(a.y, b.y),
        f = d.pointsCount,
        g = d.i(0),
        h = K.alloc(),
        k = 1;
      k < f;
      k++
    ) {
      var l = d.i(k);
      if (k < f - 1) {
        var m = d.i(k + 1);
        if (g.y === l.y && l.y === m.y) {
          if ((l.x > g.x && m.x >= l.x) || (l.x < g.x && m.x <= l.x)) continue;
        } else if (
          g.x === l.x &&
          l.x === m.x &&
          ((l.y > g.y && m.y >= l.y) || (l.y < g.y && m.y <= l.y))
        )
          continue;
      }
      a: {
        m = a.x;
        var n = a.y,
          p = b.x,
          r = b.y,
          q = g.x;
        g = g.y;
        var u = l.x,
          w = l.y;
        if (!L.C(m, p)) {
          if (
            L.C(n, r) &&
            L.C(q, u) &&
            Math.min(m, p) < q &&
            Math.max(m, p) > q &&
            Math.min(g, w) < n &&
            Math.max(g, w) > n &&
            !L.C(g, w)
          ) {
            h.x = q;
            h.y = n;
            m = !0;
            break a;
          }
        } else if (
          !L.C(n, r) &&
          L.C(g, w) &&
          Math.min(n, r) < g &&
          Math.max(n, r) > g &&
          Math.min(q, u) < m &&
          Math.max(q, u) > m &&
          !L.C(q, u)
        ) {
          h.x = m;
          h.y = g;
          m = !0;
          break a;
        }
        h.x = 0;
        h.y = 0;
        m = !1;
      }
      m && (e ? c.push(h.x) : c.push(h.y));
      g = l;
    }
    K.free(h);
  }
  function zp(a) {
    a = a.curve;
    return a === fg || a === gg;
  }
  function Dp(a, b) {
    if (b || zp(a))
      (b = a.diagram),
        null === b ||
          b.animationManager.isTicking ||
          b.ei.contains(a) ||
          (0 === a.Ol.width && 0 === a.Ol.height) ||
          b.ei.add(a, a.Ol.copy());
  }
  R.prototype.oq = function (a) {
    var b = this.layer;
    if (null !== b && b.visible && !b.isTemporary) {
      var c = b.diagram;
      if (null !== c && !c.animationManager.isTicking) {
        var d = !1;
        for (c = c.layers; c.next(); ) {
          var e = c.value;
          if (e.visible)
            if (e === b) {
              d = !0;
              var f = !1;
              e = e.Ma.m;
              for (var g = e.length, h = 0; h < g; h++) {
                var k = e[h];
                k instanceof R && (k === this ? (f = !0) : f && aq(this, k, a));
              }
            } else if (d)
              for (f = e.Ma.m, e = f.length, g = 0; g < e; g++)
                (h = f[g]), h instanceof R && aq(this, h, a);
        }
      }
    }
  };
  function aq(a, b, c) {
    if (null !== b && b.Om && b.Bd && zp(b)) {
      var d = b.routeBounds;
      d.s() &&
        (a.routeBounds.Sc(d) || c.Sc(d)) &&
        (a.usesSamePort(b) || b.lc(!1));
    }
  }
  R.prototype.usesSamePort = function (a) {
    var b = this.pointsCount,
      c = a.pointsCount;
    if (0 < b && 0 < c) {
      var d = this.i(0),
        e = a.i(0);
      if (d.$a(e)) return !0;
      b = this.i(b - 1);
      a = a.i(c - 1);
      if (b.$a(a) || d.$a(a) || b.$a(e)) return !0;
    } else if (
      this.fromNode === a.fromNode ||
      this.toNode === a.toNode ||
      this.fromNode === a.toNode ||
      this.toNode === a.fromNode
    )
      return !0;
    return !1;
  };
  R.prototype.isVisible = function () {
    if (!U.prototype.isVisible.call(this)) return !1;
    var a = this.containingGroup,
      b = !0,
      c = this.diagram;
    null !== c && (b = c.isTreePathToChildren);
    c = this.fromNode;
    if (null !== c) {
      if (this.isTreeLink && b && !c.isTreeExpanded) return !1;
      if (c === a) return !0;
      for (var d = c; null !== d; ) {
        if (d.labeledLink === this) return !0;
        d = d.containingGroup;
      }
      c = c.findVisibleNode();
      if (null === c || c === a) return !1;
    }
    c = this.toNode;
    if (null !== c) {
      if (this.isTreeLink && !b && !c.isTreeExpanded) return !1;
      if (c === a) return !0;
      for (b = c; null !== b; ) {
        if (b.labeledLink === this) return !0;
        b = b.containingGroup;
      }
      b = c.findVisibleNode();
      if (null === b || b === a) return !1;
    }
    return !0;
  };
  R.prototype.Vb = function (a) {
    U.prototype.Vb.call(this, a);
    null !== this.Uf && this.Uf.pm();
    if (null !== this.vd)
      for (var b = this.vd.iterator; b.next(); ) b.value.Vb(a);
  };
  R.prototype.computeAdjusting = function () {
    return this.isAvoiding &&
      null !== this.diagram &&
      this.diagram.animationManager.defaultAnimation.isAnimating
      ? vp
      : this.Mk;
  };
  function Ap(a) {
    var b = a.df;
    if (null !== b) {
      var c = a.xf;
      if (null !== c && isNaN(a.curviness)) {
        for (
          var d = a.ef,
            e = a.yf,
            f = (a = null),
            g = b.lb.m,
            h = g.length,
            k = 0;
          k < h;
          k++
        ) {
          var l = g[k];
          if (
            (l.df === b && l.ef === d && l.xf === c && l.yf === e) ||
            (l.df === c && l.ef === e && l.xf === b && l.yf === d)
          )
            null === f
              ? (f = l)
              : (null === a && ((a = []), a.push(f)), a.push(l));
        }
        if (null !== a) {
          f = fp(b, c, d, e);
          null === f && ((f = new bq(b, d, c, e)), ep(b, f), ep(c, f));
          f.links = a;
          for (b = 0; b < a.length; b++) a[b].Uf = f;
          f.pm();
        }
      }
    }
  }
  function Bp(a) {
    var b = a.Uf;
    null !== b &&
      isNaN(a.curviness) &&
      ((a.Uf = null),
      (a = b.links.indexOf(a)),
      0 <= a && (La(b.links, a), b.pm()));
  }
  R.prototype.Mh = function () {
    return !0;
  };
  oa.Object.defineProperties(R.prototype, {
    fromNode: {
      configurable: !0,
      get: function () {
        return this.df;
      },
      set: function (a) {
        var b = this.df;
        if (b !== a) {
          G && null !== a && x(a, V, R, "fromNode");
          var c = this.fromPort;
          null !== b && (this.xf !== b && jp(b, this, c), Bp(this), this.F(2));
          this.df = a;
          null !== a && this.Vb(a.isVisible());
          this.Yf = null;
          this.ab();
          var d = this.diagram;
          null !== d && d.ba && d.partManager.setFromNodeForLink(this, a, b);
          var e = this.fromPort,
            f = this.fromPortChanged;
          if (null !== f) {
            var g = !0;
            null !== d && ((g = d.ba), (d.ba = !0));
            f(this, c, e);
            null !== d && (d.ba = g);
          }
          null !== a && (this.xf !== a && ip(a, this, e), Ap(this), this.F(1));
          this.g("fromNode", b, a);
          cp(this);
        }
      },
    },
    fromPortId: {
      configurable: !0,
      get: function () {
        return this.ef;
      },
      set: function (a) {
        var b = this.ef;
        if (b !== a) {
          G && A(a, "string", R, "fromPortId");
          var c = this.fromPort;
          null !== c && gp(c);
          Bp(this);
          this.ef = a;
          var d = this.fromPort;
          null !== d && gp(d);
          var e = this.diagram;
          if (null !== e) {
            var f = this.data,
              g = e.model;
            null !== f && g.Zi() && g.Xv(f, a);
          }
          c !== d &&
            ((this.Yf = null),
            this.ab(),
            (f = this.fromPortChanged),
            null !== f &&
              ((g = !0),
              null !== e && ((g = e.ba), (e.ba = !0)),
              f(this, c, d),
              null !== e && (e.ba = g)));
          Ap(this);
          this.g("fromPortId", b, a);
        }
      },
    },
    fromPort: {
      configurable: !0,
      get: function () {
        var a = this.df;
        return null === a ? null : a.Es(this.ef);
      },
    },
    fromPortChanged: {
      configurable: !0,
      get: function () {
        return this.On;
      },
      set: function (a) {
        var b = this.On;
        b !== a &&
          (null !== a && A(a, "function", R, "fromPortChanged"),
          (this.On = a),
          this.g("fromPortChanged", b, a));
      },
    },
    toNode: {
      configurable: !0,
      get: function () {
        return this.xf;
      },
      set: function (a) {
        var b = this.xf;
        if (b !== a) {
          G && null !== a && x(a, V, R, "toNode");
          var c = this.toPort;
          null !== b && (this.df !== b && jp(b, this, c), Bp(this), this.F(2));
          this.xf = a;
          null !== a && this.Vb(a.isVisible());
          this.Yf = null;
          this.ab();
          var d = this.diagram;
          null !== d && d.ba && d.partManager.setToNodeForLink(this, a, b);
          var e = this.toPort,
            f = this.toPortChanged;
          if (null !== f) {
            var g = !0;
            null !== d && ((g = d.ba), (d.ba = !0));
            f(this, c, e);
            null !== d && (d.ba = g);
          }
          null !== a && (this.df !== a && ip(a, this, e), Ap(this), this.F(1));
          this.g("toNode", b, a);
          cp(this);
        }
      },
    },
    toPortId: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.yf;
      },
      set: function (a) {
        var b = this.yf;
        if (b !== a) {
          G && A(a, "string", R, "toPortId");
          var c = this.toPort;
          null !== c && gp(c);
          Bp(this);
          this.yf = a;
          var d = this.toPort;
          null !== d && gp(d);
          var e = this.diagram;
          if (null !== e) {
            var f = this.data,
              g = e.model;
            null !== f && g.Zi() && g.aw(f, a);
          }
          c !== d &&
            ((this.Yf = null),
            this.ab(),
            (f = this.toPortChanged),
            null !== f &&
              ((g = !0),
              null !== e && ((g = e.ba), (e.ba = !0)),
              f(this, c, d),
              null !== e && (e.ba = g)));
          Ap(this);
          this.g("toPortId", b, a);
        }
      },
    },
    toPort: {
      configurable: !0,
      get: function () {
        var a = this.xf;
        return null === a ? null : a.Es(this.yf);
      },
    },
    toPortChanged: {
      configurable: !0,
      get: function () {
        return this.Lp;
      },
      set: function (a) {
        var b = this.Lp;
        b !== a &&
          (null !== a && A(a, "function", R, "toPortChanged"),
          (this.Lp = a),
          this.g("toPortChanged", b, a));
      },
    },
    fromSpot: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.Ug : gd;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.Ug;
        b.D(a) ||
          (G && x(a, Ib, R, "fromSpot"),
          (a = a.L()),
          (this.T.Ug = a),
          this.g("fromSpot", b, a),
          (b.Uc() || a.Uc()) && null !== this.fromNode && gp(this.fromPort),
          this.ab());
      },
    },
    fromEndSegmentLength: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.Sg : NaN;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.Sg;
        b !== a &&
          (G && A(a, "number", R, "fromEndSegmentLength"),
          0 > a && Aa(a, ">= 0", R, "fromEndSegmentLength"),
          (this.T.Sg = a),
          this.g("fromEndSegmentLength", b, a),
          this.ab());
      },
    },
    fromShortLength: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.Tg : NaN;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.Tg;
        b !== a &&
          (G && A(a, "number", R, "fromShortLength"),
          (this.T.Tg = a),
          this.lc(!0),
          this.g("fromShortLength", b, a));
      },
    },
    toSpot: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.yh : gd;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.yh;
        b.D(a) ||
          (G && x(a, Ib, R, "toSpot"),
          (a = a.L()),
          (this.T.yh = a),
          this.g("toSpot", b, a),
          (b.Uc() || a.Uc()) && null !== this.toNode && gp(this.toPort),
          this.ab());
      },
    },
    toEndSegmentLength: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.wh : NaN;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.wh;
        b !== a &&
          (G && A(a, "number", R, "toEndSegmentLength"),
          0 > a && Aa(a, ">= 0", R, "toEndSegmentLength"),
          (this.T.wh = a),
          this.g("toEndSegmentLength", b, a),
          this.ab());
      },
    },
    toShortLength: {
      configurable: !0,
      get: function () {
        return null !== this.T ? this.T.xh : NaN;
      },
      set: function (a) {
        this.Rc();
        var b = this.T.xh;
        b !== a &&
          (G && A(a, "number", R, "toShortLength"),
          (this.T.xh = a),
          this.lc(!0),
          this.g("toShortLength", b, a));
      },
    },
    isLabeledLink: {
      configurable: !0,
      get: function () {
        return null === this.vd ? !1 : 0 < this.vd.count;
      },
    },
    labelNodes: {
      configurable: !0,
      get: function () {
        return null === this.vd ? hb : this.vd.iterator;
      },
    },
    relinkableFrom: {
      configurable: !0,
      get: function () {
        return 0 !== (this.Oa & 1);
      },
      set: function (a) {
        var b = 0 !== (this.Oa & 1);
        b !== a &&
          (G && A(a, "boolean", R, "relinkableFrom"),
          (this.Oa ^= 1),
          this.g("relinkableFrom", b, a),
          this.Tb());
      },
    },
    relinkableTo: {
      configurable: !0,
      get: function () {
        return 0 !== (this.Oa & 2);
      },
      set: function (a) {
        var b = 0 !== (this.Oa & 2);
        b !== a &&
          (G && A(a, "boolean", R, "relinkableTo"),
          (this.Oa ^= 2),
          this.g("relinkableTo", b, a),
          this.Tb());
      },
    },
    resegmentable: {
      configurable: !0,
      get: function () {
        return 0 !== (this.Oa & 4);
      },
      set: function (a) {
        var b = 0 !== (this.Oa & 4);
        b !== a &&
          (G && A(a, "boolean", R, "resegmentable"),
          (this.Oa ^= 4),
          this.g("resegmentable", b, a),
          this.Tb());
      },
    },
    isTreeLink: {
      configurable: !0,
      get: function () {
        return 0 !== (this.Oa & 8);
      },
      set: function (a) {
        var b = 0 !== (this.Oa & 8);
        b !== a &&
          (G && A(a, "boolean", R, "isTreeLink"),
          (this.Oa ^= 8),
          this.g("isTreeLink", b, a),
          null !== this.fromNode && Pk(this.fromNode),
          null !== this.toNode && Pk(this.toNode));
      },
    },
    path: {
      configurable: !0,
      get: function () {
        var a = this.vb();
        return a instanceof Hf ? a : null;
      },
    },
    routeBounds: {
      configurable: !0,
      get: function () {
        this.Ag();
        var a = this.Ol,
          b = Infinity,
          c = Infinity,
          d = this.pointsCount;
        if (0 === d) a.h(NaN, NaN, 0, 0);
        else {
          if (1 === d)
            (d = this.i(0)),
              (b = Math.min(d.x, b)),
              (c = Math.min(d.y, c)),
              a.h(d.x, d.y, 0, 0);
          else if (2 === d) {
            d = this.i(0);
            var e = this.i(1);
            b = Math.min(d.x, e.x);
            c = Math.min(d.y, e.y);
            a.h(d.x, d.y, 0, 0);
            a.Ye(e);
          } else if (this.computeCurve() === kg && 3 <= d && !this.isOrthogonal)
            if (
              ((e = this.i(0)), (b = e.x), (c = e.y), a.h(b, c, 0, 0), 3 === d)
            ) {
              d = this.i(1);
              b = Math.min(d.x, b);
              c = Math.min(d.y, c);
              var f = this.i(2);
              b = Math.min(f.x, b);
              c = Math.min(f.y, c);
              L.em(e.x, e.y, d.x, d.y, d.x, d.y, f.x, f.y, 0.5, a);
            } else
              for (f = 3; f < d; f += 3) {
                var g = this.i(f - 2);
                f + 3 >= d && (f = d - 1);
                var h = this.i(f - 1),
                  k = this.i(f);
                L.em(e.x, e.y, g.x, g.y, h.x, h.y, k.x, k.y, 0.5, a);
                b = Math.min(k.x, b);
                c = Math.min(k.y, c);
                e = k;
              }
          else
            for (
              e = this.i(0),
                f = this.i(1),
                b = Math.min(e.x, f.x),
                c = Math.min(e.y, f.y),
                a.h(e.x, e.y, 0, 0),
                a.Ye(f),
                e = 2;
              e < d;
              e++
            )
              (f = this.i(e)),
                (b = Math.min(f.x, b)),
                (c = Math.min(f.y, c)),
                a.Ye(f);
          this.Qu.h(b - a.x, c - a.y);
        }
        return a;
      },
    },
    midPoint: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        this.Ag();
        return this.computeMidPoint(new K());
      },
    },
    midAngle: {
      configurable: !0,
      get: function () {
        this.Ag();
        return this.computeMidAngle();
      },
    },
    flattenedLengths: {
      configurable: !0,
      get: function () {
        if (null === this.nr) {
          this.Bd || Cp(this);
          for (
            var a = (this.nr = []), b = this.pointsCount, c = 0;
            c < b - 1;
            c++
          ) {
            var d = this.i(c);
            var e = this.i(c + 1);
            L.da(d.x, e.x)
              ? ((d = e.y - d.y), 0 > d && (d = -d))
              : L.da(d.y, e.y)
              ? ((d = e.x - d.x), 0 > d && (d = -d))
              : (d = Math.sqrt(d.Ff(e)));
            a.push(d);
          }
        }
        return this.nr;
      },
    },
    flattenedTotalLength: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        var a = this.Qt;
        if (isNaN(a)) {
          for (
            var b = this.flattenedLengths, c = b.length, d = (a = 0);
            d < c;
            d++
          )
            a += b[d];
          this.Qt = a;
        }
        return a;
      },
    },
    points: {
      configurable: !0,
      get: function () {
        return this.Jb;
      },
      set: function (a) {
        var b = this.Jb;
        if (b !== a) {
          var c = null;
          if (Array.isArray(a)) {
            var d = 0 === a.length % 2;
            if (d)
              for (var e = 0; e < a.length; e++)
                if ("number" !== typeof a[e] || isNaN(a[e])) {
                  d = !1;
                  break;
                }
            if (d)
              for (c = new H(), d = 0; d < a.length / 2; d++)
                (e = new K(a[2 * d], a[2 * d + 1]).freeze()), c.add(e);
            else {
              d = !0;
              for (e = 0; e < a.length; e++) {
                var f = a[e];
                if (
                  !Ga(f) ||
                  "number" !== typeof f.x ||
                  isNaN(f.x) ||
                  "number" !== typeof f.y ||
                  isNaN(f.y)
                ) {
                  d = !1;
                  break;
                }
              }
              if (d)
                for (c = new H(), d = 0; d < a.length; d++)
                  (e = a[d]), c.add(new K(e.x, e.y).freeze());
              else
                G &&
                  v(
                    "Link.points array must contain only an even number of numbers or objects with x and y properties, not: " +
                      a
                  );
            }
          } else if (a instanceof H)
            for (c = a.copy(), a = c.iterator; a.next(); ) a.value.freeze();
          else v("Link.points value is not an instance of List or Array: " + a);
          c.freeze();
          this.Jb = c;
          this.lc(!0);
          Cp(this);
          a = this.diagram;
          null !== a &&
            (a.Yi || a.undoManager.isUndoingRedoing || a.Ts.add(this),
            a.animationManager.zb &&
              ((a = a.animationManager), (this.qf = c), a.Ql.add(this)));
          this.g("points", b, c);
        }
      },
    },
    pointsCount: {
      configurable: !0,
      get: function () {
        return this.Jb.count;
      },
    },
    Bd: {
      configurable: !0,
      get: function () {
        return 0 !== (this.Oa & 16);
      },
      set: function (a) {
        (0 !== (this.Oa & 16)) !== a && (this.Oa ^= 16);
      },
    },
    suspendsRouting: {
      configurable: !0,
      get: function () {
        return 0 !== (this.Oa & 32);
      },
      set: function (a) {
        (0 !== (this.Oa & 32)) !== a && (this.Oa ^= 32);
      },
    },
    computingPoints: {
      configurable: !0,
      get: function () {
        return 0 !== (this.Oa & 64);
      },
      set: function (a) {
        (0 !== (this.Oa & 64)) !== a && (this.Oa ^= 64);
      },
    },
    defaultFromPoint: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        this.o = a.copy();
      },
    },
    defaultToPoint: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        this.B = a.copy();
      },
    },
    isOrthogonal: {
      configurable: !0,
      get: function () {
        return 2 === (this.Vj.value & 2);
      },
    },
    isAvoiding: {
      configurable: !0,
      get: function () {
        return 4 === (this.Vj.value & 4);
      },
    },
    Om: {
      configurable: !0,
      get: function () {
        return 0 !== (this.Oa & 128);
      },
      set: function (a) {
        (0 !== (this.Oa & 128)) !== a && (this.Oa ^= 128);
      },
    },
    geometry: {
      configurable: !0,
      get: function () {
        this.Om || (this.Ag(), (this.ta = this.makeGeometry()));
        return this.ta;
      },
    },
    firstPickIndex: {
      configurable: !0,
      get: function () {
        return 2 >= this.pointsCount
          ? 0
          : this.isOrthogonal || !Gp(this.computeSpot(!0))
          ? 1
          : 0;
      },
    },
    lastPickIndex: {
      configurable: !0,
      get: function () {
        var a = this.pointsCount;
        return 0 === a
          ? 0
          : 2 >= a
          ? a - 1
          : this.isOrthogonal || !Gp(this.computeSpot(!1))
          ? a - 2
          : a - 1;
      },
    },
    adjusting: {
      configurable: !0,
      get: function () {
        return this.Mk;
      },
      set: function (a) {
        var b = this.Mk;
        b !== a &&
          (G &&
            a !== hg &&
            a !== vp &&
            a !== wp &&
            a !== xp &&
            v(
              "Link.adjusting can only be set to Link.None, Link.End, LInk.Scale, or Link.Stretch, not: " +
                a
            ),
          (this.Mk = a),
          this.g("adjusting", b, a));
      },
    },
    corner: {
      configurable: !0,
      get: function () {
        return this.tn;
      },
      set: function (a) {
        var b = this.tn;
        b !== a &&
          (G && A(a, "number", R, "corner"),
          (this.tn = a),
          this.lc(!0),
          this.g("corner", b, a));
      },
    },
    curve: {
      configurable: !0,
      get: function () {
        return this.vn;
      },
      set: function (a) {
        var b = this.vn;
        b !== a &&
          (G &&
            a !== hg &&
            a !== kg &&
            a !== gg &&
            a !== fg &&
            v(
              "Link.curve can only be set to Link.None, Link.Bezier, LInk.JumpGap, or Link.JumpOver, not: " +
                a
            ),
          (this.vn = a),
          this.ab(),
          this.lc(!0),
          Dp(this, b === gg || b === fg || a === gg || a === fg),
          this.g("curve", b, a));
      },
    },
    curviness: {
      configurable: !0,
      get: function () {
        return this.wn;
      },
      set: function (a) {
        var b = this.wn;
        b !== a &&
          (G && A(a, "number", R, "curviness"),
          (this.wn = a),
          this.ab(),
          this.lc(!1),
          this.g("curviness", b, a));
      },
    },
    routing: {
      configurable: !0,
      get: function () {
        return this.Vj;
      },
      set: function (a) {
        var b = this.Vj;
        b !== a &&
          (G &&
            a !== up &&
            a !== cq &&
            a !== dq &&
            a !== Mp &&
            v(
              "Link.routing can only be set to Link.Normal, Link.Orthogonal, LInk.AvoidsNodes, not: " +
                a
            ),
          (this.Vj = a),
          (this.Yf = null),
          this.ab(),
          Dp(this, 2 === (b.value & 2) || 2 === (a.value & 2)),
          this.g("routing", b, a));
      },
    },
    smoothness: {
      configurable: !0,
      get: function () {
        return this.Ap;
      },
      set: function (a) {
        var b = this.Ap;
        b !== a &&
          (G && A(a, "number", R, "smoothness"),
          (this.Ap = a),
          this.lc(!0),
          this.g("smoothness", b, a));
      },
    },
    key: {
      configurable: !0,
      get: function () {
        var a = this.diagram;
        if (null !== a && a.model.Zi()) return a.model.vc(this.data);
      },
    },
  });
  R.prototype.invalidateOtherJumpOvers = R.prototype.oq;
  R.prototype.findClosestSegment = R.prototype.Pz;
  R.prototype.updateRoute = R.prototype.Ag;
  R.prototype.invalidateRoute = R.prototype.ab;
  R.prototype.rollbackRoute = R.prototype.Tv;
  R.prototype.commitRoute = R.prototype.Df;
  R.prototype.startRoute = R.prototype.Qh;
  R.prototype.clearPoints = R.prototype.hk;
  R.prototype.removePoint = R.prototype.Rv;
  R.prototype.addPointAt = R.prototype.Bf;
  R.prototype.addPoint = R.prototype.je;
  R.prototype.insertPointAt = R.prototype.l;
  R.prototype.insertPoint = R.prototype.uA;
  R.prototype.setPointAt = R.prototype.P;
  R.prototype.setPoint = R.prototype.Wc;
  R.prototype.getPoint = R.prototype.i;
  R.prototype.getOtherPort = R.prototype.lA;
  R.prototype.getOtherNode = R.prototype.kq;
  var Ep = null,
    Fp = null,
    up = new F(R, "Normal", 1),
    cq = new F(R, "Orthogonal", 2),
    dq = new F(R, "AvoidsNodes", 6),
    Mp = new F(R, "AvoidsNodesStraight", 7),
    hg = new F(R, "None", 0),
    kg = new F(R, "Bezier", 9),
    gg = new F(R, "JumpGap", 10),
    fg = new F(R, "JumpOver", 11),
    vp = new F(R, "End", 17),
    wp = new F(R, "Scale", 18),
    xp = new F(R, "Stretch", 19),
    gn = new F(R, "OrientAlong", 21),
    $m = new F(R, "OrientPlus90", 22),
    bn = new F(R, "OrientMinus90", 23),
    yp = new F(R, "OrientOpposite", 24),
    hn = new F(R, "OrientUpright", 25),
    an = new F(R, "OrientPlus90Upright", 26),
    cn = new F(R, "OrientMinus90Upright", 27),
    dn = new F(R, "OrientUpright45", 28),
    Op = 16,
    Np = 14,
    Pp = 8;
  R.className = "Link";
  R.Normal = up;
  R.Orthogonal = cq;
  R.AvoidsNodes = dq;
  R.AvoidsNodesStraight = Mp;
  R.None = hg;
  R.Bezier = kg;
  R.JumpGap = gg;
  R.JumpOver = fg;
  R.End = vp;
  R.Scale = wp;
  R.Stretch = xp;
  R.OrientAlong = gn;
  R.OrientPlus90 = $m;
  R.OrientMinus90 = bn;
  R.OrientOpposite = yp;
  R.OrientUpright = hn;
  R.OrientPlus90Upright = an;
  R.OrientMinus90Upright = cn;
  R.OrientUpright45 = dn;
  R.EndSegmentStep = 8;
  R.CurvinessStart = Op;
  R.SpacingMin = Np;
  R.OrthoShortCut = Pp;
  function bq(a, b, c, d) {
    ab(this);
    this.Ae = this.ur = !1;
    this.Ws = a;
    this.wy = b;
    this.Iv = c;
    this.xy = d;
    this.links = [];
  }
  bq.prototype.pm = function () {
    if (!this.ur) {
      var a = this.links;
      0 < a.length &&
        ((a = a[0].diagram),
        null !== a &&
          (a.Qw.add(this), (this.Ae = a.undoManager.isUndoingRedoing)));
    }
    this.ur = !0;
  };
  bq.prototype.kw = function () {
    if (this.ur) {
      this.ur = !1;
      var a = this.links;
      if (0 < a.length) {
        var b = a[0],
          c = b.diagram;
        c = null === c || (c.Yi && !this.Ae);
        this.Ae = !1;
        b.arrangeBundledLinks(a, c);
        1 === a.length && ((b.Uf = null), (a.length = 0));
      }
      0 === a.length &&
        ((a = this.Ws),
        null !== this && null !== a.af && a.af.remove(this),
        (a = this.Iv),
        null !== this && null !== a.af && a.af.remove(this));
    }
  };
  bq.className = "LinkBundle";
  function sk(a) {
    ab(this);
    this.Hy = this.group = null;
    this.Ms = !0;
    this.abort = !1;
    this.Hd = this.Gd = 1;
    this.Ao = this.zo = -1;
    this.mc = a.width;
    this.nc = a.height;
    this.Yb = null;
    this.Ii = this.Hi = 0;
    this.ht = 11;
    this.oy = this.ny = 22;
  }
  sk.prototype.initialize = function (a) {
    if (!(0 >= a.width || 0 >= a.height)) {
      var b = a.y,
        c = a.x + a.width,
        d = a.y + a.height;
      this.Gd = Math.floor((a.x - this.mc) / this.mc) * this.mc;
      this.Hd = Math.floor((b - this.nc) / this.nc) * this.nc;
      this.zo = Math.ceil((c + 2 * this.mc) / this.mc) * this.mc;
      this.Ao = Math.ceil((d + 2 * this.nc) / this.nc) * this.nc;
      a = 1 + (Math.ceil((this.zo - this.Gd) / this.mc) | 0);
      b = 1 + (Math.ceil((this.Ao - this.Hd) / this.nc) | 0);
      if (null === this.Yb || this.Hi < a - 1 || this.Ii < b - 1) {
        c = [];
        for (d = 0; d <= a; d++) c[d] = new Uint32Array(b);
        this.Yb = c;
        this.Hi = a - 1;
        this.Ii = b - 1;
      }
      a = eq;
      if (null !== this.Yb)
        for (b = 0; b <= this.Hi; b++)
          if (((c = this.Yb[b]), c.fill)) c.fill(a);
          else for (d = 0; d <= this.Ii; d++) c[d] = a;
    }
  };
  function Dk(a, b, c) {
    return a.Gd <= b && b <= a.zo && a.Hd <= c && c <= a.Ao;
  }
  function Rp(a, b, c) {
    if (!Dk(a, b, c)) return eq;
    b -= a.Gd;
    b /= a.mc;
    c -= a.Hd;
    c /= a.nc;
    return a.Yb[b | 0][c | 0];
  }
  function vk(a) {
    if (null !== a.Yb)
      for (var b = 0; b <= a.Hi; b++)
        for (var c = a.Yb[b], d = 0; d <= a.Ii; d++) c[d] >= Up && (c[d] = eq);
  }
  sk.prototype.wk = function (a, b, c, d) {
    if (a > this.zo || a + c < this.Gd || b > this.Ao || b + d < this.Hd)
      return !0;
    a = ((a - this.Gd) / this.mc) | 0;
    b = ((b - this.Hd) / this.nc) | 0;
    c = (Math.max(0, c) / this.mc + 1) | 0;
    var e = (Math.max(0, d) / this.nc + 1) | 0;
    0 > a && ((c += a), (a = 0));
    0 > b && ((e += b), (b = 0));
    if (0 > c || 0 > e) return !0;
    d = Math.min(a + c - 1, this.Hi) | 0;
    for (c = Math.min(b + e - 1, this.Ii) | 0; a <= d; a++) {
      e = this.Yb[a];
      for (var f = b; f <= c; f++) if (e[f] === Hk) return !1;
    }
    return !0;
  };
  function fq(a, b, c, d, e, f, g, h, k) {
    if (!(b < f || b > g || c < h || c > k)) {
      var l = b | 0;
      var m = c | 0;
      var n = a.Yb[l][m];
      if (n >= Up && n < Sp)
        for (
          e ? (m += d) : (l += d), n += 1;
          f <= l && l <= g && h <= m && m <= k && !(n >= a.Yb[l][m]);

        )
          (a.Yb[l][m] = n), (n += 1), e ? (m += d) : (l += d);
      l = e ? m : l;
      if (e)
        if (0 < d)
          for (c += d; c < l; c += d)
            fq(a, b, c, 1, !e, f, g, h, k), fq(a, b, c, -1, !e, f, g, h, k);
        else
          for (c += d; c > l; c += d)
            fq(a, b, c, 1, !e, f, g, h, k), fq(a, b, c, -1, !e, f, g, h, k);
      else if (0 < d)
        for (b += d; b < l; b += d)
          fq(a, b, c, 1, !e, f, g, h, k), fq(a, b, c, -1, !e, f, g, h, k);
      else
        for (b += d; b > l; b += d)
          fq(a, b, c, 1, !e, f, g, h, k), fq(a, b, c, -1, !e, f, g, h, k);
    }
  }
  function gq(a, b, c, d, e, f, g, h, k) {
    b |= 0;
    c |= 0;
    var l = Hk,
      m = Up;
    for (a.Yb[b][c] = m; l === Hk && b > f && b < g && c > h && c < k; )
      (m += 1), (a.Yb[b][c] = m), e ? (c += d) : (b += d), (l = a.Yb[b][c]);
  }
  function hq(a, b, c, d, e, f, g, h, k) {
    b |= 0;
    c |= 0;
    var l = Hk,
      m = Sp;
    for (a.Yb[b][c] = m; l === Hk && b > f && b < g && c > h && c < k; )
      (a.Yb[b][c] = m), e ? (c += d) : (b += d), (l = a.Yb[b][c]);
  }
  function Qp(a, b, c, d, e, f, g) {
    if (null !== a.Yb) {
      a.abort = !1;
      var h = b.x,
        k = b.y;
      if (Dk(a, h, k)) {
        h -= a.Gd;
        h /= a.mc;
        k -= a.Hd;
        k /= a.nc;
        var l = d.x,
          m = d.y;
        if (Dk(a, l, m))
          if (
            ((l -= a.Gd),
            (l /= a.mc),
            (m -= a.Hd),
            (m /= a.nc),
            1 >= Math.abs(h - l) && 1 >= Math.abs(k - m))
          )
            a.abort = !0;
          else {
            var n = f.x;
            d = f.y;
            b = f.x + f.width;
            var p = f.y + f.height;
            n -= a.Gd;
            n /= a.mc;
            d -= a.Hd;
            d /= a.nc;
            b -= a.Gd;
            b /= a.mc;
            p -= a.Hd;
            p /= a.nc;
            f = Math.max(0, Math.min(a.Hi, n | 0));
            b = Math.min(a.Hi, Math.max(0, b | 0));
            n = Math.max(0, Math.min(a.Ii, d | 0));
            p = Math.min(a.Ii, Math.max(0, p | 0));
            d = a.Yb;
            h |= 0;
            k |= 0;
            l |= 0;
            m |= 0;
            var r = 0 === c || 90 === c ? 1 : -1;
            c = 90 === c || 270 === c;
            d[h][k] === Hk
              ? (gq(a, h, k, r, c, f, b, n, p),
                gq(a, h, k, 1, !c, f, b, n, p),
                gq(a, h, k, -1, !c, f, b, n, p))
              : gq(a, h, k, r, c, h, k, h, k);
            d[l][m] === Hk
              ? (hq(
                  a,
                  l,
                  m,
                  0 === e || 90 === e ? 1 : -1,
                  90 === e || 270 === e,
                  f,
                  b,
                  n,
                  p
                ),
                hq(a, l, m, 1, !(90 === e || 270 === e), f, b, n, p),
                hq(a, l, m, -1, !(90 === e || 270 === e), f, b, n, p))
              : hq(a, l, m, r, c, l, m, l, m);
            c = Ma();
            if (g && iq(a, l, m, e, h, k, c)) {
              if (c[0] !== l || c[1] !== m) c.unshift(m), c.unshift(l);
              if (c[c.length - 2] !== h || c[c.length - 1] !== k)
                c.push(h), c.push(k);
              a = Up;
              e = c[c.length - 2];
              g = c[c.length - 1];
              d[e][g] = a++;
              for (f = c.length - 4; 0 <= f; f -= 2)
                for (
                  e = c[f + 2], g = c[f + 3], b = c[f], l = c[f + 1];
                  b > e ? e++ : b < e ? e-- : l > g ? g++ : l < g && g--,
                    (d[e][g] = a++),
                    e !== b || g !== l;

                );
            } else
              fq(a, h, k, 1, !1, f, b, n, p),
                fq(a, h, k, -1, !1, f, b, n, p),
                fq(a, h, k, 1, !0, f, b, n, p),
                fq(a, h, k, -1, !0, f, b, n, p);
            Pa(c);
          }
      }
    }
  }
  function iq(a, b, c, d, e, f, g) {
    for (var h = a.Yb, k = b, l = c; ; ) {
      if (k === e && l === f) return !0;
      var m = k,
        n = l;
      if (0 === d)
        if (m < e) m++;
        else break;
      else if (90 === d)
        if (n < f) n++;
        else break;
      else if (180 === d)
        if (m > e) m--;
        else break;
      else if (n > f) n--;
      else break;
      var p = h[m][n];
      if (0 === p || p === jq) break;
      k = m;
      l = n;
    }
    for (;;) {
      m = d;
      n = k;
      p = l;
      0 === d
        ? p < f
          ? ((m = 90), p++)
          : p > f && ((m = 270), p--)
        : 90 === d
        ? n < e
          ? ((m = 0), n++)
          : n > e && ((m = 180), n--)
        : 180 === d
        ? p < f
          ? ((m = 90), p++)
          : p > f && ((m = 270), p--)
        : n < e
        ? ((m = 0), n++)
        : n > e && ((m = 180), n--);
      n = h[n][p];
      if (m !== d && 0 !== n && n !== jq) {
        g.push(k);
        g.push(l);
        if (iq(a, k, l, m, e, f, g)) return !0;
        g.pop();
        g.pop();
      }
      h[k][l] = jq;
      if (0 === d) {
        if (k === b) return !1;
        k--;
      } else if (90 === d) {
        if (l === c) return !1;
        l--;
      } else if (180 === d) {
        if (k === b) return !1;
        k++;
      } else {
        if (l === c) return !1;
        l++;
      }
    }
  }
  oa.Object.defineProperties(sk.prototype, {
    bounds: {
      configurable: !0,
      get: function () {
        return new M(this.Gd, this.Hd, this.zo - this.Gd, this.Ao - this.Hd);
      },
    },
    Zp: {
      configurable: !0,
      get: function () {
        return this.mc;
      },
      set: function (a) {
        0 < a && a !== this.mc && ((this.mc = a), this.initialize(this.bounds));
      },
    },
    Yp: {
      configurable: !0,
      get: function () {
        return this.nc;
      },
      set: function (a) {
        0 < a && a !== this.nc && ((this.nc = a), this.initialize(this.bounds));
      },
    },
  });
  var Hk = 0,
    Up = 1,
    Sp = 999999,
    eq = Sp + 1,
    jq = Sp + 2;
  sk.className = "PositionArray";
  function Kp() {
    ab(this);
    this.port = this.node = null;
    this.le = [];
    this.sq = !1;
  }
  Kp.prototype.toString = function () {
    for (
      var a = this.le,
        b = this.node.toString() + " " + a.length.toString() + ":",
        c = 0;
      c < a.length;
      c++
    ) {
      var d = a[c];
      null !== d && (b += "\n  " + d.toString());
    }
    return b;
  };
  function kq(a, b, c, d) {
    b = b.offsetY;
    switch (b) {
      case 8:
        return 90;
      case 2:
        return 180;
      case 1:
        return 270;
      case 4:
        return 0;
    }
    switch (b) {
      case 9:
        return 180 < c ? 270 : 90;
      case 6:
        return 90 < c && 270 >= c ? 180 : 0;
    }
    a = (180 * Math.atan2(a.height, a.width)) / Math.PI;
    switch (b) {
      case 3:
        return c > a && c <= 180 + a ? 180 : 270;
      case 5:
        return c > 180 - a && c <= 360 - a ? 270 : 0;
      case 12:
        return c > a && c <= 180 + a ? 90 : 0;
      case 10:
        return c > 180 - a && c <= 360 - a ? 180 : 90;
      case 7:
        return 90 < c && c <= 180 + a
          ? 180
          : c > 180 + a && c <= 360 - a
          ? 270
          : 0;
      case 13:
        return 180 < c && c <= 360 - a ? 270 : c > a && 180 >= c ? 90 : 0;
      case 14:
        return c > a && c <= 180 - a ? 90 : c > 180 - a && 270 >= c ? 180 : 0;
      case 11:
        return c > 180 - a && c <= 180 + a ? 180 : c > 180 + a ? 270 : 90;
    }
    d && 15 !== b && ((c -= 15), 0 > c && (c += 360));
    return c > a && c < 180 - a
      ? 90
      : c >= 180 - a && c <= 180 + a
      ? 180
      : c > 180 + a && c < 360 - a
      ? 270
      : 0;
  }
  Kp.prototype.pm = function () {
    this.le.length = 0;
  };
  function Lp(a, b) {
    var c = a.le;
    if (0 === c.length) {
      a: if (!a.sq) {
        c = a.sq;
        a.sq = !0;
        var d = null,
          e = a.node,
          f = e instanceof vf ? e : null;
        if (null === f || f.isSubGraphExpanded)
          var g = e.isTreeExpanded
            ? e.findLinksConnected(a.port.portId)
            : e.Tx();
        else {
          if (!f.actualBounds.s()) {
            a.sq = c;
            break a;
          }
          d = f;
          g = d.pv();
        }
        f = a.le.length = 0;
        var h = a.port.ka(Fc, K.alloc()),
          k = a.port.ka(Pc, K.alloc());
        e = M.allocAt(h.x, h.y, 0, 0);
        e.Ye(k);
        K.free(h);
        K.free(k);
        h = K.allocAt(e.x + e.width / 2, e.y + e.height / 2);
        k = a.port.Ti();
        for (g = g.iterator; g.next(); ) {
          var l = g.value;
          if (l.isVisible() && l.fromPort !== l.toPort) {
            var m =
                l.fromPort === a.port ||
                (null !== l.fromNode && l.fromNode.Pd(d)),
              n = l.computeSpot(m, a.port);
            if (n.Uc() && ((m = m ? l.toPort : l.fromPort), null !== m)) {
              var p = m.part;
              if (null !== p) {
                var r = p.findVisibleNode();
                null !== r && r !== p && ((p = r), (m = p.port));
                m = l.computeOtherPoint(p, m);
                p = h.Ya(m);
                p -= k;
                0 > p ? (p += 360) : 360 <= p && (p -= 360);
                n = kq(e, n, p, l.isOrthogonal);
                0 === n
                  ? ((n = 4), 180 < p && (p -= 360))
                  : 90 === n
                  ? ((n = 8), 270 < p && (p -= 360))
                  : 180 === n
                  ? (n = 2)
                  : ((n = 1), 90 > p && (p += 360));
                r = a.le[f];
                void 0 === r
                  ? ((r = new lq(l, p, n)), (a.le[f] = r))
                  : ((r.link = l), (r.angle = p), (r.Gc = n));
                r.Kv.set(m);
                f++;
              }
            }
          }
        }
        K.free(h);
        a.le.sort(Kp.prototype.j);
        k = a.le.length;
        d = -1;
        for (f = h = 0; f < k; f++)
          (g = a.le[f]),
            void 0 !== g &&
              (g.Gc !== d && ((d = g.Gc), (h = 0)), (g.lq = h), h++);
        d = -1;
        h = 0;
        for (f = k - 1; 0 <= f; f--)
          (k = a.le[f]),
            void 0 !== k &&
              (k.Gc !== d && ((d = k.Gc), (h = k.lq + 1)), (k.im = h));
        f = a.le;
        n = a.port;
        d = a.node.portSpreading;
        h = K.alloc();
        k = K.alloc();
        g = K.alloc();
        l = K.alloc();
        n.ka(Fc, h);
        n.ka(Ic, k);
        n.ka(Pc, g);
        n.ka(Mc, l);
        r = p = m = n = 0;
        if (d === rp)
          for (var q = 0; q < f.length; q++) {
            var u = f[q];
            if (null !== u) {
              var w = u.link.computeThickness();
              switch (u.Gc) {
                case 8:
                  p += w;
                  break;
                case 2:
                  r += w;
                  break;
                case 1:
                  n += w;
                  break;
                default:
                case 4:
                  m += w;
              }
            }
          }
        var y = (q = 0),
          z = 1,
          B = (u = 0);
        for (w = 0; w < f.length; w++) {
          var C = f[w];
          if (null !== C) {
            if (q !== C.Gc) {
              q = C.Gc;
              switch (q) {
                case 8:
                  var E = g;
                  y = l;
                  break;
                case 2:
                  E = l;
                  y = h;
                  break;
                case 1:
                  E = h;
                  y = k;
                  break;
                default:
                case 4:
                  (E = k), (y = g);
              }
              u = y.x - E.x;
              B = y.y - E.y;
              switch (q) {
                case 8:
                  p > Math.abs(u)
                    ? ((z = Math.abs(u) / p), (p = Math.abs(u)))
                    : (z = 1);
                  break;
                case 2:
                  r > Math.abs(B)
                    ? ((z = Math.abs(B) / r), (r = Math.abs(B)))
                    : (z = 1);
                  break;
                case 1:
                  n > Math.abs(u)
                    ? ((z = Math.abs(u) / n), (n = Math.abs(u)))
                    : (z = 1);
                  break;
                default:
                case 4:
                  m > Math.abs(B)
                    ? ((z = Math.abs(B) / m), (m = Math.abs(B)))
                    : (z = 1);
              }
              y = 0;
            }
            var J = C.rq;
            if (d === rp) {
              C = C.link.computeThickness();
              C *= z;
              J.set(E);
              switch (q) {
                case 8:
                  J.x = E.x + u / 2 + p / 2 - y - C / 2;
                  break;
                case 2:
                  J.y = E.y + B / 2 + r / 2 - y - C / 2;
                  break;
                case 1:
                  J.x = E.x + u / 2 - n / 2 + y + C / 2;
                  break;
                default:
                case 4:
                  J.y = E.y + B / 2 - m / 2 + y + C / 2;
              }
              y += C;
            } else {
              var S = 0.5;
              d === dp && (S = (C.lq + 1) / (C.im + 1));
              J.x = E.x + u * S;
              J.y = E.y + B * S;
            }
          }
        }
        K.free(h);
        K.free(k);
        K.free(g);
        K.free(l);
        E = a.le;
        for (f = 0; f < E.length; f++)
          (d = E[f]), null !== d && (d.nv = a.computeEndSegmentLength(d));
        a.sq = c;
        M.free(e);
      }
      c = a.le;
    }
    for (a = 0; a < c.length; a++)
      if (((e = c[a]), null !== e && e.link === b)) return e;
    return null;
  }
  Kp.prototype.j = function (a, b) {
    return a === b
      ? 0
      : null === a
      ? -1
      : null === b
      ? 1
      : a.Gc < b.Gc
      ? -1
      : a.Gc > b.Gc
      ? 1
      : a.angle < b.angle
      ? -1
      : a.angle > b.angle
      ? 1
      : 0;
  };
  Kp.prototype.computeEndSegmentLength = function (a) {
    var b = a.link,
      c = b.computeEndSegmentLength(
        this.node,
        this.port,
        Ec,
        b.fromPort === this.port
      ),
      d = a.lq;
    if (0 > d) return c;
    var e = a.im;
    if (1 >= e || !b.isOrthogonal) return c;
    b = a.Kv;
    var f = a.rq;
    if (2 === a.Gc || 8 === a.Gc) d = e - 1 - d;
    return ((a = 2 === a.Gc || 4 === a.Gc) ? b.y < f.y : b.x < f.x)
      ? c + 8 * d
      : (a ? b.y === f.y : b.x === f.x)
      ? c
      : c + 8 * (e - 1 - d);
  };
  Kp.className = "Knot";
  function lq(a, b, c) {
    this.link = a;
    this.angle = b;
    this.Gc = c;
    this.Kv = new K();
    this.im = this.lq = 0;
    this.rq = new K();
    this.nv = 0;
  }
  lq.prototype.toString = function () {
    return (
      this.link.toString() +
      " " +
      this.angle.toString() +
      " " +
      this.Gc.toString() +
      ":" +
      this.lq.toString() +
      "/" +
      this.im.toString() +
      " " +
      this.rq.toString() +
      " " +
      this.nv.toString() +
      " " +
      this.Kv.toString()
    );
  };
  lq.className = "LinkInfo";
  function ql() {
    this.yh = this.Ug = gd;
    this.xh = this.Tg = this.wh = this.Sg = NaN;
    this.Jp = this.Mn = null;
    this.Kp = this.Nn = Infinity;
  }
  ql.prototype.copy = function () {
    var a = new ql();
    a.Ug = this.Ug.L();
    a.yh = this.yh.L();
    a.Sg = this.Sg;
    a.wh = this.wh;
    a.Tg = this.Tg;
    a.xh = this.xh;
    a.Mn = this.Mn;
    a.Jp = this.Jp;
    a.Nn = this.Nn;
    a.Kp = this.Kp;
    return a;
  };
  ql.className = "LinkSettings";
  function zi(a) {
    ab(this);
    this.o = this.G = null;
    this.ii = this.fo = !0;
    this.mo = !1;
    this.cn = new K(0, 0).freeze();
    this.jo = !0;
    this.gn = this.io = null;
    this.lo = !1;
    this.j = null;
    this.B = 0;
    this.Bo = this.Qp = null;
    this.us = !1;
    this.qg = this.Xj = null;
    this.ls = !1;
    a && Object.assign(this, a);
  }
  zi.prototype.cloneProtected = function (a) {
    a.fo = this.fo;
    a.ii = this.ii;
    a.mo = this.mo;
    a.cn.assign(this.cn);
    a.jo = this.jo;
    a.io = this.io;
    a.gn = this.gn;
    a.lo = !0;
    a.Bo = this.Bo;
    a.Qp = this.Qp;
  };
  zi.prototype.copy = function () {
    var a = new this.constructor();
    this.cloneProtected(a);
    return a;
  };
  zi.prototype.serializeLayoutProperties = function (a) {
    a.arrangementOrigin = {
      x: this.arrangementOrigin.x,
      y: this.arrangementOrigin.y,
    };
    a.isRouting = this.isRouting;
  };
  zi.prototype.deserializeLayoutProperties = function (a) {
    null !== a &&
      ((this.arrangementOrigin = new K(
        a.arrangementOrigin.x,
        a.arrangementOrigin.y
      )),
      (this.isRouting = a.isRouting));
  };
  zi.prototype.pb = function (a) {
    Ea(this, a);
  };
  zi.prototype.toString = function () {
    var a = Qa(this.constructor);
    a += "(";
    null !== this.group && (a += " in " + this.group);
    null !== this.diagram && (a += " for " + this.diagram);
    return a + ")";
  };
  zi.prototype.F = function () {
    if (this.isValidLayout) {
      var a = this.diagram;
      if (null !== a && !a.undoManager.isUndoingRedoing) {
        var b = a.animationManager;
        !b.isTicking &&
          (b.defaultAnimation.isAnimating && b.wc(),
          (this.isOngoing && a.Yi) || (this.isInitial && !a.Yi)) &&
          ((this.isValidLayout = !1), a.Ob());
      }
    }
  };
  zi.prototype.createNetwork = function () {
    return new mq(this);
  };
  zi.prototype.makeNetwork = function (a) {
    var b = this.createNetwork();
    a instanceof Q
      ? (b.sg(a.nodes, !0), b.sg(a.links, !0))
      : a instanceof vf
      ? b.sg(a.memberParts)
      : b.sg(a.iterator);
    return b;
  };
  zi.prototype.updateParts = function () {
    this.isValidLayout = !0;
    if (!this.workerLayout()) {
      var a = this.diagram;
      if (null === a && null !== this.network)
        for (var b = this.network.vertexes.iterator; b.next(); ) {
          var c = b.value.node;
          if (null !== c && ((a = c.diagram), null !== a)) break;
        }
      try {
        null !== a && a.Fa("Layout"), this.commitLayout();
      } finally {
        null !== a && a.gb("Layout");
      }
    }
  };
  zi.prototype.commitLayout = function () {
    if (null !== this.network) {
      for (var a = this.network.vertexes.iterator; a.next(); ) a.value.commit();
      if (this.isRouting)
        for (a = this.network.edges.iterator; a.next(); ) a.value.commit();
    }
  };
  zi.prototype.doLayout = function (a) {
    G &&
      null === a &&
      v(
        "Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts"
      );
    var b = new I();
    a instanceof Q
      ? (nq(this, b, a.nodes, !0, this.Oh, !0, !1, !0),
        nq(this, b, a.parts, !0, this.Oh, !0, !1, !0))
      : a instanceof vf
      ? nq(this, b, a.memberParts, !1, this.Oh, !0, !1, !0)
      : b.addAll(a.iterator);
    0 < b.count &&
      ((a = this.diagram),
      null !== a && a.Fa("Layout"),
      this.doMinimalNoNetworkLayout(b),
      null !== a && a.gb("Layout"));
    this.isValidLayout = !0;
  };
  zi.prototype.doMinimalNoNetworkLayout = function (a) {
    var b = Math.ceil(Math.sqrt(a.count));
    this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin);
    var c = this.arrangementOrigin.x,
      d = c,
      e = this.arrangementOrigin.y,
      f = 0,
      g = 0;
    for (a = a.iterator; a.next(); ) {
      var h = a.value;
      oq(h);
      var k = h.measuredBounds,
        l = k.width;
      k = k.height;
      h.moveTo(d, e);
      h instanceof vf && (h.Oh = !1);
      d += Math.max(l, 50) + 20;
      g = Math.max(g, Math.max(k, 50));
      f >= b - 1 ? ((f = 0), (d = c), (e += g + 20), (g = 0)) : f++;
    }
  };
  zi.prototype.doMinimalNetworkLayout = function () {
    var a = Math.ceil(Math.sqrt(this.network.vertexes.count));
    this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin);
    for (
      var b = this.arrangementOrigin.x,
        c = b,
        d = this.arrangementOrigin.y,
        e = 0,
        f = 0,
        g = this.network.vertexes.iterator;
      g.next();

    ) {
      var h = g.value.node;
      if (!(null === h || h instanceof R) && (oq(h), this.Oh(h))) {
        var k = h.measuredBounds,
          l = k.width;
        k = k.height;
        h.moveTo(c, d);
        h instanceof vf && (h.Oh = !1);
        c += Math.max(l, 50) + 20;
        f = Math.max(f, Math.max(k, 50));
        e >= a - 1 ? ((e = 0), (c = b), (d += f + 20), (f = 0)) : e++;
      }
    }
  };
  zi.prototype.Oh = function (a) {
    return !a.location.s() || (a instanceof vf && a.Oh) ? !0 : !1;
  };
  function nq(a, b, c, d, e, f, g, h) {
    for (c = c.iterator; c.next(); ) {
      var k = c.value;
      (d && !k.isTopLevel) ||
        (null !== e && !e(k)) ||
        !k.canLayout() ||
        (f && k instanceof V
          ? k.isLinkLabel ||
            (k instanceof vf
              ? null === k.layout
                ? nq(a, b, k.memberParts, !1, e, f, g, h)
                : (oq(k), b.add(k))
              : (oq(k), b.add(k)))
          : g && k instanceof R
          ? b.add(k)
          : !h || !k.Tc() || k instanceof V || (oq(k), b.add(k)));
    }
  }
  function oq(a) {
    var b = a.actualBounds;
    (0 === b.width || 0 === b.height || isNaN(b.width) || isNaN(b.height)) &&
      a.Za();
  }
  zi.prototype.Vi = function (a, b) {
    var c = this.boundsComputation;
    if (null !== c) return b || (b = new M()), c(a, this, b);
    if (!b) return a.actualBounds;
    b.set(a.actualBounds);
    return b;
  };
  zi.prototype.Hx = function (a) {
    var b = new I();
    a instanceof Q
      ? (nq(this, b, a.nodes, !0, null, !0, !0, !0),
        nq(this, b, a.links, !0, null, !0, !0, !0),
        nq(this, b, a.parts, !0, null, !0, !0, !0))
      : a instanceof vf
      ? nq(this, b, a.memberParts, !1, null, !0, !0, !0)
      : nq(this, b, a.iterator, !1, null, !0, !0, !0);
    return b;
  };
  zi.prototype.initialOrigin = function (a) {
    var b = this.group;
    if (null !== b) {
      var c = b.position.copy();
      (isNaN(c.x) || isNaN(c.y)) && c.set(a);
      b = b.placeholder;
      null !== b &&
        ((c = b.ka(Fc)),
        (isNaN(c.x) || isNaN(c.y)) && c.set(a),
        (a = b.padding),
        (c.x += a.left),
        (c.y += a.top));
      return c;
    }
    return a;
  };
  zi.prototype.mayUseWorker = function () {
    return this.mayUseWorkerFunction ? this.mayUseWorkerFunction(this) : !1;
  };
  zi.prototype.workerLayout = function () {
    return !1;
  };
  function pq(a, b) {
    if (null !== a.workerStateChanged) {
      var c = { key: a.group ? a.group.key : null };
      void 0 !== b && (c.time = b);
      null !== a.Xj && (c.running = qq(a.Xj));
      null !== a.qg && (c.waiting = qq(a.qg));
      a.workerStateChanged(c, a);
    }
  }
  function qq(a) {
    return { vertexes: a.vertexes.count, edges: a.edges.count };
  }
  zi.prototype.uz = function () {
    var a = rq(this.constructor);
    a &&
      (null !== a.Ze && a.Ze.terminate(),
      (a.Ze = null),
      a.rm.iteratorValues.each(function (a) {
        a.us = !1;
        a.Xj = null;
        a.qg = null;
        a.ls = !1;
        pq(a);
      }),
      a.rm.clear());
  };
  function sq(a, b) {
    var c = rq(a);
    if (c) {
      if (b) for (var d in b) c[d] = b[d];
    } else throw Error("Unknown Layout class: " + a);
  }
  function rq(a) {
    var b = null;
    if ("function" === typeof a) {
      if (((b = tq.get(a)), !b)) {
        var c = Qa(a);
        b = tq.get(c);
        b ||
          ((b = new uq()),
          (b.hv = a),
          (b.name = c),
          (b.j = a.name),
          (b.hy = vq),
          tq.set(c, b),
          tq.set(a, b),
          tq.set(a.name, b));
      }
    } else "string" === typeof a && (b = tq.get(a));
    return b;
  }
  zi.prototype.jw = function () {
    if (
      "undefined" === typeof Worker ||
      !wq ||
      "undefined" === typeof self ||
      "undefined" !== typeof self.DedicatedWorkerGlobalScope
    )
      return !1;
    if (!this.mayUseWorker())
      return (
        this.us && ((this.ls = !0), (this.qg = this.Xj = null), pq(this)), !1
      );
    var a = rq(this.constructor);
    if (null === a) return !1;
    null === a.Ze &&
      ((a.Ze = new Worker(wq)),
      (a.Ze.onerror = function (a) {
        a.preventDefault();
        Fa(
          "Worker Error at: " +
            a.filename +
            " " +
            a.lineno +
            " " +
            a.colno +
            "\n  " +
            a.message
        );
      }),
      (a.Ze.j = function (a) {
        Fa("Worker serialization error: " + a);
      }),
      (a.Ze.onmessage = function (b) {
        var c = b.data;
        if ("_GoJS" === c._GoJS)
          if (c.version && Q.version && c.version !== Q.version)
            Fa("Failure: GoJS v" + Q.version + "  Worker v" + c.version);
          else if ((b = a.rm.get(c.id))) {
            a.rm.remove(c.id);
            b.us = !1;
            b.Xj = null;
            if (b.ls) (b.ls = !1), (b.qg = null);
            else {
              var d = xq(b, c, !1);
              b.network = d;
              b.updateParts();
              b.network = null;
              b.isValidLayout = !0;
            }
            pq(b, c.time);
            c = b.qg;
            if (null !== c) b.qg = null;
            else
              for (d = a.rm.iteratorValues; d.next(); ) {
                var e = d.value;
                c = e.qg;
                if (null !== c) {
                  e.qg = null;
                  break;
                }
              }
            null !== c && yq(b, c);
          }
      }),
      a.Ze.postMessage({ _GoJS: "_GoJS", url: a.hy }),
      Array.isArray(a.scripts) &&
        a.scripts.forEach(function (b) {
          a.Ze.postMessage({ _GoJS: "_GoJS", url: b });
        }),
      a.Ze.postMessage({ _GoJS: "_GoJS", version: -1 }));
    null !== this.Xj ? (this.qg = this.network) : yq(this, this.network);
    pq(this);
    this.doMinimalNetworkLayout();
    this.network = null;
    return (this.isValidLayout = !0);
  };
  function yq(a, b) {
    a.us = !0;
    var c = rq(a.constructor),
      d = zq(a, b, !0);
    d._GoJS = "_GoJS";
    c.Ze.postMessage(d);
    c.rm.set(lb(a), a);
    a.Xj = b;
  }
  function zq(a, b, c) {
    a.onNetworkSerialization(1, c, b, null);
    var d = {};
    a.serializeLayoutProperties(d, c);
    var e = [];
    b.vertexes.each(function (a) {
      var b = {};
      a.serializeVertexProperties(b, c);
      e.push(b);
    });
    var f = [];
    b.edges.each(function (a) {
      var b = {};
      a.serializeEdgeProperties(b, c);
      f.push(b);
    });
    d = { id: c ? lb(a) : a.id, layout: Qa(a.constructor), p: d, iB: e, Nz: f };
    a.onNetworkSerialization(2, c, b, d);
    return d;
  }
  function xq(a, b, c) {
    c && (a.id = b.id);
    var d = a.diagram,
      e = a.createNetwork();
    a.onNetworkSerialization(3, c, e, b);
    var f = b.iB,
      g = new xb();
    f &&
      f.forEach(function (a) {
        var b = null;
        null === a.key || null === d || c || (b = d.Mb(a.key));
        null !== b ? (b = e.fk(b)) : ((b = e.createVertex()), e.tg(b));
        c && null !== a.key && (b.data = { ki: a.key });
        g.set(a.id, b);
      });
    var h = b.Nz,
      k = new xb();
    h &&
      h.forEach(function (a) {
        var b = null;
        null === a.key || null === d || c || (b = d.findLinkForKey(a.key));
        var f = e.createEdge();
        e.cm(f);
        f.link = b;
        c && null !== a.key && (f.data = { ki: a.key });
        k.set(a.id, f);
      });
    f &&
      f.forEach(function (a) {
        var b = g.get(a.id);
        b && b.deserializeVertexProperties(a, g, k, c);
      });
    h &&
      h.forEach(function (a) {
        var b = k.get(a.id);
        b && b.deserializeEdgeProperties(a, g, k, c);
      });
    a.deserializeLayoutProperties(b.p, g, k, c, e);
    a.onNetworkSerialization(4, c, e, b);
    return e;
  }
  zi.prototype.onNetworkSerialization = function () {};
  oa.Object.defineProperties(zi.prototype, {
    diagram: {
      configurable: !0,
      get: function () {
        return this.G;
      },
      set: function (a) {
        null !== a && x(a, Q, zi, "diagram");
        this.G = a;
      },
    },
    group: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        this.o !== a &&
          (null !== a && x(a, vf, zi, "group"),
          (this.o = a),
          null !== a && (this.G = a.diagram));
      },
    },
    isOngoing: {
      configurable: !0,
      get: function () {
        return this.fo;
      },
      set: function (a) {
        this.fo !== a && (A(a, "boolean", zi, "isOngoing"), (this.fo = a));
      },
    },
    isInitial: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.ii;
      },
      set: function (a) {
        A(a, "boolean", zi, "isInitial");
        this.ii = a;
        a || (this.lo = !0);
      },
    },
    isViewportSized: {
      configurable: !0,
      get: function () {
        return this.mo;
      },
      set: function (a) {
        this.mo !== a &&
          (A(a, "boolean", zi, "isViewportSized"), (this.mo = a) && this.F());
      },
    },
    isRouting: {
      configurable: !0,
      get: function () {
        return this.jo;
      },
      set: function (a) {
        this.jo !== a && (A(a, "boolean", zi, "isRouting"), (this.jo = a));
      },
    },
    isRealtime: {
      configurable: !0,
      get: function () {
        return this.io;
      },
      set: function (a) {
        this.io !== a &&
          (null !== a && A(a, "boolean", zi, "isRealtime"), (this.io = a));
      },
    },
    isValidLayout: {
      configurable: !0,
      get: function () {
        return this.lo;
      },
      set: function (a) {
        this.lo !== a &&
          (A(a, "boolean", zi, "isValidLayout"),
          (this.lo = a),
          a || ((a = this.diagram), null !== a && (a.Wh = !0)));
      },
    },
    network: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.j !== a &&
          (null !== a && x(a, mq, zi, "network"),
          (this.j = a),
          null !== a && (a.layout = this));
      },
    },
    boundsComputation: {
      configurable: !0,
      get: function () {
        return this.gn;
      },
      set: function (a) {
        this.gn !== a &&
          (null !== a && A(a, "function", zi, "boundsComputation"),
          (this.gn = a),
          this.F());
      },
    },
    arrangementOrigin: {
      configurable: !0,
      get: function () {
        return this.cn;
      },
      set: function (a) {
        x(a, K, zi, "arrangementOrigin");
        this.cn.D(a) || (this.cn.assign(a), this.F());
      },
    },
    id: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        this.B = a;
      },
    },
    mayUseWorkerFunction: {
      configurable: !0,
      get: function () {
        return this.Bo;
      },
      set: function (a) {
        this.Bo !== a &&
          (null !== a && A(a, "function", zi, "mayUseWorkerFunction"),
          (this.Bo = a));
      },
    },
    workerStateChanged: {
      configurable: !0,
      get: function () {
        return this.Qp;
      },
      set: function (a) {
        this.Qp !== a &&
          (null !== a && A(a, "function", zi, "workerStateChanged"),
          (this.Qp = a));
      },
    },
  });
  zi.prototype.useWorker = zi.prototype.jw;
  zi.declareWorkerLayout = sq;
  zi.prototype.cancelWorker = zi.prototype.uz;
  zi.prototype.collectParts = zi.prototype.Hx;
  zi.prototype.getLayoutBounds = zi.prototype.Vi;
  zi.prototype.invalidateLayout = zi.prototype.F;
  var tq = new xb(),
    vq =
      "object" === typeof sa.document && sa.document.currentScript
        ? sa.document.currentScript.src
        : "",
    wq =
      "undefined" !== typeof URL &&
      "function" === typeof URL.createObjectURL &&
      "function" === typeof Blob
        ? URL.createObjectURL(
            new Blob(
              [
                "self.onmessage=function(e){if(e.data.url){\nimportScripts(e.data.url);}}",
              ],
              { type: "text/javascript" }
            )
          )
        : "";
  zi.className = "Layout";
  zi.GoJSScriptURL = vq;
  zi.declareWorkerLayout = sq;
  "undefined" !== typeof self &&
    "undefined" !== typeof self.DedicatedWorkerGlobalScope &&
    "undefined" !== typeof self &&
    "undefined" !== typeof self.DedicatedWorkerGlobalScope &&
    (self.onmessage = function (a) {
      a = a.data;
      if ("_GoJS" === a._GoJS)
        if (a.url) importScripts(a.url);
        else if (a.version)
          self.postMessage({ _GoJS: "_GoJS", version: Q.version }, void 0);
        else {
          var b = performance.now(),
            c = null;
          a.layout && (c = rq(a.layout));
          var d = null;
          c && c.hv && (d = new c.hv());
          if (!d) throw Error("no registered Worker Layout: " + a.layout);
          d.network = xq(d, a, !0);
          d.workerLayout = function () {
            var a = zq(d, d.network, !1);
            a._GoJS = "_GoJS";
            a.time = performance.now() - b;
            self.postMessage(a, void 0);
            return !0;
          };
          d.doLayout(new H());
        }
    });
  function uq() {
    this.hv = null;
    this.hy = this.j = this.name = "";
    this.scripts = [];
    this.Ze = null;
    this.rm = new xb();
  }
  function mq(a) {
    ab(this);
    G && !a && v("LayoutNetwork constructor requires non-null Layout argument");
    this.Jc = a;
    this.zf = new I();
    this.ue = new I();
    this.Xs = new xb();
    this.Ss = new xb();
  }
  mq.prototype.clear = function () {
    if (this.zf) for (var a = this.zf.iterator; a.next(); ) a.value.clear();
    if (this.ue) for (a = this.ue.iterator; a.next(); ) a.value.clear();
    this.zf = new I();
    this.ue = new I();
    this.Xs = new xb();
    this.Ss = new xb();
  };
  mq.prototype.toString = function (a) {
    void 0 === a && (a = 0);
    var b =
      "LayoutNetwork" +
      (null !== this.layout ? "(" + this.layout.toString() + ")" : "");
    if (0 >= a) return b;
    b += " vertexes: " + this.zf.count + " edges: " + this.ue.count;
    if (1 < a) {
      for (var c = this.zf.iterator; c.next(); )
        b += "\n    " + c.value.toString(a - 1);
      for (c = this.ue.iterator; c.next(); )
        b += "\n    " + c.value.toString(a - 1);
    }
    return b;
  };
  mq.prototype.createVertex = function () {
    return new Aq(this);
  };
  mq.prototype.createEdge = function () {
    return new Bq(this);
  };
  mq.prototype.sg = function (a, b, c) {
    if (null !== a) {
      void 0 === b && (b = !1);
      A(b, "boolean", mq, "addParts:toplevelonly");
      void 0 === c && (c = null);
      null === c &&
        (c = function (a) {
          if (a instanceof V) return !a.isLinkLabel;
          if (a instanceof R) {
            var b = a.fromNode;
            if (null === b || b.isLinkLabel) return !1;
            a = a.toNode;
            return null === a || a.isLinkLabel ? !1 : !0;
          }
          return !1;
        });
      for (a = a.iterator; a.next(); ) {
        var d = a.value;
        if (d instanceof V && (!b || d.isTopLevel) && d.canLayout() && c(d))
          if (d instanceof vf && null === d.layout) this.sg(d.memberParts, !1);
          else if (null === this.Si(d)) {
            var e = this.createVertex();
            e.node = d;
            this.tg(e);
          }
      }
      for (a.reset(); a.next(); )
        if (
          ((d = a.value),
          d instanceof R &&
            (!b || d.isTopLevel) &&
            d.canLayout() &&
            c(d) &&
            null === this.eq(d))
        ) {
          var f = d.fromNode;
          e = d.toNode;
          null !== f &&
            null !== e &&
            f !== e &&
            ((f = this.findGroupVertex(f)),
            (e = this.findGroupVertex(e)),
            null !== f && null !== e && this.xk(f, e, d));
        }
    }
  };
  mq.prototype.findGroupVertex = function (a) {
    if (null === a) return null;
    var b = a.findVisibleNode();
    if (null === b) return null;
    a = this.Si(b);
    if (null !== a) return a;
    for (b = b.containingGroup; null !== b; ) {
      a = this.Si(b);
      if (null !== a) return a;
      b = b.containingGroup;
    }
    return null;
  };
  t = mq.prototype;
  t.tg = function (a) {
    if (null !== a) {
      G && x(a, Aq, mq, "addVertex:vertex");
      this.zf.add(a);
      var b = a.node;
      null !== b && this.Xs.add(b, a);
      a.network = this;
    }
  };
  t.fk = function (a) {
    if (null === a) return null;
    G && x(a, V, mq, "addNode:node");
    var b = this.Si(a);
    null === b && ((b = this.createVertex()), (b.node = a), this.tg(b));
    return b;
  };
  t.kv = function (a) {
    if (null !== a && (G && x(a, Aq, mq, "deleteVertex:vertex"), Cq(this, a))) {
      for (var b = a.Ad, c = b.count - 1; 0 <= c; c--) {
        var d = b.N(c);
        this.nk(d);
      }
      b = a.Md;
      for (a = b.count - 1; 0 <= a; a--) (c = b.N(a)), this.nk(c);
    }
  };
  function Cq(a, b) {
    if (null === b) return !1;
    var c = a.zf.remove(b);
    c && ((b = b.node), null !== b && a.Xs.remove(b));
    return c;
  }
  t.Gz = function (a) {
    null !== a &&
      (G && x(a, V, mq, "deleteNode:node"),
      (a = this.Si(a)),
      null !== a && this.kv(a));
  };
  t.Si = function (a) {
    if (null === a) return null;
    G && x(a, V, mq, "findVertex:node");
    return this.Xs.K(a);
  };
  t.cm = function (a) {
    if (null !== a) {
      G && x(a, Bq, mq, "addEdge:edge");
      Dq(this, a);
      var b = a.toVertex;
      null !== b && b.av(a);
      b = a.fromVertex;
      null !== b && b.Zu(a);
    }
  };
  function Dq(a, b) {
    if (null !== b) {
      a.ue.add(b);
      var c = b.link;
      null !== c && null === a.eq(c) && a.Ss.add(c, b);
      b.network = a;
    }
  }
  t.iz = function (a) {
    if (null === a) return null;
    G && x(a, R, mq, "addLink:link");
    var b = a.fromNode,
      c = a.toNode,
      d = this.eq(a);
    null === d
      ? ((d = this.createEdge()),
        (d.link = a),
        null !== b && (d.fromVertex = this.fk(b)),
        null !== c && (d.toVertex = this.fk(c)),
        this.cm(d))
      : (null !== b ? (d.fromVertex = this.fk(b)) : (d.fromVertex = null),
        null !== c ? (d.toVertex = this.fk(c)) : (d.toVertex = null));
    return d;
  };
  t.nk = function (a) {
    if (null !== a) {
      G && x(a, Bq, mq, "deleteEdge:edge");
      var b = a.toVertex;
      null !== b && b.jv(a);
      b = a.fromVertex;
      null !== b && b.iv(a);
      Eq(this, a);
    }
  };
  function Eq(a, b) {
    null !== b &&
      a.ue.remove(b) &&
      ((b = b.link), null !== b && a.Ss.remove(b));
  }
  t.Fz = function (a) {
    null !== a &&
      (G && x(a, R, mq, "deleteLink:link"),
      (a = this.eq(a)),
      null !== a && this.nk(a));
  };
  t.eq = function (a) {
    if (null === a) return null;
    G && x(a, R, mq, "findEdge:link");
    return this.Ss.K(a);
  };
  t.xk = function (a, b, c) {
    if (null === a || null === b) return null;
    G &&
      (x(a, Aq, mq, "linkVertexes:fromVertex"),
      x(b, Aq, mq, "linkVertexes:toVertex"),
      null !== c && x(c, R, mq, "linkVertexes:link"));
    if (a.network === this && b.network === this) {
      var d = this.createEdge();
      d.link = c;
      d.fromVertex = a;
      d.toVertex = b;
      this.cm(d);
      return d;
    }
    return null;
  };
  t.Dm = function (a) {
    if (null !== a) {
      G && x(a, Bq, mq, "reverseEdge:edge");
      var b = a.fromVertex,
        c = a.toVertex;
      null !== b && null !== c && (b.iv(a), c.jv(a), a.Dm(), b.av(a), c.Zu(a));
    }
  };
  t.bq = function () {
    for (var a = Ma(), b = this.ue.iterator; b.next(); ) {
      var c = b.value;
      c.fromVertex === c.toVertex && a.push(c);
    }
    b = a.length;
    for (c = 0; c < b; c++) this.nk(a[c]);
    Pa(a);
  };
  mq.prototype.deleteArtificialVertexes = function () {
    for (var a = Ma(), b = this.zf.iterator; b.next(); ) {
      var c = b.value;
      null === c.node && null === c.data && a.push(c);
    }
    c = a.length;
    for (b = 0; b < c; b++) this.kv(a[b]);
    b = Ma();
    for (c = this.ue.iterator; c.next(); ) {
      var d = c.value;
      null === d.link && null === d.data && b.push(d);
    }
    c = b.length;
    for (d = 0; d < c; d++) this.nk(b[d]);
    Pa(a);
    Pa(b);
  };
  function Fq(a) {
    for (var b = Ma(), c = a.ue.iterator; c.next(); ) {
      var d = c.value;
      (null !== d.fromVertex && null !== d.toVertex) || b.push(d);
    }
    c = b.length;
    for (d = 0; d < c; d++) a.nk(b[d]);
    Pa(b);
  }
  mq.prototype.Iy = function (a) {
    void 0 === a && (a = !0);
    a && (this.deleteArtificialVertexes(), Fq(this), this.bq());
    a = new H();
    for (var b = !0; b; ) {
      b = !1;
      for (var c = this.zf.iterator; c.next(); ) {
        var d = c.value;
        if (0 < d.Ad.count || 0 < d.Md.count) {
          b = this.layout.createNetwork();
          a.add(b);
          Gq(this, b, d);
          b = !0;
          break;
        }
      }
    }
    a.sort(function (a, b) {
      return null === a || null === b || a === b
        ? 0
        : b.vertexes.count - a.vertexes.count;
    });
    return a;
  };
  function Gq(a, b, c) {
    if (null !== c && c.network !== b) {
      Cq(a, c);
      b.tg(c);
      for (var d = c.sourceEdges; d.next(); ) {
        var e = d.value;
        e.network !== b && (Eq(a, e), Dq(b, e), Gq(a, b, e.fromVertex));
      }
      for (d = c.destinationEdges; d.next(); )
        (c = d.value),
          c.network !== b && (Eq(a, c), Dq(b, c), Gq(a, b, c.toVertex));
    }
  }
  mq.prototype.Oz = function () {
    for (var a = new I(), b = this.zf.iterator; b.next(); ) a.add(b.value.node);
    for (b = this.ue.iterator; b.next(); ) a.add(b.value.link);
    return a;
  };
  oa.Object.defineProperties(mq.prototype, {
    layout: {
      configurable: !0,
      get: function () {
        return this.Jc;
      },
      set: function (a) {
        null !== a && (this.Jc = a);
      },
    },
    vertexes: {
      configurable: !0,
      get: function () {
        return this.zf;
      },
    },
    edges: {
      configurable: !0,
      get: function () {
        return this.ue;
      },
    },
  });
  mq.prototype.findAllParts = mq.prototype.Oz;
  mq.prototype.splitIntoSubNetworks = mq.prototype.Iy;
  mq.prototype.deleteSelfEdges = mq.prototype.bq;
  mq.prototype.reverseEdge = mq.prototype.Dm;
  mq.prototype.linkVertexes = mq.prototype.xk;
  mq.prototype.findEdge = mq.prototype.eq;
  mq.prototype.deleteLink = mq.prototype.Fz;
  mq.prototype.deleteEdge = mq.prototype.nk;
  mq.prototype.addLink = mq.prototype.iz;
  mq.prototype.addEdge = mq.prototype.cm;
  mq.prototype.findVertex = mq.prototype.Si;
  mq.prototype.deleteNode = mq.prototype.Gz;
  mq.prototype.deleteVertex = mq.prototype.kv;
  mq.prototype.addNode = mq.prototype.fk;
  mq.prototype.addVertex = mq.prototype.tg;
  mq.prototype.addParts = mq.prototype.sg;
  mq.className = "LayoutNetwork";
  function Aq(a) {
    ab(this);
    G &&
      !a &&
      v("LayoutVertex constructor requires non-null LayoutNetwork argument");
    this.Zc = a;
    this.j = new M(0, 0, 10, 10).freeze();
    this.o = new K(5, 5).freeze();
    this.vi = this.qb = null;
    this.Ad = new H();
    this.Md = new H();
  }
  Aq.prototype.serializeVertexProperties = function (a) {
    a.id = lb(this);
    a.key = this.node ? this.node.key : this.data ? this.data.ki : void 0;
    void 0 === a.key && (a.key = null);
    a.x = this.bounds.x;
    a.y = this.bounds.y;
    a.jB = this.bounds.width;
    a.rA = this.bounds.height;
    a.fx = this.focus.x;
    a.fy = this.focus.y;
    var b = [];
    this.Ad.each(function (a) {
      b.push(lb(a));
    });
    a.Gy = b;
    var c = [];
    this.Md.each(function (a) {
      c.push(lb(a));
    });
    a.Nx = c;
  };
  Aq.prototype.deserializeVertexProperties = function (a, b, c) {
    if (null !== a) {
      this.x = a.x;
      this.y = a.y;
      this.width = a.jB;
      this.height = a.rA;
      this.focusX = a.fx;
      this.focusY = a.fy;
      var d = this;
      a.Gy &&
        a.Gy.forEach(function (a) {
          (a = c.get(a)) && d.Ad.add(a);
        });
      a.Nx &&
        a.Nx.forEach(function (a) {
          (a = c.get(a)) && d.Md.add(a);
        });
    }
  };
  Aq.prototype.clear = function () {
    this.vi = this.qb = null;
    this.Ad = new H();
    this.Md = new H();
  };
  Aq.prototype.toString = function (a) {
    void 0 === a && (a = 0);
    var b = "LayoutVertex#" + lb(this);
    if (
      0 < a &&
      ((b += null !== this.node ? "(" + this.node.toString() + ")" : ""), 1 < a)
    ) {
      a = "";
      for (var c = !0, d = this.Ad.iterator; d.next(); ) {
        var e = d.value;
        c ? (c = !1) : (a += ",");
        a += e.toString(0);
      }
      e = "";
      c = !0;
      for (d = this.Md.iterator; d.next(); ) {
        var f = d.value;
        c ? (c = !1) : (e += ",");
        e += f.toString(0);
      }
      b += " sources: " + a + " destinations: " + e;
    }
    return b;
  };
  Aq.prototype.commit = function () {
    var a = this.qb;
    if (null !== a) {
      var b = this.bounds,
        c = a.bounds;
      Ga(c)
        ? ((c.x = b.x), (c.y = b.y), (c.width = b.width), (c.height = b.height))
        : (a.bounds = b.copy());
    } else if (((a = this.node), null !== a)) {
      b = this.bounds;
      if (!(a instanceof vf)) {
        c = M.alloc();
        var d = this.network.layout.Vi(a, c),
          e = a.locationObject.ka(Kc);
        if (d.s() && e.s()) {
          a.moveTo(
            b.x + this.focusX - (e.x - d.x),
            b.y + this.focusY - (e.y - d.y)
          );
          M.free(c);
          return;
        }
        M.free(c);
      }
      a.moveTo(b.x, b.y);
    }
  };
  Aq.prototype.av = function (a) {
    null !== a &&
      (G && x(a, Bq, Aq, "addSourceEdge:edge"),
      this.Ad.contains(a) || this.Ad.add(a));
  };
  Aq.prototype.jv = function (a) {
    null !== a &&
      (G && x(a, Bq, Aq, "deleteSourceEdge:edge"), this.Ad.remove(a));
  };
  Aq.prototype.Zu = function (a) {
    null !== a &&
      (G && x(a, Bq, Aq, "addDestinationEdge:edge"),
      this.Md.contains(a) || this.Md.add(a));
  };
  Aq.prototype.iv = function (a) {
    null !== a &&
      (G && x(a, Bq, Aq, "deleteDestinationEdge:edge"), this.Md.remove(a));
  };
  function Hq(a, b) {
    G && x(a, Aq, Aq, "standardComparer:m");
    G && x(b, Aq, Aq, "standardComparer:n");
    a = a.vi;
    b = b.vi;
    return a
      ? b
        ? ((a = a.text), (b = b.text), a < b ? -1 : a > b ? 1 : 0)
        : 1
      : null !== b
      ? -1
      : 0;
  }
  oa.Object.defineProperties(Aq.prototype, {
    sourceEdgesArrayAccess: {
      configurable: !0,
      get: function () {
        return this.Ad._dataArray;
      },
    },
    destinationEdgesArrayAccess: {
      configurable: !0,
      get: function () {
        return this.Md._dataArray;
      },
    },
    data: {
      configurable: !0,
      get: function () {
        return this.qb;
      },
      set: function (a) {
        this.qb = a;
        if (null !== a && a.bounds) {
          var b = a.bounds;
          a = b.x;
          var c = b.y,
            d = b.width;
          b = b.height;
          this.o.h(d / 2, b / 2);
          this.j.h(a, c, d, b);
        }
      },
    },
    node: {
      configurable: !0,
      get: function () {
        return this.vi;
      },
      set: function (a) {
        if (this.vi !== a) {
          G && null !== a && x(a, V, Aq, "node");
          this.vi = a;
          a.Za();
          var b = this.network.layout,
            c = M.alloc(),
            d = b.Vi(a, c);
          b = d.x;
          var e = d.y,
            f = d.width;
          d = d.height;
          isNaN(b) && (b = 0);
          isNaN(e) && (e = 0);
          this.j.h(b, e, f, d);
          M.free(c);
          if (!(a instanceof vf) && ((a = a.locationObject.ka(Kc)), a.s())) {
            this.o.h(a.x - b, a.y - e);
            return;
          }
          this.o.h(f / 2, d / 2);
        }
      },
    },
    bounds: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.j.D(a) || (G && x(a, M, Aq, "bounds"), this.j.assign(a));
      },
    },
    focus: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        this.o.D(a) || (G && x(a, K, Aq, "focus"), this.o.assign(a));
      },
    },
    centerX: {
      configurable: !0,
      get: function () {
        return this.j.x + this.o.x;
      },
      set: function (a) {
        var b = this.j;
        b.x + this.o.x !== a &&
          (G && D(a, Aq, "centerX"), b.la(), (b.x = a - this.o.x), b.freeze());
      },
    },
    centerY: {
      configurable: !0,
      get: function () {
        return this.j.y + this.o.y;
      },
      set: function (a) {
        var b = this.j;
        b.y + this.o.y !== a &&
          (G && D(a, Aq, "centerY"), b.la(), (b.y = a - this.o.y), b.freeze());
      },
    },
    focusX: {
      configurable: !0,
      get: function () {
        return this.o.x;
      },
      set: function (a) {
        var b = this.o;
        b.x !== a && (b.la(), (b.x = a), b.freeze());
      },
    },
    focusY: {
      configurable: !0,
      get: function () {
        return this.o.y;
      },
      set: function (a) {
        var b = this.o;
        b.y !== a && (b.la(), (b.y = a), b.freeze());
      },
    },
    x: {
      configurable: !0,
      get: function () {
        return this.j.x;
      },
      set: function (a) {
        var b = this.j;
        b.x !== a && (b.la(), (b.x = a), b.freeze());
      },
    },
    y: {
      configurable: !0,
      get: function () {
        return this.j.y;
      },
      set: function (a) {
        var b = this.j;
        b.y !== a && (b.la(), (b.y = a), b.freeze());
      },
    },
    width: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.j.width;
      },
      set: function (a) {
        var b = this.j;
        b.width !== a && (b.la(), (b.width = a), b.freeze());
      },
    },
    height: {
      configurable: !0,
      get: function () {
        return this.j.height;
      },
      set: function (a) {
        var b = this.j;
        b.height !== a && (b.la(), (b.height = a), b.freeze());
      },
    },
    network: {
      configurable: !0,
      get: function () {
        return this.Zc;
      },
      set: function (a) {
        G && x(a, mq, Aq, "network");
        this.Zc = a;
      },
    },
    sourceVertexes: {
      configurable: !0,
      get: function () {
        for (var a = new I(), b = this.sourceEdges; b.next(); )
          a.add(b.value.fromVertex);
        return a.iterator;
      },
    },
    destinationVertexes: {
      configurable: !0,
      get: function () {
        for (var a = new I(), b = this.destinationEdges; b.next(); )
          a.add(b.value.toVertex);
        return a.iterator;
      },
    },
    vertexes: {
      configurable: !0,
      get: function () {
        for (var a = new I(), b = this.sourceEdges; b.next(); )
          a.add(b.value.fromVertex);
        for (b = this.destinationEdges; b.next(); ) a.add(b.value.toVertex);
        return a.iterator;
      },
    },
    sourceEdges: {
      configurable: !0,
      get: function () {
        return this.Ad.iterator;
      },
    },
    destinationEdges: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Md.iterator;
      },
    },
    edges: {
      configurable: !0,
      get: function () {
        for (var a = new H(), b = this.sourceEdges; b.next(); ) a.add(b.value);
        for (b = this.destinationEdges; b.next(); ) a.add(b.value);
        return a.iterator;
      },
    },
    edgesCount: {
      configurable: !0,
      get: function () {
        return this.Ad.count + this.Md.count;
      },
    },
  });
  Aq.prototype.deleteDestinationEdge = Aq.prototype.iv;
  Aq.prototype.addDestinationEdge = Aq.prototype.Zu;
  Aq.prototype.deleteSourceEdge = Aq.prototype.jv;
  Aq.prototype.addSourceEdge = Aq.prototype.av;
  Aq.className = "LayoutVertex";
  Aq.standardComparer = Hq;
  Aq.smartComparer = function (a, b) {
    G && x(a, Aq, Aq, "smartComparer:m");
    G && x(b, Aq, Aq, "smartComparer:n");
    if (null !== a) {
      if (null !== b) {
        a = a.vi;
        var c = b.vi;
        if (null !== a) {
          if (null !== c) {
            b = a.text
              .toLocaleLowerCase()
              .split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);
            a = c.text
              .toLocaleLowerCase()
              .split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);
            for (c = 0; c < b.length; c++)
              if ("" !== a[c] && void 0 !== a[c]) {
                var d = parseFloat(b[c]),
                  e = parseFloat(a[c]);
                if (isNaN(d))
                  if (isNaN(e)) {
                    if (0 !== b[c].localeCompare(a[c]))
                      return b[c].localeCompare(a[c]);
                  } else return 1;
                else {
                  if (isNaN(e)) return -1;
                  if (0 !== d - e) return d - e;
                }
              } else if ("" !== b[c]) return 1;
            return "" !== a[c] && void 0 !== a[c] ? -1 : 0;
          }
          return 1;
        }
        return null !== c ? -1 : 0;
      }
      return 1;
    }
    return null !== b ? -1 : 0;
  };
  function Bq(a) {
    ab(this);
    G &&
      !a &&
      v("LayoutEdge constructor requires non-null LayoutNetwork argument");
    this.Yc = a;
    this.ld = this.cd = this.Bl = this.qb = null;
  }
  Bq.prototype.clear = function () {
    this.ld = this.cd = this.Bl = this.qb = null;
  };
  Bq.prototype.serializeEdgeProperties = function (a) {
    a.id = lb(this);
    a.key = this.link ? this.link.key : this.data ? this.data.ki : void 0;
    void 0 === a.key && (a.key = null);
    a.from = this.fromVertex ? lb(this.fromVertex) : null;
    a.eB = this.toVertex ? lb(this.toVertex) : null;
  };
  Bq.prototype.deserializeEdgeProperties = function (a, b) {
    if (null !== a) {
      var c = b.get(a.from);
      c && (this.fromVertex = c);
      if ((a = b.get(a.eB))) this.toVertex = a;
    }
  };
  Bq.prototype.toString = function (a) {
    void 0 === a && (a = 0);
    var b = "LayoutEdge#" + lb(this);
    0 < a &&
      ((b += null !== this.Bl ? "(" + this.Bl.toString() + ")" : ""),
      1 < a &&
        (b +=
          " " +
          (this.cd ? this.cd.toString() : "null") +
          " --\x3e " +
          (this.ld ? this.ld.toString() : "null")));
    return b;
  };
  Bq.prototype.Dm = function () {
    var a = this.cd;
    this.cd = this.ld;
    this.ld = a;
  };
  Bq.prototype.commit = function () {};
  Bq.prototype.by = function (a) {
    G && x(a, Aq, Bq, "getOtherVertex:v");
    return this.ld === a ? this.cd : this.cd === a ? this.ld : null;
  };
  oa.Object.defineProperties(Bq.prototype, {
    network: {
      configurable: !0,
      get: function () {
        return this.Yc;
      },
      set: function (a) {
        G && x(a, mq, Bq, "network");
        this.Yc = a;
      },
    },
    data: {
      configurable: !0,
      get: function () {
        return this.qb;
      },
      set: function (a) {
        this.qb !== a &&
          (G && null !== a && A(a, "object", Bq, "data"), (this.qb = a));
      },
    },
    link: {
      configurable: !0,
      get: function () {
        return this.Bl;
      },
      set: function (a) {
        this.Bl !== a &&
          (G && null !== a && x(a, R, Bq, "link"), (this.Bl = a));
      },
    },
    fromVertex: {
      configurable: !0,
      get: function () {
        return this.cd;
      },
      set: function (a) {
        this.cd !== a &&
          (G && null !== a && x(a, Aq, Bq, "fromVertex"), (this.cd = a));
      },
    },
    toVertex: {
      configurable: !0,
      get: function () {
        return this.ld;
      },
      set: function (a) {
        this.ld !== a &&
          (G && null !== a && x(a, Aq, Bq, "toVertex"), (this.ld = a));
      },
    },
  });
  Bq.prototype.getOtherVertex = Bq.prototype.by;
  Bq.className = "LayoutEdge";
  function Zk(a) {
    zi.call(this);
    this.isViewportSized = !0;
    this.Rp = this.Sp = NaN;
    this.Eg = new Gb(NaN, NaN).freeze();
    this.sf = new Gb(10, 10).freeze();
    this.Eb = Iq;
    this.Pb = Jq;
    this.hd = Kq;
    this.ad = Lq;
    a && Object.assign(this, a);
  }
  na(Zk, zi);
  Zk.prototype.cloneProtected = function (a) {
    zi.prototype.cloneProtected.call(this, a);
    a.Sp = this.Sp;
    a.Rp = this.Rp;
    a.Eg.assign(this.Eg);
    a.sf.assign(this.sf);
    a.Eb = this.Eb;
    a.Pb = this.Pb;
    a.hd = this.hd;
    a.ad = this.ad;
  };
  Zk.prototype.pb = function (a) {
    a.classType === Zk
      ? a === Kq || a === Mq || a === Nq || a === Oq
        ? (this.sorting = a)
        : a === Jq || a === Pq
        ? (this.arrangement = a)
        : a === Iq || a === Qq
        ? (this.alignment = a)
        : v("Unknown enum value: " + a)
      : zi.prototype.pb.call(this, a);
  };
  Zk.prototype.doLayout = function (a) {
    G &&
      null === a &&
      v(
        "Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts"
      );
    this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin);
    var b = this.Hx(a);
    a = this.diagram;
    for (var c = b.copy().iterator; c.next(); ) {
      var d = c.value;
      if (!d.Mh() || (null === d.fromNode && null === d.toNode)) {
        if ((d.Za(), d instanceof vf))
          for (d = d.memberParts; d.next(); ) b.remove(d.value);
      } else b.remove(d);
    }
    var e = b.Ga();
    if (0 !== e.length) {
      switch (this.sorting) {
        case Oq:
          e.reverse();
          break;
        case Kq:
          e.sort(this.comparer);
          break;
        case Mq:
          e.sort(this.comparer), e.reverse();
      }
      var f = this.wrappingColumn;
      isNaN(f) && (f = 0);
      var g = this.wrappingWidth;
      isNaN(g) && null !== a
        ? ((b = a.padding),
          (g = Math.max(a.viewportBounds.width - b.left - b.right, 0)))
        : (g = Math.max(this.wrappingWidth, 0));
      0 >= f && 0 >= g && (f = 1);
      b = this.spacing.width;
      isFinite(b) || (b = 0);
      c = this.spacing.height;
      isFinite(c) || (c = 0);
      null !== a && a.Fa("Layout");
      d = [];
      switch (this.alignment) {
        case Qq:
          var h = b,
            k = c,
            l = M.alloc(),
            m = Math.max(this.cellSize.width, 1);
          if (!isFinite(m))
            for (var n = (m = 0); n < e.length; n++) {
              var p = this.Vi(e[n], l);
              m = Math.max(m, p.width);
            }
          m = Math.max(m + h, 1);
          n = Math.max(this.cellSize.height, 1);
          if (!isFinite(n))
            for (p = n = 0; p < e.length; p++) {
              var r = this.Vi(e[p], l);
              n = Math.max(n, r.height);
            }
          n = Math.max(n + k, 1);
          p = this.arrangement;
          for (
            var q = (r = this.arrangementOrigin.x),
              u = this.arrangementOrigin.y,
              w = 0,
              y = 0,
              z = 0;
            z < e.length;
            z++
          ) {
            var B = e[z],
              C = this.Vi(B, l),
              E = Math.ceil((C.width + h) / m) * m,
              J = Math.ceil((C.height + k) / n) * n;
            switch (p) {
              case Pq:
                var S = Math.abs(q - C.width);
                break;
              default:
                S = q + C.width;
            }
            if ((0 < f && w > f - 1) || (0 < g && 0 < w && S - r > g))
              d.push(new M(0, u, g + h, y)),
                (w = 0),
                (q = r),
                (u += y),
                (y = 0);
            y = Math.max(y, J);
            switch (p) {
              case Pq:
                C = -C.width;
                break;
              default:
                C = 0;
            }
            B.moveTo(q + C, u);
            switch (p) {
              case Pq:
                q -= E;
                break;
              default:
                q += E;
            }
            w++;
          }
          d.push(new M(0, u, g + h, y));
          M.free(l);
          break;
        case Iq:
          k = g;
          m = f;
          n = b;
          p = c;
          g = M.alloc();
          r = Math.max(this.cellSize.width, 1);
          f = u = l = 0;
          h = K.alloc();
          for (q = 0; q < e.length; q++)
            (y = e[q]),
              (w = this.Vi(y, g)),
              (y = Qo(y, y.locationObject, y.locationSpot, h)),
              (l = Math.max(l, y.x)),
              (u = Math.max(u, w.width - y.x)),
              (f = Math.max(f, y.y));
          q = this.arrangement;
          switch (q) {
            case Pq:
              l += n;
              break;
            default:
              u += n;
          }
          r = isFinite(r) ? Math.max(r + n, 1) : Math.max(l + u, 1);
          var aa = (y = this.arrangementOrigin.x);
          z = this.arrangementOrigin.y;
          u = 0;
          k >= l && (k -= l);
          l = B = 0;
          E = Math.max(this.cellSize.height, 1);
          C = f = 0;
          J = !0;
          w = K.alloc();
          for (S = 0; S < e.length; S++) {
            var Y = e[S],
              T = this.Vi(Y, g),
              P = Qo(Y, Y.locationObject, Y.locationSpot, h);
            if (0 < u)
              switch (q) {
                case Pq:
                  aa = (aa - y - (T.width - P.x)) / r;
                  aa = L.da(Math.round(aa), aa)
                    ? Math.round(aa)
                    : Math.floor(aa);
                  aa = aa * r + y;
                  break;
                default:
                  (aa = (aa - y + P.x) / r),
                    (aa = L.da(Math.round(aa), aa)
                      ? Math.round(aa)
                      : Math.ceil(aa)),
                    (aa = aa * r + y);
              }
            else
              switch (q) {
                case Pq:
                  B = aa + P.x + T.width;
                  break;
                default:
                  B = aa - P.x;
              }
            switch (q) {
              case Pq:
                var ma = -(aa + P.x) + B;
                break;
              default:
                ma = aa + T.width - P.x - B;
            }
            if ((0 < m && u > m - 1) || (0 < k && 0 < u && ma > k)) {
              d.push(new M(0, J ? z - f : z, k + n, C + f + p));
              for (aa = 0; aa < u && S !== u; aa++) {
                ma = e[S - u + aa];
                var ia = Qo(ma, ma.locationObject, ma.locationSpot, w);
                ma.moveTo(ma.position.x, ma.position.y + f - ia.y);
              }
              C += p;
              z = J ? z + C : z + (C + f);
              u = C = f = 0;
              aa = y;
              J = !1;
            }
            aa === y &&
              (l = q === Pq ? Math.max(l, T.width - P.x) : Math.min(l, -P.x));
            f = Math.max(f, P.y);
            C = Math.max(C, T.height - P.y);
            isFinite(E) && (C = Math.max(C, Math.max(T.height, E) - P.y));
            J ? Y.moveTo(aa - P.x, z - P.y) : Y.moveTo(aa - P.x, z);
            switch (q) {
              case Pq:
                aa -= P.x + n;
                break;
              default:
                aa += T.width - P.x + n;
            }
            u++;
          }
          d.push(new M(0, z, k + n, (J ? C : C + f) + p));
          if (e.length !== u)
            for (k = 0; k < u; k++)
              (m = e[e.length - u + k]),
                (n = Qo(m, m.locationObject, m.locationSpot, h)),
                m.moveTo(m.position.x, m.position.y + f - n.y);
          K.free(h);
          K.free(w);
          if (q === Pq)
            for (e = 0; e < d.length; e++)
              (f = d[e]), (f.width += l), (f.x -= l);
          else
            for (e = 0; e < d.length; e++)
              (f = d[e]), f.x > l && ((f.width += f.x - l), (f.x = l));
          M.free(g);
      }
      for (h = f = g = e = 0; h < d.length; h++)
        (k = d[h]),
          (e = Math.min(e, k.x)),
          (g = Math.min(g, k.y)),
          (f = Math.max(f, k.x + k.width));
      this.arrangement === Pq
        ? this.commitLayers(d, new K(e + b / 2 - (f + e), g - c / 2))
        : this.commitLayers(d, new K(e - b / 2, g - c / 2));
      null !== a && a.gb("Layout");
      this.isValidLayout = !0;
    }
  };
  Zk.prototype.commitLayers = function () {};
  function Lq(a, b) {
    G && x(a, U, Zk, "standardComparer:a");
    G && x(b, U, Zk, "standardComparer:b");
    a = a.text;
    b = b.text;
    return a < b ? -1 : a > b ? 1 : 0;
  }
  oa.Object.defineProperties(Zk.prototype, {
    wrappingWidth: {
      configurable: !0,
      get: function () {
        return this.Sp;
      },
      set: function (a) {
        this.Sp !== a &&
          (A(a, "number", Zk, "wrappingWidth"), 0 < a || isNaN(a)) &&
          ((this.Sp = a), (this.isViewportSized = isNaN(a)), this.F());
      },
    },
    wrappingColumn: {
      configurable: !0,
      get: function () {
        return this.Rp;
      },
      set: function (a) {
        this.Rp !== a &&
          (A(a, "number", Zk, "wrappingColumn"), 0 < a || isNaN(a)) &&
          ((this.Rp = a), this.F());
      },
    },
    cellSize: {
      configurable: !0,
      get: function () {
        return this.Eg;
      },
      set: function (a) {
        x(a, Gb, Zk, "cellSize");
        this.Eg.D(a) || (this.Eg.assign(a), this.F());
      },
    },
    spacing: {
      configurable: !0,
      get: function () {
        return this.sf;
      },
      set: function (a) {
        x(a, Gb, Zk, "spacing");
        this.sf.D(a) || (this.sf.assign(a), this.F());
      },
    },
    alignment: {
      configurable: !0,
      get: function () {
        return this.Eb;
      },
      set: function (a) {
        this.Eb !== a &&
          (cb(a, Zk, Zk, "alignment"), a === Iq || a === Qq) &&
          ((this.Eb = a), this.F());
      },
    },
    arrangement: {
      configurable: !0,
      get: function () {
        return this.Pb;
      },
      set: function (a) {
        this.Pb !== a &&
          (cb(a, Zk, Zk, "arrangement"), a === Jq || a === Pq) &&
          ((this.Pb = a), this.F());
      },
    },
    sorting: {
      configurable: !0,
      get: function () {
        return this.hd;
      },
      set: function (a) {
        this.hd !== a &&
          (cb(a, Zk, Zk, "sorting"),
          a === Nq || a === Oq || a === Kq || a === Mq) &&
          ((this.hd = a), this.F());
      },
    },
    comparer: {
      configurable: !0,
      get: function () {
        return this.ad;
      },
      set: function (a) {
        this.ad !== a &&
          (A(a, "function", Zk, "comparer"), (this.ad = a), this.F());
      },
    },
  });
  var Qq = new F(Zk, "Position", 0),
    Iq = new F(Zk, "Location", 1),
    Jq = new F(Zk, "LeftToRight", 2),
    Pq = new F(Zk, "RightToLeft", 3),
    Nq = new F(Zk, "Forward", 4),
    Oq = new F(Zk, "Reverse", 5),
    Kq = new F(Zk, "Ascending", 6),
    Mq = new F(Zk, "Descending", 7);
  Zk.className = "GridLayout";
  Zk.standardComparer = Lq;
  Zk.smartComparer = function (a, b) {
    G && x(a, U, Zk, "standardComparer:a");
    G && x(b, U, Zk, "standardComparer:b");
    if (null !== a) {
      if (null !== b) {
        a = a.text
          .toLocaleLowerCase()
          .split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);
        b = b.text
          .toLocaleLowerCase()
          .split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);
        for (var c = 0; c < a.length; c++)
          if ("" !== b[c] && void 0 !== b[c]) {
            var d = parseFloat(a[c]),
              e = parseFloat(b[c]);
            if (isNaN(d))
              if (isNaN(e)) {
                if (0 !== a[c].localeCompare(b[c]))
                  return a[c].localeCompare(b[c]);
              } else return 1;
            else {
              if (isNaN(e)) return -1;
              if (0 !== d - e) return d - e;
            }
          } else if ("" !== a[c]) return 1;
        return "" !== b[c] && void 0 !== b[c] ? -1 : 0;
      }
      return 1;
    }
    return null !== b ? -1 : 0;
  };
  Zk.Position = Qq;
  Zk.Location = Iq;
  Zk.LeftToRight = Jq;
  Zk.RightToLeft = Pq;
  Zk.Forward = Nq;
  Zk.Reverse = Oq;
  Zk.Ascending = Kq;
  Zk.Descending = Mq;
  function vi() {
    this.Oo = new I();
    this.vo = new I();
    this.Ma = new I();
    this.cf = new xb();
    this.bf = new xb();
    this.Ij = new xb();
    this.G = null;
    this.Lq = !1;
  }
  t = vi.prototype;
  t.clear = function () {
    this.Oo.clear();
    this.vo.clear();
    this.Ma.clear();
    this.cf.clear();
    this.bf.clear();
    this.Ij.clear();
  };
  t.Xe = function (a) {
    G && null !== a && x(a, Q, vi, "setDiagram");
    this.G = a;
  };
  t.Wi = function (a) {
    if (a instanceof V) {
      if ((this.Oo.add(a), a instanceof vf)) {
        var b = a.containingGroup;
        null === b ? this.G.Fi.add(a) : b.Hl.add(a);
        b = a.layout;
        null !== b && (b.diagram = this.G);
      }
    } else a instanceof R ? this.vo.add(a) : a instanceof Je || this.Ma.add(a);
    b = a.data;
    null === b ||
      a instanceof Je ||
      (a instanceof R ? this.bf.add(b, a) : this.cf.add(b, a));
  };
  t.kc = function (a) {
    a.gk();
    if (a instanceof V) {
      if ((this.Oo.remove(a), a instanceof vf)) {
        var b = a.containingGroup;
        null === b ? this.G.Fi.remove(a) : b.Hl.remove(a);
        b = a.layout;
        null !== b && (b.diagram = null);
      }
    } else
      a instanceof R ? this.vo.remove(a) : a instanceof Je || this.Ma.remove(a);
    b = a.data;
    null === b ||
      a instanceof Je ||
      (a instanceof R ? this.bf.remove(b) : this.cf.remove(b));
  };
  t.Rd = function () {
    var a = this.G;
    if (null !== a) {
      for (var b = a.nodeTemplateMap.iterator; b.next(); ) {
        var c = b.value,
          d = b.key;
        (!c.Tc() || c instanceof vf) &&
          v(
            'Invalid node template in Diagram.nodeTemplateMap: template for "' +
              d +
              '" must be a Node or a simple Part, not a Group or Link: ' +
              c
          );
      }
      for (b = a.groupTemplateMap.iterator; b.next(); )
        (c = b.value),
          (d = b.key),
          c instanceof vf ||
            v(
              'Invalid group template in Diagram.groupTemplateMap: template for "' +
                d +
                '" must be a Group, not a normal Node or Link: ' +
                c
            );
      for (b = a.linkTemplateMap.iterator; b.next(); )
        (c = b.value),
          (d = b.key),
          c instanceof R ||
            v(
              'Invalid link template in Diagram.linkTemplateMap: template for "' +
                d +
                '" must be a Link, not a normal Node or simple Part: ' +
                c
            );
      b = Ma();
      for (c = a.selection.iterator; c.next(); )
        (d = c.value.data) && b.push(d);
      c = Ma();
      for (a = a.highlighteds.iterator; a.next(); )
        (d = a.value.data) && c.push(d);
      a = Ma();
      for (d = this.nodes.iterator; d.next(); ) {
        var e = d.value;
        null !== e.data && (a.push(e.data), a.push(e.location));
      }
      for (d = this.links.iterator; d.next(); )
        (e = d.value), null !== e.data && (a.push(e.data), a.push(e.location));
      for (d = this.parts.iterator; d.next(); )
        (e = d.value), null !== e.data && (a.push(e.data), a.push(e.location));
      this.removeAllModeledParts();
      this.addAllModeledParts();
      for (d = 0; d < b.length; d++)
        (e = this.Fc(b[d])), null !== e && (e.isSelected = !0);
      for (d = 0; d < c.length; d++)
        (e = this.Fc(c[d])), null !== e && (e.isHighlighted = !0);
      for (d = 0; d < a.length; d += 2)
        (e = this.Fc(a[d])), null !== e && (e.location = a[d + 1]);
      Pa(b);
      Pa(c);
      Pa(a);
    }
  };
  vi.prototype.addAllModeledParts = function () {
    this.addModeledParts(this.diagram.model.nodeDataArray);
  };
  vi.prototype.addModeledParts = function (a, b) {
    var c = this,
      d = this.diagram.model;
    a.forEach(function (a) {
      d.bb(a) && Rq(c, a, !1);
    });
    a.forEach(function (a) {
      d.bb(a) && c.resolveReferencesForData(a);
    });
    !1 !== b && mk(this.diagram, !1);
  };
  function Rq(a, b, c) {
    if (
      void 0 !== b &&
      null !== b &&
      !a.diagram.undoManager.isUndoingRedoing &&
      !a.cf.contains(b)
    ) {
      void 0 === c && (c = !0);
      a: {
        if (
          void 0 !== b &&
          null !== b &&
          !a.G.undoManager.isUndoingRedoing &&
          !a.cf.contains(b)
        ) {
          var d = a.iq(b);
          var e = bp(a, b, d);
          if (null !== e && (sg(e), (e = e.copy()), null !== e)) {
            var f = a.diagram.skipsModelSourceBindings;
            a.diagram.skipsModelSourceBindings = !0;
            e.Vf = d;
            e.qb = b;
            a.Lq && (e.Zg = "Tool");
            a.diagram.add(e);
            e.qb = null;
            e.data = b;
            a.diagram.skipsModelSourceBindings = f;
            d = e;
            break a;
          }
        }
        d = null;
      }
      null !== d && c && a.resolveReferencesForData(b);
    }
  }
  vi.prototype.insertLink = function () {
    return null;
  };
  vi.prototype.resolveReferencesForData = function () {};
  vi.prototype.iq = function (a) {
    return this.G.model.iq(a);
  };
  function bp(a, b, c) {
    a = a.G;
    var d = a.model;
    d.Xi() && d.Os(b)
      ? ((b = a.groupTemplateMap.K(c)),
        null === b &&
          ((b = a.groupTemplateMap.K("")),
          null === b &&
            (Sq ||
              ((Sq = !0),
              Fa('No Group template found for category "' + c + '"'),
              Fa("  Using default group template")),
            (b = a.Sy))))
      : ((b = a.nodeTemplateMap.K(c)),
        null === b &&
          ((b = a.nodeTemplateMap.K("")),
          null === b &&
            (Tq ||
              ((Tq = !0),
              Fa('No Node template found for category "' + c + '"'),
              Fa("  Using default node template")),
            (b = a.Uy))));
    return b;
  }
  vi.prototype.getLinkCategoryForData = function () {
    return "";
  };
  vi.prototype.setLinkCategoryForData = function () {};
  vi.prototype.setFromNodeForLink = function () {};
  vi.prototype.setToNodeForLink = function () {};
  vi.prototype.findLinkTemplateForCategory = function (a) {
    var b = this.G,
      c = b.linkTemplateMap.K(a);
    null === c &&
      ((c = b.linkTemplateMap.K("")),
      null === c &&
        (Uq ||
          ((Uq = !0),
          Fa('No Link template found for category "' + a + '"'),
          Fa("  Using default link template")),
        (c = b.Ty)));
    return c;
  };
  vi.prototype.removeAllModeledParts = function () {
    this.$s(this.diagram.model.nodeDataArray);
  };
  vi.prototype.$s = function (a) {
    var b = this;
    a.forEach(function (a) {
      b.Aq(a);
    });
  };
  vi.prototype.Aq = function (a) {
    a = this.Fc(a);
    null !== a && (Tj(this.diagram, a, !1), this.unresolveReferencesForPart(a));
  };
  vi.prototype.unresolveReferencesForPart = function () {};
  vi.prototype.removeDataForLink = function () {};
  vi.prototype.findPartForKey = function (a) {
    if (null === a || void 0 === a) return null;
    a = this.G.model.cc(a);
    return null !== a ? this.cf.K(a) : null;
  };
  vi.prototype.Mb = function (a) {
    if (null === a || void 0 === a) return null;
    a = this.G.model.cc(a);
    if (null === a) return null;
    a = this.cf.K(a);
    return a instanceof V ? a : null;
  };
  vi.prototype.findLinkForKey = function () {
    return null;
  };
  t = vi.prototype;
  t.Fc = function (a) {
    if (null === a) return null;
    var b = this.cf.K(a);
    return null !== b ? b : (b = this.bf.K(a));
  };
  t.Pi = function (a) {
    if (null === a) return null;
    a = this.cf.K(a);
    return a instanceof V ? a : null;
  };
  t.Ec = function (a) {
    return null === a ? null : this.bf.K(a);
  };
  t.Ds = function (a) {
    for (var b = 0; b < arguments.length; ++b);
    b = new I();
    for (var c = this.Oo.iterator; c.next(); ) {
      var d = c.value,
        e = d.data;
      if (null !== e)
        for (var f = 0; f < arguments.length; f++) {
          var g = arguments[f];
          if (Ga(g) && Vq(this, e, g)) {
            b.add(d);
            break;
          }
        }
    }
    return b.iterator;
  };
  t.Cs = function (a) {
    for (var b = 0; b < arguments.length; ++b);
    b = new I();
    for (var c = this.vo.iterator; c.next(); ) {
      var d = c.value,
        e = d.data;
      if (null !== e)
        for (var f = 0; f < arguments.length; f++) {
          var g = arguments[f];
          if (Ga(g) && Vq(this, e, g)) {
            b.add(d);
            break;
          }
        }
    }
    return b.iterator;
  };
  function Vq(a, b, c) {
    for (var d in c) {
      var e = b[d],
        f = c[d];
      if (Ha(f)) {
        if (!Ha(e) || e.length < f.length) return !1;
        for (var g = 0; g < e.length; g++) {
          var h = f[g];
          if (void 0 !== h && !Wq(a, e[g], h)) return !1;
        }
      } else if (!Wq(a, e, f)) return !1;
    }
    return !0;
  }
  function Wq(a, b, c) {
    if ("function" === typeof c) {
      if (!c(b)) return !1;
    } else if (c instanceof RegExp) {
      if (!b || !c.test(b.toString())) return !1;
    } else if (Ga(b) && Ga(c)) {
      if (!Vq(a, b, c)) return !1;
    } else if (b !== c) return !1;
    return !0;
  }
  vi.prototype.doModelChanged = function (a) {
    if (this.G) {
      var b = this.G;
      if (a.model === b.model) {
        var c = a.change;
        b.doModelChanged(a);
        if (b.ba) {
          b.ba = !1;
          try {
            var d = a.modelChange;
            if ("" !== d)
              if (c === pe) {
                if ("nodeCategory" === d) {
                  var e = this.Fc(a.object),
                    f = a.newValue;
                  null !== e && "string" === typeof f && (e.category = f);
                } else
                  "nodeDataArray" === d &&
                    (this.$s(a.oldValue), this.addModeledParts(a.newValue));
                b.isModified = !0;
              } else if (c === re) {
                var g = a.newValue;
                "nodeDataArray" === d && Ga(g) && Rq(this, g);
                b.isModified = !0;
              } else if (c === se) {
                var h = a.oldValue;
                "nodeDataArray" === d && Ga(h) && this.Aq(h);
                b.isModified = !0;
              } else
                c === qe &&
                  ("SourceChanged" === d
                    ? null !== a.object
                      ? this.updateDataBindings(a.object, a.propertyName)
                      : (this.Jq(), this.updateAllTargetBindings())
                    : "ModelDisplaced" === d && this.Rd());
            else if (c === pe) {
              var k = a.propertyName,
                l = a.object;
              if (l === b.model) {
                if ("nodeKeyProperty" === k || "nodeCategoryProperty" === k)
                  b.undoManager.isUndoingRedoing || this.Rd();
              } else this.updateDataBindings(l, k);
              b.isModified = !0;
            } else if (c === re || c === se) {
              var m = a.change === re,
                n = m ? a.newParam : a.oldParam,
                p = m ? a.newValue : a.oldValue,
                r = this.Ij.K(a.object);
              if (Array.isArray(r))
                for (a = 0; a < r.length; a++) {
                  var q = r[a];
                  if (m) Bn(q, p, n, !0);
                  else if (!(0 > n)) {
                    var u = n + sn(q);
                    q.kc(u, !0);
                    En(q, u, n);
                  }
                }
              b.isModified = !0;
            }
          } finally {
            b.ba = !0;
          }
        }
      }
    }
  };
  vi.prototype.updateAllTargetBindings = function (a) {
    void 0 === a && (a = "");
    for (var b = this.parts.iterator; b.next(); ) b.value.Ka(a);
    for (b = this.nodes.iterator; b.next(); ) b.value.Ka(a);
    for (b = this.links.iterator; b.next(); ) b.value.Ka(a);
  };
  vi.prototype.Jq = function () {
    for (
      var a = this.G.model, b = new I(), c = a.nodeDataArray, d = 0;
      d < c.length;
      d++
    )
      b.add(c[d]);
    var e = [];
    this.nodes.each(function (a) {
      null === a.data || b.contains(a.data) || e.push(a.data);
    });
    this.parts.each(function (a) {
      null === a.data || b.contains(a.data) || e.push(a.data);
    });
    e.forEach(function (b) {
      Xq(a, b, !1);
    });
    for (d = 0; d < c.length; d++) {
      var f = c[d];
      null === this.Fc(f) && Yq(a, f, !1);
    }
    this.refreshDataBoundLinks();
    for (c = this.parts.iterator; c.next(); )
      c.value.updateRelationshipsFromData();
    for (c = this.nodes.iterator; c.next(); )
      c.value.updateRelationshipsFromData();
    for (c = this.links.iterator; c.next(); )
      c.value.updateRelationshipsFromData();
  };
  vi.prototype.refreshDataBoundLinks = function () {};
  vi.prototype.updateRelationshipsFromData = function () {};
  vi.prototype.updateDataBindings = function (a, b) {
    if ("string" === typeof b) {
      var c = this.Fc(a);
      if (null !== c) c.Ka(b);
      else {
        c = null;
        for (var d = this.Ij.iterator; d.next(); ) {
          for (var e = d.value, f = 0; f < e.length; f++) {
            var g = e[f].Ux(a);
            null !== g && (null === c && (c = Ma()), c.push(g));
          }
          if (null !== c) break;
        }
        if (null !== c) {
          for (d = 0; d < c.length; d++) c[d].Ka(b);
          Pa(c);
        }
      }
      a === this.diagram.model.modelData && this.updateAllTargetBindings(b);
    }
  };
  function Pj(a, b) {
    var c = b.ji;
    if (Ha(c)) {
      var d = a.Ij.K(c);
      if (null === d) (d = []), d.push(b), a.Ij.add(c, d);
      else {
        for (a = 0; a < d.length; a++) if (d[a] === b) return;
        d.push(b);
      }
    }
  }
  function Sj(a, b, c) {
    Nj(b, function (a) {
      a = a.W.m;
      for (var b = a.length, d = 0; d < b; d++) kk(c, a[d]);
    });
    var d = b.ji;
    if (Ha(d)) {
      var e = a.Ij.K(d);
      if (null !== e)
        for (var f = 0; f < e.length; f++)
          if (e[f] === b) {
            e.splice(f, 1);
            0 === e.length && a.Ij.remove(d);
            break;
          }
    }
  }
  vi.prototype.lk = function (a, b, c) {
    void 0 === c && (c = !1);
    var d = new xb();
    if (Ha(a)) for (var e = 0; e < a.length; e++) Zq(this, a[e], b, d, c);
    else for (a = a.iterator; a.next(); ) Zq(this, a.value, b, d, c);
    if (null !== b) {
      c = b.model;
      a = b.toolManager.findTool("Dragging");
      a = null !== a ? a.dragOptions.dragsLink : b.Bn.dragsLink;
      e = new I();
      for (var f = new xb(), g = d.iterator; g.next(); ) {
        var h = g.value;
        if (h instanceof R)
          a || (null !== h.fromNode && null !== h.toNode) || e.add(h);
        else if (h instanceof V && null !== h.data && c.qm()) {
          var k = h;
          h = g.key;
          var l = h.wg();
          null !== l &&
            ((l = d.K(l)),
            null !== l
              ? (c.me(k.data, c.wa(l.data)),
                (k = b.Ec(k.data)),
                (h = h.Ri()),
                null !== h && null !== k && f.add(h, k))
              : c.me(k.data, void 0));
        }
      }
      0 < e.count && b.at(e, !1);
      if (0 < f.count) for (c = f.iterator; c.next(); ) d.add(c.key, c.value);
    }
    if (
      null !== b &&
      null !== this.G &&
      ((b = b.model), (c = b.afterCopyFunction), null !== c)
    ) {
      var m = new xb();
      d.each(function (a) {
        null !== a.key.data && m.add(a.key.data, a.value.data);
      });
      c(m, b, this.G.model);
    }
    for (b = d.iterator; b.next(); ) b.value.Ka();
    return d;
  };
  function Zq(a, b, c, d, e) {
    if (null === b || (e && !b.canCopy())) return null;
    if (d.contains(b)) return d.K(b);
    var f = a.copyPartData(b, c);
    if (!(f instanceof U)) return null;
    f.isSelected = !1;
    f.isHighlighted = !1;
    d.add(b, f);
    if (b instanceof V) {
      for (var g = b.linksConnected; g.next(); ) {
        var h = g.value;
        if (h.fromNode === b) {
          var k = d.K(h);
          null !== k && (k.fromNode = f);
        }
        h.toNode === b && ((h = d.K(h)), null !== h && (h.toNode = f));
      }
      if (b instanceof vf && f instanceof vf)
        for (b = b.memberParts; b.next(); )
          (g = Zq(a, b.value, c, d, e)),
            g instanceof R || null === g || (g.containingGroup = f);
    } else if (b instanceof R && f instanceof R)
      for (
        g = b.fromNode,
          null !== g && ((g = d.K(g)), null !== g && (f.fromNode = g)),
          g = b.toNode,
          null !== g && ((g = d.K(g)), null !== g && (f.toNode = g)),
          b = b.labelNodes;
        b.next();

      )
        (g = Zq(a, b.value, c, d, e)),
          null !== g && g instanceof V && (g.labeledLink = f);
    return f;
  }
  vi.prototype.copyPartData = function (a, b) {
    var c = null,
      d = a.data;
    if (null !== d && null !== b) {
      var e = b.model;
      a instanceof R ||
        ((d = e.copyNodeData(d)), Ga(d) && (e.Af(d), (c = b.Fc(d))));
    } else
      sg(a),
        (c = a.copy()),
        null !== c &&
          ((e = this.G),
          null !== b
            ? b.add(c)
            : null !== d &&
              null !== e &&
              null !== e.commandHandler &&
              e.commandHandler.copiesClipboardData &&
              ((b = e.model),
              (e = null),
              c instanceof R || (e = b.copyNodeData(d)),
              Ga(e) && (c.data = e)));
    return c;
  };
  oa.Object.defineProperties(vi.prototype, {
    nodes: {
      configurable: !0,
      get: function () {
        return this.Oo;
      },
    },
    links: {
      configurable: !0,
      get: function () {
        return this.vo;
      },
    },
    parts: {
      configurable: !0,
      get: function () {
        return this.Ma;
      },
    },
    diagram: {
      configurable: !0,
      get: function () {
        return this.G;
      },
    },
    addsToTemporaryLayer: {
      configurable: !0,
      get: function () {
        return this.Lq;
      },
      set: function (a) {
        A(a, "boolean", vi, "addsToTemporaryLayer");
        this.Lq = a;
      },
    },
  });
  vi.prototype.updateAllRelationshipsFromData = vi.prototype.Jq;
  vi.prototype.findLinksByExample = vi.prototype.Cs;
  vi.prototype.findNodesByExample = vi.prototype.Ds;
  vi.prototype.findLinkForData = vi.prototype.Ec;
  vi.prototype.findNodeForData = vi.prototype.Pi;
  vi.prototype.findPartForData = vi.prototype.Fc;
  vi.prototype.findNodeForKey = vi.prototype.Mb;
  vi.prototype.removeModeledPart = vi.prototype.Aq;
  vi.prototype.removeModeledParts = vi.prototype.$s;
  vi.prototype.rebuildParts = vi.prototype.Rd;
  var Tq = !1,
    Sq = !1,
    Uq = !1;
  vi.className = "PartManager";
  function $q(a) {
    vi.apply(this, arguments);
  }
  na($q, vi);
  $q.prototype.addAllModeledParts = function () {
    var a = this.diagram.model;
    this.addModeledParts(a.nodeDataArray);
    ar(this, a.linkDataArray);
  };
  $q.prototype.addModeledParts = function (a) {
    vi.prototype.addModeledParts.call(this, a, !1);
    for (a = this.links.iterator; a.next(); ) cp(a.value);
    mk(this.diagram, !1);
  };
  function ar(a, b) {
    b.forEach(function (b) {
      br(a, b);
    });
    mk(a.diagram, !1);
  }
  function br(a, b) {
    if (
      void 0 !== b &&
      null !== b &&
      !a.diagram.undoManager.isUndoingRedoing &&
      !a.bf.contains(b)
    ) {
      var c = a.getLinkCategoryForData(b),
        d = a.findLinkTemplateForCategory(c);
      if (null !== d) {
        sg(d);
        var e = d.copy();
        if (null !== e) {
          d = a.diagram.skipsModelSourceBindings;
          a.diagram.skipsModelSourceBindings = !0;
          e.Vf = c;
          e.qb = b;
          c = a.diagram.model;
          var f = cr(c, b, !0);
          "" !== f && (e.fromPortId = f);
          f = dr(c, b, !0);
          void 0 !== f && ((f = a.Mb(f)), f instanceof V && (e.fromNode = f));
          f = cr(c, b, !1);
          "" !== f && (e.toPortId = f);
          f = dr(c, b, !1);
          void 0 !== f && ((f = a.Mb(f)), f instanceof V && (e.toNode = f));
          c = c.Jf(b);
          Array.isArray(c) &&
            c.forEach(function (b) {
              b = a.Mb(b);
              null !== b && (b.labeledLink = e);
            });
          a.Lq && (e.Zg = "Tool");
          a.diagram.add(e);
          e.qb = null;
          e.data = b;
          a.diagram.skipsModelSourceBindings = d;
        }
      }
    }
  }
  $q.prototype.removeAllModeledParts = function () {
    var a = this.diagram.model;
    er(this, a.linkDataArray);
    this.$s(a.nodeDataArray);
  };
  function er(a, b) {
    b.forEach(function (b) {
      a.Aq(b);
    });
  }
  $q.prototype.getLinkCategoryForData = function (a) {
    return this.diagram.model.Gs(a);
  };
  $q.prototype.setLinkCategoryForData = function (a, b) {
    return this.diagram.model.Dq(a, b);
  };
  $q.prototype.setFromNodeForLink = function (a, b) {
    var c = this.diagram.model;
    c.Wv(a.data, c.wa(null !== b ? b.data : null));
  };
  $q.prototype.setToNodeForLink = function (a, b) {
    var c = this.diagram.model;
    c.$v(a.data, c.wa(null !== b ? b.data : null));
  };
  $q.prototype.removeDataForLink = function (a) {
    this.diagram.model.ym(a.data);
  };
  $q.prototype.findPartForKey = function (a) {
    var b = vi.prototype.findPartForKey.call(this, a);
    return null === b && ((a = this.diagram.model.Ih(a)), null !== a)
      ? this.bf.K(a)
      : b;
  };
  $q.prototype.findLinkForKey = function (a) {
    if (null === a || void 0 === a) return null;
    a = this.diagram.model.Ih(a);
    return null !== a ? this.bf.K(a) : null;
  };
  $q.prototype.doModelChanged = function (a) {
    var b = this;
    vi.prototype.doModelChanged.call(this, a);
    if (this.diagram) {
      var c = this.diagram;
      if (a.model === c.model) {
        var d = a.change;
        if (c.ba) {
          c.ba = !1;
          try {
            var e = a.modelChange;
            if ("" !== e)
              if (d === pe) {
                if ("linkFromKey" === e) {
                  var f = this.Ec(a.object);
                  if (null !== f) {
                    var g = this.Mb(a.newValue);
                    f.fromNode = g;
                  }
                } else if ("linkToKey" === e) {
                  var h = this.Ec(a.object);
                  if (null !== h) {
                    var k = this.Mb(a.newValue);
                    h.toNode = k;
                  }
                } else if ("linkFromPortId" === e) {
                  var l = this.Ec(a.object);
                  if (null !== l) {
                    var m = a.newValue;
                    "string" === typeof m && (l.fromPortId = m);
                  }
                } else if ("linkToPortId" === e) {
                  var n = this.Ec(a.object);
                  if (null !== n) {
                    var p = a.newValue;
                    "string" === typeof p && (n.toPortId = p);
                  }
                } else if ("nodeGroupKey" === e) {
                  var r = this.Fc(a.object);
                  if (null !== r) {
                    var q = a.newValue;
                    if (void 0 !== q) {
                      var u = this.Mb(q);
                      u instanceof vf
                        ? (r.containingGroup = u)
                        : (r.containingGroup = null);
                    } else r.containingGroup = null;
                  }
                } else if ("linkLabelKeys" === e) {
                  var w = this.Ec(a.object);
                  if (null !== w) {
                    var y = a.oldValue,
                      z = a.newValue;
                    Array.isArray(y) &&
                      y.forEach(function (a) {
                        0 <= z.indexOf(a) ||
                          ((a = b.Mb(a)), null !== a && (a.labeledLink = null));
                      });
                    Array.isArray(z) &&
                      z.forEach(function (a) {
                        a = b.Mb(a);
                        null !== a && (a.labeledLink = w);
                      });
                  }
                } else if ("linkCategory" === e) {
                  var B = this.Ec(a.object),
                    C = a.newValue;
                  null !== B && "string" === typeof C && (B.category = C);
                } else
                  "linkDataArray" === e &&
                    (er(this, a.oldValue), ar(this, a.newValue));
                c.isModified = !0;
              } else if (d === re) {
                var E = a.newValue;
                if (
                  "linkDataArray" === e &&
                  "object" === typeof E &&
                  null !== E
                )
                  br(this, E);
                else if ("linkLabelKeys" === e && fr(E)) {
                  var J = this.Ec(a.object),
                    S = this.Mb(E);
                  null !== J && null !== S && (S.labeledLink = J);
                }
                c.isModified = !0;
              } else {
                if (d === se) {
                  var aa = a.oldValue;
                  if (
                    "linkDataArray" === e &&
                    "object" === typeof aa &&
                    null !== aa
                  )
                    this.Aq(aa);
                  else if ("linkLabelKeys" === e && fr(aa)) {
                    var Y = this.Mb(aa);
                    null !== Y && (Y.labeledLink = null);
                  }
                  c.isModified = !0;
                }
              }
            else if (d === pe) {
              var T = a.propertyName;
              a.object !== c.model ||
                ("linkFromKeyProperty" !== T &&
                  "linkToKeyProperty" !== T &&
                  "linkFromPortIdProperty" !== T &&
                  "linkToPortIdProperty" !== T &&
                  "linkLabelKeysProperty" !== T &&
                  "nodeIsGroupProperty" !== T &&
                  "nodeGroupKeyProperty" !== T &&
                  "linkCategoryProperty" !== T) ||
                c.undoManager.isUndoingRedoing ||
                this.Rd();
              c.isModified = !0;
            }
          } finally {
            c.ba = !0;
          }
        }
      }
    }
  };
  $q.prototype.refreshDataBoundLinks = function () {
    var a = this,
      b = this.diagram.model,
      c = new I(),
      d = b.linkDataArray;
    d.forEach(function (a) {
      c.add(a);
    });
    var e = [];
    this.links.each(function (a) {
      null === a.data || c.contains(a.data) || e.push(a.data);
    });
    e.forEach(function (a) {
      gr(b, a, !1);
    });
    d.forEach(function (c) {
      null === a.Ec(c) && hr(b, c, !1);
    });
  };
  $q.prototype.updateRelationshipsFromData = function (a) {
    var b = a.data;
    if (null !== b) {
      var c = a.diagram;
      if (null !== c) {
        var d = c.model;
        if (a instanceof R) {
          var e = dr(d, b, !0);
          e = c.Mb(e);
          a.fromNode = e;
          e = dr(d, b, !1);
          e = c.Mb(e);
          a.toNode = e;
          b = d.Jf(b);
          if (0 < b.length || 0 < a.labelNodes.count) {
            if (1 === b.length && 1 === a.labelNodes.count) {
              e = b[0];
              var f = a.labelNodes.first();
              if (d.wa(f.data) === e) return;
            }
            e = new I().addAll(b);
            var g = new I();
            a.labelNodes.each(function (a) {
              null !== a.data && ((a = d.wa(a.data)), void 0 !== a && g.add(a));
            });
            b = g.copy();
            b.zq(e);
            e = e.copy();
            e.zq(g);
            if (0 < b.count || 0 < e.count)
              b.each(function (b) {
                b = c.Mb(b);
                null !== b && b.labeledLink === a && (b.labeledLink = null);
              }),
                e.each(function (b) {
                  b = c.Mb(b);
                  null !== b && b.labeledLink !== a && (b.labeledLink = a);
                });
          }
        } else
          !(a instanceof Je) &&
            ((b = d.Jh(b)),
            (b = c.findPartForKey(b)),
            null === b || b instanceof vf) &&
            (a.containingGroup = b);
      }
    }
  };
  $q.prototype.resolveReferencesForData = function (a) {
    var b = this.diagram.model,
      c = b.wa(a);
    if (void 0 !== c) {
      var d = ir(b, c),
        e = this.Fc(a);
      if (null !== d && null !== e) {
        d = d.iterator;
        for (var f = {}; d.next(); ) {
          var g = d.value;
          b.bb(g)
            ? e instanceof vf &&
              b.Jh(g) === c &&
              ((g = this.Fc(g)), null !== g && (g.containingGroup = e))
            : ((f.link = this.Ec(g)),
              null !== f.link &&
                e instanceof V &&
                (dr(b, g, !0) === c && (f.link.fromNode = e),
                dr(b, g, !1) === c && (f.link.toNode = e),
                (g = b.Jf(g)),
                Array.isArray(g) &&
                  g.some(
                    (function (a) {
                      return function (b) {
                        return b === c ? ((e.labeledLink = a.link), !0) : !1;
                      };
                    })(f)
                  )));
          f = { link: f.link };
        }
        jr(b, c);
      }
      a = b.Jh(a);
      void 0 !== a &&
        ((a = this.Mb(a)), a instanceof vf && (e.containingGroup = a));
    }
  };
  $q.prototype.unresolveReferencesForPart = function (a) {
    var b = this.diagram.model;
    if (a instanceof V) {
      var c = b.wa(a.data);
      if (void 0 !== c) {
        for (var d = a.linksConnected; d.next(); ) kr(b, c, d.value.data);
        a.isLinkLabel && ((d = a.labeledLink), null !== d && kr(b, c, d.data));
        if (a instanceof vf)
          for (a = a.memberParts; a.next(); )
            (d = a.value.data), b.bb(d) && kr(b, c, d);
      }
    }
  };
  $q.prototype.copyPartData = function (a, b) {
    var c = vi.prototype.copyPartData.call(this, a, b);
    if (a instanceof R)
      if (((a = a.data), null !== a && null !== b)) {
        var d = b.model;
        a = d.aq(a);
        "object" === typeof a && null !== a && (d.Ki(a), (c = b.Ec(a)));
      } else
        null !== c &&
          ((b = this.diagram),
          null !== a &&
            null !== b &&
            null !== b.commandHandler &&
            b.commandHandler.copiesClipboardData &&
            ((b = b.model.aq(a)),
            "object" === typeof b && null !== b && (c.data = b)));
    return c;
  };
  $q.prototype.insertLink = function (a, b, c, d) {
    var e = this.diagram,
      f = e.model,
      g = e.toolManager.findTool("Linking"),
      h = "";
    null !== a &&
      (null === b && (b = a), (h = b.portId), null === h && (h = ""));
    b = "";
    null !== c &&
      (null === d && (d = c), (b = d.portId), null === b && (b = ""));
    d = g.archetypeLinkData;
    if (d instanceof R) {
      if ((sg(d), (f = d.copy()), null !== f))
        return (
          (f.fromNode = a),
          (f.fromPortId = h),
          (f.toNode = c),
          (f.toPortId = b),
          e.add(f),
          (a = g.archetypeLabelNodeData),
          a instanceof V &&
            (sg(a),
            (a = a.copy()),
            null !== a && ((a.labeledLink = f), e.add(a))),
          f
        );
    } else if (
      null !== d &&
      ((d = f.aq(d)), "object" === typeof d && null !== d)
    )
      return (
        null !== a && lr(f, d, f.wa(a.data), !0),
        mr(f, d, h, !0),
        null !== c && lr(f, d, f.wa(c.data), !1),
        mr(f, d, b, !1),
        f.Ki(d),
        (a = g.archetypeLabelNodeData),
        null === a ||
          a instanceof V ||
          ((a = f.copyNodeData(a)),
          "object" === typeof a &&
            null !== a &&
            (f.Af(a), (a = f.wa(a)), void 0 !== a && f.$u(d, a))),
        e.Ec(d)
      );
    return null;
  };
  $q.prototype.findLinkForKey = $q.prototype.findLinkForKey;
  $q.prototype.findPartForKey = $q.prototype.findPartForKey;
  $q.prototype.removeAllModeledParts = $q.prototype.removeAllModeledParts;
  $q.prototype.addModeledParts = $q.prototype.addModeledParts;
  $q.prototype.addAllModeledParts = $q.prototype.addAllModeledParts;
  $q.className = "GraphLinksPartManager";
  function nr() {
    vi.apply(this, arguments);
    this.oh = null;
  }
  na(nr, vi);
  function or(a, b, c) {
    if (null !== b && null !== c) {
      var d = a.diagram.toolManager.findTool("Linking"),
        e = b,
        f = c;
      if (a.diagram.isTreePathToChildren)
        for (b = f.linksConnected; b.next(); ) {
          if (b.value.toNode === f) return;
        }
      else
        for (e = c, f = b, b = e.linksConnected; b.next(); )
          if (b.value.fromNode === e) return;
      if (null === d || !Lf(d, e, f, null, !0))
        if (
          ((d = a.getLinkCategoryForData(c.data)),
          (b = a.findLinkTemplateForCategory(d)),
          null !== b && (sg(b), (b = b.copy()), null !== b))
        ) {
          var g = a.diagram.skipsModelSourceBindings;
          a.diagram.skipsModelSourceBindings = !0;
          b.Vf = d;
          b.qb = c.data;
          b.fromNode = e;
          b.toNode = f;
          a.diagram.add(b);
          b.qb = null;
          b.data = c.data;
          a.diagram.skipsModelSourceBindings = g;
        }
    }
  }
  nr.prototype.getLinkCategoryForData = function (a) {
    return this.diagram.model.Js(a);
  };
  nr.prototype.setLinkCategoryForData = function (a, b) {
    this.diagram.model.et(a, b);
  };
  nr.prototype.setFromNodeForLink = function (a, b, c) {
    var d = this.diagram.model;
    void 0 === c && (c = null);
    b = null !== b ? b.data : null;
    if (this.diagram.isTreePathToChildren) d.me(a.data, d.wa(b));
    else {
      var e = this.oh;
      this.oh = a;
      null !== c && d.me(c.data, void 0);
      d.me(b, d.wa(null !== a.toNode ? a.toNode.data : null));
      this.oh = e;
    }
  };
  nr.prototype.setToNodeForLink = function (a, b, c) {
    var d = this.diagram.model;
    void 0 === c && (c = null);
    b = null !== b ? b.data : null;
    if (this.diagram.isTreePathToChildren) {
      var e = this.oh;
      this.oh = a;
      null !== c && d.me(c.data, void 0);
      d.me(b, d.wa(null !== a.fromNode ? a.fromNode.data : null));
      this.oh = e;
    } else d.me(a.data, d.wa(b));
  };
  nr.prototype.removeDataForLink = function (a) {
    this.diagram.model.me(a.data, void 0);
  };
  nr.prototype.findLinkForKey = function (a) {
    if (null === a || void 0 === a) return null;
    a = this.diagram.model.cc(a);
    return null !== a ? this.bf.K(a) : null;
  };
  nr.prototype.doModelChanged = function (a) {
    vi.prototype.doModelChanged.call(this, a);
    if (this.diagram) {
      var b = this.diagram;
      if (a.model === b.model) {
        var c = a.change;
        if (b.ba) {
          b.ba = !1;
          try {
            var d = a.modelChange;
            if ("" !== d) {
              if (c === pe) {
                if ("nodeParentKey" === d) {
                  var e = a.object,
                    f = this.Mb(a.newValue),
                    g = this.Pi(e);
                  if (null !== this.oh)
                    null !== f &&
                      ((this.oh.data = e),
                      (this.oh.category = this.getLinkCategoryForData(e)));
                  else if (null !== g) {
                    var h = g.Ri();
                    null !== h
                      ? null === f
                        ? b.remove(h)
                        : b.isTreePathToChildren
                        ? (h.fromNode = f)
                        : (h.toNode = f)
                      : or(this, f, g);
                  }
                } else if ("parentLinkCategory" === d) {
                  var k = this.Pi(a.object),
                    l = a.newValue;
                  if (null !== k && "string" === typeof l) {
                    var m = k.Ri();
                    null !== m && (m.category = l);
                  }
                }
                b.isModified = !0;
              }
            } else if (c === pe) {
              var n = a.propertyName;
              a.object === b.model &&
                "nodeParentKeyProperty" === n &&
                (b.undoManager.isUndoingRedoing || this.Rd());
              b.isModified = !0;
            }
          } finally {
            b.ba = !0;
          }
        }
      }
    }
  };
  nr.prototype.updateRelationshipsFromData = function (a) {
    var b = a.data;
    if (null !== b) {
      var c = a.diagram;
      if (null !== c) {
        var d = c.model;
        a instanceof V &&
          ((b = d.Kh(b)),
          (b = c.Mb(b)),
          (d = a.wg()),
          b !== d &&
            ((d = a.Ri()),
            null !== b
              ? null !== d
                ? c.isTreePathToChildren
                  ? (d.fromNode = b)
                  : (d.toNode = b)
                : or(this, b, a)
              : null !== d && Tj(c, d, !1)));
      }
    }
  };
  nr.prototype.updateDataBindings = function (a, b) {
    vi.prototype.updateDataBindings.call(this, a, b);
    "string" === typeof b &&
      null !== this.Fc(a) &&
      ((a = this.Ec(a)), null !== a && a.Ka(b));
  };
  nr.prototype.resolveReferencesForData = function (a) {
    var b = this.diagram.model,
      c = b.wa(a);
    if (void 0 !== c) {
      var d = ir(b, c),
        e = this.Fc(a);
      if (null !== d && null !== e) {
        for (d = d.iterator; d.next(); ) {
          var f = d.value;
          b.bb(f) && e instanceof V && b.Kh(f) === c && or(this, e, this.Pi(f));
        }
        jr(b, c);
      }
      a = b.Kh(a);
      void 0 !== a && e instanceof V && ((a = this.Mb(a)), or(this, a, e));
    }
  };
  nr.prototype.unresolveReferencesForPart = function (a) {
    var b = this.diagram.model;
    if (a instanceof V) {
      var c = b.wa(a.data),
        d = this.Ec(a.data);
      if (null !== d) {
        d.isSelected = !1;
        d.isHighlighted = !1;
        var e = d.layer;
        if (null !== e) {
          var f = e.kc(-1, d, !1);
          0 <= f && this.diagram.cb(se, "parts", e, d, null, f, null);
          f = d.layerChanged;
          null !== f && f(d, e, null);
        }
      }
      d = this.diagram.isTreePathToChildren;
      for (a = a.linksConnected; a.next(); )
        (e = a.value),
          (e = (d ? e.toNode : e.fromNode).data),
          b.bb(e) && kr(b, c, e);
    }
  };
  nr.prototype.insertLink = function (a, b, c) {
    b = this.diagram.model;
    var d = a,
      e = c;
    this.diagram.isTreePathToChildren || ((d = c), (e = a));
    return null !== d && null !== e
      ? (b.me(e.data, b.wa(d.data)), e.Ri())
      : null;
  };
  nr.prototype.findLinkForKey = nr.prototype.findLinkForKey;
  nr.className = "TreePartManager";
  function X(a, b) {
    this.Ll = new I();
    this.Jl = new I();
    this.ww = ',\n  "insertedNodeKeys": ';
    this.Qy = ',\n  "modifiedNodeData": ';
    this.yw = ',\n  "removedNodeKeys": ';
    this.Uh = null;
    ab(this);
    this.xn = this.ua = "";
    this.Xg = !1;
    this.j = {};
    this.Ac = [];
    this.mb = new xb();
    this.wi = "key";
    this.$k = this.Dl = null;
    this.on = this.pn = !1;
    this.rn = !0;
    this.$m = null;
    this.Rj = "category";
    this.Xf = new xb();
    this.gu = new H();
    this.qh = !1;
    this.o = null;
    this.undoManager = new ue();
    void 0 !== a && (Ha(a) ? (this.nodeDataArray = a) : Object.assign(this, a));
    b && Object.assign(this, b);
  }
  X.prototype.cloneProtected = function (a) {
    a.ua = this.ua;
    a.xn = this.xn;
    a.Xg = this.Xg;
    a.wi = this.wi;
    a.Dl = this.Dl;
    a.$k = this.$k;
    a.pn = this.pn;
    a.on = this.on;
    a.rn = this.rn;
    a.$m = this.$m;
    a.Rj = this.Rj;
  };
  X.prototype.copy = function () {
    var a = new this.constructor();
    this.cloneProtected(a);
    return a;
  };
  X.prototype.clear = function () {
    this.Ac = [];
    this.mb.clear();
    this.Xf.clear();
    this.undoManager.clear();
  };
  X.prototype.toString = function (a) {
    void 0 === a && (a = 0);
    if (1 < a) return this.Fq();
    var b = ("" !== this.name ? this.name : "") + " Model";
    if (0 < a) {
      b += "\n node data:";
      a = this.nodeDataArray;
      for (var c = a.length, d = 0; d < c; d++) {
        var e = a[d];
        b += " " + this.wa(e) + ":" + Ra(e);
      }
    }
    return b;
  };
  X.prototype.fB = function (a) {
    x(a, oe, X, "toIncrementalData:e");
    a.change !== qe &&
      v(
        "Model.toIncrementalData argument is not a Transaction ChangedEvent:" +
          a.toString()
      );
    var b = a.object;
    if (!(a.isTransactionFinished && b instanceof te)) return null;
    pr(this, b);
    a = this.nw(b, "FinishedUndo" === a.propertyName);
    this.Uh = null;
    return a;
  };
  X.prototype.nw = function (a, b) {
    var c = this,
      d = !1,
      e = new I(),
      f = new I(),
      g = new I(),
      h = this.Uh;
    a.changes.each(function (a) {
      a.model === c &&
        ("nodeDataArray" === a.modelChange
          ? a.change === re
            ? e.add(a.newValue)
            : a.change === se && g.add(a.oldValue)
          : c.bb(a.object)
          ? f.add(a.object)
          : a.change !== pe ||
            (c.modelData !== a.object && "modelData" !== a.propertyName)
          ? null !== a.object &&
            (h && h.contains(a.object)
              ? h.get(a.object).each(function (a) {
                  c.bb(a) && f.add(a);
                })
              : a.object instanceof X ||
                (c.Zi() && c.Dc(a.object)) ||
                qr(c, a.object).each(function (a) {
                  f.add(a);
                }))
          : (d = !0));
    });
    var k = this.Jl;
    k.clear();
    e.each(function (a) {
      k.add(c.wa(a));
      b || f.add(a);
    });
    var l = this.Ll;
    l.clear();
    g.each(function (a) {
      l.add(c.wa(a));
      b && f.add(a);
    });
    a = c.cloneDeep(f.Ga());
    var m = null;
    d &&
      (null === m && (m = {}), (m.modelData = this.cloneDeep(this.modelData)));
    0 < k.count &&
      (null === m && (m = {}),
      b ? (m.removedNodeKeys = k.Ga()) : (m.insertedNodeKeys = k.Ga()));
    0 < a.length && (null === m && (m = {}), (m.modifiedNodeData = a));
    0 < l.count &&
      (null === m && (m = {}),
      b ? (m.insertedNodeKeys = l.Ga()) : (m.removedNodeKeys = l.Ga()));
    l.clear();
    k.clear();
    return m;
  };
  X.prototype.cloneDeep = function (a) {
    return rr(this, a, !0);
  };
  function rr(a, b, c, d, e, f) {
    function g(a, c) {
      h
        ? (void 0 === a.__gohashid && f.push(a), d.set(a, c))
        : ((a = pb++), d.set(a, c), e.set(a, b));
    }
    if (!Ga(b)) return b;
    f || (f = []);
    var h = Object.isExtensible(b);
    d || (d = new xb());
    if (h) {
      var k = d.get(b);
      if (k) return k;
    } else
      for (e || (e = new xb()), k = e.iterator; k.next(); ) {
        var l = k.key;
        if (k.value === b && (l = d.get(l))) return l;
      }
    if (Array.isArray(b)) {
      k = [];
      g(b, k);
      for (var m = 0; m < b.length; m++) k.push(rr(a, b[m], !1, d, e, f));
    } else if (
      b instanceof K ||
      b instanceof Gb ||
      b instanceof M ||
      b instanceof ic ||
      b instanceof Ib
    )
      (k = b.copy()), g(b, k);
    else {
      if (b instanceof Al || b instanceof N || b instanceof F) return b;
      if (b instanceof H)
        (k = new H().addAll(rr(a, b.Ga(), !1, d, e, f))), g(b, k);
      else if (b instanceof I)
        (k = new I().addAll(rr(a, b.Ga(), !1, d, e, f))), g(b, k);
      else if (b instanceof xb)
        (k = new xb().addAll(rr(a, b.Ga(), !1, d, e, f))), g(b, k);
      else if (b instanceof Date) (k = new Date(b.getTime())), g(b, k);
      else if (b instanceof RegExp)
        (k = new RegExp(b)), g(b, k), (k.lastIndex = b.lastIndex);
      else if ("function" === typeof b.copy) (k = b.copy()), g(b, k);
      else
        for (m in ((k = {}), g(b, k), b))
          "__gohashid" !== m && (k[m] = rr(a, b[m], !1, d, e, f));
    }
    c &&
      f.forEach(function (a) {
        delete a.__gohashid;
      });
    return k;
  }
  t = X.prototype;
  t.quote = function (a) {
    return JSON.stringify(a).replace(/[\u007F-\uFFFF]/g, function (a) {
      return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).substr(-4);
    });
  };
  t.Pm = function () {
    var a = "";
    "" !== this.name && (a += ',\n  "name": ' + this.quote(this.name));
    "" !== this.dataFormat &&
      (a += ',\n  "dataFormat": ' + this.quote(this.dataFormat));
    this.isReadOnly && (a += ',\n  "isReadOnly": ' + this.isReadOnly);
    "key" !== this.nodeKeyProperty &&
      "string" === typeof this.nodeKeyProperty &&
      (a += ',\n  "nodeKeyProperty": ' + this.quote(this.nodeKeyProperty));
    this.copiesArrays && (a += ',\n  "copiesArrays": true');
    this.copiesArrayObjects && (a += ',\n  "copiesArrayObjects": true');
    this.copiesKey || (a += ',\n  "copiesKey": false');
    "category" !== this.nodeCategoryProperty &&
      "string" === typeof this.nodeCategoryProperty &&
      (a +=
        ',\n  "nodeCategoryProperty": ' +
        this.quote(this.nodeCategoryProperty));
    return a;
  };
  t.xq = function (a) {
    a.name && (this.name = a.name);
    a.dataFormat && (this.dataFormat = a.dataFormat);
    a.isReadOnly && (this.isReadOnly = !0);
    a.nodeKeyProperty && (this.nodeKeyProperty = a.nodeKeyProperty);
    a.copiesArrays && (this.copiesArrays = !0);
    a.copiesArrayObjects && (this.copiesArrayObjects = !0);
    !1 === a.copiesKey && (this.copiesKey = !1);
    a.nodeCategoryProperty &&
      (this.nodeCategoryProperty = a.nodeCategoryProperty);
  };
  function sr(a, b) {
    b = b.modelData;
    Ga(b) && (a.Am(b), (a.modelData = b));
  }
  t.ow = function () {
    var a = this.modelData,
      b = !1,
      c;
    for (c in a)
      if (!tr(c, a[c])) {
        b = !0;
        break;
      }
    a = "";
    b && (a = ',\n  "modelData": ' + ur(this, this.modelData));
    return a + ',\n  "nodeDataArray": ' + vr(this, this.nodeDataArray, !0);
  };
  t.Nv = function (a) {
    sr(this, a);
    a = a.nodeDataArray;
    Ha(a) && (this.Am(a), (this.nodeDataArray = a));
  };
  function pr(a, b) {
    function c(a, b) {
      if ((b = b.part))
        if (((b = b.data), a !== b)) {
          var c = d.get(a);
          null === c ? ((c = new I()), c.add(b), d.add(a, c)) : c.add(b);
        }
    }
    var d = a.Uh;
    null === d &&
      ((d = new xb()),
      b.changes.each(function (a) {
        if (null !== a.diagram) {
          var b = a.change;
          if (b === pe) (a = a.object.panel) && (b = a.data) && c(b, a);
          else if (b === re || b === se)
            (a = a.object), (b = a.itemArray) && c(b, a);
        }
      }),
      (a.Uh = d));
  }
  function qr(a, b) {
    for (var c = new I(), d = 0; d < a.nodeDataArray.length; d++) {
      var e = a.nodeDataArray[d];
      wr(a, b, e, e, c);
    }
    return c;
  }
  function wr(a, b, c, d, e) {
    if (Array.isArray(c))
      for (var f = 0; f < c.length; f++) {
        var g = c[f];
        if (g === b) return e.add(d), !0;
        if (wr(a, b, g, d, e)) return !0;
      }
    else if (Ga(c) && Object.getPrototypeOf(c) === Object.prototype)
      for (f in c) {
        g = c[f];
        if (g === b) return e.add(d), !0;
        if (wr(a, b, g, d, e)) return !0;
      }
    return !1;
  }
  t.mw = function (a, b) {
    var c = this,
      d = !1,
      e = new I(),
      f = new I(),
      g = new I(),
      h = this.Uh;
    a.changes.each(function (a) {
      a.model === c &&
        ("nodeDataArray" === a.modelChange
          ? a.change === re
            ? e.add(a.newValue)
            : a.change === se && g.add(a.oldValue)
          : c.bb(a.object)
          ? f.add(a.object)
          : a.change !== pe ||
            (c.modelData !== a.object && "modelData" !== a.propertyName)
          ? null !== a.object &&
            (h && h.contains(a.object)
              ? h.get(a.object).each(function (a) {
                  c.bb(a) && f.add(a);
                })
              : a.object instanceof X ||
                (c.Zi() && c.Dc(a.object)) ||
                qr(c, a.object).each(function (a) {
                  f.add(a);
                }))
          : (d = !0));
    });
    var k = this.Jl;
    k.clear();
    e.each(function (a) {
      k.add(c.wa(a));
      b || f.add(a);
    });
    var l = this.Ll;
    l.clear();
    g.each(function (a) {
      l.add(c.wa(a));
      b && f.add(a);
    });
    a = "";
    d && (a += ',\n  "modelData": ' + ur(this, this.modelData));
    0 < k.count && (a += (b ? this.yw : this.ww) + vr(this, k.Ga(), !0));
    0 < f.count && (a += this.Qy + vr(this, f.Ga(), !0));
    0 < l.count && (a += (b ? this.ww : this.yw) + vr(this, l.Ga(), !0));
    l.clear();
    k.clear();
    return a;
  };
  t.wq = function (a) {
    ((void 0 !== a.name && a.name !== this.name) ||
      (void 0 !== a.dataFormat && a.dataFormat !== this.dataFormat) ||
      (void 0 !== a.isReadOnly && a.isReadOnly !== this.isReadOnly) ||
      (void 0 !== a.nodeKeyProperty &&
        a.nodeKeyProperty !== this.nodeKeyProperty) ||
      (void 0 !== a.copiesArrays && a.copiesArrays !== this.copiesArrays) ||
      (void 0 !== a.copiesArrayObjects &&
        a.copiesArrayObjects !== this.copiesArrayObjects) ||
      (void 0 !== a.copiesKey && a.copiesKey !== this.copiesKey) ||
      (void 0 !== a.nodeCategoryProperty &&
        a.nodeCategoryProperty !== this.nodeCategoryProperty)) &&
      v("applyIncrementalJson cannot change Model properties");
    sr(this, a);
    var b = a.insertedNodeKeys,
      c = a.modifiedNodeData,
      d = new xb();
    if (Array.isArray(c))
      for (var e = 0; e < c.length; e++) {
        var f = c[e],
          g = this.wa(f);
        void 0 !== g && null !== g && d.set(g, f);
      }
    if (Array.isArray(b))
      for (e = b.length, f = 0; f < e; f++) {
        g = b[f];
        var h = this.cc(g);
        null === h &&
          ((h = (h = d.get(g)) ? h : this.copyNodeData({})),
          this.Hm(h, g),
          this.Af(h));
      }
    if (Array.isArray(c))
      for (b = c.length, d = 0; d < b; d++)
        if (((e = c[d]), (f = this.wa(e)), (f = this.cc(f)), null !== f)) {
          for (var k in e)
            "__gohashid" === k ||
              k === this.nodeKeyProperty ||
              (this.vk() && k === this.nodeIsGroupProperty) ||
              this.setDataProperty(f, k, e[k]);
          this.Im(e, f);
        }
    a = a.removedNodeKeys;
    if (Array.isArray(a))
      for (c = a.length, k = 0; k < c; k++)
        (b = this.cc(a[k])), null !== b && this.zm(b);
  };
  t.Jy = function (a, b) {
    x(a, oe, X, "toIncrementalJson:e");
    a.change !== qe &&
      v(
        "Model.toIncrementalJson argument is not a Transaction ChangedEvent:" +
          a.toString()
      );
    var c = a.object;
    if (!(a.isTransactionFinished && c instanceof te))
      return '{ "incremental": 0 }';
    void 0 === b && (b = xr(this, this));
    pr(this, c);
    a = this.mw(c, "FinishedUndo" === a.propertyName);
    this.Uh = null;
    return "2" === b
      ? '{ "incremental": 2' + a + "}"
      : '{ "class": ' +
          this.quote(b) +
          ', "incremental": 1' +
          this.Pm() +
          a +
          "}";
  };
  t.gB = function (a, b) {
    return this.Jy(a, b);
  };
  t.Fq = function (a) {
    void 0 === a && (a = xr(this, this));
    return '{ "class": ' + this.quote(a) + this.Pm() + this.ow() + "}";
  };
  t.toJSON = function (a) {
    return this.Fq(a);
  };
  t.Cx = function (a) {
    var b = null;
    if ("string" === typeof a)
      try {
        b = sa.JSON.parse(a);
      } catch (d) {
        G && Fa("JSON.parse error: " + d.toString());
      }
    else
      "object" === typeof a
        ? (b = a)
        : v("Unable to modify a Model from: " + a);
    var c = b.incremental;
    "number" !== typeof c &&
      v("Unable to apply non-incremental changes to Model: " + a);
    0 !== c &&
      (this.Fa("applyIncrementalJson"),
      this.wq(b),
      this.gb("applyIncrementalJson"));
  };
  t.oz = function (a) {
    return this.Cx(a);
  };
  X.constructGraphLinksModel = function () {
    G &&
      v(
        "Unable to construct a Model. Provided JSON requires GraphLinksModel, which is not loaded."
      );
    return new X();
  };
  t = X.prototype;
  t.Am = function (a) {
    if (Ha(a))
      for (var b = a.length, c = 0; c < b; c++) {
        var d = a[c];
        if (Ga(d)) {
          var e = c;
          d = this.Am(d);
          Array.isArray(a)
            ? (a[e] = d)
            : v(
                "Cannot replace an object in an HTMLCollection or NodeList at " +
                  e
              );
        }
      }
    else if (Ga(a)) {
      for (b in a)
        if (
          ((c = a[b]),
          Ga(c) &&
            ((c = this.Am(c)), (a[b] = c), "points" === b && Array.isArray(c)))
        ) {
          e = 0 === c.length % 2;
          for (d = 0; d < c.length; d++)
            if ("number" !== typeof c[d]) {
              e = !1;
              break;
            }
          if (e) {
            e = new H();
            for (d = 0; d < c.length / 2; d++)
              e.add(new K(c[2 * d], c[2 * d + 1]));
            e.freeze();
            a[b] = e;
          }
        }
      return yr(a);
    }
    return a;
  };
  t.Qm = function (a) {
    return void 0 === a
      ? "undefined"
      : null === a
      ? "null"
      : !0 === a
      ? "true"
      : !1 === a
      ? "false"
      : "string" === typeof a
      ? this.quote(a)
      : "number" === typeof a
      ? Infinity === a
        ? "9e9999"
        : -Infinity === a
        ? "-9e9999"
        : isNaN(a)
        ? '{"class":"NaN"}'
        : a.toString()
      : a instanceof Date
      ? '{"class":"Date", "value":"' + a.toJSON() + '"}'
      : a instanceof Number
      ? this.Qm(a.valueOf())
      : Ha(a)
      ? vr(this, a)
      : Ga(a)
      ? ur(this, a)
      : "function" === typeof a
      ? "null"
      : a.toString();
  };
  function vr(a, b, c) {
    void 0 === c && (c = !1);
    var d = b.length;
    if (0 >= d) return "[]";
    var e = new db();
    e.add("[");
    c && 1 < d && e.add("\n");
    for (var f = 0; f < d; f++) {
      var g = b[f];
      void 0 !== g && (0 < f && (e.add(","), c && e.add("\n")), e.add(a.Qm(g)));
    }
    c && 1 < d && e.add("\n");
    e.add("]");
    return e.toString();
  }
  function tr(a, b) {
    return void 0 === b ||
      "__gohashid" === a ||
      "_" === a[0] ||
      "function" === typeof b
      ? !0
      : !1;
  }
  function Ar(a) {
    return isNaN(a)
      ? "NaN"
      : Infinity === a
      ? "9e9999"
      : -Infinity === a
      ? "-9e9999"
      : a;
  }
  function ur(a, b) {
    var c = b;
    if (c instanceof K) b = { class: "go.Point", x: Ar(c.x), y: Ar(c.y) };
    else if (c instanceof Gb)
      b = { class: "go.Size", width: Ar(c.width), height: Ar(c.height) };
    else if (c instanceof M)
      b = {
        class: "go.Rect",
        x: Ar(c.x),
        y: Ar(c.y),
        width: Ar(c.width),
        height: Ar(c.height),
      };
    else if (c instanceof ic)
      b = {
        class: "go.Margin",
        top: Ar(c.top),
        right: Ar(c.right),
        bottom: Ar(c.bottom),
        left: Ar(c.left),
      };
    else if (c instanceof Ib)
      c.ib()
        ? (b = {
            class: "go.Spot",
            x: Ar(c.x),
            y: Ar(c.y),
            offsetX: Ar(c.offsetX),
            offsetY: Ar(c.offsetY),
          })
        : (b = { class: "go.Spot", enum: c.toString() });
    else if (c instanceof Al) {
      b = { class: "go.Brush", type: c.type.name };
      if (c.type === Hl) b.color = c.color;
      else if (c.type === Kl || c.type === Bl)
        (b.start = c.start),
          (b.end = c.end),
          c.type === Bl &&
            (0 !== c.startRadius && (b.startRadius = Ar(c.startRadius)),
            isNaN(c.endRadius) || (b.endRadius = Ar(c.endRadius)));
      if (null !== c.colorStops) {
        var d = {};
        for (c = c.colorStops.iterator; c.next(); ) d[c.key] = c.value;
        b.colorStops = d;
      }
    } else if (c instanceof N)
      (b = { class: "go.Geometry", type: c.type.name }),
        0 !== c.startX && (b.startX = Ar(c.startX)),
        0 !== c.startY && (b.startY = Ar(c.startY)),
        0 !== c.endX && (b.endX = Ar(c.endX)),
        0 !== c.endY && (b.endY = Ar(c.endY)),
        c.spot1.D(Fc) || (b.spot1 = c.spot1),
        c.spot2.D(Pc) || (b.spot2 = c.spot2),
        c.type === N.o && (b.path = N.Ba(c));
    else if (c instanceof F)
      b = {
        class: "go.EnumValue",
        classType: xr(a, c.classType),
        name: c.name,
      };
    else if (G && null !== Br(xr(a, c)))
      return (
        Fa(
          "ERROR: trying to convert a GraphObject or Diagram or Model or Tool or Layout or UndoManager or other unknown data into JSON text: " +
            c.toString()
        ),
        "{}"
      );
    d = "{";
    c = !0;
    for (var e in b) {
      var f = Fn(b, e);
      if (!tr(e, f))
        if (
          (c ? (c = !1) : (d += ","),
          (d += a.quote(e) + ":"),
          "points" === e && f instanceof H)
        ) {
          var g = "[";
          for (f = f.iterator; f.next(); ) {
            var h = f.value;
            1 < g.length && (g += ",");
            g += a.Qm(h.x);
            g += ",";
            g += a.Qm(h.y);
          }
          g += "]";
          d += g;
        } else d += a.Qm(f);
    }
    return d + "}";
  }
  function Cr(a) {
    return "number" === typeof a
      ? a
      : "NaN" === a
      ? NaN
      : "9e9999" === a
      ? Infinity
      : "-9e9999" === a
      ? -Infinity
      : parseFloat(a);
  }
  function yr(a) {
    if ("object" !== typeof a) return a;
    var b = a["class"] || "";
    if ("NaN" === b) return NaN;
    if ("Date" === b) return new Date(a.value);
    if (0 !== b.indexOf("go.")) return a;
    b = b.substr(3);
    var c = a;
    if ("Point" === b) c = new K(Cr(a.x), Cr(a.y));
    else if ("Size" === b) c = new Gb(Cr(a.width), Cr(a.height));
    else if ("Rect" === b)
      c = new M(Cr(a.x), Cr(a.y), Cr(a.width), Cr(a.height));
    else if ("Margin" === b)
      c = new ic(Cr(a.top), Cr(a.right), Cr(a.bottom), Cr(a.left));
    else if ("Spot" === b)
      "string" === typeof a["enum"]
        ? (c = xd(a["enum"]))
        : (c = new Ib(Cr(a.x), Cr(a.y), Cr(a.offsetX), Cr(a.offsetY)));
    else if ("Brush" === b) {
      if (
        ((c = new Al()),
        (c.type = bb(Al, a.type)),
        "string" === typeof a.color && (c.color = a.color),
        a.start instanceof Ib && (c.start = a.start),
        a.end instanceof Ib && (c.end = a.end),
        "number" === typeof a.startRadius &&
          (c.startRadius = Cr(a.startRadius)),
        "number" === typeof a.endRadius && (c.endRadius = Cr(a.endRadius)),
        (a = a.colorStops),
        Ga(a))
      )
        for (var d in a) c.addColorStop(parseFloat(d), a[d]);
    } else
      "Geometry" === b
        ? ((c = null),
          "string" === typeof a.path ? (c = N.parse(a.path)) : (c = new N()),
          (c.type = bb(N, a.type)),
          "number" === typeof a.startX && (c.startX = Cr(a.startX)),
          "number" === typeof a.startY && (c.startY = Cr(a.startY)),
          "number" === typeof a.endX && (c.endX = Cr(a.endX)),
          "number" === typeof a.endY && (c.endY = Cr(a.endY)),
          a.spot1 instanceof Ib && (c.spot1 = a.spot1),
          a.spot2 instanceof Ib && (c.spot2 = a.spot2))
        : "EnumValue" === b &&
          ((d = a.classType),
          0 === d.indexOf("go.") && (d = d.substr(3)),
          (d = Br(d)),
          "function" === typeof d && (c = bb(d, a.name)));
    return c;
  }
  t.Dh = function (a) {
    A(a, "function", X, "addChangedListener:listener");
    this.gu.add(a);
    return this;
  };
  t.Ik = function (a) {
    A(a, "function", X, "removeChangedListener:listener");
    this.gu.remove(a);
  };
  t.ws = function (a) {
    this.skipsUndoManager || this.undoManager.zv(a);
    for (var b = this.gu, c = b.length, d = 0; d < c; d++) b.N(d)(a);
  };
  t.cb = function (a, b, c, d, e, f, g) {
    Dr(this, "", a, b, c, d, e, f, g);
  };
  t.g = function (a, b, c, d, e) {
    Dr(this, "", pe, a, this, b, c, d, e);
  };
  t.Zs = function (a, b, c, d, e, f) {
    Dr(this, "", pe, b, a, c, d, e, f);
  };
  function Dr(a, b, c, d, e, f, g, h, k) {
    void 0 === h && (h = null);
    void 0 === k && (k = null);
    var l = new oe();
    l.model = a;
    l.change = c;
    l.modelChange = b;
    l.propertyName = d;
    l.object = e;
    l.oldValue = f;
    l.oldParam = h;
    l.newValue = g;
    l.newParam = k;
    a.ws(l);
  }
  X.prototype.changeState = function (a, b) {
    if (null !== a && a.model === this)
      if (a.change === pe) {
        var c = a.object,
          d = a.propertyName,
          e = a.K(b);
        d === this.nodeKeyProperty &&
          this.bb(c) &&
          ((b = a.K(!b)),
          void 0 !== b && this.mb.remove(b),
          void 0 !== e && this.mb.add(e, c));
        ak(c, d, e);
      } else
        a.change === re
          ? ((c = a.newParam),
            "nodeDataArray" === a.modelChange
              ? ((a = a.newValue),
                Ga(a) &&
                  "number" === typeof c &&
                  ((d = this.wa(a)),
                  b
                    ? (this.Ac[c] === a && La(this.Ac, c),
                      void 0 !== d && this.mb.remove(d))
                    : (this.Ac[c] !== a && Ka(this.Ac, c, a),
                      void 0 !== d && this.mb.add(d, a))))
              : "" === a.modelChange
              ? ((d = a.object) &&
                  !Ha(d) &&
                  a.propertyName &&
                  (d = Fn(a.object, a.propertyName)),
                Ha(d) &&
                  "number" === typeof c &&
                  ((a = a.newValue), b ? La(d, c) : Ka(d, c, a)))
              : v("unknown ChangedEvent.Insert modelChange: " + a.toString()))
          : a.change === se
          ? ((c = a.oldParam),
            "nodeDataArray" === a.modelChange
              ? ((a = a.oldValue),
                Ga(a) &&
                  "number" === typeof c &&
                  ((d = this.wa(a)),
                  b
                    ? (this.Ac[c] !== a && Ka(this.Ac, c, a),
                      void 0 !== d && this.mb.add(d, a))
                    : (this.Ac[c] === a && La(this.Ac, c),
                      void 0 !== d && this.mb.remove(d))))
              : "" === a.modelChange
              ? ((d = a.object) &&
                  !Ha(d) &&
                  a.propertyName &&
                  (d = Fn(a.object, a.propertyName)),
                Ha(d) &&
                  "number" === typeof c &&
                  ((a = a.oldValue), b ? Ka(d, c, a) : La(d, c)))
              : v("unknown ChangedEvent.Remove modelChange: " + a.toString()))
          : a.change !== qe && v("unknown ChangedEvent: " + a.toString());
  };
  X.prototype.Fa = function (a) {
    return this.undoManager.Fa(a);
  };
  X.prototype.gb = function (a) {
    return this.undoManager.gb(a);
  };
  X.prototype.Pf = function () {
    return this.undoManager.Pf();
  };
  X.prototype.commit = function (a, b) {
    void 0 === b && (b = "");
    var c = this.skipsUndoManager;
    null === b && ((this.skipsUndoManager = !0), (b = ""));
    this.undoManager.Fa(b);
    var d = !1;
    try {
      a(this), (d = !0);
    } finally {
      d ? this.undoManager.gb(b) : this.undoManager.Pf(),
        (this.skipsUndoManager = c);
    }
  };
  t = X.prototype;
  t.Ka = function (a, b) {
    void 0 === b && (b = "");
    Dr(this, "SourceChanged", qe, b, a, null, null);
  };
  function Er(a, b, c) {
    "string" !== typeof a &&
      "function" !== typeof a &&
      za(a, "string or function", b, c);
  }
  t.wa = function (a) {
    if (null !== a) {
      var b = this.wi;
      if ("" !== b && ((b = Fn(a, b)), void 0 !== b)) {
        if (fr(b)) return b;
        v(
          "Key value for node data " + a + " is not a number or a string: " + b
        );
      }
    }
  };
  t.Hm = function (a, b) {
    (void 0 !== b && null !== b && fr(b)) ||
      za(b, "number or string", X, "setKeyForNodeData:key");
    if (null !== a) {
      var c = this.wi;
      if ("" !== c)
        if (this.bb(a)) {
          var d = Fn(a, c);
          d !== b &&
            null === this.cc(b) &&
            (ak(a, c, b),
            void 0 !== d && this.mb.remove(d),
            this.mb.add(b, a),
            Dr(this, "nodeKey", pe, c, a, d, b),
            "string" === typeof c && this.Ka(a, c),
            this.Bq(d, b));
        } else ak(a, c, b);
    }
  };
  function fr(a) {
    return "number" === typeof a || "string" === typeof a;
  }
  t.bb = function (a) {
    var b = this.wa(a);
    return void 0 === b ? !1 : this.mb.K(b) === a;
  };
  t.cc = function (a) {
    null === a && v("Model.findNodeDataForKey:key must not be null");
    return void 0 !== a && fr(a) ? this.mb.K(a) : null;
  };
  t.Fv = function (a) {
    if (null !== a) {
      var b = this.wi;
      if ("" !== b) {
        var c = this.wa(a);
        if (void 0 === c || this.mb.contains(c)) {
          var d = this.Dl;
          if (
            null !== d &&
            ((c = d(this, a)),
            void 0 !== c && null !== c && !this.mb.contains(c))
          ) {
            ak(a, b, c);
            return;
          }
          if ("string" === typeof c) {
            for (d = 2; this.mb.contains(c + d); ) d++;
            ak(a, b, c + d);
          } else if (void 0 === c || "number" === typeof c) {
            for (c = -this.mb.count - 1; this.mb.contains(c); ) c--;
            ak(a, b, c);
          } else
            G &&
              v(
                "Model.getKeyForNodeData returned something other than a string or a number: " +
                  c
              );
        }
      }
    }
  };
  t.Af = function (a) {
    null !== a && (nb(a), this.bb(a) || Yq(this, a, !0));
  };
  function Yq(a, b, c) {
    var d = a.wa(b);
    if (void 0 === d || a.mb.K(d) !== b)
      a.Fv(b),
        (d = a.wa(b)),
        void 0 === d &&
          v(
            "Model.makeNodeDataKeyUnique failed on " +
              b +
              ".  Data not added to Model."
          ),
        a.mb.add(d, b),
        (d = null),
        c && ((d = a.Ac.length), Ka(a.Ac, d, b)),
        Dr(a, "nodeDataArray", re, "nodeDataArray", a, null, b, null, d),
        a.Cm(b),
        a.Bm(b);
  }
  t.kz = function (a) {
    if (Ha(a)) for (var b = a.length, c = 0; c < b; c++) this.Af(a[c]);
    else for (a = a.iterator; a.next(); ) this.Af(a.value);
  };
  t.zm = function (a) {
    null !== a && Xq(this, a, !0);
  };
  function Xq(a, b, c) {
    var d = a.wa(b);
    void 0 !== d && a.mb.remove(d);
    d = null;
    if (c) {
      a: if (((c = a.Ac), Array.isArray(c))) d = c.indexOf(b);
      else {
        d = c.length;
        for (var e = 0; e < d; e++)
          if (c[e] === b) {
            d = e;
            break a;
          }
        d = -1;
      }
      if (0 > d) return;
      La(a.Ac, d);
    }
    Dr(a, "nodeDataArray", se, "nodeDataArray", a, b, null, d, null);
    a.Iq(b);
  }
  t.VA = function (a) {
    if (Ha(a)) for (var b = a.length, c = 0; c < b; c++) this.zm(a[c]);
    else for (a = a.iterator; a.next(); ) this.zm(a.value);
  };
  t.IA = function (a) {
    if (a !== this.nodeDataArray && Ha(a)) {
      var b = this.Ll;
      b.clear();
      b.addAll(this.mb.iteratorKeys);
      var c = this.Jl;
      c.clear();
      for (var d = a.length, e = 0; e < d; e++) {
        var f = a[e],
          g = this.wa(f);
        if (void 0 !== g) {
          c.add(g);
          var h = this.cc(g);
          h !== f &&
            (null !== h
              ? (this.Vp(h, f), this.Im(f, h))
              : ((f = this.cloneDeep(f)), this.Hm(f, g), this.Af(f)));
        } else (g = this.cloneDeep(f)), this.Af(g), c.add(this.wa(g));
      }
      for (a = b.iterator; a.next(); )
        (d = a.value), c.contains(d) || ((d = this.cc(d)) && this.zm(d));
      b.clear();
      c.clear();
    }
  };
  t.Bq = function (a, b) {
    void 0 !== b && ((a = ir(this, a)), a instanceof I && this.Xf.add(b, a));
  };
  t.hw = function () {};
  t.Cm = function () {};
  t.Bm = function () {};
  t.Iq = function () {};
  function kr(a, b, c) {
    if (void 0 !== b) {
      var d = a.Xf.K(b);
      null === d && ((d = new I()), a.Xf.add(b, d));
      d.add(c);
    }
  }
  function jr(a, b, c) {
    if (void 0 !== b) {
      var d = a.Xf.K(b);
      d instanceof I &&
        (void 0 === c || null === c
          ? a.Xf.remove(b)
          : (d.remove(c), 0 === d.count && a.Xf.remove(b)));
    }
  }
  function ir(a, b) {
    if (void 0 === b) return null;
    a = a.Xf.K(b);
    return a instanceof I ? a : null;
  }
  t.xz = function (a) {
    void 0 === a ? this.Xf.clear() : this.Xf.remove(a);
  };
  X.prototype.copyNodeData = function (a) {
    if (null === a) return null;
    var b = this.$k;
    a = null !== b ? b(a, this) : Fr(this, a, !0);
    Ga(a) && ab(a);
    return a;
  };
  function Fr(a, b, c) {
    if (a.copiesArrays && Array.isArray(b)) {
      var d = [];
      for (c = 0; c < b.length; c++) {
        var e = Fr(a, b[c], a.copiesArrayObjects);
        d.push(e);
      }
      ab(d);
      return d;
    }
    if (c && Ga(b)) {
      c = (c = b.constructor) ? new c() : {};
      e =
        a.copiesKey || "string" !== typeof a.nodeKeyProperty
          ? null
          : a.nodeKeyProperty;
      for (d in b)
        if ("__gohashid" === d) c.__gohashid = void 0;
        else if (d === e) c[e] = void 0;
        else {
          var f = Fn(b, d);
          var g = xr(a, f);
          "GraphObject" === g ||
          "Diagram" === g ||
          "Layer" === g ||
          "RowColumnDefinition" === g ||
          "AnimationManager" === g ||
          "Tool" === g ||
          "CommandHandler" === g ||
          "Layout" === g ||
          "InputEvent" === g ||
          "DiagramEvent" === g
            ? (G &&
                "_" !== d[0] &&
                Fa(
                  'Warning: found GraphObject or Diagram reference when copying model data on property "' +
                    d +
                    '" of data object: ' +
                    b.toString() +
                    "  \nModel data should not have any references to a Diagram or any part of a diagram, such as: " +
                    f.toString()
                ),
              (g = !0))
            : (g =
                f instanceof X ||
                f instanceof ue ||
                f instanceof te ||
                f instanceof oe
                  ? !0
                  : !1);
          g ? ak(c, d, f) : ((f = Fr(a, f, !1)), ak(c, d, f));
        }
      ab(c);
      return c;
    }
    return b instanceof K
      ? b.copy()
      : b instanceof Gb
      ? b.copy()
      : b instanceof M
      ? b.copy()
      : b instanceof Ib
      ? b.copy()
      : b instanceof ic
      ? b.copy()
      : b;
  }
  X.prototype.setDataProperty = function (a, b, c) {
    G &&
      (A(a, "object", X, "setDataProperty:data"),
      A(b, "string", X, "setDataProperty:propname"),
      "" === b &&
        v(
          "Model.setDataProperty: property name must not be an empty string when setting " +
            a +
            " to " +
            c
        ));
    if (this.bb(a)) {
      if (b === this.nodeKeyProperty) {
        this.Hm(a, c);
        return;
      }
      if (b === this.nodeCategoryProperty) {
        this.Gm(a, c);
        return;
      }
    } else
      !Gr &&
        a instanceof O &&
        ((Gr = !0),
        Fa(
          'Model.setDataProperty is modifying a GraphObject, "' +
            a.toString() +
            '"'
        ),
        Fa("  Is that really your intent?"));
    var d = Fn(a, b);
    d !== c && (ak(a, b, c), this.Zs(a, b, d, c));
  };
  t = X.prototype;
  t.set = function (a, b, c) {
    this.setDataProperty(a, b, c);
  };
  t.Vp = function (a, b) {
    if (b) {
      var c = this.bb(a),
        d;
      for (d in b)
        "__gohashid" === d ||
          (c && d === this.nodeKeyProperty) ||
          this.setDataProperty(a, d, b[d]);
    }
  };
  t.gz = function (a, b) {
    this.Ks(a, -1, b);
  };
  t.Ks = function (a, b, c) {
    G &&
      (Ia(a, X, "insertArrayItem:arr"),
      D(b, X, "insertArrayItem:idx"),
      a === this.Ac &&
        v(
          "Model.insertArrayItem or Model.addArrayItem should not be called on the Model.nodeDataArray"
        ));
    0 > b && (b = a.length);
    Ka(a, b, c);
    Dr(this, "", re, "", a, null, c, null, b);
  };
  t.Qv = function (a, b) {
    void 0 === b && (b = -1);
    G && (Ia(a, X, "removeArrayItem:arr"), D(b, X, "removeArrayItem:idx"));
    a === this.Ac &&
      v(
        "Model.removeArrayItem should not be called on the Model.nodeDataArray"
      );
    -1 === b && (b = a.length - 1);
    var c = a[b];
    La(a, b);
    Dr(this, "", se, "", a, c, null, b, null);
  };
  t.iq = function (a) {
    if (null === a) return "";
    var b = this.Rj;
    if ("" === b) return "";
    b = Fn(a, b);
    if (void 0 === b) return "";
    if ("string" === typeof b) return b;
    v("getCategoryForNodeData found a non-string category for " + a + ": " + b);
  };
  t.Gm = function (a, b) {
    A(b, "string", X, "setCategoryForNodeData:cat");
    if (null !== a) {
      var c = this.Rj;
      if ("" !== c)
        if (this.bb(a)) {
          var d = Fn(a, c);
          void 0 === d && (d = "");
          d !== b && (ak(a, c, b), Dr(this, "nodeCategory", pe, c, a, d, b));
        } else ak(a, c, b);
    }
  };
  t.Im = function (a, b) {
    this.Gm(b, this.iq(a));
  };
  t.qm = function () {
    return !1;
  };
  t.vk = function () {
    return !1;
  };
  t.Zi = function () {
    return !1;
  };
  t.Qs = function () {
    return !1;
  };
  t.Xi = function () {
    return !1;
  };
  function xi() {
    return new X();
  }
  function xr(a, b) {
    if ("function" === typeof b) {
      if (b.className) return b.className;
      if (b.name) return b.name;
    } else if ("object" === typeof b && null !== b && b.constructor)
      return xr(a, b.constructor);
    return typeof b;
  }
  function Br(a) {
    return Hr[a] ? Hr[a] : void 0 !== sa.go && sa.go[a] ? sa.go[a] : null;
  }
  function Fn(a, b) {
    if (!a || !b) return null;
    try {
      if ("function" === typeof b) var c = b(a);
      else
        "function" === typeof a.getAttribute
          ? ((c = a.getAttribute(b)), null === c && (c = void 0))
          : (c = a[b]);
    } catch (d) {
      G && Fa("property get error: " + d.toString());
    }
    return c;
  }
  function ak(a, b, c) {
    if (a && b)
      try {
        "function" === typeof b
          ? b(a, c)
          : "function" === typeof a.setAttribute
          ? a.setAttribute(b, c)
          : (a[b] = c);
      } catch (d) {
        G && Fa("property set error: " + d.toString());
      }
  }
  oa.Object.defineProperties(X.prototype, {
    name: {
      configurable: !0,
      get: function () {
        return this.ua;
      },
      set: function (a) {
        var b = this.ua;
        b !== a &&
          (A(a, "string", X, "name"), (this.ua = a), this.g("name", b, a));
      },
    },
    dataFormat: {
      configurable: !0,
      get: function () {
        return this.xn;
      },
      set: function (a) {
        var b = this.xn;
        b !== a &&
          (A(a, "string", X, "dataFormat"),
          (this.xn = a),
          this.g("dataFormat", b, a));
      },
    },
    isReadOnly: {
      configurable: !0,
      get: function () {
        return this.Xg;
      },
      set: function (a) {
        var b = this.Xg;
        b !== a &&
          (A(a, "boolean", X, "isReadOnly"),
          (this.Xg = a),
          this.g("isReadOnly", b, a));
      },
    },
    modelData: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        var b = this.j;
        b !== a &&
          (A(a, "object", X, "modelData"),
          (this.j = a),
          this.g("modelData", b, a),
          this.Ka(a));
      },
    },
    undoManager: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        var b = this.o;
        b !== a &&
          (x(a, ue, X, "undoManager"),
          null !== b && b.zy(this),
          (this.o = a),
          null !== a && a.Ax(this));
      },
    },
    skipsUndoManager: {
      configurable: !0,
      get: function () {
        return this.qh;
      },
      set: function (a) {
        A(a, "boolean", X, "skipsUndoManager");
        this.qh = a;
      },
    },
    nodeKeyProperty: {
      configurable: !0,
      get: function () {
        return this.wi;
      },
      set: function (a) {
        var b = this.wi;
        b !== a &&
          (Er(a, X, "nodeKeyProperty"),
          "" === a && v("Model.nodeKeyProperty may not be the empty string"),
          0 < this.mb.count &&
            v(
              "Cannot set Model.nodeKeyProperty when there is existing node data"
            ),
          (this.wi = a),
          this.g("nodeKeyProperty", b, a));
      },
    },
    makeUniqueKeyFunction: {
      configurable: !0,
      get: function () {
        return this.Dl;
      },
      set: function (a) {
        var b = this.Dl;
        b !== a &&
          (null !== a && A(a, "function", X, "makeUniqueKeyFunction"),
          (this.Dl = a),
          this.g("makeUniqueKeyFunction", b, a));
      },
    },
    nodeDataArray: {
      configurable: !0,
      get: function () {
        return this.Ac;
      },
      set: function (a) {
        var b = this.Ac;
        if (b !== a) {
          Ia(a, X, "nodeDataArray");
          this.mb.clear();
          this.hw();
          for (var c = a.length, d = 0; d < c; d++) {
            var e = a[d];
            Ga(e) ||
              v("Model.nodeDataArray must only contain Objects, not: " + e);
            nb(e);
          }
          this.Ac = a;
          d = new H();
          for (e = 0; e < c; e++) {
            var f = a[e],
              g = this.wa(f);
            void 0 === g
              ? d.add(f)
              : null !== this.mb.K(g)
              ? d.add(f)
              : this.mb.add(g, f);
          }
          for (d = d.iterator; d.next(); )
            (e = d.value),
              this.Fv(e),
              (f = this.wa(e)),
              void 0 !== f && this.mb.add(f, e);
          Dr(this, "nodeDataArray", pe, "nodeDataArray", this, b, a);
          for (b = 0; b < c; b++) (d = a[b]), this.Cm(d), this.Bm(d);
          Array.isArray(a) || (this.isReadOnly = !0);
        }
      },
    },
    copyNodeDataFunction: {
      configurable: !0,
      get: function () {
        return this.$k;
      },
      set: function (a) {
        var b = this.$k;
        b !== a &&
          (null !== a && A(a, "function", X, "copyNodeDataFunction"),
          (this.$k = a),
          this.g("copyNodeDataFunction", b, a));
      },
    },
    copiesArrays: {
      configurable: !0,
      get: function () {
        return this.pn;
      },
      set: function (a) {
        var b = this.pn;
        b !== a &&
          (null !== a && A(a, "boolean", X, "copiesArrays"),
          (this.pn = a),
          this.g("copiesArrays", b, a));
      },
    },
    copiesArrayObjects: {
      configurable: !0,
      get: function () {
        return this.on;
      },
      set: function (a) {
        var b = this.on;
        b !== a &&
          (null !== a && A(a, "boolean", X, "copiesArrayObjects"),
          (this.on = a),
          this.g("copiesArrayObjects", b, a));
      },
    },
    copiesKey: {
      configurable: !0,
      get: function () {
        return this.rn;
      },
      set: function (a) {
        var b = this.rn;
        b !== a &&
          (null !== a && A(a, "boolean", X, "copiesKey"),
          (this.rn = a),
          this.g("copiesKey", b, a));
      },
    },
    afterCopyFunction: {
      configurable: !0,
      get: function () {
        return this.$m;
      },
      set: function (a) {
        var b = this.$m;
        b !== a &&
          (null !== a && A(a, "function", X, "afterCopyFunction"),
          (this.$m = a),
          this.g("afterCopyFunction", b, a));
      },
    },
    nodeCategoryProperty: {
      configurable: !0,
      get: function () {
        return this.Rj;
      },
      set: function (a) {
        var b = this.Rj;
        b !== a &&
          (Er(a, X, "nodeCategoryProperty"),
          (this.Rj = a),
          this.g("nodeCategoryProperty", b, a));
      },
    },
    type: {
      configurable: !0,
      get: function () {
        return "Model";
      },
    },
  });
  X.prototype.setCategoryForNodeData = X.prototype.Gm;
  X.prototype.getCategoryForNodeData = X.prototype.iq;
  X.prototype.removeArrayItem = X.prototype.Qv;
  X.prototype.insertArrayItem = X.prototype.Ks;
  X.prototype.addArrayItem = X.prototype.gz;
  X.prototype.assignAllDataProperties = X.prototype.Vp;
  X.prototype.set = X.prototype.set;
  X.prototype.clearUnresolvedReferences = X.prototype.xz;
  X.prototype.mergeNodeDataArray = X.prototype.IA;
  X.prototype.removeNodeDataCollection = X.prototype.VA;
  X.prototype.removeNodeData = X.prototype.zm;
  X.prototype.addNodeDataCollection = X.prototype.kz;
  X.prototype.addNodeData = X.prototype.Af;
  X.prototype.makeNodeDataKeyUnique = X.prototype.Fv;
  X.prototype.findNodeDataForKey = X.prototype.cc;
  X.prototype.containsNodeData = X.prototype.bb;
  X.prototype.setKeyForNodeData = X.prototype.Hm;
  X.prototype.getKeyForNodeData = X.prototype.wa;
  X.prototype.updateTargetBindings = X.prototype.Ka;
  X.prototype.commit = X.prototype.commit;
  X.prototype.rollbackTransaction = X.prototype.Pf;
  X.prototype.commitTransaction = X.prototype.gb;
  X.prototype.startTransaction = X.prototype.Fa;
  X.prototype.raiseDataChanged = X.prototype.Zs;
  X.prototype.raiseChanged = X.prototype.g;
  X.prototype.raiseChangedEvent = X.prototype.cb;
  X.prototype.removeChangedListener = X.prototype.Ik;
  X.prototype.addChangedListener = X.prototype.Dh;
  X.prototype.writeJsonValue = X.prototype.Qm;
  X.prototype.replaceJsonObjects = X.prototype.Am;
  X.prototype.applyIncrementalJSON = X.prototype.oz;
  X.prototype.applyIncrementalJson = X.prototype.Cx;
  X.prototype.toJSON = X.prototype.toJSON;
  X.prototype.toJson = X.prototype.Fq;
  X.prototype.toIncrementalJSON = X.prototype.gB;
  X.prototype.toIncrementalJson = X.prototype.Jy;
  X.prototype.toIncrementalData = X.prototype.fB;
  X.prototype.clear = X.prototype.clear;
  var Gr = !1,
    Hr = {};
  X.className = "Model";
  X.fromJSON = X.fromJson = function (a, b) {
    void 0 === b && (b = null);
    null !== b && x(b, X, X, "fromJson:model");
    var c = null;
    if ("string" === typeof a)
      try {
        c = sa.JSON.parse(a);
      } catch (f) {
        G && Fa("JSON.parse error: " + f.toString());
      }
    else
      "object" === typeof a
        ? (c = a)
        : v("Unable to construct a Model from: " + a);
    if (null === b) {
      a = null;
      var d = c["class"];
      if ("string" === typeof d)
        try {
          var e = null;
          0 === d.indexOf("go.")
            ? ((d = d.substr(3)), (e = Br(d)))
            : ((e = Br(d)), null === e && (e = sa[d]));
          "function" === typeof e && (a = new e());
        } catch (f) {}
      null === a || a instanceof X
        ? (b = a)
        : v("Unable to construct a Model of declared class: " + c["class"]);
    }
    null === b && (b = X.constructGraphLinksModel());
    b.xq(c);
    b.Nv(c);
    return b;
  };
  X.safePropertyValue = Fn;
  X.safePropertySet = ak;
  Hr.Brush = Al;
  Hr.ChangedEvent = oe;
  Hr.Geometry = N;
  Hr.Margin = ic;
  Hr.Panel = W;
  Hr.Point = K;
  Hr.Rect = M;
  Hr.Size = Gb;
  Hr.Spot = Ib;
  Hr.Transaction = te;
  Hr.UndoManager = ue;
  function Fi(a, b, c, d) {
    ab(this);
    this.u = !1;
    void 0 === a ? (a = "") : A(a, "string", Fi, "constructor:targetprop");
    void 0 === b ? (b = a) : A(b, "string", Fi, "constructor:sourceprop");
    void 0 === c
      ? (c = null)
      : null !== c && A(c, "function", Fi, "constructor:conv");
    this.j = -1;
    this.wd = null;
    this.am = a;
    this.$l = this.Gp = 0;
    this.fs = null;
    this.ko = !1;
    this.Vl = b;
    this.nn = c;
    void 0 === d
      ? ((this.Gl = Ir), (this.Tk = null))
      : ((this.Gl = xn), (this.Tk = d));
    this.Nt = new I();
  }
  Fi.prototype.copy = function () {
    var a = new Fi();
    a.am = this.am;
    a.Gp = this.Gp;
    a.$l = this.$l;
    a.fs = this.fs;
    a.ko = this.ko;
    a.Vl = this.Vl;
    a.nn = this.nn;
    a.Gl = this.Gl;
    a.Tk = this.Tk;
    return a;
  };
  t = Fi.prototype;
  t.pb = function (a) {
    a.classType === Fi ? (this.mode = a) : Ea(this, a);
  };
  t.toString = function () {
    return (
      "Binding(" +
      this.targetProperty +
      ":" +
      this.sourceProperty +
      (-1 !== this.gj ? " " + this.gj : "") +
      " " +
      this.mode.name +
      ")"
    );
  };
  t.freeze = function () {
    this.u = !0;
    return this;
  };
  t.la = function () {
    this.u = !1;
    return this;
  };
  t.qy = function (a) {
    void 0 === a && (a = null);
    null !== a && A(a, "function", Fi, "makeTwoWay");
    this.mode = xn;
    this.backConverter = a;
    return this;
  };
  t.uq = function (a) {
    void 0 === a && (a = "");
    G && A(a, "string", Fi, "ofObject:srcname");
    this.sourceName = a;
    this.isToModel = !1;
    return this;
  };
  t.LA = function () {
    this.sourceName = null;
    this.isToModel = !0;
    return this;
  };
  function tl(a, b, c) {
    a = a.sourceName;
    return null === a || "" === a
      ? b
      : "/" === a
      ? c.part
      : "." === a
      ? c
      : ".." === a
      ? c.panel
      : b.hb(a);
  }
  t.iw = function (a, b, c) {
    var d = this.Vl;
    if (void 0 === c || "" === d || d === c) {
      c = this.am;
      var e = this.nn;
      if (null === e && "" === c)
        Fa(
          "Binding error: target property is the empty string: " +
            this.toString()
        );
      else {
        G &&
          "string" === typeof c &&
          ("function" !== typeof a.setAttribute &&
          0 < c.length &&
          "_" !== c[0] &&
          !Sa(a, c)
            ? Fa(
                "Binding error: undefined target property: " +
                  c +
                  " on " +
                  a.toString()
              )
            : "name" === c &&
              a instanceof O &&
              Fa(
                "Binding error: cannot modify GraphObject.name on " +
                  a.toString()
              ));
        var f = b;
        "" !== d && (f = Fn(b, d));
        if (void 0 !== f)
          if (null === e) "" !== c && ak(a, c, f);
          else
            try {
              if ("" !== c) {
                var g = e(f, a);
                G &&
                  void 0 === g &&
                  Fa(
                    'Binding warning: conversion function returned undefined when setting target property "' +
                      c +
                      '" on ' +
                      a.toString() +
                      ", function is: " +
                      e
                  );
                ak(a, c, g);
              } else e(f, a);
            } catch (h) {
              G &&
                Fa(
                  "Binding error: " +
                    h.toString() +
                    ' setting target property "' +
                    c +
                    '" on ' +
                    a.toString() +
                    " with conversion function: " +
                    e
                );
            }
      }
    }
  };
  t.Kq = function (a, b, c, d) {
    if (this.Gl === xn) {
      var e = this.am;
      if (void 0 === c || e === c) {
        c = this.Vl;
        var f = this.Tk,
          g = a;
        "" !== e && (g = Fn(a, e));
        if (void 0 !== g && !this.Nt.contains(a))
          try {
            this.Nt.add(a);
            var h = null !== d ? d.diagram : null,
              k = null !== h ? h.model : null;
            if (null === f)
              if ("" !== c)
                null !== k
                  ? (G &&
                      k.nodeKeyProperty === c &&
                      k.bb(b) &&
                      Fa(
                        "Binding error: cannot have TwoWay Binding on node data key property: " +
                          this.toString()
                      ),
                    k.setDataProperty(b, c, g))
                  : ak(b, c, g);
              else {
                if (
                  null !== k &&
                  null !== d &&
                  0 <= d.itemIndex &&
                  null !== d.panel &&
                  Array.isArray(d.panel.itemArray)
                ) {
                  var l = d.itemIndex,
                    m = d.panel.itemArray;
                  k.Qv(m, l);
                  k.Ks(m, l, g);
                }
              }
            else
              try {
                if ("" !== c) {
                  var n = f(g, b, k);
                  null !== k
                    ? (G &&
                        (k.nodeKeyProperty === c &&
                          k.bb(b) &&
                          Fa(
                            "Binding error: cannot have TwoWay Binding on node data key property: " +
                              this.toString()
                          ),
                        void 0 === n &&
                          Fa(
                            'Binding warning: conversion function returned undefined when setting source property "' +
                              c +
                              '" on ' +
                              b.toString() +
                              ", function is: " +
                              f
                          )),
                      k.setDataProperty(b, c, n))
                    : ak(b, c, n);
                } else {
                  var p = f(g, b, k);
                  if (
                    void 0 !== p &&
                    null !== k &&
                    null !== d &&
                    0 <= d.itemIndex &&
                    null !== d.panel &&
                    Array.isArray(d.panel.itemArray)
                  ) {
                    var r = d.itemIndex,
                      q = d.panel.itemArray;
                    k.Qv(q, r);
                    k.Ks(q, r, p);
                  }
                }
              } catch (u) {
                G &&
                  Fa(
                    "Binding error: " +
                      u.toString() +
                      ' setting source property "' +
                      c +
                      '" on ' +
                      b.toString() +
                      " with conversion function: " +
                      f
                  );
              }
          } finally {
            this.Nt.remove(a);
          }
      }
    }
  };
  oa.Object.defineProperties(Fi.prototype, {
    gj: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.u && xa(this);
        A(a, "number", Fi, "targetId");
        this.j = a;
      },
    },
    targetProperty: {
      configurable: !0,
      get: function () {
        return this.am;
      },
      set: function (a) {
        this.u && xa(this);
        A(a, "string", Fi, "targetProperty");
        this.am = a;
      },
    },
    sourceName: {
      configurable: !0,
      get: function () {
        return this.fs;
      },
      set: function (a) {
        this.u && xa(this);
        null !== a && A(a, "string", Fi, "sourceName");
        this.fs = a;
        null !== a && (this.ko = !1);
      },
    },
    isToModel: {
      configurable: !0,
      get: function () {
        return this.ko;
      },
      set: function (a) {
        this.u && xa(this);
        A(a, "boolean", Fi, "isToModel");
        this.ko = a;
      },
    },
    sourceProperty: {
      configurable: !0,
      get: function () {
        return this.Vl;
      },
      set: function (a) {
        this.u && xa(this);
        A(a, "string", Fi, "sourceProperty");
        this.Vl = a;
      },
    },
    converter: {
      configurable: !0,
      get: function () {
        return this.nn;
      },
      set: function (a) {
        this.u && xa(this);
        null !== a && A(a, "function", Fi, "converter");
        this.nn = a;
      },
    },
    backConverter: {
      configurable: !0,
      get: function () {
        return this.Tk;
      },
      set: function (a) {
        this.u && xa(this);
        null !== a && A(a, "function", Fi, "backConverter");
        this.Tk = a;
      },
    },
    mode: {
      configurable: !0,
      get: function () {
        return this.Gl;
      },
      set: function (a) {
        this.u && xa(this);
        cb(a, Fi, Fi, "mode");
        this.Gl = a;
      },
    },
  });
  Fi.prototype.updateSource = Fi.prototype.Kq;
  Fi.prototype.updateTarget = Fi.prototype.iw;
  Fi.prototype.ofModel = Fi.prototype.LA;
  Fi.prototype.ofObject = Fi.prototype.uq;
  Fi.prototype.makeTwoWay = Fi.prototype.qy;
  var Wk = "Binding",
    Ir = new F(Fi, "OneWay", 1),
    xn = new F(Fi, "TwoWay", 2);
  Fi.className = "Binding";
  Fi.parseEnum = function (a, b) {
    A(a, "function", Fi, "parseEnum:ctor");
    cb(b, a, Fi, "parseEnum:defval");
    return function (c) {
      c = bb(a, c);
      return null === c ? b : c;
    };
  };
  Fi.toString = Ra;
  Fi.OneWay = Ir;
  Fi.TwoWay = xn;
  function Jr(a, b, c) {
    X.call(this);
    this.vw = ',\n  "insertedLinkKeys": ';
    this.Py = ',\n  "modifiedLinkData": ';
    this.xw = ',\n  "removedLinkKeys": ';
    this.gd = [];
    this.cg = new I();
    this.rb = new xb();
    this.oi = "";
    this.vj = this.Zk = this.El = null;
    this.jf = "from";
    this.kf = "to";
    this.Nj = this.Mj = "";
    this.Lj = "category";
    this.ee = "";
    this.Kl = "isGroup";
    this.He = "group";
    this.qn = !1;
    void 0 !== b && (this.linkDataArray = b);
    void 0 !== a && (Ha(a) ? (this.nodeDataArray = a) : Object.assign(this, a));
    c && Object.assign(this, c);
  }
  na(Jr, X);
  Jr.constructGraphLinksModel = X.constructGraphLinksModel;
  Jr.prototype.cloneProtected = function (a) {
    X.prototype.cloneProtected.call(this, a);
    a.oi = this.oi;
    a.El = this.El;
    a.Zk = this.Zk;
    a.jf = this.jf;
    a.kf = this.kf;
    a.Mj = this.Mj;
    a.Nj = this.Nj;
    a.Lj = this.Lj;
    a.ee = this.ee;
    a.Kl = this.Kl;
    a.He = this.He;
    a.qn = this.qn;
  };
  t = Jr.prototype;
  t.clear = function () {
    X.prototype.clear.call(this);
    this.gd = [];
    this.rb.clear();
    this.cg.clear();
  };
  t.toString = function (a) {
    void 0 === a && (a = 0);
    if (2 <= a) return this.Fq();
    var b = ("" !== this.name ? this.name : "") + " GraphLinksModel";
    if (0 < a) {
      b += "\n node data:";
      a = this.nodeDataArray;
      var c = a.length,
        d;
      for (d = 0; d < c; d++) {
        var e = a[d];
        b += " " + this.wa(e) + ":" + Ra(e);
      }
      b += "\n link data:";
      a = this.linkDataArray;
      c = a.length;
      for (d = 0; d < c; d++)
        (e = a[d]), (b += " " + dr(this, e, !0) + "--\x3e" + dr(this, e, !1));
    }
    return b;
  };
  t.nw = function (a, b) {
    "" === this.linkKeyProperty &&
      v(
        "GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalData() to succeed."
      );
    var c = X.prototype.nw.call(this, a, b),
      d = this,
      e = new I(),
      f = new I(),
      g = new I(),
      h = this.Uh;
    a.changes.each(function (a) {
      a.model === d &&
        ("linkDataArray" === a.modelChange
          ? a.change === re
            ? e.add(a.newValue)
            : a.change === se && g.add(a.oldValue)
          : d.Dc(a.object)
          ? f.add(a.object)
          : null !== a.object &&
            (null !== a.object && h && h.contains(a.object)
              ? h.get(a.object).each(function (a) {
                  d.Dc(a) && f.add(a);
                })
              : a.object instanceof X ||
                d.bb(a.object) ||
                Kr(d, a.object).each(function (a) {
                  f.add(a);
                })));
    });
    var k = this.Jl;
    k.clear();
    e.each(function (a) {
      k.add(d.vc(a));
      b || f.add(a);
    });
    var l = this.Ll;
    l.clear();
    g.each(function (a) {
      l.add(d.vc(a));
      b && f.add(a);
    });
    a = d.cloneDeep(f.Ga());
    0 < k.count &&
      (null === c && (c = {}),
      b ? (c.removedLinkKeys = k.Ga()) : (c.insertedLinkKeys = k.Ga()));
    0 < a.length && (null === c && (c = {}), (c.modifiedLinkData = a));
    0 < l.count &&
      (null === c && (c = {}),
      b ? (c.insertedLinkKeys = l.Ga()) : (c.removedLinkKeys = l.Ga()));
    l.clear();
    k.clear();
    return c;
  };
  t.Pm = function () {
    var a = X.prototype.Pm.call(this),
      b = "";
    "category" !== this.linkCategoryProperty &&
      "string" === typeof this.linkCategoryProperty &&
      (b +=
        ',\n  "linkCategoryProperty": ' +
        this.quote(this.linkCategoryProperty));
    "" !== this.linkKeyProperty &&
      "string" === typeof this.linkKeyProperty &&
      (b += ',\n  "linkKeyProperty": ' + this.quote(this.linkKeyProperty));
    "from" !== this.linkFromKeyProperty &&
      "string" === typeof this.linkFromKeyProperty &&
      (b +=
        ',\n  "linkFromKeyProperty": ' + this.quote(this.linkFromKeyProperty));
    "to" !== this.linkToKeyProperty &&
      "string" === typeof this.linkToKeyProperty &&
      (b += ',\n  "linkToKeyProperty": ' + this.quote(this.linkToKeyProperty));
    "" !== this.linkFromPortIdProperty &&
      "string" === typeof this.linkFromPortIdProperty &&
      (b +=
        ',\n  "linkFromPortIdProperty": ' +
        this.quote(this.linkFromPortIdProperty));
    "" !== this.linkToPortIdProperty &&
      "string" === typeof this.linkToPortIdProperty &&
      (b +=
        ',\n  "linkToPortIdProperty": ' +
        this.quote(this.linkToPortIdProperty));
    "" !== this.linkLabelKeysProperty &&
      "string" === typeof this.linkLabelKeysProperty &&
      (b +=
        ',\n  "linkLabelKeysProperty": ' +
        this.quote(this.linkLabelKeysProperty));
    "isGroup" !== this.nodeIsGroupProperty &&
      "string" === typeof this.nodeIsGroupProperty &&
      (b +=
        ',\n  "nodeIsGroupProperty": ' + this.quote(this.nodeIsGroupProperty));
    "group" !== this.nodeGroupKeyProperty &&
      "string" === typeof this.nodeGroupKeyProperty &&
      (b +=
        ',\n  "nodeGroupKeyProperty": ' +
        this.quote(this.nodeGroupKeyProperty));
    return a + b;
  };
  t.xq = function (a) {
    X.prototype.xq.call(this, a);
    a.linkKeyProperty && (this.linkKeyProperty = a.linkKeyProperty);
    a.linkFromKeyProperty && (this.linkFromKeyProperty = a.linkFromKeyProperty);
    a.linkToKeyProperty && (this.linkToKeyProperty = a.linkToKeyProperty);
    a.linkFromPortIdProperty &&
      (this.linkFromPortIdProperty = a.linkFromPortIdProperty);
    a.linkToPortIdProperty &&
      (this.linkToPortIdProperty = a.linkToPortIdProperty);
    a.linkCategoryProperty &&
      (this.linkCategoryProperty = a.linkCategoryProperty);
    a.linkLabelKeysProperty &&
      (this.linkLabelKeysProperty = a.linkLabelKeysProperty);
    a.nodeIsGroupProperty && (this.nodeIsGroupProperty = a.nodeIsGroupProperty);
    a.nodeGroupKeyProperty &&
      (this.nodeGroupKeyProperty = a.nodeGroupKeyProperty);
  };
  t.ow = function () {
    var a = X.prototype.ow.call(this),
      b = ',\n  "linkDataArray": ' + vr(this, this.linkDataArray, !0);
    return a + b;
  };
  t.Nv = function (a) {
    X.prototype.Nv.call(this, a);
    a = a.linkDataArray;
    Array.isArray(a) && (this.Am(a), (this.linkDataArray = a));
  };
  function Kr(a, b) {
    for (var c = new I(), d = 0; d < a.linkDataArray.length; d++) {
      var e = a.linkDataArray[d];
      wr(a, b, e, e, c);
    }
    return c;
  }
  t.mw = function (a, b) {
    "" === this.linkKeyProperty &&
      v(
        "GraphLinksModel.linkKeyProperty must not be an empty string for .toIncrementalJson() to succeed."
      );
    var c = X.prototype.mw.call(this, a, b),
      d = this,
      e = new I(),
      f = new I(),
      g = new I(),
      h = this.Uh;
    a.changes.each(function (a) {
      a.model === d &&
        ("linkDataArray" === a.modelChange
          ? a.change === re
            ? e.add(a.newValue)
            : a.change === se && g.add(a.oldValue)
          : d.Dc(a.object)
          ? f.add(a.object)
          : null !== a.object &&
            (null !== a.object && h && h.contains(a.object)
              ? h.get(a.object).each(function (a) {
                  d.Dc(a) && f.add(a);
                })
              : a.object instanceof X ||
                d.bb(a.object) ||
                Kr(d, a.object).each(function (a) {
                  f.add(a);
                })));
    });
    var k = this.Jl;
    k.clear();
    e.each(function (a) {
      k.add(d.vc(a));
      b || f.add(a);
    });
    var l = this.Ll;
    l.clear();
    g.each(function (a) {
      l.add(d.vc(a));
      b && f.add(a);
    });
    a = c;
    0 < k.count && (a += (b ? this.xw : this.vw) + vr(this, k.Ga(), !0));
    0 < f.count && (a += this.Py + vr(this, f.Ga(), !0));
    0 < l.count && (a += (b ? this.vw : this.xw) + vr(this, l.Ga(), !0));
    l.clear();
    k.clear();
    return a;
  };
  t.wq = function (a) {
    ((void 0 !== a.linkCategoryProperty &&
      a.linkCategoryProperty !== this.linkCategoryProperty) ||
      (void 0 !== a.linkKeyProperty &&
        a.linkKeyProperty !== this.linkKeyProperty) ||
      (void 0 !== a.linkFromKeyProperty &&
        a.linkFromKeyProperty !== this.linkFromKeyProperty) ||
      (void 0 !== a.linkToKeyProperty &&
        a.linkToKeyProperty !== this.linkToKeyProperty) ||
      (void 0 !== a.linkFromPortIdProperty &&
        a.linkFromPortIdProperty !== this.linkFromPortIdProperty) ||
      (void 0 !== a.linkToPortIdProperty &&
        a.linkToPortIdProperty !== this.linkToPortIdProperty) ||
      (void 0 !== a.linkLabelKeysProperty &&
        a.linkLabelKeysProperty !== this.linkLabelKeysProperty) ||
      (void 0 !== a.nodeIsGroupProperty &&
        a.nodeIsGroupProperty !== this.nodeIsGroupProperty) ||
      (void 0 !== a.nodeGroupKeyProperty &&
        a.nodeGroupKeyProperty !== this.nodeGroupKeyProperty)) &&
      v("applyIncrementalJson cannot change Model properties");
    X.prototype.wq.call(this, a);
    var b = a.insertedLinkKeys;
    if (Array.isArray(b))
      for (var c = b.length, d = 0; d < c; d++) {
        var e = b[d],
          f = this.Ih(e);
        null === f && ((f = this.aq({})), this.ct(f, e), this.Ki(f));
      }
    b = a.modifiedLinkData;
    if (Array.isArray(b))
      for (c = b.length, d = 0; d < c; d++)
        if (((e = b[d]), (f = this.vc(e)), (f = this.Ih(f)), null !== f)) {
          for (var g in e)
            "__gohashid" !== g &&
              g !== this.linkKeyProperty &&
              this.setDataProperty(f, g, e[g]);
          Lr(this, e, f);
        }
    a = a.removedLinkKeys;
    if (Array.isArray(a))
      for (g = a.length, b = 0; b < g; b++)
        (c = this.Ih(a[b])), null !== c && this.ym(c);
  };
  Jr.prototype.changeState = function (a, b) {
    if (null !== a && a.model === this) {
      if (a.change === pe) {
        var c = a.object,
          d = a.propertyName;
        if (d === this.linkKeyProperty && this.Dc(c)) {
          var e = a.K(b);
          b = a.K(!b);
          void 0 !== b && this.rb.remove(b);
          void 0 !== e && this.rb.add(e, c);
          ak(c, d, e);
          return;
        }
      } else if (a.change === re) {
        c = a.newParam;
        if ("linkDataArray" === a.modelChange) {
          a = a.newValue;
          Ga(a) &&
            "number" === typeof c &&
            ((d = this.vc(a)),
            b
              ? (this.cg.remove(a),
                this.gd[c] === a && this.gd.splice(c, 1),
                void 0 !== d && this.rb.remove(d))
              : (this.cg.add(a),
                this.gd[c] !== a && this.gd.splice(c, 0, a),
                void 0 !== d && this.rb.add(d, a)));
          return;
        }
        if ("linkLabelKeys" === a.modelChange) {
          d = this.Jf(a.object);
          Array.isArray(d) &&
            "number" === typeof c &&
            (b
              ? ((c = d.indexOf(a.newValue)), 0 <= c && d.splice(c, 1))
              : 0 > d.indexOf(a.newValue) && d.splice(c, 0, a.newValue));
          return;
        }
      } else if (a.change === se) {
        c = a.oldParam;
        if ("linkDataArray" === a.modelChange) {
          a = a.oldValue;
          Ga(a) &&
            "number" === typeof c &&
            ((d = this.vc(a)),
            b
              ? (this.cg.add(a),
                this.gd[c] !== a && this.gd.splice(c, 0, a),
                void 0 !== d && this.rb.add(d, a))
              : (this.cg.remove(a),
                this.gd[c] === a && this.gd.splice(c, 1),
                void 0 !== d && this.rb.remove(d)));
          return;
        }
        if ("linkLabelKeys" === a.modelChange) {
          d = this.Jf(a.object);
          Array.isArray(d) &&
            "number" === typeof c &&
            (b
              ? 0 > d.indexOf(a.newValue) && d.splice(c, 0, a.newValue)
              : ((c = d.indexOf(a.newValue)), 0 <= c && d.splice(c, 1)));
          return;
        }
      }
      X.prototype.changeState.call(this, a, b);
    }
  };
  t = Jr.prototype;
  t.sm = function (a) {
    if (void 0 !== a) {
      var b = this.vj;
      if (null !== b) {
        var c = this.cc(a);
        null === c &&
          ((c = this.copyNodeData(b)),
          ak(c, this.nodeKeyProperty, a),
          this.Af(c));
      }
      return a;
    }
  };
  t.$x = function (a) {
    return dr(this, a, !0);
  };
  t.Wv = function (a, b) {
    lr(this, a, b, !0);
  };
  t.ey = function (a) {
    return dr(this, a, !1);
  };
  t.$v = function (a, b) {
    lr(this, a, b, !1);
  };
  function dr(a, b, c) {
    if (
      null !== b &&
      ((a = c ? a.jf : a.kf), "" !== a && ((a = Fn(b, a)), void 0 !== a))
    ) {
      if (fr(a)) return a;
      v(
        (c ? "FromKey" : "ToKey") +
          " value for link data " +
          b +
          " is not a number or a string: " +
          a
      );
    }
  }
  function lr(a, b, c, d) {
    null === c && (c = void 0);
    void 0 === c ||
      fr(c) ||
      za(
        c,
        "number or string",
        Jr,
        d ? "setFromKeyForLinkData:key" : "setToKeyForLinkData:key"
      );
    if (null !== b) {
      var e = d ? a.jf : a.kf;
      if ("" !== e)
        if (((c = a.sm(c)), a.Dc(b))) {
          var f = Fn(b, e);
          f !== c &&
            (jr(a, f, b),
            ak(b, e, c),
            null === a.cc(c) && kr(a, c, b),
            Dr(a, d ? "linkFromKey" : "linkToKey", pe, e, b, f, c),
            "string" === typeof e && a.Ka(b, e));
        } else ak(b, e, c);
    }
  }
  t.ay = function (a) {
    return cr(this, a, !0);
  };
  t.Xv = function (a, b) {
    mr(this, a, b, !0);
  };
  t.gy = function (a) {
    return cr(this, a, !1);
  };
  t.aw = function (a, b) {
    mr(this, a, b, !1);
  };
  function cr(a, b, c) {
    if (null === b) return "";
    a = c ? a.Mj : a.Nj;
    if ("" === a) return "";
    b = Fn(b, a);
    return void 0 === b ? "" : b;
  }
  function mr(a, b, c, d) {
    A(
      c,
      "string",
      Jr,
      d
        ? "setFromPortIdForLinkData:portname"
        : "setToPortIdForLinkData:portname"
    );
    if (null !== b) {
      var e = d ? a.Mj : a.Nj;
      if ("" !== e)
        if (a.Dc(b)) {
          var f = Fn(b, e);
          void 0 === f && (f = "");
          f !== c &&
            (ak(b, e, c),
            Dr(a, d ? "linkFromPortId" : "linkToPortId", pe, e, b, f, c),
            "string" === typeof e && a.Ka(b, e));
        } else ak(b, e, c);
    }
  }
  t.Jf = function (a) {
    if (null === a) return Mr;
    var b = this.ee;
    if ("" === b) return Mr;
    a = Fn(a, b);
    return void 0 === a ? Mr : a;
  };
  t.dt = function (a, b) {
    Ia(b, Jr, "setLabelKeysForLinkData:arr");
    if (null !== a) {
      var c = this.ee;
      if ("" !== c)
        if (this.Dc(a)) {
          var d = Fn(a, c);
          void 0 === d && (d = Mr);
          if (d !== b) {
            if (Array.isArray(d))
              for (var e = d.length, f = 0; f < e; f++) jr(this, d[f], a);
            ak(a, c, b);
            e = b.length;
            for (f = 0; f < e; f++) {
              var g = b[f];
              null === this.cc(g) && kr(this, g, a);
            }
            Dr(this, "linkLabelKeys", pe, c, a, d, b);
            "string" === typeof c && this.Ka(a, c);
          }
        } else ak(a, c, b);
    }
  };
  t.$u = function (a, b) {
    if (
      null !== b &&
      void 0 !== b &&
      (fr(b) || za(b, "number or string", Jr, "addLabelKeyForLinkData:key"),
      null !== a)
    ) {
      var c = this.ee;
      if ("" !== c) {
        var d = Fn(a, c);
        if (void 0 === d) (c = []), c.push(b), this.dt(a, c);
        else if (Array.isArray(d)) {
          var e = d.indexOf(b);
          0 <= e ||
            ((e = d.length),
            d.push(b),
            this.Dc(a) &&
              (null === this.cc(b) && kr(this, b, a),
              Dr(this, "linkLabelKeys", re, c, a, null, b, null, e)));
        } else
          v(
            c + " property is not an Array; cannot addLabelKeyForLinkData: " + a
          );
      }
    }
  };
  t.yy = function (a, b) {
    if (
      null !== b &&
      void 0 !== b &&
      (fr(b) || za(b, "number or string", Jr, "removeLabelKeyForLinkData:key"),
      null !== a)
    ) {
      var c = this.ee;
      if ("" !== c) {
        var d = Fn(a, c);
        if (Array.isArray(d)) {
          var e = d.indexOf(b);
          0 > e ||
            (d.splice(e, 1),
            this.Dc(a) &&
              (jr(this, b, a),
              Dr(this, "linkLabelKeys", se, c, a, b, null, e, null)));
        } else
          void 0 !== d &&
            v(
              c +
                " property is not an Array; cannot removeLabelKeyforLinkData: " +
                a
            );
      }
    }
  };
  t.vc = function (a) {
    if (null !== a) {
      var b = this.oi;
      if ("" !== b && ((b = Fn(a, b)), void 0 !== b)) {
        if (fr(b)) return b;
        v(
          "Key value for link data " + a + " is not a number or a string: " + b
        );
      }
    }
  };
  t.ct = function (a, b) {
    (void 0 !== b && null !== b && fr(b)) ||
      za(b, "number or string", Jr, "setKeyForLinkData:key");
    if (null !== a) {
      var c = this.oi;
      if ("" !== c)
        if (this.Dc(a)) {
          var d = Fn(a, c);
          d !== b &&
            null === this.Ih(b) &&
            (ak(a, c, b),
            void 0 !== d && this.rb.remove(d),
            this.rb.add(b, a),
            Dr(this, "linkKey", pe, c, a, d, b),
            "string" === typeof c && this.Ka(a, c));
        } else ak(a, c, b);
    }
  };
  t.Ih = function (a) {
    null === a && v("GraphLinksModel.findLinkDataForKey:key must not be null");
    return void 0 !== a && fr(a) ? this.rb.K(a) : null;
  };
  t.Us = function (a) {
    if (null !== a) {
      var b = this.oi;
      if ("" !== b) {
        var c = this.vc(a);
        if (void 0 === c || this.rb.contains(c)) {
          var d = this.El;
          if (
            null !== d &&
            ((c = d(this, a)),
            void 0 !== c && null !== c && !this.rb.contains(c))
          ) {
            ak(a, b, c);
            return;
          }
          if ("string" === typeof c) {
            for (d = 2; this.rb.contains(c + d); ) d++;
            ak(a, b, c + d);
          } else if (void 0 === c || "number" === typeof c) {
            for (c = -this.rb.count - 1; this.rb.contains(c); ) c--;
            ak(a, b, c);
          } else
            G &&
              v(
                "GraphLinksModel.getKeyForLinkData returned something other than a string or a number: " +
                  c
              );
        }
      }
    }
  };
  t.Dc = function (a) {
    return null === a ? !1 : this.cg.contains(a);
  };
  t.Ki = function (a) {
    null !== a && (nb(a), this.Dc(a) || hr(this, a, !0));
  };
  function hr(a, b, c) {
    if ("" !== a.linkKeyProperty) {
      var d = a.vc(b);
      if (void 0 !== d && a.rb.K(d) === b) return;
      a.Us(b);
      d = a.vc(b);
      void 0 === d &&
        v(
          "GraphLinksModel.makeLinkDataKeyUnique failed on " +
            b +
            ". Data not added to model."
        );
      a.rb.add(d, b);
    }
    a.cg.add(b);
    d = null;
    c && ((d = a.gd.length), a.gd.splice(d, 0, b));
    Dr(a, "linkDataArray", re, "linkDataArray", a, null, b, null, d);
    Nr(a, b);
  }
  t.jz = function (a) {
    if (Array.isArray(a))
      for (var b = a.length, c = 0; c < b; c++) this.Ki(a[c]);
    else for (a = a.iterator; a.next(); ) this.Ki(a.value);
  };
  t.ym = function (a) {
    null !== a && gr(this, a, !0);
  };
  function gr(a, b, c) {
    a.cg.remove(b);
    var d = a.vc(b);
    void 0 !== d && a.rb.remove(d);
    d = null;
    if (c) {
      d = a.gd.indexOf(b);
      if (0 > d) return;
      a.gd.splice(d, 1);
    }
    Dr(a, "linkDataArray", se, "linkDataArray", a, b, null, d, null);
    c = dr(a, b, !0);
    jr(a, c, b);
    c = dr(a, b, !1);
    jr(a, c, b);
    d = a.Jf(b);
    if (Array.isArray(d))
      for (var e = d.length, f = 0; f < e; f++) (c = d[f]), jr(a, c, b);
  }
  t.TA = function (a) {
    if (Array.isArray(a))
      for (var b = a.length, c = 0; c < b; c++) this.ym(a[c]);
    else for (a = a.iterator; a.next(); ) this.ym(a.value);
  };
  t.HA = function (a) {
    "" === this.linkKeyProperty &&
      v(
        "GraphLinksModel.linkKeyProperty must not be an empty string for .mergeLinkDataArray() to succeed."
      );
    if (a !== this.linkDataArray && Ha(a)) {
      var b = this.Ll;
      b.clear();
      b.addAll(this.rb.iteratorKeys);
      var c = this.Jl;
      c.clear();
      for (var d = a.length, e = 0; e < d; e++) {
        var f = a[e],
          g = this.vc(f);
        if (void 0 !== g) {
          c.add(g);
          var h = this.Ih(g);
          h !== f &&
            (null !== h
              ? (this.Vp(h, f), Lr(this, f, h))
              : ((f = this.cloneDeep(f)), this.ct(f, g), this.Ki(f)));
        } else (g = this.cloneDeep(f)), this.Ki(g), c.add(this.vc(g));
      }
      for (a = b.iterator; a.next(); )
        (d = a.value), c.contains(d) || ((d = this.Ih(d)) && this.ym(d));
      b.clear();
      c.clear();
    }
  };
  function Nr(a, b) {
    var c = dr(a, b, !0);
    c = a.sm(c);
    null === a.cc(c) && kr(a, c, b);
    c = dr(a, b, !1);
    c = a.sm(c);
    null === a.cc(c) && kr(a, c, b);
    var d = a.Jf(b);
    if (Array.isArray(d))
      for (var e = d.length, f = 0; f < e; f++)
        (c = d[f]), null === a.cc(c) && kr(a, c, b);
  }
  t.aq = function (a) {
    if (null === a) return null;
    var b = this.Zk;
    a = null !== b ? b(a, this) : Fr(this, a, !0);
    Ga(a) &&
      (ab(a),
      "" !== this.jf && ak(a, this.jf, void 0),
      "" !== this.kf && ak(a, this.kf, void 0),
      "" !== this.ee && ak(a, this.ee, []));
    return a;
  };
  t.Os = function (a) {
    if (null === a) return !1;
    var b = this.Kl;
    return "" === b ? !1 : Fn(a, b) ? !0 : !1;
  };
  t.Jh = function (a) {
    if (null !== a) {
      var b = this.He;
      if ("" !== b && ((b = Fn(a, b)), void 0 !== b)) {
        if (fr(b)) return b;
        v(
          "GroupKey value for node data " +
            a +
            " is not a number or a string: " +
            b
        );
      }
    }
  };
  t.Eq = function (a, b) {
    null === b && (b = void 0);
    void 0 === b ||
      fr(b) ||
      za(b, "number or string", Jr, "setGroupKeyForNodeData:key");
    if (null !== a) {
      var c = this.He;
      if ("" !== c)
        if (this.bb(a)) {
          var d = Fn(a, c);
          d !== b &&
            (jr(this, d, a),
            ak(a, c, b),
            null === this.cc(b) && kr(this, b, a),
            Dr(this, "nodeGroupKey", pe, c, a, d, b),
            "string" === typeof c && this.Ka(a, c));
        } else ak(a, c, b);
    }
  };
  Jr.prototype.copyNodeData = function (a) {
    if (null === a) return null;
    a = X.prototype.copyNodeData.call(this, a);
    this.jk ||
      "" === this.He ||
      void 0 === Fn(a, this.He) ||
      ak(a, this.He, void 0);
    return a;
  };
  Jr.prototype.setDataProperty = function (a, b, c) {
    G &&
      (A(a, "object", Jr, "setDataProperty:data"),
      A(b, "string", Jr, "setDataProperty:propname"),
      "" === b &&
        v(
          "GraphLinksModel.setDataProperty: property name must not be an empty string when setting " +
            a +
            " to " +
            c
        ));
    if (this.bb(a)) {
      if (b === this.nodeKeyProperty) {
        this.Hm(a, c);
        return;
      }
      if (b === this.nodeCategoryProperty) {
        this.Gm(a, c);
        return;
      }
      if (b === this.nodeGroupKeyProperty) {
        this.Eq(a, c);
        return;
      }
      G &&
        b === this.nodeIsGroupProperty &&
        v(
          "GraphLinksModel.setDataProperty: property name must not be the nodeIsGroupProperty: " +
            b
        );
    } else if (this.Dc(a)) {
      if (b === this.linkFromKeyProperty) {
        lr(this, a, c, !0);
        return;
      }
      if (b === this.linkToKeyProperty) {
        lr(this, a, c, !1);
        return;
      }
      if (b === this.linkFromPortIdProperty) {
        mr(this, a, c, !0);
        return;
      }
      if (b === this.linkToPortIdProperty) {
        mr(this, a, c, !1);
        return;
      }
      if (b === this.linkKeyProperty) {
        this.ct(a, c);
        return;
      }
      if (b === this.linkCategoryProperty) {
        this.Dq(a, c);
        return;
      }
      if (b === this.linkLabelKeysProperty) {
        this.dt(a, c);
        return;
      }
    }
    var d = Fn(a, b);
    d !== c && (ak(a, b, c), this.Zs(a, b, d, c));
  };
  t = Jr.prototype;
  t.Vp = function (a, b) {
    if (b) {
      var c = this.bb(a),
        d = this.Dc(a),
        e;
      for (e in b)
        "__gohashid" === e ||
          (c && e === this.nodeKeyProperty) ||
          (c && e === this.nodeIsGroupProperty && Fn(a, e) === b[e]) ||
          (d && e === this.linkKeyProperty) ||
          this.setDataProperty(a, e, b[e]);
    }
  };
  t.Bq = function (a, b) {
    X.prototype.Bq.call(this, a, b);
    for (var c = this.mb.iterator; c.next(); ) this.Sv(c.value, a, b);
    for (c = this.cg.iterator; c.next(); ) {
      var d = c.value,
        e = a,
        f = b;
      if (dr(this, d, !0) === e) {
        var g = this.jf;
        ak(d, g, f);
        Dr(this, "linkFromKey", pe, g, d, e, f);
        "string" === typeof g && this.Ka(d, g);
      }
      dr(this, d, !1) === e &&
        ((g = this.kf),
        ak(d, g, f),
        Dr(this, "linkToKey", pe, g, d, e, f),
        "string" === typeof g && this.Ka(d, g));
      g = this.Jf(d);
      if (Array.isArray(g))
        for (var h = g.length, k = this.ee, l = 0; l < h; l++)
          g[l] === e &&
            ((g[l] = f), Dr(this, "linkLabelKeys", re, k, d, e, f, l, l));
    }
  };
  t.Sv = function (a, b, c) {
    if (this.Jh(a) === b) {
      var d = this.He;
      ak(a, d, c);
      Dr(this, "nodeGroupKey", pe, d, a, b, c);
      "string" === typeof d && this.Ka(a, d);
    }
  };
  t.hw = function () {
    X.prototype.hw.call(this);
    for (var a = this.linkDataArray, b = a.length, c = 0; c < b; c++)
      Nr(this, a[c]);
  };
  t.Cm = function (a) {
    X.prototype.Cm.call(this, a);
    a = this.wa(a);
    var b = ir(this, a);
    if (null !== b) {
      var c = Ma();
      for (b = b.iterator; b.next(); ) {
        var d = b.value;
        if (this.bb(d)) {
          if (this.Jh(d) === a) {
            var e = this.He;
            Dr(this, "nodeGroupKey", pe, e, d, a, a);
            "string" === typeof e && this.Ka(d, e);
            c.push(d);
          }
        } else if (
          (dr(this, d, !0) === a &&
            ((e = this.jf),
            Dr(this, "linkFromKey", pe, e, d, a, a),
            "string" === typeof e && this.Ka(d, e),
            c.push(d)),
          dr(this, d, !1) === a &&
            ((e = this.kf),
            Dr(this, "linkToKey", pe, e, d, a, a),
            "string" === typeof e && this.Ka(d, e),
            c.push(d)),
          (e = this.Jf(d)),
          Array.isArray(e))
        )
          for (var f = e.length, g = this.ee, h = 0; h < f; h++)
            e[h] === a &&
              (Dr(this, "linkLabelKeys", re, g, d, a, a, h, h), c.push(d));
      }
      for (b = 0; b < c.length; b++) jr(this, a, c[b]);
      Pa(c);
    }
  };
  t.Bm = function (a) {
    X.prototype.Bm.call(this, a);
    var b = this.Jh(a);
    null === this.cc(b) && kr(this, b, a);
  };
  t.Iq = function (a) {
    X.prototype.Iq.call(this, a);
    var b = this.Jh(a);
    jr(this, b, a);
  };
  t.Gs = function (a) {
    if (null === a) return "";
    var b = this.Lj;
    if ("" === b) return "";
    b = Fn(a, b);
    if (void 0 === b) return "";
    if ("string" === typeof b) return b;
    v("getCategoryForLinkData found a non-string category for " + a + ": " + b);
  };
  Jr.prototype.getLinkCategoryForData = function (a) {
    return this.Gs(a);
  };
  Jr.prototype.Dq = function (a, b) {
    A(b, "string", Jr, "setCategoryForLinkData:cat");
    if (null !== a) {
      var c = this.Lj;
      if ("" !== c)
        if (this.Dc(a)) {
          var d = Fn(a, c);
          void 0 === d && (d = "");
          d !== b &&
            (ak(a, c, b),
            Dr(this, "linkCategory", pe, c, a, d, b),
            "string" === typeof c && this.Ka(a, c));
        } else ak(a, c, b);
    }
  };
  Jr.prototype.setLinkCategoryForData = function (a, b) {
    this.Dq(a, b);
  };
  t = Jr.prototype;
  t.Im = function (a, b) {
    X.prototype.Im.call(this, a, b);
    this.Eq(b, this.Jh(a));
  };
  function Lr(a, b, c) {
    a.Dq(c, a.Gs(b));
    a.Wv(c, a.$x(b));
    a.$v(c, a.ey(b));
    a.dt(c, a.Jf(b));
    a.Xv(c, a.ay(b));
    a.aw(c, a.gy(b));
  }
  t.vk = function () {
    return !0;
  };
  t.Zi = function () {
    return !0;
  };
  t.Qs = function () {
    return !0;
  };
  t.Xi = function () {
    return !0;
  };
  oa.Object.defineProperties(Jr.prototype, {
    archetypeNodeData: {
      configurable: !0,
      get: function () {
        return this.vj;
      },
      set: function (a) {
        var b = this.vj;
        b !== a &&
          (null !== a && A(a, "object", Jr, "archetypeNodeData"),
          (this.vj = a),
          this.g("archetypeNodeData", b, a));
      },
    },
    linkFromKeyProperty: {
      configurable: !0,
      get: function () {
        return this.jf;
      },
      set: function (a) {
        var b = this.jf;
        b !== a &&
          (Er(a, Jr, "linkFromKeyProperty"),
          (this.jf = a),
          this.g("linkFromKeyProperty", b, a));
      },
    },
    linkToKeyProperty: {
      configurable: !0,
      get: function () {
        return this.kf;
      },
      set: function (a) {
        var b = this.kf;
        b !== a &&
          (Er(a, Jr, "linkToKeyProperty"),
          (this.kf = a),
          this.g("linkToKeyProperty", b, a));
      },
    },
    linkFromPortIdProperty: {
      configurable: !0,
      get: function () {
        return this.Mj;
      },
      set: function (a) {
        var b = this.Mj;
        b !== a &&
          (Er(a, Jr, "linkFromPortIdProperty"),
          !G ||
            (a !== this.linkFromKeyProperty && a !== this.linkToKeyProperty) ||
            v(
              "linkFromPortIdProperty name must not be the same as the GraphLinksModel.linkFromKeyProperty or linkToKeyProperty: " +
                a
            ),
          (this.Mj = a),
          this.g("linkFromPortIdProperty", b, a));
      },
    },
    linkToPortIdProperty: {
      configurable: !0,
      get: function () {
        return this.Nj;
      },
      set: function (a) {
        var b = this.Nj;
        b !== a &&
          (Er(a, Jr, "linkToPortIdProperty"),
          !G ||
            (a !== this.linkFromKeyProperty && a !== this.linkToKeyProperty) ||
            v(
              "linkFromPortIdProperty name must not be the same as the GraphLinksModel.linkFromKeyProperty or linkToKeyProperty: " +
                a
            ),
          (this.Nj = a),
          this.g("linkToPortIdProperty", b, a));
      },
    },
    linkLabelKeysProperty: {
      configurable: !0,
      get: function () {
        return this.ee;
      },
      set: function (a) {
        var b = this.ee;
        b !== a &&
          (Er(a, Jr, "linkLabelKeysProperty"),
          (this.ee = a),
          this.g("linkLabelKeysProperty", b, a));
      },
    },
    linkDataArray: {
      configurable: !0,
      get: function () {
        return this.gd;
      },
      set: function (a) {
        var b = this.gd;
        if (b !== a) {
          Ia(a, Jr, "linkDataArray");
          this.rb.clear();
          for (var c = a.length, d = 0; d < c; d++) {
            var e = a[d];
            Ga(e) ||
              v(
                "GraphLinksModel.linkDataArray must only contain Objects, not: " +
                  e
              );
            nb(e);
          }
          this.gd = a;
          if ("" !== this.linkKeyProperty) {
            d = new H();
            for (e = 0; e < c; e++) {
              var f = a[e],
                g = this.vc(f);
              void 0 === g
                ? d.add(f)
                : null !== this.rb.K(g)
                ? d.add(f)
                : this.rb.add(g, f);
            }
            for (d = d.iterator; d.next(); )
              (e = d.value),
                this.Us(e),
                (f = this.vc(e)),
                void 0 !== f && this.rb.add(f, e);
          }
          d = new I();
          for (e = 0; e < c; e++) d.add(a[e]);
          this.cg = d;
          Dr(this, "linkDataArray", pe, "linkDataArray", this, b, a);
          for (b = 0; b < c; b++) Nr(this, a[b]);
        }
      },
    },
    linkKeyProperty: {
      configurable: !0,
      get: function () {
        return this.oi;
      },
      set: function (a) {
        var b = this.oi;
        if (b !== a) {
          Er(a, Jr, "linkKeyProperty");
          this.oi = a;
          this.rb.clear();
          for (var c = this.linkDataArray.length, d = 0; d < c; d++) {
            var e = this.linkDataArray[d],
              f = this.vc(e);
            void 0 === f && (this.Us(e), (f = this.vc(e)));
            void 0 !== f && this.rb.add(f, e);
          }
          this.g("linkKeyProperty", b, a);
        }
      },
    },
    makeUniqueLinkKeyFunction: {
      configurable: !0,
      get: function () {
        return this.El;
      },
      set: function (a) {
        var b = this.El;
        b !== a &&
          (null !== a && A(a, "function", Jr, "makeUniqueLinkKeyFunction"),
          (this.El = a),
          this.g("makeUniqueLinkKeyFunction", b, a));
      },
    },
    copyLinkDataFunction: {
      configurable: !0,
      get: function () {
        return this.Zk;
      },
      set: function (a) {
        var b = this.Zk;
        b !== a &&
          (null !== a && A(a, "function", Jr, "copyLinkDataFunction"),
          (this.Zk = a),
          this.g("copyLinkDataFunction", b, a));
      },
    },
    nodeIsGroupProperty: {
      configurable: !0,
      get: function () {
        return this.Kl;
      },
      set: function (a) {
        var b = this.Kl;
        b !== a &&
          (Er(a, Jr, "nodeIsGroupProperty"),
          (this.Kl = a),
          this.g("nodeIsGroupProperty", b, a));
      },
    },
    nodeGroupKeyProperty: {
      configurable: !0,
      get: function () {
        return this.He;
      },
      set: function (a) {
        var b = this.He;
        b !== a &&
          (Er(a, Jr, "nodeGroupKeyProperty"),
          (this.He = a),
          this.g("nodeGroupKeyProperty", b, a));
      },
    },
    jk: {
      configurable: !0,
      get: function () {
        return this.qn;
      },
      set: function (a) {
        this.qn !== a &&
          (A(a, "boolean", Jr, "copiesGroupKeyOfNodeData"), (this.qn = a));
      },
    },
    linkCategoryProperty: {
      configurable: !0,
      get: function () {
        return this.Lj;
      },
      set: function (a) {
        var b = this.Lj;
        b !== a &&
          (Er(a, Jr, "linkCategoryProperty"),
          (this.Lj = a),
          this.g("linkCategoryProperty", b, a));
      },
    },
    type: {
      configurable: !0,
      get: function () {
        return "GraphLinksModel";
      },
    },
  });
  Jr.prototype.setCategoryForLinkData = Jr.prototype.Dq;
  Jr.prototype.getCategoryForLinkData = Jr.prototype.Gs;
  Jr.prototype.assignAllDataProperties = Jr.prototype.Vp;
  Jr.prototype.setGroupKeyForNodeData = Jr.prototype.Eq;
  Jr.prototype.getGroupKeyForNodeData = Jr.prototype.Jh;
  Jr.prototype.isGroupForNodeData = Jr.prototype.Os;
  Jr.prototype.copyLinkData = Jr.prototype.aq;
  Jr.prototype.mergeLinkDataArray = Jr.prototype.HA;
  Jr.prototype.removeLinkDataCollection = Jr.prototype.TA;
  Jr.prototype.removeLinkData = Jr.prototype.ym;
  Jr.prototype.addLinkDataCollection = Jr.prototype.jz;
  Jr.prototype.addLinkData = Jr.prototype.Ki;
  Jr.prototype.containsLinkData = Jr.prototype.Dc;
  Jr.prototype.makeLinkDataKeyUnique = Jr.prototype.Us;
  Jr.prototype.findLinkDataForKey = Jr.prototype.Ih;
  Jr.prototype.setKeyForLinkData = Jr.prototype.ct;
  Jr.prototype.getKeyForLinkData = Jr.prototype.vc;
  Jr.prototype.removeLabelKeyForLinkData = Jr.prototype.yy;
  Jr.prototype.addLabelKeyForLinkData = Jr.prototype.$u;
  Jr.prototype.setLabelKeysForLinkData = Jr.prototype.dt;
  Jr.prototype.getLabelKeysForLinkData = Jr.prototype.Jf;
  Jr.prototype.setToPortIdForLinkData = Jr.prototype.aw;
  Jr.prototype.getToPortIdForLinkData = Jr.prototype.gy;
  Jr.prototype.setFromPortIdForLinkData = Jr.prototype.Xv;
  Jr.prototype.getFromPortIdForLinkData = Jr.prototype.ay;
  Jr.prototype.setToKeyForLinkData = Jr.prototype.$v;
  Jr.prototype.getToKeyForLinkData = Jr.prototype.ey;
  Jr.prototype.setFromKeyForLinkData = Jr.prototype.Wv;
  Jr.prototype.getFromKeyForLinkData = Jr.prototype.$x;
  Jr.prototype.clear = Jr.prototype.clear;
  var Mr = Object.freeze([]);
  Jr.className = "GraphLinksModel";
  Hr.GraphLinksModel = Jr;
  X.constructGraphLinksModel = X.constructGraphLinksModel = function () {
    return new Jr();
  };
  X.initDiagramModel = xi = function () {
    return new Jr();
  };
  function Or(a, b) {
    X.call(this);
    this.Ie = "parent";
    this.sn = !1;
    this.Tj = "parentLinkCategory";
    void 0 !== a && (Ha(a) ? (this.nodeDataArray = a) : Object.assign(this, a));
    b && Object.assign(this, b);
  }
  na(Or, X);
  Or.constructGraphLinksModel = X.constructGraphLinksModel;
  Or.prototype.cloneProtected = function (a) {
    X.prototype.cloneProtected.call(this, a);
    a.Ie = this.Ie;
    a.sn = this.sn;
    a.Tj = this.Tj;
  };
  t = Or.prototype;
  t.toString = function (a) {
    void 0 === a && (a = 0);
    if (2 <= a) return this.Fq();
    var b = ("" !== this.name ? this.name : "") + " TreeModel";
    if (0 < a) {
      b += "\n node data:";
      a = this.nodeDataArray;
      for (var c = a.length, d = 0; d < c; d++) {
        var e = a[d];
        b += " " + this.wa(e) + ":" + Ra(e);
      }
    }
    return b;
  };
  t.Pm = function () {
    var a = X.prototype.Pm.call(this),
      b = "";
    "parent" !== this.nodeParentKeyProperty &&
      "string" === typeof this.nodeParentKeyProperty &&
      (b +=
        ',\n  "nodeParentKeyProperty": ' +
        this.quote(this.nodeParentKeyProperty));
    return a + b;
  };
  t.xq = function (a) {
    X.prototype.xq.call(this, a);
    a.nodeParentKeyProperty &&
      (this.nodeParentKeyProperty = a.nodeParentKeyProperty);
  };
  t.wq = function (a) {
    void 0 !== a.nodeParentKeyProperty &&
      a.nodeParentKeyProperty !== this.nodeParentKeyProperty &&
      v("applyIncrementalJson cannot change Model properties");
    X.prototype.wq.call(this, a);
  };
  t.sm = function (a) {
    return a;
  };
  t.Kh = function (a) {
    if (null !== a) {
      var b = this.Ie;
      if ("" !== b && ((b = Fn(a, b)), void 0 !== b)) {
        if (fr(b)) return b;
        v(
          "ParentKey value for node data " +
            a +
            " is not a number or a string: " +
            b
        );
      }
    }
  };
  t.me = function (a, b) {
    null === b && (b = void 0);
    void 0 === b ||
      fr(b) ||
      za(b, "number or string", Or, "setParentKeyForNodeData:key");
    if (null !== a) {
      var c = this.Ie;
      if ("" !== c)
        if (((b = this.sm(b)), this.bb(a))) {
          var d = Fn(a, c);
          d !== b &&
            (jr(this, d, a),
            ak(a, c, b),
            null === this.cc(b) && kr(this, b, a),
            Dr(this, "nodeParentKey", pe, c, a, d, b),
            "string" === typeof c && this.Ka(a, c));
        } else ak(a, c, b);
    }
  };
  t.Js = function (a) {
    if (null === a) return "";
    var b = this.Tj;
    if ("" === b) return "";
    b = Fn(a, b);
    if (void 0 === b) return "";
    if ("string" === typeof b) return b;
    v(
      "getParentLinkCategoryForNodeData found a non-string category for " +
        a +
        ": " +
        b
    );
    return "";
  };
  Or.prototype.getLinkCategoryForData = function (a) {
    return this.Js(a);
  };
  Or.prototype.et = function (a, b) {
    A(b, "string", Or, "setParentLinkCategoryForNodeData:cat");
    if (null !== a) {
      var c = this.Tj;
      if ("" !== c)
        if (this.bb(a)) {
          var d = Fn(a, c);
          void 0 === d && (d = "");
          d !== b &&
            (ak(a, c, b),
            Dr(this, "parentLinkCategory", pe, c, a, d, b),
            "string" === typeof c && this.Ka(a, c));
        } else ak(a, c, b);
    }
  };
  Or.prototype.setLinkCategoryForData = function (a, b) {
    this.et(a, b);
  };
  Or.prototype.copyNodeData = function (a) {
    if (null === a) return null;
    a = X.prototype.copyNodeData.call(this, a);
    this.kk ||
      "" === this.Ie ||
      void 0 === Fn(a, this.Ie) ||
      ak(a, this.Ie, void 0);
    return a;
  };
  Or.prototype.setDataProperty = function (a, b, c) {
    G &&
      (A(a, "object", Or, "setDataProperty:data"),
      A(b, "string", Or, "setDataProperty:propname"),
      "" === b &&
        v(
          "TreeModel.setDataProperty: property name must not be an empty string when setting " +
            a +
            " to " +
            c
        ));
    if (this.bb(a)) {
      if (b === this.nodeKeyProperty) {
        this.Hm(a, c);
        return;
      }
      if (b === this.nodeCategoryProperty) {
        this.Gm(a, c);
        return;
      }
      if (b === this.nodeParentKeyProperty) {
        this.me(a, c);
        return;
      }
    }
    var d = Fn(a, b);
    d !== c && (ak(a, b, c), this.Zs(a, b, d, c));
  };
  t = Or.prototype;
  t.Bq = function (a, b) {
    X.prototype.Bq.call(this, a, b);
    for (var c = this.mb.iterator; c.next(); ) this.Sv(c.value, a, b);
  };
  t.Sv = function (a, b, c) {
    if (this.Kh(a) === b) {
      var d = this.Ie;
      ak(a, d, c);
      Dr(this, "nodeParentKey", pe, d, a, b, c);
      "string" === typeof d && this.Ka(a, d);
    }
  };
  t.Cm = function (a) {
    X.prototype.Cm.call(this, a);
    a = this.wa(a);
    var b = ir(this, a);
    if (null !== b) {
      var c = Ma();
      for (b = b.iterator; b.next(); ) {
        var d = b.value;
        if (this.bb(d) && this.Kh(d) === a) {
          var e = this.Ie;
          Dr(this, "nodeParentKey", pe, e, d, a, a);
          "string" === typeof e && this.Ka(d, e);
          c.push(d);
        }
      }
      for (b = 0; b < c.length; b++) jr(this, a, c[b]);
      Pa(c);
    }
  };
  t.Bm = function (a) {
    X.prototype.Bm.call(this, a);
    var b = this.Kh(a);
    b = this.sm(b);
    null === this.cc(b) && kr(this, b, a);
  };
  t.Iq = function (a) {
    X.prototype.Iq.call(this, a);
    var b = this.Kh(a);
    jr(this, b, a);
  };
  t.Im = function (a, b) {
    X.prototype.Im.call(this, a, b);
    this.et(b, this.Js(a));
    this.me(b, this.Kh(a));
  };
  t.qm = function () {
    return !0;
  };
  t.Qs = function () {
    return !0;
  };
  oa.Object.defineProperties(Or.prototype, {
    nodeParentKeyProperty: {
      configurable: !0,
      get: function () {
        return this.Ie;
      },
      set: function (a) {
        var b = this.Ie;
        b !== a &&
          (Er(a, Or, "nodeParentKeyProperty"),
          (this.Ie = a),
          this.g("nodeParentKeyProperty", b, a));
      },
    },
    kk: {
      configurable: !0,
      get: function () {
        return this.sn;
      },
      set: function (a) {
        this.sn !== a &&
          (A(a, "boolean", Or, "copiesParentKeyOfNodeData"), (this.sn = a));
      },
    },
    parentLinkCategoryProperty: {
      configurable: !0,
      get: function () {
        return this.Tj;
      },
      set: function (a) {
        var b = this.Tj;
        b !== a &&
          (Er(a, Or, "parentLinkCategoryProperty"),
          (this.Tj = a),
          this.g("parentLinkCategoryProperty", b, a));
      },
    },
    linkCategoryProperty: {
      configurable: !0,
      get: function () {
        return this.parentLinkCategoryProperty;
      },
      set: function (a) {
        this.parentLinkCategoryProperty = a;
      },
    },
    type: {
      configurable: !0,
      get: function () {
        return "TreeModel";
      },
    },
  });
  Or.prototype.setParentLinkCategoryForNodeData = Or.prototype.et;
  Or.prototype.getParentLinkCategoryForNodeData = Or.prototype.Js;
  Or.prototype.setParentKeyForNodeData = Or.prototype.me;
  Or.prototype.getParentKeyForNodeData = Or.prototype.Kh;
  Or.className = "TreeModel";
  Hr.TreeModel = Or;
  function Pr(a) {
    zi.call(this);
    this.Mw = this.Fn = this.hc = 0;
    this.gr = 360;
    this.Lw = Qr;
    this.zj = 0;
    this.zw = new K();
    this.Yq = this.ie = 0;
    this.ss = new Rr();
    this.At = this.Sj = 0;
    this.$y = 600;
    this.bp = NaN;
    this.en = 1;
    this.Dp = 0;
    this.Yl = 360;
    this.Pb = Qr;
    this.O = Sr;
    this.hd = Tr;
    this.ad = Hq;
    this.sf = 6;
    this.No = Ur;
    a && Object.assign(this, a);
  }
  na(Pr, zi);
  Pr.prototype.cloneProtected = function (a) {
    zi.prototype.cloneProtected.call(this, a);
    a.bp = this.bp;
    a.en = this.en;
    a.Dp = this.Dp;
    a.Yl = this.Yl;
    a.Pb = this.Pb;
    a.O = this.O;
    a.hd = this.hd;
    a.ad = this.ad;
    a.sf = this.sf;
    a.No = this.No;
  };
  Pr.prototype.pb = function (a) {
    if (a.classType === Pr)
      if (a === Vr || a === Wr || a === Xr || a === Yr || a === Tr)
        this.sorting = a;
      else if (a === Zr || a === $r || a === Sr || a === as) this.direction = a;
      else if (a === bs || a === cs || a === Qr || a === ds)
        this.arrangement = a;
      else {
        if (a === es || a === Ur) this.nodeDiameterFormula = a;
      }
    else zi.prototype.pb.call(this, a);
  };
  Pr.prototype.createNetwork = function () {
    return new fs(this);
  };
  Pr.prototype.doLayout = function (a) {
    G &&
      null === a &&
      v(
        "Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts"
      );
    null === this.network && (this.network = this.makeNetwork(a));
    this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin);
    a = this.network.vertexes;
    if (1 >= a.count)
      1 === a.count && ((a = a.first()), (a.centerX = 0), (a.centerY = 0));
    else {
      var b = new H();
      b.addAll(a.iterator);
      a = new H();
      var c = new H();
      var d = this.sort(b);
      var e,
        f,
        g = this.Yq;
      var h = this.arrangement;
      var k = this.nodeDiameterFormula;
      var l = this.radius;
      if (!isFinite(l) || 0 >= l) l = NaN;
      var m = this.aspectRatio;
      if (!isFinite(m) || 0 >= m) m = 1;
      var n = this.startAngle;
      isFinite(n) || (n = 0);
      var p = this.sweepAngle;
      if (!isFinite(p) || 360 < p || 1 > p) p = 360;
      b = this.spacing;
      isFinite(b) || (b = NaN);
      h === ds && k === es
        ? (h = Qr)
        : h === ds && k !== es && (h = this.arrangement);
      if (
        (this.direction === Zr || this.direction === $r) &&
        this.sorting !== Tr
      ) {
        for (k = 0; !(k >= d.length); k += 2) {
          a.add(d.N(k));
          if (k + 1 >= d.length) break;
          c.add(d.N(k + 1));
        }
        this.direction === Zr
          ? (this.arrangement === ds && a.reverse(),
            (d = new H()),
            d.addAll(a),
            d.addAll(c))
          : (this.arrangement === ds && c.reverse(),
            (d = new H()),
            d.addAll(c),
            d.addAll(a));
      }
      k = d.length;
      for (var r = (f = e = 0); r < d.length; r++) {
        var q = n + (p * f * (this.direction === Sr ? 1 : -1)) / k,
          u = d.N(r).diameter;
        isNaN(u) && (u = gs(d.N(r), q));
        360 > p && (0 === r || r === d.length - 1) && (u /= 2);
        e += u;
        f++;
      }
      if (isNaN(l) || h === ds) {
        isNaN(b) && (b = 6);
        if (h !== Qr && h !== ds) {
          f = -Infinity;
          for (g = 0; g < k; g++)
            (r = d.N(g)),
              (e = d.N(g === k - 1 ? 0 : g + 1)),
              isNaN(r.diameter) && gs(r, 0),
              isNaN(e.diameter) && gs(e, 0),
              (f = Math.max(f, (r.diameter + e.diameter) / 2));
          g = f + b;
          h === bs
            ? (l = (f + b) / ((2 * Math.PI) / k))
            : (l = hs(
                this,
                g * (360 <= p ? k : k - 1),
                m,
                (n * Math.PI) / 180,
                (p * Math.PI) / 180
              ));
        } else
          l = hs(
            this,
            e + (360 <= p ? k : k - 1) * (h !== ds ? b : 1.6 * b),
            m,
            (n * Math.PI) / 180,
            (p * Math.PI) / 180
          );
        f = l * m;
      } else if (
        ((f = l * m),
        (r = is(this, l, f, (n * Math.PI) / 180, (p * Math.PI) / 180)),
        isNaN(b))
      ) {
        if (h === Qr || h === ds) b = (r - e) / (360 <= p ? k : k - 1);
      } else if (h === Qr || h === ds)
        (r = (r - e) / (360 <= p ? k : k - 1)),
          r < b
            ? ((l = hs(
                this,
                e + b * (360 <= p ? k : k - 1),
                m,
                (n * Math.PI) / 180,
                (p * Math.PI) / 180
              )),
              (f = l * m))
            : (b = r);
      else {
        g = -Infinity;
        for (e = 0; e < k; e++)
          (q = d.N(e)),
            (u = d.N(e === k - 1 ? 0 : e + 1)),
            isNaN(q.diameter) && gs(q, 0),
            isNaN(u.diameter) && gs(u, 0),
            (g = Math.max(g, (q.diameter + u.diameter) / 2));
        g += b;
        e = hs(
          this,
          g * (360 <= p ? k : k - 1),
          m,
          (n * Math.PI) / 180,
          (p * Math.PI) / 180
        );
        e > l ? ((l = e), (f = l * m)) : (g = r / (360 <= p ? k : k - 1));
      }
      this.Lw = h;
      this.hc = l;
      this.Fn = m;
      this.Mw = n;
      this.gr = p;
      this.zj = b;
      this.ie = f;
      this.Yq = g;
      b = d;
      d = this.Lw;
      h = this.hc;
      l = this.Mw;
      m = this.gr;
      n = this.zj;
      p = this.ie;
      k = this.Yq;
      if ((this.direction !== Zr && this.direction !== $r) || d !== ds)
        if (this.direction === Zr || this.direction === $r) {
          g = 0;
          switch (d) {
            case cs:
              g = (180 * js(this, h, p, l, k)) / Math.PI;
              break;
            case Qr:
              k = b = 0;
              g = a.first();
              null !== g && (b = gs(g, Math.PI / 2));
              g = c.first();
              null !== g && (k = gs(g, Math.PI / 2));
              g = (180 * js(this, h, p, l, n + (b + k) / 2)) / Math.PI;
              break;
            case bs:
              g = m / b.length;
          }
          if (this.direction === Zr) {
            switch (d) {
              case cs:
                ks(this, a, l, as);
                break;
              case Qr:
                ls(this, a, l, as);
                break;
              case bs:
                ms(this, a, m / 2, l, as);
            }
            switch (d) {
              case cs:
                ks(this, c, l + g, Sr);
                break;
              case Qr:
                ls(this, c, l + g, Sr);
                break;
              case bs:
                ms(this, c, m / 2, l + g, Sr);
            }
          } else {
            switch (d) {
              case cs:
                ks(this, c, l, as);
                break;
              case Qr:
                ls(this, c, l, as);
                break;
              case bs:
                ms(this, c, m / 2, l, as);
            }
            switch (d) {
              case cs:
                ks(this, a, l + g, Sr);
                break;
              case Qr:
                ls(this, a, l + g, Sr);
                break;
              case bs:
                ms(this, a, m / 2, l + g, Sr);
            }
          }
        } else
          switch (d) {
            case cs:
              ks(this, b, l, this.direction);
              break;
            case Qr:
              ls(this, b, l, this.direction);
              break;
            case bs:
              ms(this, b, m, l, this.direction);
              break;
            case ds:
              ns(this, b, m, l, this.direction);
          }
      else ns(this, b, m, l - m / 2, Sr);
    }
    this.updateParts();
    this.network = null;
    this.isValidLayout = !0;
  };
  function ms(a, b, c, d, e) {
    var f = a.gr,
      g = a.hc;
    a = a.ie;
    d = (d * Math.PI) / 180;
    c = (c * Math.PI) / 180;
    for (var h = b.length, k = 0; k < h; k++) {
      var l = d + (e === Sr ? (k * c) / (360 <= f ? h : h - 1) : -(k * c) / h),
        m = b.N(k),
        n = (g * Math.tan(l)) / a;
      n = Math.sqrt((g * g + a * a * n * n) / (1 + n * n));
      m.centerX = n * Math.cos(l);
      m.centerY = n * Math.sin(l);
      m.actualAngle = (180 * l) / Math.PI;
    }
  }
  function ls(a, b, c, d) {
    var e = a.hc,
      f = a.ie,
      g = a.zj;
    c = (c * Math.PI) / 180;
    for (var h = b.length, k = 0; k < h; k++) {
      var l = b.N(k),
        m = b.N(k === h - 1 ? 0 : k + 1),
        n = f * Math.sin(c);
      l.centerX = e * Math.cos(c);
      l.centerY = n;
      l.actualAngle = (180 * c) / Math.PI;
      isNaN(l.diameter) && gs(l, 0);
      isNaN(m.diameter) && gs(m, 0);
      l = js(a, e, f, d === Sr ? c : -c, (l.diameter + m.diameter) / 2 + g);
      c += d === Sr ? l : -l;
    }
  }
  function ks(a, b, c, d) {
    var e = a.hc,
      f = a.ie,
      g = a.Yq;
    c = (c * Math.PI) / 180;
    for (var h = b.length, k = 0; k < h; k++) {
      var l = b.N(k);
      l.centerX = e * Math.cos(c);
      l.centerY = f * Math.sin(c);
      l.actualAngle = (180 * c) / Math.PI;
      l = js(a, e, f, d === Sr ? c : -c, g);
      c += d === Sr ? l : -l;
    }
  }
  function ns(a, b, c, d, e) {
    var f = a.gr;
    a.Sj = 0;
    a.ss = new Rr();
    if (360 > c) {
      for (f = d + (e === Sr ? f : -f); 0 > f; ) f += 360;
      f %= 360;
      180 < f && (f -= 360);
      f *= Math.PI / 180;
      a.At = f;
      os(a, b, c, d, e);
    } else ps(a, b, c, d, e);
    a.ss.commit(b);
  }
  function ps(a, b, c, d, e) {
    var f = a.hc,
      g = a.zj,
      h = a.Fn,
      k = f * Math.cos((d * Math.PI) / 180),
      l = a.ie * Math.sin((d * Math.PI) / 180),
      m = b.Ga();
    if (3 === m.length)
      (m[0].centerX = f),
        (m[0].centerY = 0),
        (m[1].centerX = m[0].centerX - m[0].width / 2 - m[1].width / 2 - g),
        (m[1].y = m[0].y),
        (m[2].centerX = (m[0].centerX + m[1].centerX) / 2),
        (m[2].y = m[0].y - m[2].height - g);
    else if (4 === m.length)
      (m[0].centerX = f),
        (m[0].centerY = 0),
        (m[2].centerX = -m[0].centerX),
        (m[2].centerY = m[0].centerY),
        (m[1].centerX = 0),
        (m[1].y = Math.min(m[0].y, m[2].y) - m[1].height - g),
        (m[3].centerX = 0),
        (m[3].y = Math.max(m[0].y + m[0].height + g, m[2].y + m[2].height + g));
    else {
      f = K.alloc();
      for (var n = 0; n < m.length; n++) {
        m[n].centerX = k;
        m[n].centerY = l;
        if (n >= m.length - 1) break;
        qs(a, k, l, m, n, e, f) || rs(a, k, l, m, n, e, f);
        k = f.x;
        l = f.y;
      }
      K.free(f);
      a.Sj++;
      if (!(23 < a.Sj)) {
        k = m[0].centerX;
        l = m[0].centerY;
        f = m[m.length - 1].centerX;
        n = m[m.length - 1].centerY;
        var p =
            Math.abs(k - f) - ((m[0].width + m[m.length - 1].width) / 2 + g),
          r =
            Math.abs(l - n) - ((m[0].height + m[m.length - 1].height) / 2 + g);
        g = 0;
        1 > Math.abs(r)
          ? Math.abs(k - f) < (m[0].width + m[m.length - 1].width) / 2 &&
            (g = 0)
          : (g = 0 < r ? r : 1 > Math.abs(p) ? 0 : p);
        k = Math.abs(f) > Math.abs(n) ? 0 < f !== l > n : 0 < n !== k < f;
        if ((k = e === Sr ? k : !k))
          (g = -Math.abs(g)),
            (g = Math.min(g, -m[m.length - 1].width)),
            (g = Math.min(g, -m[m.length - 1].height));
        a.ss.compare(g, m);
        1 < Math.abs(g) &&
          ((a.hc =
            8 > a.Sj
              ? a.hc - g / (2 * Math.PI)
              : 5 > m.length && 10 < g
              ? a.hc / 2
              : a.hc - (0 < g ? 1.7 : -2.3)),
          (a.ie = a.hc * h),
          ps(a, b, c, d, e));
      }
    }
  }
  function os(a, b, c, d, e) {
    for (
      var f = a.hc,
        g = a.ie,
        h = a.Fn,
        k = f * Math.cos((d * Math.PI) / 180),
        l = g * Math.sin((d * Math.PI) / 180),
        m = K.alloc(),
        n = b.Ga(),
        p = 0;
      p < n.length;
      p++
    ) {
      n[p].centerX = k;
      n[p].centerY = l;
      if (p >= n.length - 1) break;
      qs(a, k, l, n, p, e, m) || rs(a, k, l, n, p, e, m);
      k = m.x;
      l = m.y;
    }
    K.free(m);
    a.Sj++;
    if (!(23 < a.Sj)) {
      k = Math.atan2(l, k);
      k = e === Sr ? a.At - k : k - a.At;
      k = Math.abs(k) < Math.abs(k - 2 * Math.PI) ? k : k - 2 * Math.PI;
      f = (k * (f + g)) / 2;
      g = a.ss;
      if (Math.abs(f) < Math.abs(g.mm))
        for (g.mm = f, g.Kk = [], g.Rm = [], k = 0; k < n.length; k++)
          (g.Kk[k] = n[k].bounds.x), (g.Rm[k] = n[k].bounds.y);
      1 < Math.abs(f) &&
        ((a.hc =
          8 > a.Sj ? a.hc - f / (2 * Math.PI) : a.hc - (0 < f ? 1.7 : -2.3)),
        (a.ie = a.hc * h),
        os(a, b, c, d, e));
    }
  }
  function qs(a, b, c, d, e, f, g) {
    var h = a.hc,
      k = a.ie,
      l = 0;
    a = (d[e].width + d[e + 1].width) / 2 + a.zj;
    var m = !1;
    if (0 <= c !== (f === Sr)) {
      if (((f = b + a), f > h)) {
        f = b - a;
        if (f < -h) return (g.x = f), (g.y = l), !1;
        m = !0;
      }
    } else if (((f = b - a), f < -h)) {
      f = b + a;
      if (f > h) return (g.x = f), (g.y = l), !1;
      m = !0;
    }
    l = Math.sqrt(1 - Math.min(1, (f * f) / (h * h))) * k;
    0 > c !== m && (l = -l);
    if (Math.abs(c - l) > (d[e].height + d[e + 1].height) / 2)
      return (g.x = f), (g.y = l), !1;
    g.x = f;
    g.y = l;
    return !0;
  }
  function rs(a, b, c, d, e, f, g) {
    var h = a.hc,
      k = a.ie,
      l = 0;
    a = (d[e].height + d[e + 1].height) / 2 + a.zj;
    d = !1;
    if (0 <= b !== (f === Sr)) {
      if (((f = c - a), f < -k)) {
        f = c + a;
        if (f > k) {
          g.x = l;
          g.y = f;
          return;
        }
        d = !0;
      }
    } else if (((f = c + a), f > k)) {
      f = c - a;
      if (f < -k) {
        g.x = l;
        g.y = f;
        return;
      }
      d = !0;
    }
    l = Math.sqrt(1 - Math.min(1, (f * f) / (k * k))) * h;
    0 > b !== d && (l = -l);
    g.x = l;
    g.y = f;
  }
  Pr.prototype.commitLayout = function () {
    this.commitNodes();
    this.isRouting && this.commitLinks();
  };
  Pr.prototype.commitNodes = function () {
    var a =
        null !== this.group &&
        null !== this.group.placeholder &&
        this.group.isSubGraphExpanded,
      b = a ? this.group.location.copy() : null,
      c = this.actualCenter;
    a
      ? (c = new K(0, 0))
      : ((c.x = this.arrangementOrigin.x + this.hc),
        (c.y = this.arrangementOrigin.y + this.ie));
    for (var d = this.network.vertexes.iterator; d.next(); ) {
      var e = d.value;
      e.x += c.x;
      e.y += c.y;
      e.commit();
    }
    a &&
      (this.group.Za(),
      (a = this.group.position.copy()),
      (c = this.group.location.copy()),
      (b = b.ne(c.ne(a))),
      this.group.move(b),
      (this.zw = b.ne(a)));
  };
  Pr.prototype.commitLinks = function () {
    for (var a = this.network.edges.iterator; a.next(); ) a.value.commit();
  };
  function is(a, b, c, d, e) {
    var f = a.$y;
    if (0.001 > Math.abs(a.Fn - 1))
      return void 0 !== d && void 0 !== e ? e * b : 2 * Math.PI * b;
    a = b > c ? Math.sqrt(b * b - c * c) / b : Math.sqrt(c * c - b * b) / c;
    var g = 0;
    var h =
      void 0 !== d && void 0 !== e ? e / (f + 1) : Math.PI / (2 * (f + 1));
    for (var k = 0, l = 0; l <= f; l++) {
      void 0 !== d && void 0 !== e
        ? (k = d + (l * e) / f)
        : (k = (l * Math.PI) / (2 * f));
      var m = Math.sin(k);
      g += Math.sqrt(1 - a * a * m * m) * h;
    }
    return void 0 !== d && void 0 !== e
      ? (b > c ? b : c) * g
      : 4 * (b > c ? b : c) * g;
  }
  function hs(a, b, c, d, e) {
    return b / (void 0 !== d && void 0 !== e ? is(a, 1, c, d, e) : is(a, 1, c));
  }
  function js(a, b, c, d, e) {
    if (0.001 > Math.abs(a.Fn - 1)) return e / b;
    var f = b > c ? Math.sqrt(b * b - c * c) / b : Math.sqrt(c * c - b * b) / c,
      g = 0;
    a = (2 * Math.PI) / (700 * a.network.vertexes.count);
    b > c && (d += Math.PI / 2);
    for (var h = 0; ; h++) {
      var k = Math.sin(d + h * a);
      g += (b > c ? b : c) * Math.sqrt(1 - f * f * k * k) * a;
      if (g >= e) return h * a;
    }
  }
  Pr.prototype.sort = function (a) {
    switch (this.sorting) {
      case Xr:
        break;
      case Yr:
        a.reverse();
        break;
      case Vr:
        a.sort(this.comparer);
        break;
      case Wr:
        a.sort(this.comparer);
        a.reverse();
        break;
      case Tr:
        return this.Ck(ss(a));
      default:
        v("Invalid sorting type.");
    }
    return a;
  };
  function ss(a) {
    for (var b = [], c = 0; c < a.length; c++) b.push(0);
    c = new H();
    for (var d = 0; d < a.length; d++) {
      var e = -1,
        f = -1;
      if (0 === d)
        for (var g = 0; g < a.length; g++) {
          var h = a.N(g).edgesCount;
          h > e && ((e = h), (f = g));
        }
      else
        for (g = 0; g < a.length; g++) (h = b[g]), h > e && ((e = h), (f = g));
      c.add(a.N(f));
      b[f] = -1;
      f = a.N(f);
      for (g = f.sourceEdges; g.next(); )
        (e = a.indexOf(g.value.fromVertex)), 0 > e || (0 <= b[e] && b[e]++);
      for (f = f.destinationEdges; f.next(); )
        (e = a.indexOf(f.value.toVertex)), 0 > e || (0 <= b[e] && b[e]++);
    }
    return c;
  }
  Pr.prototype.Ck = function (a) {
    for (var b = [], c = 0; c < a.length; c++) {
      var d = a.N(c);
      b[c] = [];
      for (var e, f = d.destinationEdges; f.next(); )
        (e = a.indexOf(f.value.toVertex)),
          e !== c && 0 > b[c].indexOf(e) && b[c].push(e);
      for (d = d.sourceEdges; d.next(); )
        (e = a.indexOf(d.value.fromVertex)),
          e !== c && 0 > b[c].indexOf(e) && b[c].push(e);
    }
    f = [];
    for (c = 0; c < b.length; c++) f[c] = 0;
    c = [];
    var g = [],
      h = [];
    d = [];
    e = new H();
    for (var k = 0, l = 0; l < b.length; l++) {
      var m = b[l].length;
      if (1 === m) d.push(l);
      else if (0 === m) e.add(a.N(l));
      else {
        if (0 === k) c.push(l);
        else {
          for (var n = (m = Infinity), p = -1, r = [], q = 0; q < c.length; q++)
            0 > b[c[q]].indexOf(c[q === c.length - 1 ? 0 : q + 1]) &&
              r.push(q === c.length - 1 ? 0 : q + 1);
          if (0 === r.length) for (q = 0; q < c.length; q++) r.push(q);
          for (q = 0; q < r.length; q++) {
            for (var u = r[q], w = b[l], y = 0, z = 0; z < g.length; z++) {
              var B = f[g[z]],
                C = f[h[z]];
              if (B < C) {
                var E = B;
                B = C;
              } else E = C;
              if (E < u && u <= B)
                for (C = 0; C < w.length; C++) {
                  var J = w[C];
                  0 > c.indexOf(J) ||
                    (E < f[J] && f[J] < B) ||
                    E === f[J] ||
                    B === f[J] ||
                    y++;
                }
              else
                for (C = 0; C < w.length; C++)
                  (J = w[C]),
                    0 > c.indexOf(J) ||
                      (E < f[J] && f[J] < B && E !== f[J] && B !== f[J] && y++);
            }
            w = y;
            for (z = y = 0; z < b[l].length; z++)
              (E = c.indexOf(b[l][z])),
                0 <= E &&
                  ((E = Math.abs(u - (E >= u ? E + 1 : E))),
                  (y += E < c.length + 1 - E ? E : c.length + 1 - E));
            for (z = 0; z < g.length; z++)
              (E = f[g[z]]),
                (B = f[h[z]]),
                E >= u && E++,
                B >= u && B++,
                E > B && ((C = B), (B = E), (E = C)),
                B - E < (c.length + 2) / 2 === (E < u && u <= B) && y++;
            if (w < m || (w === m && y < n)) (m = w), (n = y), (p = u);
          }
          c.splice(p, 0, l);
          for (m = 0; m < c.length; m++) f[c[m]] = m;
          for (m = 0; m < b[l].length; m++)
            (n = b[l][m]), 0 <= c.indexOf(n) && (g.push(l), h.push(n));
        }
        k++;
      }
    }
    for (g = c.length; ; ) {
      f = !0;
      for (h = 0; h < d.length; h++)
        if (((k = d[h]), (l = b[k][0]), (m = c.indexOf(l)), 0 <= m)) {
          for (p = n = 0; p < b[l].length; p++)
            (r = c.indexOf(b[l][p])),
              0 > r ||
                r === m ||
                ((q = r > m ? r - m : m - r),
                (n += r < m !== q > g - q ? 1 : -1));
          c.splice(0 > n ? m : m + 1, 0, k);
          d.splice(h, 1);
          h--;
        } else f = !1;
      if (f) break;
      else c.push(d[0]), d.splice(0, 1);
    }
    for (b = 0; b < c.length; b++) e.add(a.N(c[b]));
    return e;
  };
  oa.Object.defineProperties(Pr.prototype, {
    radius: {
      configurable: !0,
      get: function () {
        return this.bp;
      },
      set: function (a) {
        this.bp !== a &&
          (A(a, "number", Pr, "radius"), 0 < a || isNaN(a)) &&
          ((this.bp = a), this.F());
      },
    },
    aspectRatio: {
      configurable: !0,
      get: function () {
        return this.en;
      },
      set: function (a) {
        this.en !== a &&
          (A(a, "number", Pr, "aspectRatio"),
          0 < a && ((this.en = a), this.F()));
      },
    },
    startAngle: {
      configurable: !0,
      get: function () {
        return this.Dp;
      },
      set: function (a) {
        this.Dp !== a &&
          (A(a, "number", Pr, "startAngle"), (this.Dp = a), this.F());
      },
    },
    sweepAngle: {
      configurable: !0,
      get: function () {
        return this.Yl;
      },
      set: function (a) {
        this.Yl !== a &&
          (A(a, "number", Pr, "sweepAngle"),
          0 < a && 360 >= a ? (this.Yl = a) : (this.Yl = 360),
          this.F());
      },
    },
    arrangement: {
      configurable: !0,
      get: function () {
        return this.Pb;
      },
      set: function (a) {
        this.Pb !== a &&
          (cb(a, Pr, Pr, "arrangement"),
          a === ds || a === Qr || a === cs || a === bs) &&
          ((this.Pb = a), this.F());
      },
    },
    direction: {
      configurable: !0,
      get: function () {
        return this.O;
      },
      set: function (a) {
        this.O !== a &&
          (cb(a, Pr, Pr, "direction"),
          a === Sr || a === as || a === Zr || a === $r) &&
          ((this.O = a), this.F());
      },
    },
    sorting: {
      configurable: !0,
      get: function () {
        return this.hd;
      },
      set: function (a) {
        this.hd !== a &&
          (cb(a, Pr, Pr, "sorting"),
          a === Xr || a === Yr || a === Vr || Wr || a === Tr) &&
          ((this.hd = a), this.F());
      },
    },
    comparer: {
      configurable: !0,
      get: function () {
        return this.ad;
      },
      set: function (a) {
        this.ad !== a &&
          (A(a, "function", Pr, "comparer"), (this.ad = a), this.F());
      },
    },
    spacing: {
      configurable: !0,
      get: function () {
        return this.sf;
      },
      set: function (a) {
        this.sf !== a &&
          (A(a, "number", Pr, "spacing"), (this.sf = a), this.F());
      },
    },
    nodeDiameterFormula: {
      configurable: !0,
      get: function () {
        return this.No;
      },
      set: function (a) {
        this.No !== a &&
          (cb(a, Pr, Pr, "nodeDiameterFormula"), a === Ur || a === es) &&
          ((this.No = a), this.F());
      },
    },
    actualXRadius: {
      configurable: !0,
      get: function () {
        return this.hc;
      },
    },
    actualYRadius: {
      configurable: !0,
      get: function () {
        return this.ie;
      },
    },
    actualSpacing: {
      configurable: !0,
      get: function () {
        return this.zj;
      },
    },
    actualCenter: {
      configurable: !0,
      get: function () {
        return this.zw;
      },
    },
  });
  var Qr = new F(Pr, "ConstantSpacing", 0),
    cs = new F(Pr, "ConstantDistance", 1),
    bs = new F(Pr, "ConstantAngle", 2),
    ds = new F(Pr, "Packed", 3),
    Sr = new F(Pr, "Clockwise", 4),
    as = new F(Pr, "Counterclockwise", 5),
    Zr = new F(Pr, "BidirectionalLeft", 6),
    $r = new F(Pr, "BidirectionalRight", 7),
    Xr = new F(Pr, "Forwards", 8),
    Yr = new F(Pr, "Reverse", 9),
    Vr = new F(Pr, "Ascending", 10),
    Wr = new F(Pr, "Descending", 11),
    Tr = new F(Pr, "Optimized", 12),
    Ur = new F(Pr, "Pythagorean", 13),
    es = new F(Pr, "Circular", 14);
  Pr.className = "CircularLayout";
  Pr.ConstantSpacing = Qr;
  Pr.ConstantDistance = cs;
  Pr.ConstantAngle = bs;
  Pr.Packed = ds;
  Pr.Clockwise = Sr;
  Pr.Counterclockwise = as;
  Pr.BidirectionalLeft = Zr;
  Pr.BidirectionalRight = $r;
  Pr.Forwards = Xr;
  Pr.Reverse = Yr;
  Pr.Ascending = Vr;
  Pr.Descending = Wr;
  Pr.Optimized = Tr;
  Pr.Pythagorean = Ur;
  Pr.Circular = es;
  function Rr() {
    this.mm = -Infinity;
    this.Rm = this.Kk = null;
  }
  Rr.prototype.compare = function (a, b) {
    if (
      (0 < a && 0 > this.mm) ||
      (Math.abs(a) < Math.abs(this.mm) && !(0 > a && 0 < this.mm))
    )
      for (this.mm = a, this.Kk = [], this.Rm = [], a = 0; a < b.length; a++)
        (this.Kk[a] = b[a].bounds.x), (this.Rm[a] = b[a].bounds.y);
  };
  Rr.prototype.commit = function (a) {
    if (null !== this.Kk && null !== this.Rm)
      for (var b = 0; b < this.Kk.length; b++) {
        var c = a.N(b);
        c.x = this.Kk[b];
        c.y = this.Rm[b];
      }
  };
  Rr.className = "VertexArrangement";
  function fs(a) {
    mq.call(this, a);
  }
  na(fs, mq);
  fs.prototype.createVertex = function () {
    return new ts(this);
  };
  fs.prototype.createEdge = function () {
    return new us(this);
  };
  fs.className = "CircularNetwork";
  function ts(a) {
    Aq.call(this, a);
    this.B = this.yj = NaN;
  }
  na(ts, Aq);
  function gs(a, b) {
    var c = a.network;
    if (null === c) return NaN;
    c = c.layout;
    if (null === c) return NaN;
    if (c.arrangement === ds)
      if (c.nodeDiameterFormula === es) a.yj = Math.max(a.width, a.height);
      else {
        c = Math.abs(Math.sin(b));
        b = Math.abs(Math.cos(b));
        if (0 === c) return a.width;
        if (0 === b) return a.height;
        a.yj = Math.min(a.height / c, a.width / b);
      }
    else
      a.yj =
        c.nodeDiameterFormula === es
          ? Math.max(a.width, a.height)
          : Math.sqrt(a.width * a.width + a.height * a.height);
    return a.yj;
  }
  oa.Object.defineProperties(ts.prototype, {
    diameter: {
      configurable: !0,
      get: function () {
        return this.yj;
      },
      set: function (a) {
        this.yj !== a && (A(a, "number", ts, "diameter"), (this.yj = a));
      },
    },
    actualAngle: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        this.B !== a && (A(a, "number", ts, "actualAngle"), (this.B = a));
      },
    },
  });
  ts.className = "CircularVertex";
  function us(a) {
    Bq.call(this, a);
  }
  na(us, Bq);
  us.className = "CircularEdge";
  function vs(a) {
    zi.call(this);
    this.Bh = null;
    this.oo = 0;
    this.Wd = new Gb(100, 100).freeze();
    this.dn = !1;
    this.rf = !0;
    this.rd = !1;
    this.Fl = 100;
    this.Hn = 1;
    this.ag = 1e3;
    this.Io = 10;
    this.cp = Math;
    this.fl = 0.05;
    this.el = 50;
    this.cl = 150;
    this.dl = 0;
    this.An = 10;
    this.zn = 5;
    a && Object.assign(this, a);
  }
  na(vs, zi);
  vs.prototype.cloneProtected = function (a) {
    zi.prototype.cloneProtected.call(this, a);
    a.Wd.assign(this.Wd);
    a.dn = this.dn;
    a.rf = this.rf;
    a.rd = this.rd;
    a.Fl = this.Fl;
    a.Hn = this.Hn;
    a.ag = this.ag;
    a.Io = this.Io;
    a.cp = this.cp;
    a.fl = this.fl;
    a.el = this.el;
    a.cl = this.cl;
    a.dl = this.dl;
    a.An = this.An;
    a.zn = this.zn;
  };
  vs.prototype.serializeLayoutProperties = function (a, b) {
    zi.prototype.serializeLayoutProperties.call(this, a, b);
    a.arrangementSpacing = {
      width: this.arrangementSpacing.width,
      height: this.arrangementSpacing.height,
    };
    a.arrangesToOrigin = this.arrangesToOrigin;
    a.setsPortSpots = this.setsPortSpots;
    a.comments = this.comments;
    a.maxIterations = this.maxIterations;
    a.epsilonDistance = this.epsilonDistance;
    a.infinityDistance = this.infinityDistance;
    a.moveLimit = this.moveLimit;
    a.defaultSpringStiffness = this.defaultSpringStiffness;
    a.defaultSpringLength = this.defaultSpringLength;
    a.defaultElectricalCharge = this.defaultElectricalCharge;
    a.defaultGravitationalMass = this.defaultGravitationalMass;
    a.defaultCommentSpringLength = this.defaultCommentSpringLength;
    a.defaultCommentElectricalCharge = this.defaultCommentElectricalCharge;
  };
  vs.prototype.deserializeLayoutProperties = function (a, b, c, d, e) {
    zi.prototype.deserializeLayoutProperties.call(this, a, b, c, d, e);
    this.arrangementSpacing = new Gb(
      a.arrangementSpacing.width,
      a.arrangementSpacing.height
    );
    this.arrangesToOrigin = a.arrangesToOrigin;
    this.setsPortSpots = a.setsPortSpots;
    this.comments = a.comments;
    this.maxIterations = a.maxIterations;
    this.epsilonDistance = a.epsilonDistance;
    this.infinityDistance = a.infinityDistance;
    this.moveLimit = a.moveLimit;
    this.defaultSpringStiffness = a.defaultSpringStiffness;
    this.defaultSpringLength = a.defaultSpringLength;
    this.defaultElectricalCharge = a.defaultElectricalCharge;
    this.defaultGravitationalMass = a.defaultGravitationalMass;
    this.defaultCommentSpringLength = a.defaultCommentSpringLength;
    this.defaultCommentElectricalCharge = a.defaultCommentElectricalCharge;
  };
  vs.prototype.createNetwork = function () {
    return new ws(this);
  };
  vs.prototype.doLayout = function (a) {
    G &&
      null === a &&
      v(
        "Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts"
      );
    null === this.network && (this.network = this.makeNetwork(a));
    if (!this.jw()) {
      a = this.maxIterations;
      if (0 < this.network.vertexes.count) {
        this.network.bq();
        for (var b = this.network.vertexes.iterator; b.next(); ) {
          var c = b.value;
          c.charge = this.electricalCharge(c);
          c.mass = this.gravitationalMass(c);
        }
        for (b = this.network.edges.iterator; b.next(); )
          (c = b.value),
            (c.stiffness = this.springStiffness(c)),
            (c.length = this.springLength(c));
        this.bv();
        this.oo = 0;
        if (this.needsClusterLayout()) {
          b = this.network;
          c = b.Iy();
          for (var d = c.iterator; d.next(); ) {
            this.network = d.value;
            for (var e = this.network.vertexes.iterator; e.next(); ) {
              var f = e.value;
              f.Qd = f.vertexes.count;
              f.Ph = 1;
              f.ik = null;
              f.We = null;
            }
            xs(this, 0, a);
          }
          this.network = b;
          var g = (d = c.iterator);
          G && x(b, ws, vs, "arrangeConnectedGraphs:singletons");
          d = this.arrangementSpacing;
          var h = g.count,
            k = !0;
          f = e = 0;
          for (var l = Ma(), m = 0; m < h + b.vertexes.count + 2; m++)
            l[m] = null;
          h = 0;
          g.reset();
          for (var n = M.alloc(); g.next(); )
            if (((m = g.value), this.computeBounds(m, n), k))
              (k = !1),
                (e = n.x + n.width / 2),
                (f = n.y + n.height / 2),
                (l[0] = new K(n.x + n.width + d.width, n.y)),
                (l[1] = new K(n.x, n.y + n.height + d.height)),
                (h = 2);
            else {
              var p = ys(l, h, e, f, n.width, n.height, d),
                r = l[p],
                q = new K(r.x + n.width + d.width, r.y),
                u = new K(r.x, r.y + n.height + d.height);
              p + 1 < h && l.splice(p + 1, 0, null);
              l[p] = q;
              l[p + 1] = u;
              h++;
              p = r.x - n.x;
              r = r.y - n.y;
              for (m = m.vertexes.iterator; m.next(); )
                (q = m.value), (q.centerX += p), (q.centerY += r);
            }
          M.free(n);
          for (m = b.vertexes.iterator; m.next(); )
            (g = m.value),
              (p = g.bounds),
              2 > h
                ? ((e = p.x + p.width / 2),
                  (f = p.y + p.height / 2),
                  (l[0] = new K(p.x + p.width + d.width, p.y)),
                  (l[1] = new K(p.x, p.y + p.height + d.height)),
                  (h = 2))
                : ((k = ys(l, h, e, f, p.width, p.height, d)),
                  (n = l[k]),
                  (r = new K(n.x + p.width + d.width, n.y)),
                  (p = new K(n.x, n.y + p.height + d.height)),
                  k + 1 < h && l.splice(k + 1, 0, null),
                  (l[k] = r),
                  (l[k + 1] = p),
                  h++,
                  (g.centerX = n.x + g.width / 2),
                  (g.centerY = n.y + g.height / 2));
          Pa(l);
          for (d = c.iterator; d.next(); ) {
            c = d.value;
            for (e = c.vertexes.iterator; e.next(); ) b.tg(e.value);
            for (c = c.edges.iterator; c.next(); ) b.cm(c.value);
          }
        }
        zs(this, a);
        this.updateParts();
      }
      this.Fl = a;
      this.network = null;
      this.isValidLayout = !0;
    }
  };
  vs.prototype.needsClusterLayout = function () {
    if (3 > this.network.vertexes.count) return !1;
    for (
      var a = 0,
        b = 0,
        c = this.network.vertexes.first().bounds,
        d = this.network.vertexes.iterator;
      d.next();

    ) {
      if (d.value.bounds.Sc(c) && (a++, 2 < a)) return !0;
      if (10 < b) break;
      b++;
    }
    return !1;
  };
  vs.prototype.computeBounds = function (a, b) {
    var c = !0;
    for (a = a.vertexes.iterator; a.next(); ) {
      var d = a.value;
      c ? ((c = !1), b.set(d.bounds)) : b.Xc(d.bounds);
    }
    return b;
  };
  function As(a, b, c) {
    G &&
      (D(b, vs, "computeClusterLayoutIterations:level"),
      D(c, vs, "computeClusterLayoutIterations:maxiter"));
    return Math.max(Math.min(a.network.vertexes.count, (c * (b + 1)) / 11), 10);
  }
  function xs(a, b, c) {
    G && (D(b, vs, "layoutClusters:level"), D(c, vs, "layoutClusters:maxiter"));
    if (Bs(a, b)) {
      var d = a.ag;
      a.ag *= 1 + 1 / (b + 1);
      var e = Cs(a, b),
        f = Math.max(0, As(a, b, c));
      a.maxIterations += f;
      xs(a, b + 1, c);
      zs(a, f);
      Ds(a, e, b);
      c = e.vertexes.Ga();
      c.sort(function (a, b) {
        return null === a || null === b || a === b ? 0 : b.Qd - a.Qd;
      });
      for (e = 0; e < c.length; e++) Es(a, c[e], b);
      a.ag = d;
    }
  }
  function Bs(a, b) {
    G && D(b, vs, "hasClusters:level");
    if (10 < b || 3 > a.network.vertexes.count) return !1;
    a.Bh = a.network.vertexes.Ga();
    a = a.Bh;
    a.sort(function (a, b) {
      return null === a || null === b || a === b ? 0 : b.Qd - a.Qd;
    });
    for (b = a.length - 1; 0 <= b && 1 >= a[b].Qd; ) b--;
    return 1 < a.length - b;
  }
  function Cs(a, b) {
    G && D(b, vs, "pushSubNetwork:level");
    for (var c = a.network, d = new ws(a), e = 0; e < a.Bh.length; e++) {
      var f = a.Bh[e];
      if (1 < f.Qd) {
        d.tg(f);
        var g = new Fs();
        g.lt = f.Qd;
        g.mt = f.width;
        g.kt = f.height;
        g.pw = f.focus.x;
        g.qw = f.focus.y;
        null === f.We && (f.We = new H());
        f.We.add(g);
        f.Uv = f.We.count - 1;
      } else break;
    }
    for (f = c.edges.iterator; f.next(); ) {
      var h = f.value;
      e = h.fromVertex;
      g = h.toVertex;
      e.network === d && g.network === d
        ? d.cm(h)
        : e.network === d
        ? ((h = e.ik),
          null === h && ((h = new H()), (e.ik = h)),
          h.add(g),
          e.Qd--,
          (e.Ph += g.Ph))
        : g.network === d &&
          ((h = g.ik),
          null === h && ((h = new H()), (g.ik = h)),
          h.add(e),
          g.Qd--,
          (g.Ph += e.Ph));
    }
    for (e = d.edges.iterator; e.next(); )
      (f = e.value),
        (f.length *= Math.max(
          1,
          L.sqrt((f.fromVertex.Ph + f.toVertex.Ph) / (4 * b + 1))
        ));
    for (b = d.vertexes.iterator; b.next(); ) {
      e = b.value;
      var k = e.ik;
      if (
        null !== k &&
        0 < k.count &&
        ((g = e.We.N(e.We.count - 1).lt - e.Qd), !(0 >= g))
      ) {
        for (var l = (h = 0), m = k.count - g; m < k.count; m++) {
          var n = k.N(m),
            p = null;
          for (f = n.edges.iterator; f.next(); ) {
            var r = f.value;
            if (r.by(n) === e) {
              p = r;
              break;
            }
          }
          null !== p && ((l += p.length), (h += n.width * n.height));
        }
        f = e.centerX;
        k = e.centerY;
        m = e.width;
        n = e.height;
        p = e.focus;
        r = m * n;
        1 > r && (r = 1);
        h = L.sqrt((h + r + (l * l * 4) / (g * g)) / r);
        g = ((h - 1) * m) / 2;
        h = ((h - 1) * n) / 2;
        e.bounds = new M(f - p.x - g, k - p.y - h, m + 2 * g, n + 2 * h);
        e.focus = new K(p.x + g, p.y + h);
      }
    }
    a.network = d;
    return c;
  }
  function Ds(a, b, c) {
    G && (x(b, ws, vs, "popNetwork:oldnet"), D(c, vs, "popNetwork:level"));
    for (c = a.network.vertexes.iterator; c.next(); ) {
      var d = c.value;
      d.network = b;
      if (null !== d.We) {
        var e = d.We.N(d.Uv);
        d.Qd = e.lt;
        var f = e.pw,
          g = e.qw;
        d.bounds = new M(d.centerX - f, d.centerY - g, e.mt, e.kt);
        d.focus = new K(f, g);
        d.Uv--;
      }
    }
    for (c = a.network.edges.iterator; c.next(); ) c.value.network = b;
    a.network = b;
  }
  function Es(a, b, c) {
    G && (x(b, Gs, vs, "surroundNode:oldnet"), D(c, vs, "surroundNode:level"));
    var d = b.ik;
    if (null !== d && 0 !== d.count) {
      c = b.centerX;
      var e = b.centerY,
        f = b.width,
        g = b.height;
      null !== b.We &&
        0 < b.We.count &&
        ((g = b.We.N(0)), (f = g.mt), (g = g.kt));
      f = L.sqrt(f * f + g * g) / 2;
      for (
        var h = !1, k = (g = 0), l = 0, m = b.vertexes.iterator;
        m.next();

      ) {
        var n = m.value;
        1 >= n.Qd
          ? k++
          : ((h = !0),
            l++,
            (g += Math.atan2(b.centerY - n.centerY, b.centerX - n.centerX)));
      }
      if (0 !== k)
        for (
          0 < l && (g /= l),
            l = b = 0,
            b = h ? (2 * Math.PI) / (k + 1) : (2 * Math.PI) / k,
            0 === k % 2 && (l = b / 2),
            1 < d.count &&
              d.sort(function (a, b) {
                return null === a || null === b || a === b
                  ? 0
                  : b.width * b.height - a.width * a.height;
              }),
            h = 0 === k % 2 ? 0 : 1,
            d = d.iterator;
          d.next();

        )
          if (((k = d.value), !(1 < k.Qd || a.isFixed(k)))) {
            m = null;
            for (n = k.edges.iterator; n.next(); ) {
              m = n.value;
              break;
            }
            n = k.width;
            var p = k.height;
            n = L.sqrt(n * n + p * p) / 2;
            m = f + m.length + n;
            n = g + (b * ((h / 2) >> 1) + l) * (0 === h % 2 ? 1 : -1);
            k.centerX = c + m * Math.cos(n);
            k.centerY = e + m * Math.sin(n);
            h++;
          }
    }
  }
  function ys(a, b, c, d, e, f, g) {
    var h = 9e19,
      k = -1,
      l = 0;
    a: for (; l < b; l++) {
      var m = a[l],
        n = m.x - c,
        p = m.y - d;
      n = n * n + p * p;
      if (n < h) {
        for (p = l - 1; 0 <= p; p--)
          if (a[p].y > m.y && a[p].x - m.x < e + g.width) continue a;
        for (p = l + 1; p < b; p++)
          if (a[p].x > m.x && a[p].y - m.y < f + g.height) continue a;
        k = l;
        h = n;
      }
    }
    return k;
  }
  vs.prototype.bv = function () {
    if (this.comments)
      for (var a = this.network.vertexes.iterator; a.next(); )
        this.addComments(a.value);
  };
  vs.prototype.addComments = function (a) {
    var b = a.node;
    if (null !== b)
      for (b = b.qv(); b.next(); ) {
        var c = b.value;
        if ("Comment" === c.category && c.isVisible()) {
          var d = this.network.Si(c);
          null === d && (d = this.network.fk(c));
          d.charge = this.defaultCommentElectricalCharge;
          c = null;
          for (var e = d.destinationEdges; e.next(); ) {
            var f = e.value;
            if (f.toVertex === a) {
              c = f;
              break;
            }
          }
          if (null === c)
            for (e = d.sourceEdges; e.next(); )
              if (((f = e.value), f.fromVertex === a)) {
                c = f;
                break;
              }
          null === c && (c = this.network.xk(a, d, null));
          c.length = this.defaultCommentSpringLength;
        }
      }
  };
  function Hs(a, b) {
    G &&
      (x(a, Gs, vs, "getNodeDistance:vertexA"),
      x(b, Gs, vs, "getNodeDistance:vertexB"));
    var c = a.bounds,
      d = c.x;
    a = c.y;
    var e = c.width;
    c = c.height;
    var f = b.bounds,
      g = f.x;
    b = f.y;
    var h = f.width;
    f = f.height;
    return d + e < g
      ? a > b + f
        ? ((c = d + e - g), (a = a - b - f), L.sqrt(c * c + a * a))
        : a + c < b
        ? ((d = d + e - g), (a = a + c - b), L.sqrt(d * d + a * a))
        : g - (d + e)
      : d > g + h
      ? a > b + f
        ? ((c = d - g - h), (a = a - b - f), L.sqrt(c * c + a * a))
        : a + c < b
        ? ((d = d - g - h), (a = a + c - b), L.sqrt(d * d + a * a))
        : d - (g + h)
      : a > b + f
      ? a - (b + f)
      : a + c < b
      ? b - (a + c)
      : 0.1;
  }
  function zs(a, b) {
    G && D(b, vs, "performIterations:num");
    a.Bh = null;
    for (b = a.oo + b; a.oo < b && (a.oo++, Is(a)); );
    a.Bh = null;
  }
  function Is(a) {
    null === a.Bh && (a.Bh = a.network.vertexes.Ga());
    var b = a.Bh;
    if (0 >= b.length) return !1;
    var c = b[0];
    c.forceX = 0;
    c.forceY = 0;
    for (
      var d = c.centerX, e = d, f = (c = c.centerY), g = 1;
      g < b.length;
      g++
    ) {
      var h = b[g];
      h.forceX = 0;
      h.forceY = 0;
      var k = h.centerX;
      h = h.centerY;
      d = Math.min(d, k);
      e = Math.max(e, k);
      c = Math.min(c, h);
      f = Math.max(f, h);
    }
    (e = e - d > f - c)
      ? b.sort(function (a, b) {
          return null === a || null === b || a === b
            ? 0
            : a.centerX - b.centerX;
        })
      : b.sort(function (a, b) {
          return null === a || null === b || a === b
            ? 0
            : a.centerY - b.centerY;
        });
    c = a.ag;
    var l = (d = h = 0);
    for (f = 0; f < b.length; f++) {
      g = b[f];
      d = g.bounds;
      h = g.focus;
      k = d.x + h.x;
      var m = d.y + h.y;
      d = g.charge * a.electricalFieldX(k, m);
      l = g.charge * a.electricalFieldY(k, m);
      d += g.mass * a.gravitationalFieldX(k, m);
      l += g.mass * a.gravitationalFieldY(k, m);
      g.forceX += d;
      g.forceY += l;
      for (var n = f + 1; n < b.length; n++) {
        var p = b[n];
        if (p !== g) {
          d = p.bounds;
          h = p.focus;
          l = d.x + h.x;
          var r = d.y + h.y;
          if (k - l > c || l - k > c) {
            if (e) break;
          } else if (m - r > c || r - m > c) {
            if (!e) break;
          } else {
            var q = Hs(g, p);
            1 > q
              ? ((d = a.randomNumberGenerator),
                null === d && (a.randomNumberGenerator = d = new Js()),
                (q = d.random()),
                (h = d.random()),
                k > l
                  ? ((d = Math.abs(p.bounds.right - g.bounds.x)),
                    (d = (1 + d) * q))
                  : k < l
                  ? ((d = Math.abs(p.bounds.x - g.bounds.right)),
                    (d = -(1 + d) * q))
                  : ((d = Math.max(p.width, g.width)),
                    (d = (1 + d) * q - d / 2)),
                m > r
                  ? ((l = Math.abs(p.bounds.bottom - g.bounds.y)),
                    (l = (1 + l) * h))
                  : k < l
                  ? ((l = Math.abs(p.bounds.y - g.bounds.bottom)),
                    (l = -(1 + l) * h))
                  : ((l = Math.max(p.height, g.height)),
                    (l = (1 + l) * h - l / 2)))
              : ((h = -(g.charge * p.charge) / (q * q)),
                (d = ((l - k) / q) * h),
                (l = ((r - m) / q) * h));
            g.forceX += d;
            g.forceY += l;
            p.forceX -= d;
            p.forceY -= l;
          }
        }
      }
    }
    for (e = a.network.edges.iterator; e.next(); )
      (h = e.value),
        (c = h.fromVertex),
        (f = h.toVertex),
        (g = c.bounds),
        (k = c.focus),
        (d = g.x + k.x),
        (g = g.y + k.y),
        (m = f.bounds),
        (n = f.focus),
        (k = m.x + n.x),
        (m = m.y + n.y),
        (n = Hs(c, f)),
        1 > n
          ? ((n = a.randomNumberGenerator),
            null === n && (a.randomNumberGenerator = n = new Js()),
            (h = n.random()),
            (n = n.random()),
            (d =
              (d > k ? 1 : -1) *
              (1 + (f.width > c.width ? f.width : c.width)) *
              h),
            (l =
              (g > m ? 1 : -1) *
              (1 + (f.height > c.height ? f.height : c.height)) *
              n))
          : ((h = h.stiffness * (n - h.length)),
            (d = ((k - d) / n) * h),
            (l = ((m - g) / n) * h)),
        (c.forceX += d),
        (c.forceY += l),
        (f.forceX -= d),
        (f.forceY -= l);
    for (e = d = 0; e < b.length; e++)
      (c = b[e]),
        a.isFixed(c)
          ? a.moveFixedVertex(c)
          : (d = Math.max(d, a.moveVertex(c) || 0));
    return d > a.epsilonDistance * a.epsilonDistance;
  }
  vs.prototype.moveVertex = function (a) {
    var b = a.forceX,
      c = a.forceY,
      d = this.moveLimit;
    b < -d ? (b = -d) : b > d && (b = d);
    c < -d ? (c = -d) : c > d && (c = d);
    a.centerX += b;
    a.centerY += c;
    return b * b + c * c;
  };
  vs.prototype.moveFixedVertex = function () {};
  vs.prototype.commitLayout = function () {
    this.Yv();
    this.commitNodes();
    this.isRouting && this.commitLinks();
  };
  vs.prototype.Yv = function () {
    if (this.setsPortSpots)
      for (var a = this.network.edges.iterator; a.next(); ) {
        var b = a.value.link;
        null !== b && ((b.fromSpot = gd), (b.toSpot = gd));
      }
  };
  vs.prototype.commitNodes = function () {
    var a = 0,
      b = 0;
    if (this.arrangesToOrigin) {
      var c = M.alloc();
      this.computeBounds(this.network, c);
      b = this.arrangementOrigin;
      a = b.x - c.x;
      b = b.y - c.y;
      M.free(c);
    }
    c = M.alloc();
    for (var d = this.network.vertexes.iterator; d.next(); ) {
      var e = d.value;
      if (0 !== a || 0 !== b)
        c.assign(e.bounds), (c.x += a), (c.y += b), (e.bounds = c);
      e.commit();
    }
    M.free(c);
  };
  vs.prototype.commitLinks = function () {
    for (var a = this.network.edges.iterator; a.next(); ) a.value.commit();
  };
  vs.prototype.springStiffness = function (a) {
    a = a.stiffness;
    return isNaN(a) ? this.fl : a;
  };
  vs.prototype.springLength = function (a) {
    a = a.length;
    return isNaN(a) ? this.el : a;
  };
  vs.prototype.electricalCharge = function (a) {
    a = a.charge;
    return isNaN(a) ? this.cl : a;
  };
  vs.prototype.electricalFieldX = function () {
    return 0;
  };
  vs.prototype.electricalFieldY = function () {
    return 0;
  };
  vs.prototype.gravitationalMass = function (a) {
    a = a.mass;
    return isNaN(a) ? this.dl : a;
  };
  vs.prototype.gravitationalFieldX = function () {
    return 0;
  };
  vs.prototype.gravitationalFieldY = function () {
    return 0;
  };
  vs.prototype.isFixed = function (a) {
    return a.isFixed;
  };
  oa.Object.defineProperties(vs.prototype, {
    currentIteration: {
      configurable: !0,
      get: function () {
        return this.oo;
      },
    },
    arrangementSpacing: {
      configurable: !0,
      get: function () {
        return this.Wd;
      },
      set: function (a) {
        x(a, Gb, vs, "arrangementSpacing");
        this.Wd.D(a) || (this.Wd.assign(a), this.F());
      },
    },
    arrangesToOrigin: {
      configurable: !0,
      get: function () {
        return this.dn;
      },
      set: function (a) {
        this.dn !== a &&
          (A(a, "boolean", vs, "arrangesToOrigin"), (this.dn = a), this.F());
      },
    },
    setsPortSpots: {
      configurable: !0,
      get: function () {
        return this.rf;
      },
      set: function (a) {
        this.rf !== a &&
          (A(a, "boolean", vs, "setsPortSpots"), (this.rf = a), this.F());
      },
    },
    comments: {
      configurable: !0,
      get: function () {
        return this.rd;
      },
      set: function (a) {
        this.rd !== a &&
          (A(a, "boolean", vs, "comments"), (this.rd = a), this.F());
      },
    },
    maxIterations: {
      configurable: !0,
      get: function () {
        return this.Fl;
      },
      set: function (a) {
        this.Fl !== a &&
          (A(a, "number", vs, "maxIterations"),
          0 <= a && ((this.Fl = a), this.F()));
      },
    },
    epsilonDistance: {
      configurable: !0,
      get: function () {
        return this.Hn;
      },
      set: function (a) {
        this.Hn !== a &&
          (A(a, "number", vs, "epsilonDistance"),
          0 < a && ((this.Hn = a), this.F()));
      },
    },
    infinityDistance: {
      configurable: !0,
      get: function () {
        return this.ag;
      },
      set: function (a) {
        this.ag !== a &&
          (A(a, "number", vs, "infinityDistance"),
          1 < a && ((this.ag = a), this.F()));
      },
    },
    moveLimit: {
      configurable: !0,
      get: function () {
        return this.Io;
      },
      set: function (a) {
        this.Io !== a &&
          (A(a, "number", vs, "moveLimit"), 1 < a && ((this.Io = a), this.F()));
      },
    },
    randomNumberGenerator: {
      configurable: !0,
      get: function () {
        return this.cp;
      },
      set: function (a) {
        this.cp !== a &&
          (null !== a &&
            "function" !== typeof a.random &&
            v(
              'ForceDirectedLayout.randomNumberGenerator must have a "random()" function on it: ' +
                a
            ),
          (this.cp = a));
      },
    },
    defaultSpringStiffness: {
      configurable: !0,
      get: function () {
        return this.fl;
      },
      set: function (a) {
        this.fl !== a &&
          (A(a, "number", vs, "defaultSpringStiffness"),
          (this.fl = a),
          this.F());
      },
    },
    defaultSpringLength: {
      configurable: !0,
      get: function () {
        return this.el;
      },
      set: function (a) {
        this.el !== a &&
          (A(a, "number", vs, "defaultSpringLength"), (this.el = a), this.F());
      },
    },
    defaultElectricalCharge: {
      configurable: !0,
      get: function () {
        return this.cl;
      },
      set: function (a) {
        this.cl !== a &&
          (A(a, "number", vs, "defaultElectricalCharge"),
          (this.cl = a),
          this.F());
      },
    },
    defaultGravitationalMass: {
      configurable: !0,
      get: function () {
        return this.dl;
      },
      set: function (a) {
        this.dl !== a &&
          (A(a, "number", vs, "defaultGravitationalMass"),
          (this.dl = a),
          this.F());
      },
    },
    defaultCommentSpringLength: {
      configurable: !0,
      get: function () {
        return this.An;
      },
      set: function (a) {
        this.An !== a &&
          (A(a, "number", vs, "defaultCommentSpringLength"),
          (this.An = a),
          this.F());
      },
    },
    defaultCommentElectricalCharge: {
      configurable: !0,
      get: function () {
        return this.zn;
      },
      set: function (a) {
        this.zn !== a &&
          (A(a, "number", vs, "defaultCommentElectricalCharge"),
          (this.zn = a),
          this.F());
      },
    },
  });
  vs.className = "ForceDirectedLayout";
  function Fs() {
    this.qw = this.pw = this.kt = this.mt = this.lt = 0;
  }
  Fs.className = "ForceDirectedSubnet";
  function ws(a) {
    mq.call(this, a);
  }
  na(ws, mq);
  ws.prototype.createVertex = function () {
    return new Gs(this);
  };
  ws.prototype.createEdge = function () {
    return new Ks(this);
  };
  ws.className = "ForceDirectedNetwork";
  function Gs(a) {
    Aq.call(this, a);
    this.Na = !1;
    this.eb = this.B = NaN;
    this.Ph = this.Qd = this.Ba = this.M = 0;
    this.We = this.ik = null;
    this.Uv = 0;
  }
  na(Gs, Aq);
  Gs.prototype.serializeVertexProperties = function (a, b) {
    Aq.prototype.serializeVertexProperties.call(this, a, b);
    a.isFixed = this.isFixed;
    a.charge = this.charge;
    a.mass = this.mass;
  };
  Gs.prototype.deserializeVertexProperties = function (a, b, c, d) {
    Aq.prototype.deserializeVertexProperties.call(this, a, b, c, d);
    this.isFixed = a.isFixed;
    this.charge = a.charge;
    this.mass = a.mass;
  };
  oa.Object.defineProperties(Gs.prototype, {
    isFixed: {
      configurable: !0,
      get: function () {
        return this.Na;
      },
      set: function (a) {
        this.Na !== a && (A(a, "boolean", Gs, "isFixed"), (this.Na = a));
      },
    },
    charge: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        this.B !== a && (A(a, "number", Gs, "charge"), (this.B = a));
      },
    },
    mass: {
      configurable: !0,
      get: function () {
        return this.eb;
      },
      set: function (a) {
        this.eb !== a && (A(a, "number", Gs, "mass"), (this.eb = a));
      },
    },
    forceX: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        this.M !== a && (A(a, "number", Gs, "forceX"), (this.M = a));
      },
    },
    forceY: {
      configurable: !0,
      get: function () {
        return this.Ba;
      },
      set: function (a) {
        this.Ba !== a && (A(a, "number", Gs, "forceY"), (this.Ba = a));
      },
    },
  });
  Gs.className = "ForceDirectedVertex";
  function Ks(a) {
    Bq.call(this, a);
    this.j = this.o = NaN;
  }
  na(Ks, Bq);
  Ks.prototype.serializeEdgeProperties = function (a, b) {
    Bq.prototype.serializeEdgeProperties.call(this, a, b);
    a.stiffness = this.stiffness;
    a.length = this.length;
  };
  Ks.prototype.deserializeEdgeProperties = function (a, b, c, d) {
    Bq.prototype.deserializeEdgeProperties.call(this, a, b, c, d);
    this.stiffness = a.stiffness;
    this.length = a.length;
  };
  oa.Object.defineProperties(Ks.prototype, {
    stiffness: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        this.o !== a && (A(a, "number", Ks, "stiffness"), (this.o = a));
      },
    },
    length: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.j !== a && (A(a, "number", Ks, "length"), (this.j = a));
      },
    },
  });
  Ks.className = "ForceDirectedEdge";
  function Js() {
    var a = 0;
    void 0 === a && (a = 42);
    this.seed = a;
    this.Ky = 48271;
    this.My = 2147483647;
    this.Q = 44488.07041494893;
    this.Ny = 3399;
    this.Ly = 1 / 2147483647;
    this.random();
  }
  Js.prototype.random = function () {
    var a = (this.seed % this.Q) * this.Ky - (this.seed / this.Q) * this.Ny;
    0 < a ? (this.seed = a) : (this.seed = a + this.My);
    return this.seed * this.Ly;
  };
  Js.className = "RandomNumberGenerator";
  function Ls(a) {
    zi.call(this);
    this.gc = this.de = 25;
    this.O = 0;
    this.bl = Ms;
    this.Al = Ns;
    this.pl = Os;
    this.Jj = 4;
    this.Nk = Ps;
    this.hg = 15;
    this.rf = !0;
    this.uo = 4;
    this.Ja = this.si = this.ya = -1;
    this.yc = this.ah = 0;
    this.Qa = this.Ed = this.Fd = this.ce = this.Hb = null;
    this.ih = 0;
    this.Jo = this.Qj = null;
    this.Kc = 0;
    this.Ko = null;
    this.$c = new K();
    this.Fe = [];
    this.Fe.length = 100;
    a && Object.assign(this, a);
  }
  na(Ls, zi);
  Ls.prototype.cloneProtected = function (a) {
    zi.prototype.cloneProtected.call(this, a);
    a.de = this.de;
    a.gc = this.gc;
    a.O = this.O;
    a.bl = this.bl;
    a.Al = this.Al;
    a.pl = this.pl;
    a.Jj = this.Jj;
    a.Nk = this.Nk;
    a.hg = this.hg;
    a.rf = this.rf;
    a.uo = this.uo;
  };
  Ls.prototype.serializeLayoutProperties = function (a, b) {
    zi.prototype.serializeLayoutProperties.call(this, a, b);
    a.layerSpacing = this.layerSpacing;
    a.columnSpacing = this.columnSpacing;
    a.direction = this.direction;
    a.cycleRemoveOption = this.cycleRemoveOption.name;
    a.layeringOption = this.layeringOption.name;
    a.initializeOption = this.initializeOption.name;
    a.iterations = this.iterations;
    a.aggressiveOption = this.aggressiveOption.name;
    a.packOption = this.packOption;
    a.setsPortSpots = this.setsPortSpots;
    a.linkSpacing = this.linkSpacing;
    a.ya = this.ya;
    a.si = this.si;
    a.Ja = this.Ja;
    a.ah = this.ah;
    a.yc = this.yc;
    a.Hb = this.Hb;
    a.ih = this.ih;
    a.Kc = this.Kc;
    a.$c = { x: this.$c.x, y: this.$c.y };
  };
  Ls.prototype.deserializeLayoutProperties = function (a, b, c, d, e) {
    zi.prototype.deserializeLayoutProperties.call(this, a, b, c, d, e);
    this.layerSpacing = a.layerSpacing;
    this.columnSpacing = a.columnSpacing;
    this.direction = a.direction;
    this.cycleRemoveOption = bb(Ls, a.cycleRemoveOption);
    this.layeringOption = bb(Ls, a.layeringOption);
    this.initializeOption = bb(Ls, a.initializeOption);
    this.iterations = a.iterations;
    this.aggressiveOption = bb(Ls, a.aggressiveOption);
    this.packOption = a.packOption;
    this.setsPortSpots = a.setsPortSpots;
    this.linkSpacing = a.linkSpacing;
    this.ya = a.ya;
    this.si = a.si;
    this.Ja = a.Ja;
    this.ah = a.ah;
    this.yc = a.yc;
    this.Hb = a.Hb;
    this.ih = a.ih;
    this.Kc = a.Kc;
    this.$c = new K(this.$c.x, this.$c.y);
    e &&
      !d &&
      e.edges.each(function (a) {
        if (
          !a.link &&
          a.fromVertex &&
          a.toVertex &&
          (null === a.fromVertex.node || null === a.toVertex.node)
        ) {
          for (
            var b = a.fromVertex;
            null !== b && null === b.node && 0 < b.Ad.count;

          ) {
            var c = b.Ad.N(0);
            if (c.link) {
              a.link = c.link;
              break;
            }
            b = c.fromVertex;
          }
          if (!a.link) {
            for (
              c = a.toVertex;
              null !== c && null === c.node && 0 < c.Md.count;

            ) {
              var d = c.Md.N(0);
              if (d.link) {
                a.link = d.link;
                break;
              }
              c = d.toVertex;
            }
            if (!a.link)
              for (c = c.Ad.iterator; c.next(); )
                if (((d = c.value), d.link && d.fromVertex === b)) {
                  a.link = d.link;
                  break;
                }
          }
        }
      });
  };
  Ls.prototype.pb = function (a) {
    a.classType === Ls
      ? 0 === a.name.indexOf("Aggressive")
        ? (this.aggressiveOption = a)
        : 0 === a.name.indexOf("Cycle")
        ? (this.cycleRemoveOption = a)
        : 0 === a.name.indexOf("Init")
        ? (this.initializeOption = a)
        : 0 === a.name.indexOf("Layer")
        ? (this.layeringOption = a)
        : v("Unknown enum value: " + a)
      : zi.prototype.pb.call(this, a);
  };
  Ls.prototype.createNetwork = function () {
    return new Qs(this);
  };
  Ls.prototype.doLayout = function (a) {
    G &&
      null === a &&
      v(
        "Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts"
      );
    null === this.network && (this.network = this.makeNetwork(a));
    this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin);
    this.si = -1;
    this.yc = this.ah = 0;
    this.Ko = this.Jo = this.Qj = null;
    for (a = 0; a < this.Fe.length; a++) this.Fe[a] = null;
    if (0 < this.network.vertexes.count) {
      this.network.bq();
      if (this.jw()) return;
      this.cycleRemoveOption !== Rs && this.removeCycles();
      for (a = this.network.vertexes.iterator; a.next(); ) a.value.layer = -1;
      this.ya = -1;
      this.assignLayers();
      for (a.reset(); a.next(); ) this.ya = Math.max(this.ya, a.value.layer);
      this.cycleRemoveOption === Rs && this.removeCycles();
      a = this.network;
      for (var b = [], c = a.edges.iterator; c.next(); ) {
        var d = c.value;
        d.valid = !1;
        b.push(d);
      }
      for (c = 0; c < b.length; c++) {
        d = b[c];
        var e = d.fromVertex,
          f = d.toVertex;
        if (
          !(
            d.valid ||
            (((null === e.node && null === e.data) ||
              (null === f.node && null === f.data)) &&
              e.layer === f.layer)
          )
        ) {
          var g = 0,
            h = 0,
            k = 0,
            l = 0;
          if (null !== d.link) {
            h = d.link;
            if (null === h) continue;
            var m = e.node;
            g = f.node;
            if (null === m || null === g) continue;
            var n = h.fromNode;
            k = h.toNode;
            var p = h.fromPort;
            h = h.toPort;
            if (d.rev) {
              l = n;
              var r = p;
              n = k;
              p = h;
              k = l;
              h = r;
            }
            var q = e.focus;
            l = f.focus;
            var u = d.rev ? f.bounds : e.bounds;
            r = K.alloc();
            m !== n
              ? u.s() && n.isVisible()
                ? n.actualBounds.s()
                  ? (Qo(n, p, Kc, r),
                    (r.x += n.actualBounds.x - u.x),
                    (r.y += n.actualBounds.y - u.y))
                  : (Qo(n, p, Kc, r), r.s() || r.assign(q))
                : r.assign(q)
              : u.s()
              ? (Qo(n, p, Kc, r), r.s() || r.assign(q))
              : r.assign(q);
            n = d.rev ? e.bounds : f.bounds;
            m = K.alloc();
            g !== k
              ? n.s() && k.isVisible()
                ? k.actualBounds.s()
                  ? (Qo(k, h, Kc, m),
                    (m.x += k.actualBounds.x - n.x),
                    (m.y += k.actualBounds.y - n.y))
                  : (Qo(k, h, Kc, m), m.s() || m.assign(l))
                : m.assign(l)
              : n.s()
              ? (Qo(k, h, Kc, m), m.s() || m.assign(l))
              : m.assign(l);
            90 === this.O || 270 === this.O
              ? ((g = Math.round((r.x - q.x) / this.gc)),
                (k = r.x),
                (h = Math.round((m.x - l.x) / this.gc)),
                (l = m.x))
              : ((g = Math.round((r.y - q.y) / this.gc)),
                (k = r.y),
                (h = Math.round((m.y - l.y) / this.gc)),
                (l = m.y));
            K.free(r);
            K.free(m);
            d.portFromColOffset = g;
            d.portFromPos = k;
            d.portToColOffset = h;
            d.portToPos = l;
          } else
            (d.portFromColOffset = 0),
              (d.portFromPos = 0),
              (d.portToColOffset = 0),
              (d.portToPos = 0);
          r = e.layer;
          m = f.layer;
          n = 0;
          u = d.link;
          if (null !== u) {
            var w = u.fromPort,
              y = u.toPort;
            if (null !== w && null !== y) {
              var z = u.fromNode;
              p = u.toNode;
              if (null !== z && null !== p) {
                var B = Ss(this, !0),
                  C = Ss(this, !1),
                  E = this.setsPortSpots ? B : u.computeSpot(!0, w);
                q = this.setsPortSpots ? C : u.computeSpot(!1, y);
                var J = u.isOrthogonal;
                E.Uc() && E.Lf(C) && q.Uc() && q.Lf(B)
                  ? (n = 0)
                  : ((B = u.getLinkPoint(z, w, E, !0, J, p, y, K.alloc())),
                    (C = u.getLinkDirection(z, w, B, E, !0, J, p, y)),
                    K.free(B),
                    E.pq() || C !== Ts(this, d, !0)
                      ? this.setsPortSpots &&
                        null !== z &&
                        1 === z.ports.count &&
                        d.rev &&
                        (n += 1)
                      : (n += 1),
                    (E = u.getLinkPoint(p, y, q, !1, J, z, w, K.alloc())),
                    (u = u.getLinkDirection(p, y, E, q, !1, J, z, w)),
                    K.free(E),
                    q.pq() || u !== Ts(this, d, !1)
                      ? this.setsPortSpots &&
                        null !== p &&
                        1 === p.ports.count &&
                        d.rev &&
                        (n += 2)
                      : (n += 2));
              }
            }
          }
          p = n;
          n = 1 === p || 3 === p ? !0 : !1;
          if ((p = 2 === p || 3 === p ? !0 : !1))
            (q = a.createVertex()),
              (q.node = null),
              (q.Cf = 1),
              (q.layer = r),
              (q.near = e),
              a.tg(q),
              (e = a.xk(e, q, d.link)),
              (e.valid = !1),
              (e.rev = d.rev),
              (e.portFromColOffset = g),
              (e.portToColOffset = 0),
              (e.portFromPos = k),
              (e.portToPos = 0),
              (e = q);
          u = 1;
          n && u--;
          if (r - m > u && 0 < r) {
            d.valid = !1;
            q = a.createVertex();
            q.node = null;
            q.Cf = 2;
            q.layer = r - 1;
            a.tg(q);
            e = a.xk(e, q, d.link);
            e.valid = !0;
            e.rev = d.rev;
            e.portFromColOffset = p ? 0 : g;
            e.portToColOffset = 0;
            e.portFromPos = p ? 0 : k;
            e.portToPos = 0;
            e = q;
            for (r--; r - m > u && 0 < r; )
              (q = a.createVertex()),
                (q.node = null),
                (q.Cf = 3),
                (q.layer = r - 1),
                a.tg(q),
                (e = a.xk(e, q, d.link)),
                (e.valid = !0),
                (e.rev = d.rev),
                (e.portFromColOffset = 0),
                (e.portToColOffset = 0),
                (e.portFromPos = 0),
                (e.portToPos = 0),
                (e = q),
                r--;
            e = a.xk(q, f, d.link);
            e.valid = !n;
            n && (q.near = f);
            e.rev = d.rev;
            e.portFromColOffset = 0;
            e.portToColOffset = h;
            e.portFromPos = 0;
            e.portToPos = l;
          } else d.valid = !0;
        }
      }
      a = this.Hb = [];
      for (b = 0; b <= this.ya; b++) a[b] = 0;
      for (b = this.network.vertexes.iterator; b.next(); ) b.value.index = -1;
      this.initializeIndices();
      this.si = -1;
      for (c = this.yc = this.ah = 0; c <= this.ya; c++)
        a[c] > a[this.yc] && ((this.si = a[c] - 1), (this.yc = c)),
          a[c] < a[this.ah] && (this.ah = c);
      this.Ko = [];
      for (c = 0; c < a.length; c++) this.Ko[c] = [];
      for (b.reset(); b.next(); )
        (a = b.value), (this.Ko[a.layer][a.index] = a);
      this.Ja = -1;
      for (a = 0; a <= this.ya; a++) {
        b = Us(this, a);
        c = 0;
        d = this.Hb[a];
        for (f = 0; f < d; f++)
          (e = b[f]),
            (c += this.nodeMinColumnSpace(e, !0)),
            (e.column = c),
            (c += 1),
            (c += this.nodeMinColumnSpace(e, !1));
        this.Ja = Math.max(this.Ja, c - 1);
        Vs(this, a, b);
      }
      this.reduceCrossings();
      this.straightenAndPack();
      this.updateParts();
    }
    this.network = null;
    this.isValidLayout = !0;
  };
  Ls.prototype.linkMinLength = function () {
    return 1;
  };
  function Ws(a) {
    var b = a.fromVertex.node || a.fromVertex.data;
    a = a.toVertex.node || a.toVertex.data;
    return null === b && null === a ? 8 : null === b || null === a ? 4 : 1;
  }
  Ls.prototype.nodeMinLayerSpace = function (a, b) {
    return null === a.node && null === a.data
      ? 0
      : 90 === this.O || 270 === this.O
      ? b
        ? a.focus.y + 10
        : a.bounds.height - a.focus.y + 10
      : b
      ? a.focus.x + 10
      : a.bounds.width - a.focus.x + 10;
  };
  Ls.prototype.nodeMinColumnSpace = function (a, b) {
    if (null === a.node && null === a.data) return 0;
    var c = b ? a.Bk : a.Ak;
    if (null !== c) return c;
    c = this.O;
    return 90 === c || 270 === c
      ? b
        ? (a.Bk = (a.focus.x / this.gc + 1) | 0)
        : (a.Ak = ((a.bounds.width - a.focus.x) / this.gc + 1) | 0)
      : b
      ? (a.Bk = (a.focus.y / this.gc + 1) | 0)
      : (a.Ak = ((a.bounds.height - a.focus.y) / this.gc + 1) | 0);
  };
  function Xs(a) {
    null === a.Qj && (a.Qj = []);
    for (var b = 0, c = a.network.vertexes.iterator; c.next(); ) {
      var d = c.value;
      a.Qj[b] = d.layer;
      b++;
      a.Qj[b] = d.column;
      b++;
      a.Qj[b] = d.index;
      b++;
    }
    return a.Qj;
  }
  function Ys(a, b) {
    var c = 0;
    for (a = a.network.vertexes.iterator; a.next(); ) {
      var d = a.value;
      d.layer = b[c];
      c++;
      d.column = b[c];
      c++;
      d.index = b[c];
      c++;
    }
  }
  function Zs(a, b, c) {
    G &&
      (D(b, Ls, "crossingMatrix:unfixedLayer"),
      D(c, Ls, "crossingMatrix:direction"));
    var d = Us(a, b),
      e = a.Hb[b];
    if (null === a.Jo || a.Jo.length < e * e) a.Jo = [];
    for (var f = a.Jo, g = 0; g < e; g++) {
      var h = 0,
        k = d[g],
        l = k.near;
      if (null !== l && l.layer === k.layer)
        if (((k = l.index), k > g))
          for (var m = g + 1; m < k; m++) {
            var n = d[m];
            (n.near === l && n.Cf === l.Cf) || h++;
          }
        else
          for (m = g - 1; m > k; m--)
            (n = d[m]), (n.near === l && n.Cf === l.Cf) || h++;
      var p;
      if (0 <= c)
        for (k = d[g].sourceEdgesArrayAccess, l = 0; l < k.length; l++) {
          var r = k[l];
          if (r.valid && r.fromVertex.layer !== b)
            for (
              n = r.fromVertex.index,
                m = r.portToPos,
                r = r.portFromPos,
                p = l + 1;
              p < k.length;
              p++
            ) {
              var q = k[p];
              if (q.valid && q.fromVertex.layer !== b) {
                var u = q.fromVertex.index;
                var w = q.portToPos;
                q = q.portFromPos;
                m < w && (n > u || (n === u && r > q)) && h++;
                w < m && (u > n || (u === n && q > r)) && h++;
              }
            }
        }
      if (0 >= c)
        for (k = d[g].destinationEdgesArrayAccess, l = 0; l < k.length; l++)
          if (((r = k[l]), r.valid && r.toVertex.layer !== b))
            for (
              n = r.toVertex.index,
                m = r.portToPos,
                r = r.portFromPos,
                p = l + 1;
              p < k.length;
              p++
            )
              (q = k[p]),
                q.valid &&
                  q.toVertex.layer !== b &&
                  ((u = q.toVertex.index),
                  (w = q.portToPos),
                  (q = q.portFromPos),
                  r < q && (n > u || (n === u && m > w)) && h++,
                  q < r && (u > n || (u === n && w > m)) && h++);
      f[g * e + g] = h;
      for (k = g + 1; k < e; k++) {
        var y = 0,
          z = 0;
        if (0 <= c) {
          h = d[g].sourceEdgesArrayAccess;
          var B = d[k].sourceEdgesArrayAccess;
          for (l = 0; l < h.length; l++)
            if (((r = h[l]), r.valid && r.fromVertex.layer !== b))
              for (
                n = r.fromVertex.index, r = r.portFromPos, p = 0;
                p < B.length;
                p++
              )
                (q = B[p]),
                  q.valid &&
                    q.fromVertex.layer !== b &&
                    ((u = q.fromVertex.index),
                    (q = q.portFromPos),
                    (n < u || (n === u && r < q)) && z++,
                    (u < n || (u === n && q < r)) && y++);
        }
        if (0 >= c)
          for (
            h = d[g].destinationEdgesArrayAccess,
              B = d[k].destinationEdgesArrayAccess,
              l = 0;
            l < h.length;
            l++
          )
            if (((r = h[l]), r.valid && r.toVertex.layer !== b))
              for (
                n = r.toVertex.index, m = r.portToPos, p = 0;
                p < B.length;
                p++
              )
                (q = B[p]),
                  q.valid &&
                    q.toVertex.layer !== b &&
                    ((u = q.toVertex.index),
                    (w = q.portToPos),
                    (n < u || (n === u && m < w)) && z++,
                    (u < n || (u === n && w < m)) && y++);
        f[g * e + k] = y;
        f[k * e + g] = z;
      }
    }
    Vs(a, b, d);
    return f;
  }
  Ls.prototype.countCrossings = function () {
    for (var a = 0, b = 0; b <= this.ya; b++)
      for (var c = Zs(this, b, 1), d = this.Hb[b], e = 0; e < d; e++)
        for (var f = e; f < d; f++) a += c[e * d + f];
    return a;
  };
  function $s(a) {
    for (var b = 0, c = 0; c <= a.ya; c++) {
      for (
        var d = a, e = c, f = Us(d, e), g = d.Hb[e], h = 0, k = 0;
        k < g;
        k++
      ) {
        var l = f[k].destinationEdgesArrayAccess;
        if (null !== l)
          for (var m = 0; m < l.length; m++) {
            var n = l[m];
            if (n.valid && n.toVertex.layer !== e) {
              var p = n.fromVertex.column + n.portFromColOffset;
              var r = n.toVertex.column + n.portToColOffset;
              h += (Math.abs(p - r) + 1) * Ws(n);
            }
          }
      }
      Vs(d, e, f);
      b += h;
    }
    return b;
  }
  Ls.prototype.normalize = function () {
    var a = Infinity;
    this.Ja = -1;
    for (var b = this.network.vertexes.iterator; b.next(); ) {
      var c = b.value;
      a = Math.min(a, c.column - this.nodeMinColumnSpace(c, !0));
      this.Ja = Math.max(this.Ja, c.column + this.nodeMinColumnSpace(c, !1));
    }
    for (b.reset(); b.next(); ) b.value.column -= a;
    this.Ja -= a;
  };
  function at(a, b, c) {
    G &&
      (D(b, Ls, "barycenters:unfixedLayer"), D(c, Ls, "barycenters:direction"));
    for (var d = Us(a, b), e = a.Hb[b], f = [], g = 0; g < e; g++) {
      var h = d[g],
        k = null;
      0 >= c && (k = h.sourceEdgesArrayAccess);
      var l = null;
      0 <= c && (l = h.destinationEdgesArrayAccess);
      var m = 0,
        n = 0,
        p = h.near;
      null !== p && p.layer === h.layer && ((m += p.column - 1), n++);
      if (null !== k)
        for (p = 0; p < k.length; p++) {
          h = k[p];
          var r = h.fromVertex;
          h.valid && !h.rev && r.layer !== b && ((m += r.column), n++);
        }
      if (null !== l)
        for (k = 0; k < l.length; k++)
          (h = l[k]),
            (p = h.toVertex),
            h.valid && !h.rev && p.layer !== b && ((m += p.column), n++);
      f[g] = 0 === n ? -1 : m / n;
    }
    Vs(a, b, d);
    return f;
  }
  function bt(a, b, c) {
    G && (D(b, Ls, "medians:unfixedLayer"), D(c, Ls, "medians:direction"));
    for (var d = Us(a, b), e = a.Hb[b], f = [], g = 0; g < e; g++) {
      var h = d[g],
        k = null;
      0 >= c && (k = h.sourceEdgesArrayAccess);
      var l = null;
      0 <= c && (l = h.destinationEdgesArrayAccess);
      var m = 0,
        n = [],
        p = h.near;
      null !== p && p.layer === h.layer && ((n[m] = p.column - 1), m++);
      h = void 0;
      if (null !== k)
        for (p = 0; p < k.length; p++) {
          h = k[p];
          var r = h.fromVertex;
          h.valid &&
            !h.rev &&
            r.layer !== b &&
            ((n[m] = r.column + h.portFromColOffset), m++);
        }
      if (null !== l)
        for (k = 0; k < l.length; k++)
          (h = l[k]),
            (p = h.toVertex),
            h.valid &&
              !h.rev &&
              p.layer !== b &&
              ((n[m] = p.column + h.portToColOffset), m++);
      0 === m
        ? (f[g] = -1)
        : (n.sort(function (a, b) {
            return a - b;
          }),
          (l = m >> 1),
          (f[g] = 0 !== (m & 1) ? n[l] : (n[l - 1] + n[l]) >> 1));
    }
    Vs(a, b, d);
    return f;
  }
  function ct(a, b, c, d, e, f) {
    if (b.component === d) {
      b.component = c;
      if (e)
        for (var g = b.destinationEdges; g.next(); ) {
          var h = g.value;
          var k = h.toVertex;
          var l = b.layer - k.layer;
          h = a.linkMinLength(h);
          l === h && ct(a, k, c, d, e, f);
        }
      if (f)
        for (g = b.sourceEdges; g.next(); )
          (h = g.value),
            (k = h.fromVertex),
            (l = k.layer - b.layer),
            (h = a.linkMinLength(h)),
            l === h && ct(a, k, c, d, e, f);
    }
  }
  function dt(a, b, c, d, e, f) {
    if (b.component === d) {
      b.component = c;
      if (e)
        for (var g = b.destinationEdges; g.next(); )
          dt(a, g.value.toVertex, c, d, e, f);
      if (f)
        for (b = b.sourceEdges; b.next(); )
          dt(a, b.value.fromVertex, c, d, e, f);
    }
  }
  Ls.prototype.removeCycles = function () {
    for (var a = this.network.edges.iterator; a.next(); ) a.value.rev = !1;
    switch (this.bl) {
      default:
      case et:
        a = this.network;
        var b = 0,
          c = a.vertexes.count - 1,
          d = [];
        d.length = c + 1;
        for (var e = a.vertexes.iterator; e.next(); ) e.value.valid = !0;
        for (; null !== ft(a); ) {
          for (e = gt(a); null !== e; )
            (d[c] = e), c--, (e.valid = !1), (e = gt(a));
          for (e = ht(a); null !== e; )
            (d[b] = e), b++, (e.valid = !1), (e = ht(a));
          e = null;
          for (var f = 0, g = this.network.vertexes.iterator; g.next(); ) {
            var h = g.value;
            if (h.valid) {
              for (var k = 0, l = h.destinationEdges; l.next(); )
                l.value.toVertex.valid && k++;
              l = 0;
              for (var m = h.sourceEdges; m.next(); )
                m.value.fromVertex.valid && l++;
              if (null === e || f < k - l) (e = h), (f = k - l);
            }
          }
          null !== e && ((d[b] = e), b++, (e.valid = !1));
        }
        for (b = 0; b < a.vertexes.count; b++) d[b].index = b;
        for (d = a.edges.iterator; d.next(); )
          (b = d.value),
            b.fromVertex.index > b.toVertex.index && (a.Dm(b), (b.rev = !0));
        break;
      case Ms:
        for (d = this.network.vertexes.iterator; d.next(); )
          (a = d.value), (a.ug = -1), (a.finish = -1);
        for (a = this.network.edges.iterator; a.next(); ) a.value.forest = !1;
        this.ih = 0;
        for (d.reset(); d.next(); )
          (b = d.value), 0 === b.sourceEdges.count && it(this, b);
        for (d.reset(); d.next(); ) (b = d.value), -1 === b.ug && it(this, b);
        for (a.reset(); a.next(); )
          (d = a.value),
            d.forest ||
              ((b = d.fromVertex),
              (c = b.finish),
              (e = d.toVertex),
              (f = e.finish),
              e.ug < b.ug && c < f && (this.network.Dm(d), (d.rev = !0)));
        break;
      case Rs:
        a = this.network;
        b = a.vertexes.iterator;
        for (d = Infinity; b.next(); ) d = Math.min(d, b.value.layer);
        if (Infinity > d) {
          if (0 > d) for (b.reset(); b.next(); ) b.value.layer -= d;
          d = [];
          for (b.reset(); b.next(); )
            (c = b.value),
              (e = d[c.layer]),
              void 0 === e ? (d[c.layer] = [c]) : e.push(c);
          for (c = b = 0; c < d.length; c++)
            if (((e = d[c]), !e || 0 === e.length)) b++;
            else if (0 < c) for (f = 0; f < e.length; f++) e[f].layer -= b;
          for (d = a.edges.iterator; d.next(); )
            (b = d.value),
              b.fromVertex.layer < b.toVertex.layer && (a.Dm(b), (b.rev = !0));
        }
    }
  };
  function ft(a) {
    for (a = a.vertexes.iterator; a.next(); ) {
      var b = a.value;
      if (b.valid) return b;
    }
    return null;
  }
  function gt(a) {
    for (a = a.vertexes.iterator; a.next(); ) {
      var b = a.value;
      if (b.valid) {
        for (var c = !0, d = b.destinationEdges; d.next(); )
          if (d.value.toVertex.valid) {
            c = !1;
            break;
          }
        if (c) return b;
      }
    }
    return null;
  }
  function ht(a) {
    for (a = a.vertexes.iterator; a.next(); ) {
      var b = a.value;
      if (b.valid) {
        for (var c = !0, d = b.sourceEdges; d.next(); )
          if (d.value.fromVertex.valid) {
            c = !1;
            break;
          }
        if (c) return b;
      }
    }
    return null;
  }
  function it(a, b) {
    b.ug = a.ih;
    a.ih++;
    for (var c = b.destinationEdges; c.next(); ) {
      var d = c.value,
        e = d.toVertex;
      -1 === e.ug && ((d.forest = !0), it(a, e));
    }
    b.finish = a.ih;
    a.ih++;
  }
  Ls.prototype.assignLayers = function () {
    switch (this.Al) {
      case jt:
        kt(this);
        break;
      case lt:
        for (var a, b = this.network.vertexes.iterator; b.next(); )
          (a = mt(this, b.value)), (this.ya = Math.max(a, this.ya));
        for (b.reset(); b.next(); )
          (a = b.value), (a.layer = this.ya - a.layer);
        break;
      default:
      case Ns:
        kt(this);
        for (b = this.network.vertexes.iterator; b.next(); ) b.value.valid = !1;
        for (b.reset(); b.next(); )
          (a = b.value), 0 === a.sourceEdges.count && nt(this, a);
        a = Infinity;
        for (b.reset(); b.next(); ) a = Math.min(a, b.value.layer);
        this.ya = -1;
        for (b.reset(); b.next(); ) {
          var c = b.value;
          c.layer -= a;
          this.ya = Math.max(this.ya, c.layer);
        }
    }
  };
  function kt(a) {
    for (var b = a.network.vertexes.iterator; b.next(); ) {
      var c = ot(a, b.value);
      a.ya = Math.max(c, a.ya);
    }
  }
  function ot(a, b) {
    var c = 0;
    if (-1 === b.layer) {
      for (var d = b.destinationEdges; d.next(); ) {
        var e = d.value,
          f = e.toVertex;
        e = a.linkMinLength(e);
        c = Math.max(c, ot(a, f) + e);
      }
      b.layer = c;
    } else c = b.layer;
    return c;
  }
  function mt(a, b) {
    var c = 0;
    if (-1 === b.layer) {
      for (var d = b.sourceEdges; d.next(); ) {
        var e = d.value,
          f = e.fromVertex;
        e = a.linkMinLength(e);
        c = Math.max(c, mt(a, f) + e);
      }
      b.layer = c;
    } else c = b.layer;
    return c;
  }
  function nt(a, b) {
    if (!b.valid) {
      b.valid = !0;
      for (var c = b.destinationEdges; c.next(); ) nt(a, c.value.toVertex);
      for (c = a.network.vertexes.iterator; c.next(); ) c.value.component = -1;
      for (var d = b.sourceEdgesArrayAccess, e = d.length, f = 0; f < e; f++) {
        var g = d[f],
          h = g.fromVertex,
          k = g.toVertex;
        g = a.linkMinLength(g);
        h.layer - k.layer > g && ct(a, h, 0, -1, !0, !1);
      }
      for (ct(a, b, 1, -1, !0, !0); 0 !== b.component; ) {
        f = 0;
        d = Infinity;
        h = 0;
        k = null;
        for (g = a.network.vertexes.iterator; g.next(); ) {
          var l = g.value;
          if (1 === l.component) {
            var m = 0,
              n = !1,
              p = l.sourceEdgesArrayAccess;
            e = p.length;
            for (var r = 0; r < e; r++) {
              var q = p[r],
                u = q.fromVertex;
              m += 1;
              1 !== u.component &&
                ((f += 1),
                (u = u.layer - l.layer),
                (q = a.linkMinLength(q)),
                (d = Math.min(d, u - q)));
            }
            p = l.destinationEdgesArrayAccess;
            e = p.length;
            for (r = 0; r < e; r++)
              (q = p[r].toVertex), --m, 1 !== q.component ? --f : (n = !0);
            (null === k || m < h) && !n && ((k = l), (h = m));
          }
        }
        if (0 < f) {
          for (c.reset(); c.next(); )
            (e = c.value), 1 === e.component && (e.layer += d);
          b.component = 0;
        } else k.component = 0;
      }
      for (c = a.network.vertexes.iterator; c.next(); ) c.value.component = -1;
      for (ct(a, b, 1, -1, !0, !1); 0 !== b.component; ) {
        d = 0;
        e = Infinity;
        f = 0;
        h = null;
        for (k = a.network.vertexes.iterator; k.next(); )
          if (((g = k.value), 1 === g.component)) {
            l = 0;
            m = !1;
            p = g.sourceEdgesArrayAccess;
            n = p.length;
            for (r = 0; r < n; r++)
              (q = p[r].fromVertex),
                (l += 1),
                1 !== q.component ? (d += 1) : (m = !0);
            p = g.destinationEdgesArrayAccess;
            n = p.length;
            for (r = 0; r < n; r++)
              (q = p[r]),
                (u = q.toVertex),
                --l,
                1 !== u.component &&
                  (--d,
                  (u = g.layer - u.layer),
                  (q = a.linkMinLength(q)),
                  (e = Math.min(e, u - q)));
            (null === h || l > f) && !m && ((h = g), (f = l));
          }
        if (0 > d) {
          for (c.reset(); c.next(); )
            (d = c.value), 1 === d.component && (d.layer -= e);
          b.component = 0;
        } else h.component = 0;
      }
    }
  }
  function Ts(a, b, c) {
    return 90 === a.O
      ? (c && !b.rev) || (!c && b.rev)
        ? 270
        : 90
      : 180 === a.O
      ? (c && !b.rev) || (!c && b.rev)
        ? 0
        : 180
      : 270 === a.O
      ? (c && !b.rev) || (!c && b.rev)
        ? 90
        : 270
      : (c && !b.rev) || (!c && b.rev)
      ? 180
      : 0;
  }
  Ls.prototype.initializeIndices = function () {
    switch (this.pl) {
      default:
      case pt:
        for (var a = this.network.vertexes.iterator; a.next(); ) {
          var b = a.value,
            c = b.layer;
          b.index = this.Hb[c];
          this.Hb[c]++;
        }
        break;
      case Os:
        a = this.network.vertexes.iterator;
        for (b = this.ya; 0 <= b; b--)
          for (a.reset(); a.next(); )
            (c = a.value), c.layer === b && -1 === c.index && qt(this, c);
        break;
      case rt:
        for (a = this.network.vertexes.iterator, b = 0; b <= this.ya; b++)
          for (a.reset(); a.next(); )
            (c = a.value), c.layer === b && -1 === c.index && st(this, c);
    }
  };
  function qt(a, b) {
    var c = b.layer;
    b.index = a.Hb[c];
    a.Hb[c]++;
    b = b.destinationEdgesArrayAccess;
    for (c = !0; c; ) {
      c = !1;
      for (var d = 0; d < b.length - 1; d++) {
        var e = b[d],
          f = b[d + 1];
        e.portFromColOffset > f.portFromColOffset &&
          ((c = !0), (b[d] = f), (b[d + 1] = e));
      }
    }
    for (c = 0; c < b.length; c++)
      (d = b[c]), d.valid && ((d = d.toVertex), -1 === d.index && qt(a, d));
  }
  function st(a, b) {
    var c = b.layer;
    b.index = a.Hb[c];
    a.Hb[c]++;
    b = b.sourceEdgesArrayAccess;
    for (var d = !0; d; )
      for (d = !1, c = 0; c < b.length - 1; c++) {
        var e = b[c],
          f = b[c + 1];
        e.portToColOffset > f.portToColOffset &&
          ((d = !0), (b[c] = f), (b[c + 1] = e));
      }
    for (c = 0; c < b.length; c++)
      (d = b[c]), d.valid && ((d = d.fromVertex), -1 === d.index && st(a, d));
  }
  Ls.prototype.reduceCrossings = function () {
    var a = this.countCrossings(),
      b = Xs(this),
      c,
      d;
    for (c = 0; c < this.Jj; c++) {
      for (d = 0; d <= this.ya; d++) tt(this, d, 1), ut(this, d, 1);
      var e = this.countCrossings();
      e < a && ((a = e), (b = Xs(this)));
      for (d = this.ya; 0 <= d; d--) tt(this, d, -1), ut(this, d, -1);
      e = this.countCrossings();
      e < a && ((a = e), (b = Xs(this)));
    }
    Ys(this, b);
    for (c = 0; c < this.Jj; c++) {
      for (d = 0; d <= this.ya; d++) tt(this, d, 0), ut(this, d, 0);
      e = this.countCrossings();
      e < a && ((a = e), (b = Xs(this)));
      for (d = this.ya; 0 <= d; d--) tt(this, d, 0), ut(this, d, 0);
      e = this.countCrossings();
      e < a && ((a = e), (b = Xs(this)));
    }
    Ys(this, b);
    var f, g, h;
    switch (this.Nk) {
      case vt:
        break;
      case wt:
        for (h = a + 1; (d = this.countCrossings()) < h; )
          for (h = d, c = this.ya; 0 <= c; c--)
            for (g = 0; g <= c; g++) {
              for (f = !0; f; )
                for (f = !1, d = c; d >= g; d--) f = ut(this, d, -1) || f;
              e = this.countCrossings();
              e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
              for (f = !0; f; )
                for (f = !1, d = c; d >= g; d--) f = ut(this, d, 1) || f;
              e = this.countCrossings();
              e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
              for (f = !0; f; )
                for (f = !1, d = g; d <= c; d++) f = ut(this, d, 1) || f;
              e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
              for (f = !0; f; )
                for (f = !1, d = g; d <= c; d++) f = ut(this, d, -1) || f;
              e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
              for (f = !0; f; )
                for (f = !1, d = c; d >= g; d--) f = ut(this, d, 0) || f;
              e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
              for (f = !0; f; )
                for (f = !1, d = g; d <= c; d++) f = ut(this, d, 0) || f;
              e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
            }
        break;
      default:
      case Ps:
        for (c = this.ya, g = 0, h = a + 1; (d = this.countCrossings()) < h; ) {
          h = d;
          for (f = !0; f; )
            for (f = !1, d = c; d >= g; d--) f = ut(this, d, -1) || f;
          e = this.countCrossings();
          e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
          for (f = !0; f; )
            for (f = !1, d = c; d >= g; d--) f = ut(this, d, 1) || f;
          e = this.countCrossings();
          e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
          for (f = !0; f; )
            for (f = !1, d = g; d <= c; d++) f = ut(this, d, 1) || f;
          e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
          for (f = !0; f; )
            for (f = !1, d = g; d <= c; d++) f = ut(this, d, -1) || f;
          e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
          for (f = !0; f; )
            for (f = !1, d = c; d >= g; d--) f = ut(this, d, 0) || f;
          e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
          for (f = !0; f; )
            for (f = !1, d = g; d <= c; d++) f = ut(this, d, 0) || f;
          e >= a ? Ys(this, b) : ((a = e), (b = Xs(this)));
        }
    }
    Ys(this, b);
  };
  function tt(a, b, c) {
    G &&
      (D(b, Ls, "medianBarycenterCrossingReduction:unfixedLayer"),
      D(c, Ls, "medianBarycenterCrossingReduction:direction"));
    var d = Us(a, b),
      e = a.Hb[b],
      f = bt(a, b, c),
      g = at(a, b, c);
    for (c = 0; c < e; c++)
      -1 === g[c] && (g[c] = d[c].column), -1 === f[c] && (f[c] = d[c].column);
    for (var h = !0, k; h; )
      for (h = !1, c = 0; c < e - 1; c++)
        if (f[c + 1] < f[c] || (f[c + 1] === f[c] && g[c + 1] < g[c]))
          (h = !0),
            (k = f[c]),
            (f[c] = f[c + 1]),
            (f[c + 1] = k),
            (k = g[c]),
            (g[c] = g[c + 1]),
            (g[c + 1] = k),
            (k = d[c]),
            (d[c] = d[c + 1]),
            (d[c + 1] = k);
    for (c = f = 0; c < e; c++)
      (k = d[c]),
        (k.index = c),
        (f += a.nodeMinColumnSpace(k, !0)),
        (k.column = f),
        (f += 1),
        (f += a.nodeMinColumnSpace(k, !1));
    Vs(a, b, d);
  }
  function ut(a, b, c) {
    var d = Us(a, b),
      e = a.Hb[b];
    c = Zs(a, b, c);
    var f;
    var g = [];
    for (f = 0; f < e; f++) g[f] = -1;
    var h = [];
    for (f = 0; f < e; f++) h[f] = -1;
    for (var k = !1, l = !0; l; )
      for (l = !1, f = 0; f < e - 1; f++) {
        var m = c[d[f].index * e + d[f + 1].index],
          n = c[d[f + 1].index * e + d[f].index],
          p = 0,
          r = 0,
          q = d[f].column,
          u = d[f + 1].column,
          w = a.nodeMinColumnSpace(d[f], !0),
          y = a.nodeMinColumnSpace(d[f], !1),
          z = a.nodeMinColumnSpace(d[f + 1], !0),
          B = a.nodeMinColumnSpace(d[f + 1], !1);
        w = q - w + z;
        y = u - y + B;
        var C = d[f].sourceEdges.iterator;
        for (C.reset(); C.next(); )
          if (((z = C.value), (B = z.fromVertex), z.valid && B.layer === b)) {
            for (z = 0; d[z] !== B; ) z++;
            z < f && ((p += 2 * (f - z)), (r += 2 * (f + 1 - z)));
            z === f + 1 && (p += 1);
            z > f + 1 && ((p += 4 * (z - f)), (r += 4 * (z - (f + 1))));
          }
        C = d[f].destinationEdges.iterator;
        for (C.reset(); C.next(); )
          if (((z = C.value), (B = z.toVertex), z.valid && B.layer === b)) {
            for (z = 0; d[z] !== B; ) z++;
            z === f + 1 && (r += 1);
          }
        C = d[f + 1].sourceEdges.iterator;
        for (C.reset(); C.next(); )
          if (((z = C.value), (B = z.fromVertex), z.valid && B.layer === b)) {
            for (z = 0; d[z] !== B; ) z++;
            z < f && ((p += 2 * (f + 1 - z)), (r += 2 * (f - z)));
            z === f && (r += 1);
            z > f + 1 && ((p += 4 * (z - (f + 1))), (r += 4 * (z - f)));
          }
        C = d[f + 1].destinationEdges.iterator;
        for (C.reset(); C.next(); )
          if (((z = C.value), (B = z.toVertex), z.valid && B.layer === b)) {
            for (z = 0; d[z] !== B; ) z++;
            z === f && (p += 1);
          }
        z = B = 0;
        C = g[d[f].index];
        var E = h[d[f].index],
          J = g[d[f + 1].index],
          S = h[d[f + 1].index];
        -1 !== C && ((B += Math.abs(C - q)), (z += Math.abs(C - y)));
        -1 !== E && ((B += Math.abs(E - q)), (z += Math.abs(E - y)));
        -1 !== J && ((B += Math.abs(J - u)), (z += Math.abs(J - w)));
        -1 !== S && ((B += Math.abs(S - u)), (z += Math.abs(S - w)));
        if (
          r < p - 0.5 ||
          (r === p && n < m - 0.5) ||
          (r === p && n === m && z < B - 0.5)
        )
          (l = k = !0),
            (d[f].column = y),
            (d[f + 1].column = w),
            (m = d[f]),
            (d[f] = d[f + 1]),
            (d[f + 1] = m);
      }
    for (f = 0; f < e; f++) d[f].index = f;
    Vs(a, b, d);
    return k;
  }
  Ls.prototype.straightenAndPack = function () {
    var a = 0 !== (this.hg & 1);
    var b = 0 !== (this.hg & xt);
    1e3 < this.network.edges.count && b && (a = !1);
    if (a) {
      var c = [];
      for (b = 0; b <= this.ya; b++) c[b] = 0;
      for (var d, e = this.network.vertexes.iterator; e.next(); ) {
        var f = e.value;
        b = f.layer;
        d = f.column;
        f = this.nodeMinColumnSpace(f, !1);
        c[b] = Math.max(c[b], d + f);
      }
      for (e.reset(); e.next(); )
        (f = e.value),
          (b = f.layer),
          (d = f.column),
          (f.column = ((8 * (this.Ja - c[b])) >> 1) + 8 * d);
      this.Ja *= 8;
    }
    if (0 !== (this.hg & 2))
      for (c = !0; c; ) {
        c = !1;
        for (b = this.yc + 1; b <= this.ya; b++) c = yt(this, b, 1) || c;
        for (b = this.yc - 1; 0 <= b; b--) c = yt(this, b, -1) || c;
        c = yt(this, this.yc, 0) || c;
      }
    if (0 !== (this.hg & 4)) {
      for (b = this.yc + 1; b <= this.ya; b++) zt(this, b, 1);
      for (b = this.yc - 1; 0 <= b; b--) zt(this, b, -1);
      zt(this, this.yc, 0);
    }
    a && (At(this, -1), At(this, 1));
    if (0 !== (this.hg & 2))
      for (c = !0; c; ) {
        c = !1;
        c = yt(this, this.yc, 0) || c;
        for (b = this.yc + 1; b <= this.ya; b++) c = yt(this, b, 0) || c;
        for (b = this.yc - 1; 0 <= b; b--) c = yt(this, b, 0) || c;
      }
  };
  function yt(a, b, c) {
    G &&
      (D(b, Ls, "bendStraighten:unfixedLayer"),
      D(c, Ls, "bendStraighten:direction"));
    for (var d = !1; Bt(a, b, c); ) d = !0;
    return d;
  }
  function Bt(a, b, c) {
    G &&
      (D(b, Ls, "shiftbendStraighten:unfixedLayer"),
      D(c, Ls, "shiftbendStraighten:direction"));
    var d,
      e = Us(a, b),
      f = a.Hb[b],
      g = at(a, b, -1);
    if (0 < c) for (d = 0; d < f; d++) g[d] = -1;
    var h = at(a, b, 1);
    if (0 > c) for (d = 0; d < f; d++) h[d] = -1;
    for (var k = !1, l = !0; l; )
      for (l = !1, d = 0; d < f; d++) {
        var m = e[d].column,
          n = a.nodeMinColumnSpace(e[d], !0),
          p = a.nodeMinColumnSpace(e[d], !1),
          r = 0;
        0 > d - 1 ||
        m - e[d - 1].column - 1 > n + a.nodeMinColumnSpace(e[d - 1], !1)
          ? (r = m - 1)
          : (r = m);
        n =
          d + 1 >= f ||
          e[d + 1].column - m - 1 > p + a.nodeMinColumnSpace(e[d + 1], !0)
            ? m + 1
            : m;
        var q = (p = 0),
          u = 0;
        if (0 >= c)
          for (var w = e[d].sourceEdges.iterator; w.next(); ) {
            var y = w.value;
            var z = y.fromVertex;
            if (y.valid && z.layer !== b) {
              var B = Ws(y);
              var C = y.portFromColOffset;
              y = y.portToColOffset;
              z = z.column;
              p += (Math.abs(m + y - (z + C)) + 1) * B;
              q += (Math.abs(r + y - (z + C)) + 1) * B;
              u += (Math.abs(n + y - (z + C)) + 1) * B;
            }
          }
        if (0 <= c)
          for (w = e[d].destinationEdges.iterator; w.next(); )
            (y = w.value),
              (z = y.toVertex),
              y.valid &&
                z.layer !== b &&
                ((B = Ws(y)),
                (C = y.portFromColOffset),
                (y = y.portToColOffset),
                (z = z.column),
                (p += (Math.abs(m + C - (z + y)) + 1) * B),
                (q += (Math.abs(r + C - (z + y)) + 1) * B),
                (u += (Math.abs(n + C - (z + y)) + 1) * B));
        y = C = B = 0;
        w = g[e[d].index];
        z = h[e[d].index];
        -1 !== w &&
          ((B += Math.abs(w - m)),
          (C += Math.abs(w - r)),
          (y += Math.abs(w - n)));
        -1 !== z &&
          ((B += Math.abs(z - m)),
          (C += Math.abs(z - r)),
          (y += Math.abs(z - n)));
        if (q < p || (q === p && C < B)) (l = k = !0), (e[d].column = r);
        else if (u < p || (u === p && y < B)) (l = k = !0), (e[d].column = n);
      }
    Vs(a, b, e);
    a.normalize();
    return k;
  }
  function zt(a, b, c) {
    G &&
      (D(b, Ls, "medianStraighten:unfixedLayer"),
      D(c, Ls, "medianStraighten:direction"));
    var d = Us(a, b),
      e = a.Hb[b],
      f = bt(a, b, c),
      g = [];
    for (c = 0; c < e; c++) g[c] = f[c];
    for (f = !0; f; )
      for (f = !1, c = 0; c < e; c++) {
        var h = d[c].column,
          k = a.nodeMinColumnSpace(d[c], !0),
          l = a.nodeMinColumnSpace(d[c], !1),
          m = 0;
        if (-1 === g[c])
          if (0 === c && c === e - 1) m = h;
          else if (0 === c) {
            var n = d[c + 1].column;
            n - h === l + a.nodeMinColumnSpace(d[c + 1], !0)
              ? (m = h - 1)
              : (m = h);
          } else
            c === e - 1
              ? ((n = d[c - 1].column),
                (m =
                  h - n === k + a.nodeMinColumnSpace(d[c - 1], !1) ? h + 1 : h))
              : ((n = d[c - 1].column),
                (k = n + a.nodeMinColumnSpace(d[c - 1], !1) + k + 1),
                (n = d[c + 1].column),
                (l = n - a.nodeMinColumnSpace(d[c + 1], !0) - l - 1),
                (m = ((k + l) / 2) | 0));
        else
          0 === c && c === e - 1
            ? (m = g[c])
            : 0 === c
            ? ((n = d[c + 1].column),
              (l = n - a.nodeMinColumnSpace(d[c + 1], !0) - l - 1),
              (m = Math.min(g[c], l)))
            : c === e - 1
            ? ((n = d[c - 1].column),
              (k = n + a.nodeMinColumnSpace(d[c - 1], !1) + k + 1),
              (m = Math.max(g[c], k)))
            : ((n = d[c - 1].column),
              (k = n + a.nodeMinColumnSpace(d[c - 1], !1) + k + 1),
              (n = d[c + 1].column),
              (l = n - a.nodeMinColumnSpace(d[c + 1], !0) - l - 1),
              k < g[c] && g[c] < l
                ? (m = g[c])
                : k >= g[c]
                ? (m = k)
                : l <= g[c] && (m = l));
        m !== h && ((f = !0), (d[c].column = m));
      }
    Vs(a, b, d);
    a.normalize();
  }
  function Ct(a, b) {
    G && (D(b, Ls, "packAux:column"), D(1, Ls, "packAux:direction"));
    for (var c = !0, d = a.network.vertexes.iterator; d.next(); ) {
      var e = d.value,
        f = a.nodeMinColumnSpace(e, !0),
        g = a.nodeMinColumnSpace(e, !1);
      if (e.column - f <= b && e.column + g >= b) {
        c = !1;
        break;
      }
    }
    a = !1;
    if (c)
      for (d.reset(); d.next(); )
        (c = d.value), c.column > b && (--c.column, (a = !0));
    return a;
  }
  function Dt(a, b) {
    G && (D(b, Ls, "tightPackAux:column"), D(1, Ls, "tightPackAux:direction"));
    var c = b + 1;
    var d,
      e = [],
      f = [];
    for (d = 0; d <= a.ya; d++) (e[d] = !1), (f[d] = !1);
    for (var g = a.network.vertexes.iterator; g.next(); ) {
      d = g.value;
      var h = d.column - a.nodeMinColumnSpace(d, !0),
        k = d.column + a.nodeMinColumnSpace(d, !1);
      h <= b && k >= b && (e[d.layer] = !0);
      h <= c && k >= c && (f[d.layer] = !0);
    }
    h = !0;
    c = !1;
    for (d = 0; d <= a.ya; d++) h = h && !(e[d] && f[d]);
    if (h)
      for (g.reset(); g.next(); )
        (a = g.value), a.column > b && (--a.column, (c = !0));
    return c;
  }
  function At(a, b) {
    G && D(b, Ls, "componentPack:direction");
    for (var c = 0; c <= a.Ja; c++) for (; Ct(a, c); );
    a.normalize();
    for (c = 0; c < a.Ja; c++) for (; Dt(a, c); );
    a.normalize();
    var d;
    if (0 < b)
      for (c = 0; c <= a.Ja; c++) {
        var e = Xs(a);
        var f = $s(a);
        for (d = f + 1; f < d; ) {
          d = f;
          Et(a, c, 1);
          var g = $s(a);
          g > f ? Ys(a, e) : g < f && ((f = g), (e = Xs(a)));
        }
      }
    if (0 > b)
      for (c = a.Ja; 0 <= c; c--)
        for (e = Xs(a), f = $s(a), d = f + 1; f < d; )
          (d = f),
            Et(a, c, -1),
            (g = $s(a)),
            g > f ? Ys(a, e) : g < f && ((f = g), (e = Xs(a)));
    a.normalize();
  }
  function Et(a, b, c) {
    a.Kc = 0;
    for (var d = a.network.vertexes.iterator; d.next(); )
      d.value.component = -1;
    if (0 < c)
      for (d.reset(); d.next(); ) {
        var e = d.value;
        e.column - a.nodeMinColumnSpace(e, !0) <= b && (e.component = a.Kc);
      }
    if (0 > c)
      for (d.reset(); d.next(); )
        (e = d.value),
          e.column + a.nodeMinColumnSpace(e, !1) >= b && (e.component = a.Kc);
    a.Kc++;
    for (d.reset(); d.next(); )
      (b = d.value), -1 === b.component && (dt(a, b, a.Kc, -1, !0, !0), a.Kc++);
    var f;
    b = [];
    for (f = 0; f < a.Kc * a.Kc; f++) b[f] = !1;
    e = [];
    for (f = 0; f < (a.ya + 1) * (a.Ja + 1); f++) e[f] = -1;
    for (d.reset(); d.next(); ) {
      f = d.value;
      for (
        var g = f.layer,
          h = Math.max(0, f.column - a.nodeMinColumnSpace(f, !0)),
          k = Math.min(a.Ja, f.column + a.nodeMinColumnSpace(f, !1));
        h <= k;
        h++
      )
        e[g * (a.Ja + 1) + h] = f.component;
    }
    for (f = 0; f <= a.ya; f++) {
      if (0 < c)
        for (g = 0; g < a.Ja; g++)
          -1 !== e[f * (a.Ja + 1) + g] &&
            -1 !== e[f * (a.Ja + 1) + g + 1] &&
            e[f * (a.Ja + 1) + g] !== e[f * (a.Ja + 1) + g + 1] &&
            (b[e[f * (a.Ja + 1) + g] * a.Kc + e[f * (a.Ja + 1) + g + 1]] = !0);
      if (0 > c)
        for (g = a.Ja; 0 < g; g--)
          -1 !== e[f * (a.Ja + 1) + g] &&
            -1 !== e[f * (a.Ja + 1) + g - 1] &&
            e[f * (a.Ja + 1) + g] !== e[f * (a.Ja + 1) + g - 1] &&
            (b[e[f * (a.Ja + 1) + g] * a.Kc + e[f * (a.Ja + 1) + g - 1]] = !0);
    }
    e = [];
    for (f = 0; f < a.Kc; f++) e[f] = !0;
    g = [];
    for (g.push(0); 0 !== g.length; )
      if (((k = g[g.length - 1]), g.pop(), e[k]))
        for (e[k] = !1, f = 0; f < a.Kc; f++)
          b[k * a.Kc + f] && g.splice(0, 0, f);
    if (0 < c)
      for (d.reset(); d.next(); ) (a = d.value), e[a.component] && --a.column;
    if (0 > c)
      for (d.reset(); d.next(); )
        (c = d.value), e[c.component] && (c.column += 1);
  }
  Ls.prototype.commitLayout = function () {
    if (this.setsPortSpots)
      for (
        var a = Ss(this, !0), b = Ss(this, !1), c = this.network.edges.iterator;
        c.next();

      ) {
        var d = c.value.link;
        null !== d && ((d.fromSpot = a), (d.toSpot = b));
      }
    this.commitNodes();
    this.fv();
    this.isRouting && this.commitLinks();
  };
  function Ss(a, b) {
    return 270 === a.O
      ? b
        ? od
        : rd
      : 90 === a.O
      ? b
        ? rd
        : od
      : 180 === a.O
      ? b
        ? pd
        : qd
      : b
      ? qd
      : pd;
  }
  Ls.prototype.commitNodes = function () {
    this.ce = [];
    this.Fd = [];
    this.Ed = [];
    this.Qa = [];
    for (var a = 0; a <= this.ya; a++)
      (this.ce[a] = 0), (this.Fd[a] = 0), (this.Ed[a] = 0), (this.Qa[a] = 0);
    for (a = this.network.vertexes.iterator; a.next(); ) {
      var b = a.value,
        c = b.layer;
      this.ce[c] = Math.max(this.ce[c], this.nodeMinLayerSpace(b, !0));
      this.Fd[c] = Math.max(this.Fd[c], this.nodeMinLayerSpace(b, !1));
    }
    b = 0;
    c = this.de;
    for (var d = 0; d <= this.ya; d++) {
      var e = c;
      0 >= this.ce[d] + this.Fd[d] && (e = 0);
      0 < d && (b += e / 2);
      90 === this.O || 0 === this.O
        ? ((b += this.Fd[d]), (this.Ed[d] = b), (b += this.ce[d]))
        : ((b += this.ce[d]), (this.Ed[d] = b), (b += this.Fd[d]));
      d < this.ya && (b += e / 2);
      this.Qa[d] = b;
    }
    c = b;
    b = this.arrangementOrigin;
    for (d = 0; d <= this.ya; d++)
      270 === this.O
        ? (this.Ed[d] = b.y + this.Ed[d])
        : 90 === this.O
        ? ((this.Ed[d] = b.y + c - this.Ed[d]), (this.Qa[d] = c - this.Qa[d]))
        : 180 === this.O
        ? (this.Ed[d] = b.x + this.Ed[d])
        : ((this.Ed[d] = b.x + c - this.Ed[d]), (this.Qa[d] = c - this.Qa[d]));
    a.reset();
    for (c = d = Infinity; a.next(); ) {
      e = a.value;
      var f = e.layer,
        g = e.column | 0;
      if (270 === this.O || 90 === this.O) {
        var h = b.x + this.gc * g;
        f = this.Ed[f];
      } else (h = this.Ed[f]), (f = b.y + this.gc * g);
      e.centerX = h;
      e.centerY = f;
      d = Math.min(e.x, d);
      c = Math.min(e.y, c);
    }
    d = b.x - d;
    b = b.y - c;
    this.$c = new K(d, b);
    for (a.reset(); a.next(); )
      (c = a.value), (c.x += d), (c.y += b), c.commit();
  };
  Ls.prototype.fv = function () {
    for (var a = 0, b = this.de, c = 0; c <= this.ya; c++)
      (a += this.ce[c]), (a += this.Fd[c]);
    a += this.ya * b;
    b = [];
    c = this.gc * this.Ja;
    for (var d = this.maxLayer; 0 <= d; d--)
      270 === this.O
        ? 0 === d
          ? b.push(new M(0, 0, c, Math.abs(this.Qa[0])))
          : b.push(
              new M(0, this.Qa[d - 1], c, Math.abs(this.Qa[d - 1] - this.Qa[d]))
            )
        : 90 === this.O
        ? 0 === d
          ? b.push(new M(0, this.Qa[0], c, Math.abs(this.Qa[0] - a)))
          : b.push(
              new M(0, this.Qa[d], c, Math.abs(this.Qa[d - 1] - this.Qa[d]))
            )
        : 180 === this.O
        ? 0 === d
          ? b.push(new M(0, 0, Math.abs(this.Qa[0]), c))
          : b.push(
              new M(this.Qa[d - 1], 0, Math.abs(this.Qa[d - 1] - this.Qa[d]), c)
            )
        : 0 === d
        ? b.push(new M(this.Qa[0], 0, Math.abs(this.Qa[0] - a), c))
        : b.push(
            new M(this.Qa[d], 0, Math.abs(this.Qa[d - 1] - this.Qa[d]), c)
          );
    this.commitLayers(b, this.$c);
  };
  Ls.prototype.commitLayers = function () {};
  Ls.prototype.commitLinks = function () {
    for (var a = this.network.edges.iterator, b; a.next(); )
      (b = a.value.link), null !== b && (b.Qh(), b.hk(), b.Df());
    for (a.reset(); a.next(); ) (b = a.value.link), null !== b && b.Ag();
    for (a.reset(); a.next(); ) {
      var c = a.value;
      b = c.link;
      if (null !== b) {
        b.Qh();
        var d = b,
          e = d.fromNode,
          f = d.toNode,
          g = d.fromPort,
          h = d.toPort;
        if (null !== e) {
          var k = e.findVisibleNode();
          null !== k && k !== e && ((e = k), (g = k.port));
        }
        null !== f &&
          ((k = f.findVisibleNode()),
          null !== k && k !== f && ((f = k), (h = k.port)));
        var l = b.computeSpot(!0, g);
        k = b.computeSpot(!1, h);
        var m = c.fromVertex,
          n = c.toVertex;
        if (c.valid) {
          if (b.curve === kg && 4 === b.pointsCount)
            if (m.column === n.column)
              (c = b.getLinkPoint(e, g, l, !0, !1, f, h)),
                (g = b.getLinkPoint(f, h, k, !1, !1, e, g)),
                c.s() || c.set(e.actualBounds.center),
                g.s() || g.set(f.actualBounds.center),
                b.hk(),
                b.Bf(c.x, c.y),
                b.Bf((2 * c.x + g.x) / 3, (2 * c.y + g.y) / 3),
                b.Bf((c.x + 2 * g.x) / 3, (c.y + 2 * g.y) / 3),
                b.Bf(g.x, g.y);
            else {
              var p = !1,
                r = !1;
              null !== g && l === Ec && (p = !0);
              null !== h && k === Ec && (r = !0);
              if (p || r) {
                var q = b.i(0).x;
                c = b.i(0).y;
                m = b.i(3).x;
                d = b.i(3).y;
                if (p) {
                  if (90 === this.O || 270 === this.O) {
                    p = q;
                    var u = (c + d) / 2;
                  } else (p = (q + m) / 2), (u = c);
                  b.P(1, p, u);
                  l = b.getLinkPoint(e, g, l, !0, !1, f, h);
                  l.s() || l.set(e.actualBounds.center);
                  b.P(0, l.x, l.y);
                }
                r &&
                  (90 === this.O || 270 === this.O
                    ? ((l = m), (c = (c + d) / 2))
                    : ((l = (q + m) / 2), (c = d)),
                  b.P(2, l, c),
                  (e = b.getLinkPoint(f, h, k, !1, !1, e, g)),
                  e.s() || e.set(f.actualBounds.center),
                  b.P(3, e.x, e.y));
              }
            }
          b.Df();
        } else if (m.layer === n.layer) b.Df();
        else {
          p = r = !1;
          u = this.de;
          q = b.firstPickIndex + 1;
          if (b.isOrthogonal) {
            p = !0;
            var w = b.pointsCount;
            4 < w && b.points.removeRange(2, w - 3);
          } else if (b.curve === kg)
            (r = !0),
              (w = b.pointsCount),
              4 < w && b.points.removeRange(2, w - 3),
              4 === w && (q = 2);
          else {
            w = b.pointsCount;
            var y = l === Ec,
              z = k === Ec;
            2 < w && y && z
              ? b.points.removeRange(1, w - 2)
              : 3 < w && y && !z
              ? b.points.removeRange(1, w - 3)
              : 3 < w && !y && z
              ? b.points.removeRange(2, w - 2)
              : 4 < w && !y && !z && b.points.removeRange(2, w - 3);
          }
          if (c.rev) {
            for (; null !== n && m !== n; ) {
              var B = (w = null);
              for (
                y = n.sourceEdges.iterator;
                y.next() &&
                ((z = y.value),
                z.link !== c.link ||
                  ((w = z.fromVertex), (B = z.toVertex), null !== w.node));

              );
              if (null === w) break;
              if (w !== m) {
                y = b.i(q - 1).x;
                z = b.i(q - 1).y;
                var C = w.centerX;
                var E = w.centerY;
                if (p)
                  180 === this.O || 0 === this.O
                    ? q === b.firstPickIndex + 1
                      ? (b.l(q++, y, z), b.l(q++, y, E))
                      : (null !== B ? B.centerY : z) !== E &&
                        ((B = this.Qa[w.layer - 1] + this.$c.x),
                        b.l(q++, B, z),
                        b.l(q++, B, E))
                    : q === b.firstPickIndex + 1
                    ? (b.l(q++, y, z), b.l(q++, C, z))
                    : (null !== B ? B.centerX : y) !== C &&
                      ((B = this.Qa[w.layer - 1] + this.$c.y),
                      b.l(q++, y, B),
                      b.l(q++, C, B));
                else if (q === b.firstPickIndex + 1) {
                  B = Math.max(10, this.ce[n.layer]);
                  var J = Math.max(10, this.Fd[n.layer]);
                  if (r)
                    180 === this.O
                      ? C <= n.bounds.x
                        ? ((n = n.bounds.x),
                          b.l(q++, n - B, E),
                          b.l(q++, n, E),
                          b.l(q++, n + J, E))
                        : (b.l(q++, C - B, E),
                          b.l(q++, C, E),
                          b.l(q++, C + J, E))
                      : 90 === this.O
                      ? E >= n.bounds.bottom
                        ? ((n = n.bounds.y + n.bounds.height),
                          b.l(q++, C, n + J),
                          b.l(q++, C, n),
                          b.l(q++, C, n - B))
                        : (b.l(q++, C, E + J),
                          b.l(q++, C, E),
                          b.l(q++, C, E - B))
                      : 270 === this.O
                      ? E <= n.bounds.y
                        ? ((n = n.bounds.y),
                          b.l(q++, C, n - B),
                          b.l(q++, C, n),
                          b.l(q++, C, n + J))
                        : (b.l(q++, C, E - B),
                          b.l(q++, C, E),
                          b.l(q++, C, E + J))
                      : 0 === this.O &&
                        (C >= n.bounds.right
                          ? ((n = n.bounds.x + n.bounds.width),
                            b.l(q++, n + J, E),
                            b.l(q++, n, E),
                            b.l(q++, n - B, E))
                          : (b.l(q++, C + J, E),
                            b.l(q++, C, E),
                            b.l(q++, C - B, E)));
                  else {
                    b.l(q++, y, z);
                    var S = 0;
                    if (180 === this.O || 0 === this.O) {
                      if (
                        180 === this.O ? C >= n.bounds.right : C <= n.bounds.x
                      )
                        S = (0 === this.O ? -B : J) / 2;
                      b.l(q++, y + S, E);
                    } else {
                      if (
                        270 === this.O ? E >= n.bounds.bottom : E <= n.bounds.y
                      )
                        S = (90 === this.O ? -B : J) / 2;
                      b.l(q++, C, z + S);
                    }
                    b.l(q++, C, E);
                  }
                } else
                  (B = Math.max(10, this.ce[w.layer])),
                    (J = Math.max(10, this.Fd[w.layer])),
                    r
                      ? 180 === this.O
                        ? (b.l(q++, C - B - u, E),
                          b.l(q++, Math.min(C - B + u / 2, C), E),
                          b.l(q++, C, E),
                          b.l(q++, C, E),
                          b.l(q++, Math.max(C + J - u / 2, C), E),
                          b.l(q++, C + J + u, E))
                        : 90 === this.O
                        ? (b.l(q++, C, E + J + u),
                          b.l(q++, C, Math.max(E + J - u / 2, E)),
                          b.l(q++, C, E),
                          b.l(q++, C, E),
                          b.l(q++, C, Math.min(E - B + u / 2, E)),
                          b.l(q++, C, E - B - u))
                        : 270 === this.O
                        ? (b.l(q++, C, E - B - u),
                          b.l(q++, C, Math.min(E - B + u / 2, E)),
                          b.l(q++, C, E),
                          b.l(q++, C, E),
                          b.l(q++, C, Math.max(E + J - u / 2, E)),
                          b.l(q++, C, E + J + u))
                        : (b.l(q++, C + J + u, E),
                          b.l(q++, Math.max(C + J - u / 2, C), E),
                          b.l(q++, C, E),
                          b.l(q++, C, E),
                          b.l(q++, Math.min(C - B + u / 2, C), E),
                          b.l(q++, C - B - u, E))
                      : b.l(q++, C, E);
              }
              n = w;
            }
            if (null === h || l !== Ec || p)
              if (
                ((y = b.i(q - 1).x),
                (z = b.i(q - 1).y),
                (C = b.i(q).x),
                (E = b.i(q).y),
                p)
              )
                (u = this.Fd[m.layer]),
                  180 === this.O || 0 === this.O
                    ? ((p = z),
                      p >= m.bounds.y &&
                        p <= m.bounds.bottom &&
                        (180 === this.O
                          ? C >= m.bounds.x
                          : C <= m.bounds.right) &&
                        ((n = m.centerX + (180 === this.O ? -u : u)),
                        p < m.bounds.y + m.bounds.height / 2
                          ? (p = m.bounds.y - this.gc / 2)
                          : (p = m.bounds.bottom + this.gc / 2),
                        b.l(q++, n, z),
                        b.l(q++, n, p)),
                      b.l(q++, C, p))
                    : ((p = y),
                      p >= m.bounds.x &&
                        p <= m.bounds.right &&
                        (270 === this.O
                          ? E >= m.bounds.y
                          : E <= m.bounds.bottom) &&
                        ((n = m.centerY + (270 === this.O ? -u : u)),
                        p < m.bounds.x + m.bounds.width / 2
                          ? (p = m.bounds.x - this.gc / 2)
                          : (p = m.bounds.right + this.gc / 2),
                        b.l(q++, y, n),
                        b.l(q++, p, n)),
                      b.l(q++, p, E)),
                  b.l(q++, C, E);
              else if (r)
                (B = Math.max(10, this.ce[m.layer])),
                  (J = Math.max(10, this.Fd[m.layer])),
                  180 === this.O && C >= m.bounds.x
                    ? ((n = m.bounds.x + m.bounds.width),
                      b.P(q - 2, n, z),
                      b.P(q - 1, n + J, z))
                    : 90 === this.O && E <= m.bounds.bottom
                    ? ((n = m.bounds.y), b.P(q - 2, y, n), b.P(q - 1, y, n - B))
                    : 270 === this.O && E >= m.bounds.y
                    ? ((n = m.bounds.y + m.bounds.height),
                      b.P(q - 2, y, n),
                      b.P(q - 1, y, n + J))
                    : 0 === this.O &&
                      C <= m.bounds.right &&
                      ((n = m.bounds.x),
                      b.P(q - 2, n, z),
                      b.P(q - 1, n - B, z));
              else {
                B = Math.max(10, this.ce[m.layer]);
                J = Math.max(10, this.Fd[m.layer]);
                p = 0;
                if (180 === this.O || 0 === this.O) {
                  if (180 === this.O ? C <= m.bounds.x : C >= m.bounds.right)
                    p = (0 === this.O ? J : -B) / 2;
                  b.l(q++, C + p, z);
                } else {
                  if (270 === this.O ? E <= m.bounds.y : E >= m.bounds.bottom)
                    p = (90 === this.O ? J : -B) / 2;
                  b.l(q++, y, E + p);
                }
                b.l(q++, C, E);
              }
          } else {
            for (; null !== m && m !== n; ) {
              B = w = null;
              for (
                m = m.destinationEdges.iterator;
                m.next() &&
                ((y = m.value),
                y.link !== c.link ||
                  ((w = y.toVertex),
                  (B = y.fromVertex),
                  null !== B.node && (B = null),
                  null !== w.node));

              );
              if (null === w) break;
              w !== n &&
                ((y = b.i(q - 1).x),
                (z = b.i(q - 1).y),
                (C = w.centerX),
                (E = w.centerY),
                p
                  ? 180 === this.O || 0 === this.O
                    ? (null !== B ? B.centerY : z) !== E &&
                      ((B = this.Qa[w.layer] + this.$c.x),
                      q === b.firstPickIndex + 1 &&
                        (B = 0 === this.O ? Math.max(B, y) : Math.min(B, y)),
                      b.l(q++, B, z),
                      b.l(q++, B, E))
                    : (null !== B ? B.centerX : y) !== C &&
                      ((B = this.Qa[w.layer] + this.$c.y),
                      q === b.firstPickIndex + 1 &&
                        (B = 90 === this.O ? Math.max(B, z) : Math.min(B, z)),
                      b.l(q++, y, B),
                      b.l(q++, C, B))
                  : ((B = Math.max(10, this.ce[w.layer])),
                    (J = Math.max(10, this.Fd[w.layer])),
                    r
                      ? 180 === this.O
                        ? (b.l(q++, C + J + u, E),
                          b.l(q++, Math.max(C + J - u / 2, C), E),
                          b.l(q++, C, E),
                          b.l(q++, C, E),
                          b.l(q++, Math.min(C - B + u / 2, C), E),
                          b.l(q++, C - B - u, E))
                        : 90 === this.O
                        ? (b.l(q++, C, E - B - u),
                          b.l(q++, C, Math.min(E - B + u / 2, E)),
                          b.l(q++, C, E),
                          b.l(q++, C, E),
                          b.l(q++, C, Math.max(E + J - u / 2, E)),
                          b.l(q++, C, E + J + u))
                        : 270 === this.O
                        ? (b.l(q++, C, E + J + u),
                          b.l(q++, C, Math.max(E + J - u / 2, E)),
                          b.l(q++, C, E),
                          b.l(q++, C, E),
                          b.l(q++, C, Math.min(E - B + u / 2, E)),
                          b.l(q++, C, E - B - u))
                        : (b.l(q++, C - B - u, E),
                          b.l(q++, Math.min(C - B + u / 2, C), E),
                          b.l(q++, C, E),
                          b.l(q++, C, E),
                          b.l(q++, Math.max(C + J - u / 2, C), E),
                          b.l(q++, C + J + u, E))
                      : 180 === this.O
                      ? (b.l(q++, C + J, E), b.l(q++, C - B, E))
                      : 90 === this.O
                      ? (b.l(q++, C, E - B), b.l(q++, C, E + J))
                      : 270 === this.O
                      ? (b.l(q++, C, E + J), b.l(q++, C, E - B))
                      : (b.l(q++, C - B, E), b.l(q++, C + J, E))));
              m = w;
            }
            p &&
              ((y = b.i(q - 1).x),
              (z = b.i(q - 1).y),
              (C = b.i(q).x),
              (E = b.i(q).y),
              180 === this.O || 0 === this.O
                ? z !== E &&
                  ((B =
                    0 === this.O
                      ? Math.min(
                          Math.max((C + y) / 2, this.Qa[n.layer] + this.$c.x),
                          C
                        )
                      : Math.max(
                          Math.min((C + y) / 2, this.Qa[n.layer] + this.$c.x),
                          C
                        )),
                  b.l(q++, B, z),
                  b.l(q++, B, E))
                : y !== C &&
                  ((B =
                    90 === this.O
                      ? Math.min(
                          Math.max((E + z) / 2, this.Qa[n.layer] + this.$c.y),
                          E
                        )
                      : Math.max(
                          Math.min((E + z) / 2, this.Qa[n.layer] + this.$c.y),
                          E
                        )),
                  b.l(q++, y, B),
                  b.l(q++, C, B)));
          }
          null !== d &&
            r &&
            (null !== g &&
              (l === Ec &&
                ((l = b.i(0)),
                (d = b.i(2)),
                l.D(d) || b.P(1, (l.x + d.x) / 2, (l.y + d.y) / 2)),
              (l = b.getLinkPoint(e, g, Ec, !0, !1, f, h)),
              l.s() || l.set(e.actualBounds.center),
              b.P(0, l.x, l.y)),
            null !== h &&
              (k === Ec &&
                ((k = b.i(b.pointsCount - 1)),
                (l = b.i(b.pointsCount - 3)),
                k.D(l) ||
                  b.P(b.pointsCount - 2, (k.x + l.x) / 2, (k.y + l.y) / 2)),
              (e = b.getLinkPoint(f, h, Ec, !1, !1, e, g)),
              e.s() || e.set(f.actualBounds.center),
              b.P(b.pointsCount - 1, e.x, e.y)));
          b.Df();
          c.commit();
        }
      }
    }
    this.avoidOrthogonalOverlaps();
  };
  Ls.prototype.avoidOrthogonalOverlaps = function () {
    if (!(0 >= this.linkSpacing)) {
      for (var a = new H(), b = this.network.edges.iterator; b.next(); ) {
        var c = b.value.link;
        null !== c && c.isOrthogonal && !a.contains(c) && a.add(c);
      }
      if (0 < a.count)
        if (90 === this.O || 270 === this.O) {
          b = 0;
          c = [];
          for (a = a.iterator; a.next(); ) {
            var d = a.value;
            if (null !== d && d.isOrthogonal)
              for (var e = 2; e < d.pointsCount - 3; e++) {
                var f = d.i(e);
                var g = d.i(e + 1);
                if (this.C(f.y, g.y) && !this.C(f.x, g.x)) {
                  var h = new Ft();
                  h.layer = Math.floor(f.y / 2);
                  var k = d.i(0),
                    l = d.i(d.pointsCount - 1);
                  h.first = k.x * k.x + k.y;
                  h.fc = l.x * l.x + l.y;
                  h.nd = Math.min(f.x, g.x);
                  h.Cc = Math.max(f.x, g.x);
                  h.index = e;
                  h.link = d;
                  if (e + 2 < d.pointsCount) {
                    k = d.i(e - 1);
                    l = d.i(e + 2);
                    var m = 0;
                    k.y < f.y
                      ? (m = l.y < f.y ? 3 : f.x < g.x ? 2 : 1)
                      : k.y > f.y && (m = l.y > f.y ? 0 : g.x < f.x ? 2 : 1);
                    h.j = m;
                  }
                  c.push(h);
                }
              }
          }
          if (1 < c.length)
            for (c.sort(this.Dy), a = 0; a < c.length; ) {
              f = c[a].layer;
              for (d = a + 1; d < c.length && c[d].layer === f; ) d++;
              if (1 < d - a)
                for (f = a; f < d; ) {
                  g = c[f].Cc;
                  for (e = a + 1; e < d && c[e].nd < g; )
                    (g = Math.max(g, c[e].Cc)), e++;
                  g = e - f;
                  if (1 < g) {
                    this.ej(c, this.bt, f, f + g);
                    m = 1;
                    h = c[f].fc;
                    for (k = f; k < e; k++)
                      (l = c[k]), l.fc !== h && (m++, (h = l.fc));
                    this.ej(c, this.Cy, f, f + g);
                    var n = 1;
                    h = c[f].first;
                    for (k = f; k < e; k++)
                      (l = c[k]), l.first !== h && (n++, (h = l.first));
                    k = !0;
                    l = n;
                    m < n
                      ? ((k = !1),
                        (l = m),
                        (h = c[f].fc),
                        this.ej(c, this.bt, f, f + g))
                      : (h = c[f].first);
                    m = 0;
                    for (n = f; n < e; n++) {
                      var p = c[n];
                      (k ? p.first : p.fc) !== h &&
                        (m++, (h = k ? p.first : p.fc));
                      var r = p.link;
                      f = r.i(p.index);
                      g = r.i(p.index + 1);
                      var q = this.linkSpacing * (m - (l - 1) / 2);
                      if (!r.isAvoiding || Gt(f.x, f.y + q, g.x, g.y + q))
                        b++,
                          r.Qh(),
                          r.P(p.index, f.x, f.y + q),
                          r.P(p.index + 1, g.x, g.y + q),
                          r.Df();
                    }
                  }
                  f = e;
                }
              a = d;
            }
        } else {
          b = 0;
          c = [];
          for (a = a.iterator; a.next(); )
            if (((d = a.value), null !== d && d.isOrthogonal))
              for (e = 2; e < d.pointsCount - 3; e++)
                (f = d.i(e)),
                  (g = d.i(e + 1)),
                  this.C(f.x, g.x) &&
                    !this.C(f.y, g.y) &&
                    ((h = new Ft()),
                    (h.layer = Math.floor(f.x / 2)),
                    (k = d.i(0)),
                    (l = d.i(d.pointsCount - 1)),
                    (h.first = k.x + k.y * k.y),
                    (h.fc = l.x + l.y * l.y),
                    (h.nd = Math.min(f.y, g.y)),
                    (h.Cc = Math.max(f.y, g.y)),
                    (h.index = e),
                    (h.link = d),
                    e + 2 < d.pointsCount &&
                      ((k = d.i(e - 1)),
                      (l = d.i(e + 2)),
                      (m = 0),
                      k.x < f.x
                        ? (m = l.x < f.x ? 3 : f.y < g.y ? 2 : 1)
                        : k.x > f.x && (m = l.x > f.x ? 0 : g.y < f.y ? 2 : 1),
                      (h.j = m)),
                    c.push(h));
          if (1 < c.length)
            for (c.sort(this.Dy), a = 0; a < c.length; ) {
              f = c[a].layer;
              for (d = a + 1; d < c.length && c[d].layer === f; ) d++;
              if (1 < d - a)
                for (f = a; f < d; ) {
                  g = c[f].Cc;
                  for (e = a + 1; e < d && c[e].nd < g; )
                    (g = Math.max(g, c[e].Cc)), e++;
                  g = e - f;
                  if (1 < g) {
                    this.ej(c, this.bt, f, f + g);
                    m = 1;
                    h = c[f].fc;
                    for (k = f; k < e; k++)
                      (l = c[k]), l.fc !== h && (m++, (h = l.fc));
                    this.ej(c, this.Cy, f, f + g);
                    n = 1;
                    h = c[f].first;
                    for (k = f; k < e; k++)
                      (l = c[k]), l.first !== h && (n++, (h = l.first));
                    k = !0;
                    l = n;
                    m < n
                      ? ((k = !1),
                        (l = m),
                        (h = c[f].fc),
                        this.ej(c, this.bt, f, f + g))
                      : (h = c[f].first);
                    m = 0;
                    for (n = f; n < e; n++)
                      if (
                        ((p = c[n]),
                        (k ? p.first : p.fc) !== h &&
                          (m++, (h = k ? p.first : p.fc)),
                        (r = p.link),
                        (f = r.i(p.index)),
                        (g = r.i(p.index + 1)),
                        (q = this.linkSpacing * (m - (l - 1) / 2)),
                        !r.isAvoiding || Gt(f.x + q, f.y, g.x + q, g.y))
                      )
                        b++,
                          r.Qh(),
                          r.P(p.index, f.x + q, f.y),
                          r.P(p.index + 1, g.x + q, g.y),
                          r.Df();
                  }
                  f = e;
                }
              a = d;
            }
        }
    }
  };
  t = Ls.prototype;
  t.Dy = function (a, b) {
    return a instanceof Ft && b instanceof Ft && a !== b
      ? a.layer < b.layer
        ? -1
        : a.layer > b.layer
        ? 1
        : a.nd < b.nd
        ? -1
        : a.nd > b.nd
        ? 1
        : a.Cc < b.Cc
        ? -1
        : a.Cc > b.Cc
        ? 1
        : 0
      : 0;
  };
  t.Cy = function (a, b) {
    return a instanceof Ft && b instanceof Ft && a !== b
      ? a.first < b.first
        ? -1
        : a.first > b.first || a.j < b.j
        ? 1
        : a.j > b.j || a.nd < b.nd
        ? -1
        : a.nd > b.nd
        ? 1
        : a.Cc < b.Cc
        ? -1
        : a.Cc > b.Cc
        ? 1
        : 0
      : 0;
  };
  t.bt = function (a, b) {
    return a instanceof Ft && b instanceof Ft && a !== b
      ? a.fc < b.fc
        ? -1
        : a.fc > b.fc || a.j < b.j
        ? 1
        : a.j > b.j || a.nd < b.nd
        ? -1
        : a.nd > b.nd
        ? 1
        : a.Cc < b.Cc
        ? -1
        : a.Cc > b.Cc
        ? 1
        : 0
      : 0;
  };
  t.C = function (a, b) {
    G && (D(a, Ls, "isApprox:a"), D(b, Ls, "isApprox:b"));
    a -= b;
    return -1 < a && 1 > a;
  };
  t.ej = function (a, b, c, d) {
    var e = a.length,
      f = d - c;
    if (!(1 >= f))
      if (
        ((0 > c || c >= e - 1) && v("not in range 0 <= from < length: " + c),
        2 === f)
      )
        (d = a[c]), (e = a[c + 1]), 0 < b(d, e) && ((a[c] = e), (a[c + 1] = d));
      else if (0 === c)
        if (d >= e) a.sort(b);
        else for (c = a.slice(0, d), c.sort(b), b = 0; b < d; b++) a[b] = c[b];
      else if (d >= e)
        for (d = a.slice(c), d.sort(b), b = c; b < e; b++) a[b] = d[b - c];
      else
        for (e = a.slice(c, d), e.sort(b), b = c; b < d; b++) a[b] = e[b - c];
  };
  function Gt(a, b, c, d) {
    G &&
      (D(a, Ls, "isUnoccupied2:px"),
      D(b, Ls, "isUnoccupied2:py"),
      D(c, Ls, "isUnoccupied2:qx"),
      D(d, Ls, "isUnoccupied2:qy"));
    return !0;
  }
  function Us(a, b) {
    var c = a.Hb[b];
    if (c >= a.Fe.length) {
      var d = [];
      for (var e = 0; e < a.Fe.length; e++) d[e] = a.Fe[e];
      a.Fe = d;
    }
    void 0 === a.Fe[c] || null === a.Fe[c]
      ? (d = [])
      : ((d = a.Fe[c]), (a.Fe[c] = null));
    a = a.Ko[b];
    for (b = 0; b < a.length; b++) (c = a[b]), (d[c.index] = c);
    return d;
  }
  function Vs(a, b, c) {
    a.Fe[a.Hb[b]] = c;
  }
  oa.Object.defineProperties(Ls.prototype, {
    layerSpacing: {
      configurable: !0,
      get: function () {
        return this.de;
      },
      set: function (a) {
        this.de !== a &&
          (A(a, "number", Ls, "layerSpacing"),
          0 <= a && ((this.de = a), this.F()));
      },
    },
    columnSpacing: {
      configurable: !0,
      get: function () {
        return this.gc;
      },
      set: function (a) {
        this.gc !== a &&
          (A(a, "number", Ls, "columnSpacing"),
          0 < a && ((this.gc = a), this.F()));
      },
    },
    direction: {
      configurable: !0,
      get: function () {
        return this.O;
      },
      set: function (a) {
        this.O !== a &&
          (A(a, "number", Ls, "direction"),
          0 === a || 90 === a || 180 === a || 270 === a
            ? ((this.O = a), this.F())
            : v("LayeredDigraphLayout.direction must be 0, 90, 180, or 270"));
      },
    },
    cycleRemoveOption: {
      configurable: !0,
      get: function () {
        return this.bl;
      },
      set: function (a) {
        this.bl !== a &&
          (cb(a, Ls, Ls, "cycleRemoveOption"),
          a === et || a === Ms || a === Rs) &&
          ((this.bl = a), this.F());
      },
    },
    layeringOption: {
      configurable: !0,
      get: function () {
        return this.Al;
      },
      set: function (a) {
        this.Al !== a &&
          (cb(a, Ls, Ls, "layeringOption"), a === Ns || a === jt || a === lt) &&
          ((this.Al = a), this.F());
      },
    },
    initializeOption: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.pl;
      },
      set: function (a) {
        this.pl !== a &&
          (cb(a, Ls, Ls, "initializeOption"),
          a === Os || a === rt || a === pt) &&
          ((this.pl = a), this.F());
      },
    },
    iterations: {
      configurable: !0,
      get: function () {
        return this.Jj;
      },
      set: function (a) {
        this.Jj !== a &&
          (D(a, Qs, "iterations"), 0 <= a && ((this.Jj = a), this.F()));
      },
    },
    aggressiveOption: {
      configurable: !0,
      get: function () {
        return this.Nk;
      },
      set: function (a) {
        this.Nk !== a &&
          (cb(a, Ls, Ls, "aggressiveOption"),
          a === vt || a === Ps || a === wt) &&
          ((this.Nk = a), this.F());
      },
    },
    packOption: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.hg;
      },
      set: function (a) {
        this.hg !== a &&
          (A(a, "number", Ls, "packOption"),
          0 <= a && 8 > a && ((this.hg = a), this.F()));
      },
    },
    setsPortSpots: {
      configurable: !0,
      get: function () {
        return this.rf;
      },
      set: function (a) {
        this.rf !== a &&
          (A(a, "boolean", Ls, "setsPortSpots"), (this.rf = a), this.F());
      },
    },
    linkSpacing: {
      configurable: !0,
      get: function () {
        return this.uo;
      },
      set: function (a) {
        this.uo !== a &&
          (A(a, "number", Ls, "linkSpacing"),
          0 <= a && ((this.uo = a), this.F()));
      },
    },
    maxLayer: {
      configurable: !0,
      get: function () {
        return this.ya;
      },
    },
    maxIndex: {
      configurable: !0,
      get: function () {
        return this.si;
      },
    },
    maxColumn: {
      configurable: !0,
      get: function () {
        return this.Ja;
      },
    },
    minIndexLayer: {
      configurable: !0,
      get: function () {
        return this.ah;
      },
    },
    maxIndexLayer: {
      configurable: !0,
      get: function () {
        return this.yc;
      },
    },
  });
  var Ms = new F(Ls, "CycleDepthFirst", 0),
    et = new F(Ls, "CycleGreedy", 1),
    Rs = new F(Ls, "CycleFromLayers", 2),
    Ns = new F(Ls, "LayerOptimalLinkLength", 0),
    jt = new F(Ls, "LayerLongestPathSink", 1),
    lt = new F(Ls, "LayerLongestPathSource", 2),
    Os = new F(Ls, "InitDepthFirstOut", 0),
    rt = new F(Ls, "InitDepthFirstIn", 1),
    pt = new F(Ls, "InitNaive", 2),
    vt = new F(Ls, "AggressiveNone", 0),
    Ps = new F(Ls, "AggressiveLess", 1),
    wt = new F(Ls, "AggressiveMore", 2),
    xt = 8;
  Ls.className = "LayeredDigraphLayout";
  Ls.CycleDepthFirst = Ms;
  Ls.CycleGreedy = et;
  Ls.CycleFromLayers = Rs;
  Ls.LayerOptimalLinkLength = Ns;
  Ls.LayerLongestPathSink = jt;
  Ls.LayerLongestPathSource = lt;
  Ls.InitDepthFirstOut = Os;
  Ls.InitDepthFirstIn = rt;
  Ls.InitNaive = pt;
  Ls.AggressiveNone = vt;
  Ls.AggressiveLess = Ps;
  Ls.AggressiveMore = wt;
  Ls.PackNone = 0;
  Ls.PackExpand = 1;
  Ls.PackStraighten = 2;
  Ls.PackMedian = 4;
  Ls.PackAll = 15;
  function Ft() {
    this.index = this.Cc = this.nd = this.fc = this.first = this.layer = 0;
    this.link = null;
    this.j = 0;
  }
  Ft.className = "SegInfo";
  function Qs(a) {
    mq.call(this, a);
  }
  na(Qs, mq);
  Qs.prototype.createVertex = function () {
    return new Ht(this);
  };
  Qs.prototype.createEdge = function () {
    return new It(this);
  };
  Qs.className = "LayeredDigraphNetwork";
  function Ht(a) {
    Aq.call(this, a);
    this.Xa = this.Hg = this.mi = -1;
    this.B = NaN;
    this.M = null;
    this.valid = !1;
    this.finish = this.ug = NaN;
    this.Cf = 0;
    this.Ak = this.Bk = null;
  }
  na(Ht, Aq);
  Ht.prototype.serializeVertexProperties = function (a, b) {
    Aq.prototype.serializeVertexProperties.call(this, a, b);
    a.layer = this.layer;
    a.column = this.column;
    a.index = this.index;
    a.component = this.component;
    a.near = this.near ? lb(this.near) : null;
    a.valid = this.valid;
    a.ug = this.ug;
    a.finish = this.finish;
    a.Cf = this.Cf;
    a.Bk = this.Bk;
    a.Ak = this.Ak;
  };
  Ht.prototype.deserializeVertexProperties = function (a, b, c, d) {
    Aq.prototype.deserializeVertexProperties.call(this, a, b, c, d);
    this.layer = a.layer;
    this.column = a.column;
    this.index = a.index;
    this.component = a.component;
    if ((b = b.get(a.near))) this.near = b;
    this.valid = a.valid;
    this.ug = a.ug;
    this.finish = a.finish;
    this.Cf = a.Cf;
    this.Bk = a.Bk;
    this.Ak = a.Ak;
  };
  oa.Object.defineProperties(Ht.prototype, {
    layer: {
      configurable: !0,
      get: function () {
        return this.mi;
      },
      set: function (a) {
        this.mi !== a && (A(a, "number", Ht, "layer"), (this.mi = a));
      },
    },
    column: {
      configurable: !0,
      get: function () {
        return this.Hg;
      },
      set: function (a) {
        this.Hg !== a && (A(a, "number", Ht, "column"), (this.Hg = a));
      },
    },
    index: {
      configurable: !0,
      get: function () {
        return this.Xa;
      },
      set: function (a) {
        this.Xa !== a && (A(a, "number", Ht, "index"), (this.Xa = a));
      },
    },
    component: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        this.B !== a && (A(a, "number", Ht, "component"), (this.B = a));
      },
    },
    near: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        this.M !== a && (G && null !== a && x(a, Ht, Ht, "near"), (this.M = a));
      },
    },
  });
  Ht.className = "LayeredDigraphVertex";
  function It(a) {
    Bq.call(this, a);
    this.j = this.Na = this.eb = !1;
    this.Ba = this.B = NaN;
    this.M = this.o = 0;
  }
  na(It, Bq);
  It.prototype.serializeEdgeProperties = function (a, b) {
    Bq.prototype.serializeEdgeProperties.call(this, a, b);
    a.valid = this.valid;
    a.rev = this.rev;
    a.forest = this.forest;
    a.portFromPos = this.portFromPos;
    a.portToPos = this.portToPos;
    a.portFromColOffset = this.portFromColOffset;
    a.portToColOffset = this.portToColOffset;
  };
  It.prototype.deserializeEdgeProperties = function (a, b, c, d) {
    Bq.prototype.deserializeEdgeProperties.call(this, a, b, c, d);
    this.valid = a.valid;
    this.rev = a.rev;
    this.forest = a.forest;
    this.portFromPos = a.portFromPos;
    this.portToPos = a.portToPos;
    this.portFromColOffset = a.portFromColOffset;
    this.portToColOffset = a.portToColOffset;
  };
  oa.Object.defineProperties(It.prototype, {
    fromVertex: {
      configurable: !0,
      get: function () {
        return this.cd;
      },
      set: function (a) {
        this.cd !== a &&
          (G && null !== a && x(a, Ht, It, "fromVertex"), (this.cd = a));
      },
    },
    toVertex: {
      configurable: !0,
      get: function () {
        return this.ld;
      },
      set: function (a) {
        this.ld !== a &&
          (G && null !== a && x(a, Ht, It, "toVertex"), (this.ld = a));
      },
    },
    valid: {
      configurable: !0,
      get: function () {
        return this.eb;
      },
      set: function (a) {
        this.eb !== a && (A(a, "boolean", It, "valid"), (this.eb = a));
      },
    },
    rev: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Na;
      },
      set: function (a) {
        this.Na !== a && (A(a, "boolean", It, "rev"), (this.Na = a));
      },
    },
    forest: {
      configurable: !0,
      get: function () {
        return this.j;
      },
      set: function (a) {
        this.j !== a && (A(a, "boolean", It, "forest"), (this.j = a));
      },
    },
    portFromPos: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        this.B !== a && (A(a, "number", It, "portFromPos"), (this.B = a));
      },
    },
    portToPos: {
      configurable: !0,
      get: function () {
        return this.Ba;
      },
      set: function (a) {
        this.Ba !== a && (A(a, "number", It, "portToPos"), (this.Ba = a));
      },
    },
    portFromColOffset: {
      configurable: !0,
      get: function () {
        return this.o;
      },
      set: function (a) {
        this.o !== a && (A(a, "number", It, "portFromColOffset"), (this.o = a));
      },
    },
    portToColOffset: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        this.M !== a && (A(a, "number", It, "portToColOffset"), (this.M = a));
      },
    },
  });
  It.className = "LayeredDigraphEdge";
  function Z(a) {
    zi.call(this);
    this.Sb = new I();
    this.Xo = Jt;
    this.td = Kt;
    this.Np = Lt;
    this.Er = Mt;
    this.Aw = [];
    this.rd = !0;
    this.Pb = Nt;
    this.Wd = new Gb(10, 10).freeze();
    var b = new Ot(this);
    this.Z = new Pt(b);
    this.$ = new Pt(b);
    this.Pu = [];
    a && Object.assign(this, a);
  }
  na(Z, zi);
  Z.prototype.cloneProtected = function (a) {
    zi.prototype.cloneProtected.call(this, a);
    a.Xo = this.Xo;
    a.Np = this.Np;
    a.Er = this.Er;
    a.rd = this.rd;
    a.Pb = this.Pb;
    a.Wd.assign(this.Wd);
    a.Z.copyInheritedPropertiesFrom(this.Z);
    a.$.copyInheritedPropertiesFrom(this.$);
  };
  Z.prototype.pb = function (a) {
    a.classType === Z
      ? 0 === a.name.indexOf("Alignment")
        ? (this.alignment = a)
        : 0 === a.name.indexOf("Arrangement")
        ? (this.arrangement = a)
        : 0 === a.name.indexOf("Compaction")
        ? (this.compaction = a)
        : 0 === a.name.indexOf("Path")
        ? (this.path = a)
        : 0 === a.name.indexOf("Sorting")
        ? (this.sorting = a)
        : 0 === a.name.indexOf("Style")
        ? (this.treeStyle = a)
        : v("Unknown enum value: " + a)
      : zi.prototype.pb.call(this, a);
  };
  Z.prototype.createNetwork = function () {
    return new Ot(this);
  };
  Z.prototype.makeNetwork = function (a) {
    function b(a) {
      if (a instanceof V) return !a.isLinkLabel && "Comment" !== a.category;
      if (a instanceof R) {
        var b = a.fromNode;
        if (null === b || b.isLinkLabel || "Comment" === b.category) return !1;
        a = a.toNode;
        return null === a || a.isLinkLabel || "Comment" === a.category
          ? !1
          : !0;
      }
      return !1;
    }
    var c = this.createNetwork();
    a instanceof Q
      ? (c.sg(a.nodes, !0, b), c.sg(a.links, !0, b))
      : a instanceof vf
      ? c.sg(a.memberParts, !1, b)
      : c.sg(a.iterator, !1, b);
    return c;
  };
  Z.prototype.doLayout = function (a) {
    G &&
      null === a &&
      v(
        "Layout.doLayout(collection) argument must not be null but a Diagram, a Group, or an Iterable of Parts"
      );
    null === this.network && (this.network = this.makeNetwork(a));
    this.arrangement !== Qt &&
      (this.arrangementOrigin = this.initialOrigin(this.arrangementOrigin));
    var b = this.diagram;
    null === b && a instanceof Q && (b = a);
    this.path === Jt && null !== b
      ? (this.td = b.isTreePathToChildren ? Kt : Rt)
      : (this.td = this.path === Jt ? Kt : this.path);
    if (0 < this.network.vertexes.count) {
      this.network.bq();
      for (a = this.network.vertexes.iterator; a.next(); )
        (b = a.value),
          (b.initialized = !1),
          (b.level = 0),
          (b.parent = null),
          (b.children = []);
      if (0 < this.Sb.count) {
        a = new I();
        for (b = this.Sb.iterator; b.next(); ) {
          var c = b.value;
          c instanceof V
            ? ((c = this.network.Si(c)), null !== c && a.add(c))
            : c instanceof Pt && a.add(c);
        }
        this.Sb = a;
      }
      0 === this.Sb.count && this.findRoots();
      for (a = this.Sb.copy().iterator; a.next(); )
        (b = a.value), b.initialized || ((b.initialized = !0), St(this, b));
      b = this.network.vertexes;
      for (a = null; (a = Tt(b)), 0 < a.count; )
        (b = Ut(this, a)),
          null !== b && this.Sb.add(b),
          (b.initialized = !0),
          St(this, b),
          (b = a);
      for (a = this.Sb.iterator; a.next(); )
        (b = a.value), b instanceof Pt && Vt(this, b);
      for (a = this.Sb.iterator; a.next(); )
        (b = a.value), b instanceof Pt && Wt(this, b);
      for (a = this.Sb.iterator; a.next(); )
        (b = a.value), b instanceof Pt && Xt(this, b);
      this.bv();
      if (this.layerStyle === Yt) {
        a = [];
        for (b = this.network.vertexes.iterator; b.next(); ) {
          c = b.value;
          var d = c.parent;
          null === d && (d = c);
          d = 0 === d.angle || 180 === d.angle;
          var e = a[c.level];
          void 0 === e && (e = 0);
          a[c.level] = Math.max(e, d ? c.width : c.height);
        }
        for (b = 0; b < a.length; b++) void 0 === a[b] && (a[b] = 0);
        this.Aw = a;
        for (b = this.network.vertexes.iterator; b.next(); )
          (c = b.value),
            (d = c.parent),
            null === d && (d = c),
            0 === d.angle || 180 === d.angle
              ? (180 === d.angle && (c.focusX += a[c.level] - c.width),
                (c.width = a[c.level]))
              : (270 === d.angle && (c.focusY += a[c.level] - c.height),
                (c.height = a[c.level]));
      } else if (this.layerStyle === Zt)
        for (a = this.network.vertexes.iterator; a.next(); ) {
          b = a.value;
          c = 0 === b.angle || 180 === b.angle;
          d = -1;
          for (e = 0; e < b.children.length; e++) {
            var f = b.children[e];
            d = Math.max(d, c ? f.width : f.height);
          }
          if (0 <= d)
            for (e = 0; e < b.children.length; e++)
              (f = b.children[e]),
                c
                  ? (180 === b.angle && (f.focusX += d - f.width),
                    (f.width = d))
                  : (270 === b.angle && (f.focusY += d - f.height),
                    (f.height = d));
        }
      for (a = this.Sb.iterator; a.next(); )
        (b = a.value), b instanceof Pt && this.layoutTree(b);
      this.arrangeTrees();
      this.updateParts();
    }
    this.network = null;
    this.Sb = new I();
    this.isValidLayout = !0;
  };
  function Tt(a) {
    var b = new I();
    for (a = a.iterator; a.next(); ) {
      var c = a.value;
      c.initialized || b.add(c);
    }
    return b;
  }
  Z.prototype.findRoots = function () {
    for (var a = this.network.vertexes, b = a.iterator; b.next(); ) {
      var c = b.value;
      switch (this.td) {
        case Kt:
          0 === c.sourceEdges.count && this.Sb.add(c);
          break;
        case Rt:
          0 === c.destinationEdges.count && this.Sb.add(c);
          break;
        default:
          v("Unhandled path value " + this.td.toString());
      }
    }
    0 === this.Sb.count && ((a = Ut(this, a)), null !== a && this.Sb.add(a));
  };
  function Ut(a, b) {
    var c = 999999,
      d = null;
    for (b = b.iterator; b.next(); ) {
      var e = b.value;
      switch (a.td) {
        case Kt:
          e.sourceEdges.count < c && ((c = e.sourceEdges.count), (d = e));
          break;
        case Rt:
          e.destinationEdges.count < c &&
            ((c = e.destinationEdges.count), (d = e));
          break;
        default:
          v("Unhandled path value " + a.td.toString());
      }
    }
    return d;
  }
  function St(a, b) {
    if (null !== b) {
      G && x(b, Pt, Z, "walkTree:v");
      switch (a.td) {
        case Kt:
          if (0 < b.destinationEdges.count) {
            for (var c = new H(), d = b.destinationVertexes; d.next(); ) {
              var e = d.value;
              $t(a, b, e) && c.add(e);
            }
            0 < c.count && (b.children = c.Ga());
          }
          break;
        case Rt:
          if (0 < b.sourceEdges.count) {
            c = new H();
            for (d = b.sourceVertexes; d.next(); )
              (e = d.value), $t(a, b, e) && c.add(e);
            0 < c.count && (b.children = c.Ga());
          }
          break;
        default:
          v("Unhandled path value" + a.td.toString());
      }
      c = b.children;
      d = c.length;
      for (e = 0; e < d; e++) {
        var f = c[e];
        f.initialized = !0;
        f.level = b.level + 1;
        f.parent = b;
        a.Sb.remove(f);
      }
      for (b = 0; b < d; b++) St(a, c[b]);
    }
  }
  function $t(a, b, c) {
    G && x(b, Pt, Z, "walkOK:v");
    G && x(c, Pt, Z, "walkOK:c");
    if (c.initialized) {
      if (null === b) var d = !1;
      else {
        G && x(c, Pt, Z, "isAncestor:a");
        G && x(b, Pt, Z, "isAncestor:b");
        for (d = b.parent; null !== d && d !== c; ) d = d.parent;
        d = d === c;
      }
      if (d || c.level > b.level) return !1;
      a.removeChild(c.parent, c);
    }
    return !0;
  }
  Z.prototype.removeChild = function (a, b) {
    if (null !== a && null !== b) {
      G && x(a, Pt, Z, "removeChild:p");
      G && x(b, Pt, Z, "removeChild:c");
      for (var c = a.children, d = 0, e = 0; e < c.length; e++)
        c[e] === b && d++;
      if (0 < d) {
        d = Array(c.length - d);
        for (var f = (e = 0); f < c.length; f++) c[f] !== b && (d[e++] = c[f]);
        a.children = d;
      }
    }
  };
  function Vt(a, b) {
    if (null !== b) {
      G && x(b, Pt, Z, "initializeTree:v");
      a.initializeTreeVertexValues(b);
      b.alignment === au && a.sortTreeVertexChildren(b);
      for (
        var c = 0,
          d = b.childrenCount,
          e = 0,
          f = b.children,
          g = f.length,
          h = 0;
        h < g;
        h++
      ) {
        var k = f[h];
        Vt(a, k);
        c += k.descendantCount + 1;
        d = Math.max(d, k.maxChildrenCount);
        e = Math.max(e, k.maxGenerationCount);
      }
      b.descendantCount = c;
      b.maxChildrenCount = d;
      b.maxGenerationCount = 0 < d ? e + 1 : 0;
    }
  }
  function bu(a, b) {
    G && x(b, Pt, Z, "mom:v");
    switch (a.Np) {
      default:
      case Lt:
        return null !== b.parent ? b.parent : a.Z;
      case cu:
        return null === b.parent
          ? a.Z
          : null === b.parent.parent
          ? a.$
          : b.parent;
      case du:
        return null !== b.parent
          ? null !== b.parent.parent
            ? b.parent.parent
            : a.$
          : a.Z;
      case eu:
        var c = !0;
        if (0 === b.childrenCount) c = !1;
        else
          for (var d = b.children, e = d.length, f = 0; f < e; f++)
            if (0 < d[f].childrenCount) {
              c = !1;
              break;
            }
        return c && null !== b.parent
          ? a.$
          : null !== b.parent
          ? b.parent
          : a.Z;
    }
  }
  Z.prototype.initializeTreeVertexValues = function (a) {
    G && x(a, Pt, Z, "initializeTreeVertexValues:v");
    var b = bu(this, a);
    a.copyInheritedPropertiesFrom(b);
    if (null !== a.parent && a.parent.alignment === au) {
      b = a.angle;
      for (var c = a.parent.children, d = 0; d < c.length && a !== c[d]; ) d++;
      0 === d % 2
        ? d !== c.length - 1 &&
          (b = 90 === b ? 180 : 180 === b ? 270 : 270 === b ? 180 : 270)
        : (b = 90 === b ? 0 : 180 === b ? 90 : 270 === b ? 0 : 90);
      a.angle = b;
    }
    a.initialized = !0;
  };
  function Wt(a, b) {
    if (null !== b) {
      G && x(b, Pt, Z, "assignTree:v");
      a.assignTreeVertexValues(b);
      b = b.children;
      for (var c = b.length, d = 0; d < c; d++) Wt(a, b[d]);
    }
  }
  Z.prototype.assignTreeVertexValues = function () {};
  function Xt(a, b) {
    if (null !== b) {
      G && x(b, Pt, Z, "sortTree:v");
      b.alignment !== au && a.sortTreeVertexChildren(b);
      b = b.children;
      for (var c = b.length, d = 0; d < c; d++) Xt(a, b[d]);
    }
  }
  Z.prototype.sortTreeVertexChildren = function (a) {
    G && x(a, Pt, Z, "sortTreeVertexChildren:v");
    switch (a.sorting) {
      case fu:
        break;
      case gu:
        a.children.reverse();
        break;
      case hu:
        a.children.sort(a.comparer);
        break;
      case iu:
        a.children.sort(a.comparer);
        a.children.reverse();
        break;
      default:
        v("Unhandled sorting value " + a.sorting.toString());
    }
  };
  Z.prototype.bv = function () {
    if (this.comments)
      for (var a = this.network.vertexes.iterator; a.next(); )
        this.addComments(a.value);
  };
  Z.prototype.addComments = function (a) {
    G && x(a, Pt, Z, "addComments:v");
    var b = a.angle,
      c = a.parent,
      d = 0;
    var e = !1;
    null !== c && ((d = c.angle), (e = c.alignment), (e = ju(e)));
    b = 90 === b || 270 === b;
    d = 90 === d || 270 === d;
    c = 0 === a.childrenCount;
    var f = 0,
      g = 0,
      h = 0,
      k = a.commentSpacing;
    if (null !== a.node)
      for (var l = a.node.qv(); l.next(); ) {
        var m = l.value;
        "Comment" === m.category &&
          m.canLayout() &&
          (null === a.comments && (a.comments = []),
          a.comments.push(m),
          m.Za(),
          (m = m.measuredBounds),
          (b && !c) || (!e && !d && c) || (e && d && c)
            ? ((f = Math.max(f, m.width)), (g += m.height + Math.abs(h)))
            : ((f += m.width + Math.abs(h)), (g = Math.max(g, m.height))),
          (h = k));
      }
    null !== a.comments &&
      ((b && !c) || (!e && !d && c) || (e && d && c)
        ? ((f += Math.abs(a.commentMargin)), (g = Math.max(0, g - a.height)))
        : ((g += Math.abs(a.commentMargin)), (f = Math.max(0, f - a.width))),
      (e = M.allocAt(0, 0, a.bounds.width + f, a.bounds.height + g)),
      (a.bounds = e),
      M.free(e));
  };
  function ju(a) {
    return a === ku || a === au || a === lu || a === mu;
  }
  function nu(a) {
    return a === ku || a === au;
  }
  function ou(a) {
    G && x(a, Pt, Z, "isLeftSideBus:v");
    var b = a.parent;
    if (null !== b) {
      var c = b.alignment;
      if (ju(c)) {
        if (nu(c)) {
          b = b.children;
          for (c = 0; c < b.length && a !== b[c]; ) c++;
          return 0 === c % 2;
        }
        if (c === lu) return !0;
      }
    }
    return !1;
  }
  Z.prototype.layoutComments = function (a) {
    G && x(a, Pt, Z, "layoutComments:v");
    if (null !== a.comments) {
      var b = a.node.measuredBounds,
        c = a.parent,
        d = a.angle,
        e = 0;
      var f = !1;
      null !== c && ((e = c.angle), (f = c.alignment), (f = ju(f)));
      d = 90 === d || 270 === d;
      c = 90 === e || 270 === e;
      for (
        var g = 0 === a.childrenCount,
          h = ou(a),
          k = 0,
          l = a.comments,
          m = l.length,
          n = K.alloc(),
          p = 0;
        p < m;
        p++
      ) {
        var r = l[p],
          q = r.measuredBounds;
        if ((d && !g) || (!f && !c && g) || (f && c && g)) {
          if ((135 < e && !f) || (c && h))
            if (0 <= a.commentMargin)
              for (
                n.h(a.bounds.x - a.commentMargin - q.width, a.bounds.y + k),
                  r.move(n),
                  r = r.Nd();
                r.next();

              ) {
                var u = r.value;
                u.fromSpot = pd;
                u.toSpot = qd;
              }
            else
              for (
                n.h(
                  a.bounds.x + 2 * a.focus.x - a.commentMargin,
                  a.bounds.y + k
                ),
                  r.move(n),
                  r = r.Nd();
                r.next();

              )
                (u = r.value), (u.fromSpot = qd), (u.toSpot = pd);
          else if (0 <= a.commentMargin)
            for (
              n.h(a.bounds.x + 2 * a.focus.x + a.commentMargin, a.bounds.y + k),
                r.move(n),
                r = r.Nd();
              r.next();

            )
              (u = r.value), (u.fromSpot = qd), (u.toSpot = pd);
          else
            for (
              n.h(a.bounds.x + a.commentMargin - q.width, a.bounds.y + k),
                r.move(n),
                r = r.Nd();
              r.next();

            )
              (u = r.value), (u.fromSpot = pd), (u.toSpot = qd);
          k =
            0 <= a.commentSpacing
              ? k + (q.height + a.commentSpacing)
              : k + (a.commentSpacing - q.height);
        } else {
          if ((135 < e && !f) || (!c && h))
            if (0 <= a.commentMargin)
              for (
                n.h(a.bounds.x + k, a.bounds.y - a.commentMargin - q.height),
                  r.move(n),
                  r = r.Nd();
                r.next();

              )
                (u = r.value), (u.fromSpot = od), (u.toSpot = rd);
            else
              for (
                n.h(
                  a.bounds.x + k,
                  a.bounds.y + 2 * a.focus.y - a.commentMargin
                ),
                  r.move(n),
                  r = r.Nd();
                r.next();

              )
                (u = r.value), (u.fromSpot = rd), (u.toSpot = od);
          else if (0 <= a.commentMargin)
            for (
              n.h(a.bounds.x + k, a.bounds.y + 2 * a.focus.y + a.commentMargin),
                r.move(n),
                r = r.Nd();
              r.next();

            )
              (u = r.value), (u.fromSpot = rd), (u.toSpot = od);
          else
            for (
              n.h(a.bounds.x + k, a.bounds.y + a.commentMargin - q.height),
                r.move(n),
                r = r.Nd();
              r.next();

            )
              (u = r.value), (u.fromSpot = od), (u.toSpot = rd);
          k =
            0 <= a.commentSpacing
              ? k + (q.width + a.commentSpacing)
              : k + (a.commentSpacing - q.width);
        }
      }
      K.free(n);
      b = k - a.commentSpacing - (d ? b.height : b.width);
      if (this.td === Kt)
        for (a = a.destinationEdges; a.next(); )
          (e = a.value.link),
            null === e ||
              e.isAvoiding ||
              (e.fromEndSegmentLength = 0 < b ? b : NaN);
      else
        for (a = a.sourceEdges; a.next(); )
          (e = a.value.link),
            null === e ||
              e.isAvoiding ||
              (e.toEndSegmentLength = 0 < b ? b : NaN);
    }
  };
  Z.prototype.layoutTree = function (a) {
    if (null !== a) {
      G && x(a, Pt, Z, "layoutTree:v");
      for (var b = a.children, c = b.length, d = 0; d < c; d++)
        this.layoutTree(b[d]);
      switch (a.compaction) {
        case pu:
          qu(this, a);
          break;
        case ru:
          if (a.alignment === au) qu(this, a);
          else if (
            (G && x(a, Pt, Z, "layoutTreeBlock:v"), 0 === a.childrenCount)
          )
            (d = a.parent),
              (c = !1),
              (b = 0),
              null !== d && ((b = d.angle), (c = d.alignment), (c = ju(c))),
              (d = ou(a)),
              a.Y.h(0, 0),
              a.Ea.h(a.width, a.height),
              null === a.parent ||
              null === a.comments ||
              (((180 !== b && 270 !== b) || c) && !d)
                ? a.ma.h(0, 0)
                : (180 === b && !c) || ((90 === b || 270 === b) && d)
                ? a.ma.h(a.width - 2 * a.focus.x, 0)
                : a.ma.h(0, a.height - 2 * a.focus.y),
              (a.qq = null),
              (a.Cq = null);
          else {
            var e = su(a);
            b = 90 === e || 270 === e;
            var f = 0,
              g = a.children,
              h = g.length;
            for (c = 0; c < h; c++)
              (d = g[c]), (f = Math.max(f, b ? d.Ea.width : d.Ea.height));
            var k = a.alignment;
            d = k === tu;
            var l = k === uu,
              m = ju(k),
              n = Math.max(0, a.breadthLimit);
            c = xu(a);
            var p = a.nodeSpacing,
              r = yu(a),
              q = a.rowSpacing,
              u = 0;
            if (d || l || a.Em || (a.Fm && 1 === a.maxGenerationCount))
              u = Math.max(0, a.rowIndent);
            d = a.width;
            var w = a.height,
              y = 0,
              z = 0,
              B = 0,
              C = null,
              E = null,
              J = 0,
              S = 0,
              aa = 0,
              Y = 0,
              T = 0,
              P = 0,
              ma = 0,
              ia = 0;
            m && !nu(k) && 135 < e && g.reverse();
            if (nu(k))
              if (1 < h)
                for (var Ba = 0; Ba < h; Ba++)
                  0 === Ba % 2 &&
                    Ba !== h - 1 &&
                    (ia = Math.max(ia, b ? g[Ba].Ea.width : g[Ba].Ea.height));
              else 1 === h && (ia = b ? g[0].Ea.width : g[0].Ea.height);
            if (m) {
              switch (k) {
                case ku:
                  z = 135 > e ? zu(a, g, ia, y, z) : Au(a, g, ia, y, z);
                  ia = z.x;
                  y = z.width;
                  z = z.height;
                  break;
                case lu:
                  for (C = 0; C < h; C++)
                    (E = g[C]),
                      (n = E.Ea),
                      (B = 0 === P ? 0 : q),
                      b
                        ? (E.Y.h(f - n.width, Y + B),
                          (y = Math.max(y, n.width)),
                          (z = Math.max(z, Y + B + n.height)),
                          (Y += B + n.height))
                        : (E.Y.h(aa + B, f - n.height),
                          (y = Math.max(y, aa + B + n.width)),
                          (z = Math.max(z, n.height)),
                          (aa += B + n.width)),
                      P++;
                  break;
                case mu:
                  for (C = 0; C < h; C++)
                    (E = g[C]),
                      (f = E.Ea),
                      (n = 0 === P ? 0 : q),
                      b
                        ? (E.Y.h(p / 2 + a.focus.x, Y + n),
                          (y = Math.max(y, f.width)),
                          (z = Math.max(z, Y + n + f.height)),
                          (Y += n + f.height))
                        : (E.Y.h(aa + n, p / 2 + a.focus.y),
                          (y = Math.max(y, aa + n + f.width)),
                          (z = Math.max(z, f.height)),
                          (aa += n + f.width)),
                      P++;
              }
              C = Bu(this, 2);
              E = Bu(this, 2);
              b
                ? (C[0].h(0, 0), C[1].h(0, z), E[0].h(y, 0))
                : (C[0].h(0, 0), C[1].h(y, 0), E[0].h(0, z));
              E[1].h(y, z);
            } else
              for (Ba = 0; Ba < h; Ba++) {
                var Na = g[Ba],
                  sb = Na.Ea;
                if (b) {
                  0 < n &&
                    0 < P &&
                    aa + p + sb.width > n &&
                    (aa < f && Cu(a, k, f - aa, 0, ma, Ba - 1),
                    T++,
                    (P = 0),
                    (ma = Ba),
                    (B = z),
                    (aa = 0),
                    (Y = 135 < e ? -z - q : z + q));
                  Du(this, Na, 0, Y);
                  var tb = 0;
                  if (0 === P) {
                    if (
                      ((C = Na.qq),
                      (E = Na.Cq),
                      (J = sb.width),
                      (S = sb.height),
                      null === C || null === E || e !== su(Na))
                    )
                      (C = Bu(this, 2)),
                        (E = Bu(this, 2)),
                        C[0].h(0, 0),
                        C[1].h(0, S),
                        E[0].h(J, 0),
                        E[1].h(J, S);
                  } else {
                    var Xa = Ma();
                    S = Eu(this, a, Na, C, E, J, S, Xa);
                    tb = S.x;
                    C = Xa[0];
                    E = Xa[1];
                    J = S.width;
                    S = S.height;
                    Pa(Xa);
                    aa < sb.width &&
                      0 > tb &&
                      (Fu(a, -tb, 0, ma, Ba - 1),
                      Gu(C, -tb, 0),
                      Gu(E, -tb, 0),
                      (tb = 0));
                  }
                  Na.Y.h(tb, Y);
                  y = Math.max(y, J);
                  z = Math.max(z, B + (0 === T ? 0 : q) + sb.height);
                  aa = J;
                } else {
                  0 < n &&
                    0 < P &&
                    Y + p + sb.height > n &&
                    (Y < f && Cu(a, k, 0, f - Y, ma, Ba - 1),
                    T++,
                    (P = 0),
                    (ma = Ba),
                    (B = y),
                    (Y = 0),
                    (aa = 135 < e ? -y - q : y + q));
                  Du(this, Na, aa, 0);
                  tb = 0;
                  if (0 === P) {
                    if (
                      ((C = Na.qq),
                      (E = Na.Cq),
                      (J = sb.width),
                      (S = sb.height),
                      null === C || null === E || e !== su(Na))
                    )
                      (C = Bu(this, 2)),
                        (E = Bu(this, 2)),
                        C[0].h(0, 0),
                        C[1].h(J, 0),
                        E[0].h(0, S),
                        E[1].h(J, S);
                  } else
                    (Xa = Ma()),
                      (S = Eu(this, a, Na, C, E, J, S, Xa)),
                      (tb = S.x),
                      (C = Xa[0]),
                      (E = Xa[1]),
                      (J = S.width),
                      (S = S.height),
                      Pa(Xa),
                      Y < sb.height &&
                        0 > tb &&
                        (Fu(a, 0, -tb, ma, Ba - 1),
                        Gu(C, 0, -tb),
                        Gu(E, 0, -tb),
                        (tb = 0));
                  Na.Y.h(aa, tb);
                  z = Math.max(z, S);
                  y = Math.max(y, B + (0 === T ? 0 : q) + sb.width);
                  Y = S;
                }
                P++;
              }
            0 < T &&
              (b
                ? ((z += Math.max(0, c)),
                  aa < y && Cu(a, k, y - aa, 0, ma, h - 1),
                  0 < u && (l || Fu(a, u, 0, 0, h - 1), (y += u)))
                : ((y += Math.max(0, c)),
                  Y < z && Cu(a, k, 0, z - Y, ma, h - 1),
                  0 < u && (l || Fu(a, 0, u, 0, h - 1), (z += u))));
            u = l = 0;
            switch (k) {
              case Hu:
                b
                  ? (l += y / 2 - a.focus.x - r / 2)
                  : (u += z / 2 - a.focus.y - r / 2);
                break;
              case Iu:
                0 < T
                  ? b
                    ? (l += y / 2 - a.focus.x - r / 2)
                    : (u += z / 2 - a.focus.y - r / 2)
                  : b
                  ? ((ia = g[0].Y.x + g[0].ma.x),
                    (l +=
                      ia +
                      (g[h - 1].Y.x +
                        g[h - 1].ma.x +
                        2 * g[h - 1].focus.x -
                        ia) /
                        2 -
                      a.focus.x -
                      r / 2))
                  : ((ia = g[0].Y.y + g[0].ma.y),
                    (u +=
                      ia +
                      (g[h - 1].Y.y +
                        g[h - 1].ma.y +
                        2 * g[h - 1].focus.y -
                        ia) /
                        2 -
                      a.focus.y -
                      r / 2));
                break;
              case tu:
                b ? ((l -= r), (y += r)) : ((u -= r), (z += r));
                break;
              case uu:
                b
                  ? ((l += y - a.width + r), (y += r))
                  : ((u += z - a.height + r), (z += r));
                break;
              case ku:
                b
                  ? 1 < h
                    ? (l += ia + p / 2 - a.focus.x)
                    : (l += g[0].focus.x - a.focus.x + g[0].ma.x)
                  : 1 < h
                  ? (u += ia + p / 2 - a.focus.y)
                  : (u += g[0].focus.y - a.focus.y + g[0].ma.y);
                break;
              case lu:
                b ? (l += y + p / 2 - a.focus.x) : (u += z + p / 2 - a.focus.y);
                break;
              case mu:
                break;
              default:
                v("Unhandled alignment value " + k.toString());
            }
            for (r = 0; r < h; r++)
              (ia = g[r]),
                b
                  ? ia.Y.h(
                      ia.Y.x + ia.ma.x - l,
                      ia.Y.y +
                        (135 < e
                          ? (m ? -z : -ia.Ea.height) + ia.ma.y - c
                          : w + c + ia.ma.y)
                    )
                  : ia.Y.h(
                      ia.Y.x +
                        (135 < e
                          ? (m ? -y : -ia.Ea.width) + ia.ma.x - c
                          : d + c + ia.ma.x),
                      ia.Y.y + ia.ma.y - u
                    );
            h = g = 0;
            m
              ? b
                ? ((y = Ju(a, y, l)),
                  0 > l && (l = 0),
                  135 < e && (u += z + c),
                  (z += w + c),
                  k === mu && (g += p / 2 + a.focus.x),
                  (h += w + c))
                : (135 < e && (l += y + c),
                  (y += d + c),
                  (z = Ku(a, z, u)),
                  0 > u && (u = 0),
                  k === mu && (h += p / 2 + a.focus.y),
                  (g += d + c))
              : b
              ? (null === a.comments
                  ? d > y &&
                    ((y = Lu(k, d - y, 0)),
                    (g = y.x),
                    (h = y.y),
                    (y = d),
                    (l = 0))
                  : (y = Ju(a, y, l)),
                0 > l && ((g -= l), (l = 0)),
                135 < e && (u += z + c),
                (z = Math.max(Math.max(z, w), z + w + c)),
                (h += w + c))
              : (135 < e && (l += y + c),
                (y = Math.max(Math.max(y, d), y + d + c)),
                null === a.comments
                  ? w > z &&
                    ((z = Lu(k, 0, w - z)),
                    (g = z.x),
                    (h = z.y),
                    (z = w),
                    (u = 0))
                  : (z = Ku(a, z, u)),
                0 > u && ((h -= u), (u = 0)),
                (g += d + c));
            if (0 < T)
              (e = Bu(this, 4)),
                (T = Bu(this, 4)),
                b
                  ? (e[2].h(0, w + c),
                    e[3].h(e[2].x, z),
                    T[2].h(y, e[2].y),
                    T[3].h(T[2].x, e[3].y))
                  : (e[2].h(d + c, 0),
                    e[3].h(y, e[2].y),
                    T[2].h(e[2].x, z),
                    T[3].h(e[3].x, T[2].y));
            else {
              e = Bu(this, C.length + 2);
              T = Bu(this, E.length + 2);
              for (k = 0; k < C.length; k++)
                (m = C[k]), e[k + 2].h(m.x + g, m.y + h);
              for (k = 0; k < E.length; k++)
                (m = E[k]), T[k + 2].h(m.x + g, m.y + h);
            }
            b
              ? (e[0].h(l, 0),
                e[1].h(e[0].x, w),
                e[2].y < e[1].y &&
                  (e[2].x > e[0].x ? e[2].assign(e[1]) : e[1].assign(e[2])),
                e[3].y < e[2].y &&
                  (e[3].x > e[0].x ? e[3].assign(e[2]) : e[2].assign(e[3])),
                T[0].h(l + d, 0),
                T[1].h(T[0].x, w),
                T[2].y < T[1].y &&
                  (T[2].x < T[0].x ? T[2].assign(T[1]) : T[1].assign(T[2])),
                T[3].y < T[2].y &&
                  (T[3].x < T[0].x ? T[3].assign(T[2]) : T[2].assign(T[3])),
                (e[2].y -= c / 2),
                (T[2].y -= c / 2))
              : (e[0].h(0, u),
                e[1].h(d, e[0].y),
                e[2].x < e[1].x &&
                  (e[2].y > e[0].y ? e[2].assign(e[1]) : e[1].assign(e[2])),
                e[3].x < e[2].x &&
                  (e[3].y > e[0].y ? e[3].assign(e[2]) : e[2].assign(e[3])),
                T[0].h(0, u + w),
                T[1].h(d, T[0].y),
                T[2].x < T[1].x &&
                  (T[2].y < T[0].y ? T[2].assign(T[1]) : T[1].assign(T[2])),
                T[3].x < T[2].x &&
                  (T[3].y < T[0].y ? T[3].assign(T[2]) : T[2].assign(T[3])),
                (e[2].x -= c / 2),
                (T[2].x -= c / 2));
            Mu(this, C);
            Mu(this, E);
            a.qq = e;
            a.Cq = T;
            a.ma.h(l, u);
            a.Ea.h(y, z);
          }
          break;
        default:
          v("Unhandled compaction value " + a.compaction.toString());
      }
    }
  };
  function qu(a, b) {
    G && x(b, Pt, Z, "layoutTreeNone:v");
    if (0 === b.childrenCount) {
      var c = !1,
        d = 0;
      null !== b.parent &&
        ((d = b.parent.angle), (c = b.parent.alignment), (c = ju(c)));
      var e = ou(b);
      b.Y.h(0, 0);
      b.Ea.h(b.width, b.height);
      null === b.parent ||
      null === b.comments ||
      (((180 !== d && 270 !== d) || c) && !e)
        ? b.ma.h(0, 0)
        : (180 === d && !c) || ((90 === d || 270 === d) && e)
        ? b.ma.h(b.width - 2 * b.focus.x, 0)
        : b.ma.h(0, b.height - 2 * b.focus.y);
    } else {
      d = su(b);
      c = 90 === d || 270 === d;
      var f = 0;
      e = b.children;
      for (var g = e.length, h = 0; h < g; h++) {
        var k = e[h];
        f = Math.max(f, c ? k.Ea.width : k.Ea.height);
      }
      var l = b.alignment,
        m = l === tu,
        n = l === uu;
      h = ju(l);
      var p = Math.max(0, b.breadthLimit);
      k = xu(b);
      var r = b.nodeSpacing,
        q = yu(b),
        u = m || n ? 0 : q / 2,
        w = b.rowSpacing,
        y = 0;
      if (m || n || b.Em || (b.Fm && 1 === b.maxGenerationCount))
        y = Math.max(0, b.rowIndent);
      m = b.width;
      var z = b.height,
        B = 0,
        C = 0,
        E = 0,
        J = 0,
        S = 0,
        aa = 0,
        Y = 0,
        T = 0,
        P = 0,
        ma = 0;
      h && !nu(l) && 135 < d && e.reverse();
      if (nu(l))
        if (1 < g)
          for (var ia = 0; ia < g; ia++) {
            var Ba = e[ia],
              Na = Ba.Ea;
            0 === ia % 2 && ia !== g - 1
              ? (P = Math.max(P, (c ? Na.width : Na.height) + Nu(Ba) - r))
              : 0 !== ia % 2 &&
                (ma = Math.max(ma, (c ? Na.width : Na.height) + Nu(Ba) - r));
          }
        else 1 === g && (P = c ? e[0].Ea.width : e[0].Ea.height);
      if (h)
        switch (l) {
          case ku:
          case au:
            C = 135 > d ? zu(b, e, P, B, C) : Au(b, e, P, B, C);
            P = C.x;
            B = C.width;
            C = C.height;
            break;
          case lu:
            for (a = 0; a < g; a++)
              (p = e[a]),
                (u = p.Ea),
                (E = 0 === Y ? 0 : w),
                c
                  ? (p.Y.h(f - u.width, S + E),
                    (B = Math.max(B, u.width)),
                    (C = Math.max(C, S + E + u.height)),
                    (S += E + u.height))
                  : (p.Y.h(J + E, f - u.height),
                    (B = Math.max(B, J + E + u.width)),
                    (C = Math.max(C, u.height)),
                    (J += E + u.width)),
                Y++;
            break;
          case mu:
            for (f = 0; f < g; f++)
              (a = e[f]),
                (p = a.Ea),
                (u = 0 === Y ? 0 : w),
                c
                  ? (a.Y.h(r / 2 + b.focus.x, S + u),
                    (B = Math.max(B, p.width)),
                    (C = Math.max(C, S + u + p.height)),
                    (S += u + p.height))
                  : (a.Y.h(J + u, r / 2 + b.focus.y),
                    (B = Math.max(B, J + u + p.width)),
                    (C = Math.max(C, p.height)),
                    (J += u + p.width)),
                Y++;
        }
      else
        for (ma = 0; ma < g; ma++)
          (ia = e[ma]),
            (Ba = ia.Ea),
            c
              ? (0 < p &&
                  0 < Y &&
                  J + r + Ba.width > p &&
                  (J < f && Cu(b, l, f - J, 0, T, ma - 1),
                  aa++,
                  (Y = 0),
                  (T = ma),
                  (E = C),
                  (J = 0),
                  (S = 135 < d ? -C - w : C + w)),
                (Na = 0 === Y ? u : r),
                Du(a, ia, 0, S),
                ia.Y.h(J + Na, S),
                (B = Math.max(B, J + Na + Ba.width)),
                (C = Math.max(C, E + (0 === aa ? 0 : w) + Ba.height)),
                (J += Na + Ba.width))
              : (0 < p &&
                  0 < Y &&
                  S + r + Ba.height > p &&
                  (S < f && Cu(b, l, 0, f - S, T, ma - 1),
                  aa++,
                  (Y = 0),
                  (T = ma),
                  (E = B),
                  (S = 0),
                  (J = 135 < d ? -B - w : B + w)),
                (Na = 0 === Y ? u : r),
                Du(a, ia, J, 0),
                ia.Y.h(J, S + Na),
                (C = Math.max(C, S + Na + Ba.height)),
                (B = Math.max(B, E + (0 === aa ? 0 : w) + Ba.width)),
                (S += Na + Ba.height)),
            Y++;
      0 < aa &&
        (c
          ? ((C += Math.max(0, k)),
            J < B && Cu(b, l, B - J, 0, T, g - 1),
            0 < y && (n || Fu(b, y, 0, 0, g - 1), (B += y)))
          : ((B += Math.max(0, k)),
            S < C && Cu(b, l, 0, C - S, T, g - 1),
            0 < y && (n || Fu(b, 0, y, 0, g - 1), (C += y))));
      y = n = 0;
      switch (l) {
        case Hu:
          c
            ? (n += B / 2 - b.focus.x - q / 2)
            : (y += C / 2 - b.focus.y - q / 2);
          break;
        case Iu:
          0 < aa
            ? c
              ? (n += B / 2 - b.focus.x - q / 2)
              : (y += C / 2 - b.focus.y - q / 2)
            : c
            ? ((l = e[0].Y.x + e[0].ma.x),
              (n +=
                l +
                (e[g - 1].Y.x + e[g - 1].ma.x + 2 * e[g - 1].focus.x - l) / 2 -
                b.focus.x -
                q / 2))
            : ((l = e[0].Y.y + e[0].ma.y),
              (y +=
                l +
                (e[g - 1].Y.y + e[g - 1].ma.y + 2 * e[g - 1].focus.y - l) / 2 -
                b.focus.y -
                q / 2));
          break;
        case tu:
          c ? ((n -= q), (B += q)) : ((y -= q), (C += q));
          break;
        case uu:
          c
            ? ((n += B - b.width + q), (B += q))
            : ((y += C - b.height + q), (C += q));
          break;
        case ku:
        case au:
          c
            ? 1 < g
              ? (n += P + r / 2 - b.focus.x)
              : (n += e[0].focus.x - b.focus.x + e[0].ma.x)
            : 1 < g
            ? (y += P + r / 2 - b.focus.y)
            : (y += e[0].focus.y - b.focus.y + e[0].ma.y);
          break;
        case lu:
          c ? (n += B + r / 2 - b.focus.x) : (y += C + r / 2 - b.focus.y);
          break;
        case mu:
          break;
        default:
          v("Unhandled alignment value " + l.toString());
      }
      for (q = 0; q < g; q++)
        (l = e[q]),
          c
            ? l.Y.h(
                l.Y.x + l.ma.x - n,
                l.Y.y +
                  (135 < d
                    ? (h ? -C : -l.Ea.height) + l.ma.y - k
                    : z + k + l.ma.y)
              )
            : l.Y.h(
                l.Y.x +
                  (135 < d
                    ? (h ? -B : -l.Ea.width) + l.ma.x - k
                    : m + k + l.ma.x),
                l.Y.y + l.ma.y - y
              );
      c
        ? ((B = Ju(b, B, n)),
          0 > n && (n = 0),
          135 < d && (y += C + k),
          (C = Math.max(Math.max(C, z), C + z + k)))
        : (135 < d && (n += B + k),
          (B = Math.max(Math.max(B, m), B + m + k)),
          (C = Ku(b, C, y)),
          0 > y && (y = 0));
      b.ma.h(n, y);
      b.Ea.h(B, C);
    }
  }
  function zu(a, b, c, d, e) {
    G && x(a, Pt, Z, "layoutBusChildrenPosDir:v");
    var f = b.length;
    if (0 === f) return new M(c, 0, d, e);
    if (1 === f)
      return (a = b[0]), (d = a.Ea.width), (e = a.Ea.height), new M(c, 0, d, e);
    for (
      var g = a.nodeSpacing,
        h = a.rowSpacing,
        k = 90 === su(a),
        l = 0,
        m = 0,
        n = 0,
        p = 0;
      p < f;
      p++
    )
      if (!(0 !== p % 2 || (1 < f && p === f - 1))) {
        var r = b[p],
          q = r.Ea,
          u = 0 === l ? 0 : h;
        if (k) {
          var w = Nu(r) - g;
          r.Y.h(c - (q.width + w), n + u);
          d = Math.max(d, q.width + w);
          e = Math.max(e, n + u + q.height);
          n += u + q.height;
        } else
          (w = Nu(r) - g),
            r.Y.h(m + u, c - (q.height + w)),
            (e = Math.max(e, q.height + w)),
            (d = Math.max(d, m + u + q.width)),
            (m += u + q.width);
        l++;
      }
    l = 0;
    r = m;
    p = n;
    k ? ((m = c + g), (n = 0)) : ((m = 0), (n = c + g));
    for (q = 0; q < f; q++)
      if (0 !== q % 2) {
        u = b[q];
        w = u.Ea;
        var y = 0 === l ? 0 : h;
        if (k) {
          var z = Nu(u) - g;
          u.Y.h(m + z, n + y);
          d = Math.max(d, m + w.width + z);
          e = Math.max(e, n + y + w.height);
          n += y + w.height;
        } else
          (z = Nu(u) - g),
            u.Y.h(m + y, n + z),
            (d = Math.max(d, m + y + w.width)),
            (e = Math.max(e, n + w.height + z)),
            (m += y + w.width);
        l++;
      }
    1 < f &&
      1 === f % 2 &&
      ((b = b[f - 1]),
      (f = b.Ea),
      (h = Ou(b)),
      k
        ? (b.Y.h(c + g / 2 - b.focus.x - b.ma.x, e + h),
          (k = c + g / 2 - b.focus.x - b.ma.x),
          (d = Math.max(d, k + f.width)),
          0 > k && (d -= k),
          (e = Math.max(e, Math.max(p, n) + h + f.height)),
          0 > b.Y.x && (c = Pu(a, b.Y.x, !1, c, g)))
        : (b.Y.h(d + h, c + g / 2 - b.focus.y - b.ma.y),
          (d = Math.max(d, Math.max(r, m) + h + f.width)),
          (n = c + g / 2 - b.focus.y - b.ma.y),
          (e = Math.max(e, n + f.height)),
          0 > n && (e -= n),
          0 > b.Y.y && (c = Pu(a, b.Y.y, !0, c, g))));
    return new M(c, 0, d, e);
  }
  function Au(a, b, c, d, e) {
    G && x(a, Pt, Z, "layoutBusChildrenNegDir:v");
    var f = b.length;
    if (0 === f) return new M(c, 0, d, e);
    if (1 === f)
      return (b = b[0]), (d = b.Ea.width), (e = b.Ea.height), new M(c, 0, d, e);
    for (
      var g = a.nodeSpacing,
        h = a.rowSpacing,
        k = 270 === su(a),
        l = 0,
        m = 0,
        n = 0,
        p = 0;
      p < f;
      p++
    )
      if (!(0 !== p % 2 || (1 < f && p === f - 1))) {
        var r = b[p],
          q = r.Ea,
          u = 0 === l ? 0 : h;
        if (k) {
          var w = Nu(r) - g;
          n -= u + q.height;
          r.Y.h(c - (q.width + w), n);
          d = Math.max(d, q.width + w);
          e = Math.max(e, Math.abs(n));
        } else
          (w = Nu(r) - g),
            (m -= u + q.width),
            r.Y.h(m, c - (q.height + w)),
            (e = Math.max(e, q.height + w)),
            (d = Math.max(d, Math.abs(m)));
        l++;
      }
    l = 0;
    r = m;
    p = n;
    k ? ((m = c + g), (n = 0)) : ((m = 0), (n = c + g));
    for (q = 0; q < f; q++)
      if (0 !== q % 2) {
        u = b[q];
        w = u.Ea;
        var y = 0 === l ? 0 : h;
        if (k) {
          var z = Nu(u) - g;
          n -= y + w.height;
          u.Y.h(m + z, n);
          d = Math.max(d, m + w.width + z);
          e = Math.max(e, Math.abs(n));
        } else
          (z = Nu(u) - g),
            (m -= y + w.width),
            u.Y.h(m, n + z),
            (e = Math.max(e, n + w.height + z)),
            (d = Math.max(d, Math.abs(m)));
        l++;
      }
    1 < f &&
      1 === f % 2 &&
      ((h = b[f - 1]),
      (l = h.Ea),
      (q = Ou(h)),
      k
        ? (h.Y.h(c + g / 2 - h.focus.x - h.ma.x, -e - l.height - q),
          (m = c + g / 2 - h.focus.x - h.ma.x),
          (d = Math.max(d, m + l.width)),
          0 > m && (d -= m),
          (e = Math.max(e, Math.abs(Math.min(p, n)) + q + l.height)),
          0 > h.Y.x && (c = Pu(a, h.Y.x, !1, c, g)))
        : (h.Y.h(-d - l.width - q, c + g / 2 - h.focus.y - h.ma.y),
          (d = Math.max(d, Math.abs(Math.min(r, m)) + q + l.width)),
          (n = c + g / 2 - h.focus.y - h.ma.y),
          (e = Math.max(e, n + l.height)),
          0 > n && (e -= n),
          0 > h.Y.y && (c = Pu(a, h.Y.y, !0, c, g))));
    for (a = 0; a < f; a++)
      (g = b[a]), k ? g.Y.h(g.Y.x, g.Y.y + e) : g.Y.h(g.Y.x + d, g.Y.y);
    return new M(c, 0, d, e);
  }
  function Nu(a) {
    G && x(a, Pt, Z, "fixRelativePostions:child");
    return null === a.parent ? 0 : a.parent.nodeSpacing;
  }
  function Ou(a) {
    G && x(a, Pt, Z, "fixRelativePostions:lastchild");
    return null === a.parent ? 0 : a.parent.rowSpacing;
  }
  function Pu(a, b, c, d, e) {
    G && x(a, Pt, Z, "fixRelativePostions:v");
    a = a.children;
    for (var f = a.length, g = 0; g < f; g++)
      c ? a[g].Y.h(a[g].Y.x, a[g].Y.y - b) : a[g].Y.h(a[g].Y.x - b, a[g].Y.y);
    b = a[f - 1];
    return Math.max(
      d,
      c ? b.ma.y + b.focus.y - e / 2 : b.ma.x + b.focus.x - e / 2
    );
  }
  function Ju(a, b, c) {
    G && x(a, Pt, Z, "calculateSubwidth:v");
    switch (a.alignment) {
      case Iu:
      case Hu:
        return c + a.width > b && (b = c + a.width), 0 > c && (b -= c), b;
      case tu:
        return a.width > b ? a.width : b;
      case uu:
        return 2 * a.focus.x > b ? a.width : b + a.width - 2 * a.focus.x;
      case ku:
      case au:
        return Math.max(a.width, Math.max(b, c + a.width) - Math.min(0, c));
      case lu:
        return a.width - a.focus.x + a.nodeSpacing / 2 + b;
      case mu:
        return Math.max(a.width, a.focus.x + a.nodeSpacing / 2 + b);
      default:
        return b;
    }
  }
  function Ku(a, b, c) {
    G && x(a, Pt, Z, "calculateSubheight:v");
    switch (a.alignment) {
      case Iu:
      case Hu:
        return c + a.height > b && (b = c + a.height), 0 > c && (b -= c), b;
      case tu:
        return a.height > b ? a.height : b;
      case uu:
        return 2 * a.focus.y > b ? a.height : b + a.height - 2 * a.focus.y;
      case ku:
      case au:
        return Math.max(a.height, Math.max(b, c + a.height) - Math.min(0, c));
      case lu:
        return a.height - a.focus.y + a.nodeSpacing / 2 + b;
      case mu:
        return Math.max(a.height, a.focus.y + a.nodeSpacing / 2 + b);
      default:
        return b;
    }
  }
  function Lu(a, b, c) {
    G && x(a, F, Z, "alignOffset:align");
    switch (a) {
      case Hu:
        b /= 2;
        c /= 2;
        break;
      case Iu:
        b /= 2;
        c /= 2;
        break;
      case tu:
        c = b = 0;
        break;
      case uu:
        break;
      default:
        v("Unhandled alignment value " + a.toString());
    }
    return new K(b, c);
  }
  function Cu(a, b, c, d, e, f) {
    G && x(a, Pt, Z, "shiftRelPosAlign:v");
    G && x(b, F, Z, "shiftRelPosAlign:align");
    b = Lu(b, c, d);
    Fu(a, b.x, b.y, e, f);
  }
  function Fu(a, b, c, d, e) {
    G && x(a, Pt, Z, "shiftRelPos:v");
    if (0 !== b || 0 !== c)
      for (a = a.children; d <= e; d++) {
        var f = a[d].Y;
        f.x += b;
        f.y += c;
      }
  }
  function Du(a, b, c, d) {
    G &&
      (x(b, Pt, Z, "recordMidPoints:v"),
      A(c, "number", Z, "recordMidPoints:x"),
      A(d, "number", Z, "recordMidPoints:y"));
    var e = b.parent;
    switch (a.td) {
      case Kt:
        for (a = b.sourceEdges; a.next(); )
          (b = a.value), b.fromVertex === e && b.relativePoint.h(c, d);
        break;
      case Rt:
        for (a = b.destinationEdges; a.next(); )
          (b = a.value), b.toVertex === e && b.relativePoint.h(c, d);
        break;
      default:
        v("Unhandled path value " + a.td.toString());
    }
  }
  function Gu(a, b, c) {
    for (var d = 0; d < a.length; d++) {
      var e = a[d];
      e.x += b;
      e.y += c;
    }
  }
  function Eu(a, b, c, d, e, f, g, h) {
    G && x(b, Pt, Z, "mergeFringes:parent");
    G && x(c, Pt, Z, "mergeFringes:child");
    var k = su(b),
      l = 90 === k || 270 === k,
      m = b.nodeSpacing;
    b = d;
    var n = e;
    d = f;
    var p = g,
      r = c.qq,
      q = c.Cq;
    g = c.Ea;
    var u = l ? Math.max(p, g.height) : Math.max(d, g.width);
    if (null === r || k !== su(c))
      (r = Bu(a, 2)),
        (q = Bu(a, 2)),
        l
          ? (r[0].h(0, 0),
            r[1].h(0, g.height),
            q[0].h(g.width, 0),
            q[1].h(q[0].x, r[1].y))
          : (r[0].h(0, 0),
            r[1].h(g.width, 0),
            q[0].h(0, g.height),
            q[1].h(r[1].x, q[0].y));
    if (l) {
      p = 9999999;
      if (!(null === n || 2 > n.length || null === r || 2 > r.length))
        for (e = c = 0; c < n.length && e < r.length; ) {
          f = n[c];
          var w = r[e];
          k = w.x;
          l = w.y;
          k += d;
          var y = f;
          c + 1 < n.length && (y = n[c + 1]);
          var z = w;
          w = z.x;
          z = z.y;
          e + 1 < r.length && ((z = r[e + 1]), (w = z.x), (z = z.y), (w += d));
          var B = p;
          f.y === l
            ? (B = k - f.x)
            : f.y > l && f.y < z
            ? (B = k + ((f.y - l) / (z - l)) * (w - k) - f.x)
            : l > f.y &&
              l < y.y &&
              (B = k - (f.x + ((l - f.y) / (y.y - f.y)) * (y.x - f.x)));
          B < p && (p = B);
          y.y <= f.y ? c++ : z <= l ? e++ : (y.y <= z && c++, z <= y.y && e++);
        }
      p = d - p;
      p += m;
      c = r;
      e = p;
      if (null === b || 2 > b.length || null === c || 2 > c.length) d = null;
      else {
        m = Bu(a, b.length + c.length);
        for (d = f = k = 0; f < c.length && c[f].y < b[0].y; )
          (l = c[f++]), m[d++].h(l.x + e, l.y);
        for (; k < b.length; ) (l = b[k++]), m[d++].h(l.x, l.y);
        for (k = b[b.length - 1].y; f < c.length && c[f].y <= k; ) f++;
        for (; f < c.length && c[f].y > k; )
          (l = c[f++]), m[d++].h(l.x + e, l.y);
        c = Bu(a, d);
        for (k = 0; k < d; k++) c[k].assign(m[k]);
        Mu(a, m);
        d = c;
      }
      f = q;
      k = p;
      if (null === n || 2 > n.length || null === f || 2 > f.length) e = null;
      else {
        m = Bu(a, n.length + f.length);
        for (e = l = c = 0; c < n.length && n[c].y < f[0].y; )
          (y = n[c++]), m[e++].h(y.x, y.y);
        for (; l < f.length; ) (y = f[l++]), m[e++].h(y.x + k, y.y);
        for (f = f[f.length - 1].y; c < n.length && n[c].y <= f; ) c++;
        for (; c < n.length && n[c].y > f; ) (k = n[c++]), m[e++].h(k.x, k.y);
        f = Bu(a, e);
        for (c = 0; c < e; c++) f[c].assign(m[c]);
        Mu(a, m);
        e = f;
      }
      f = Math.max(0, p) + g.width;
      g = u;
      Mu(a, b);
      Mu(a, r);
      Mu(a, n);
      Mu(a, q);
      h[0] = d;
      h[1] = e;
      return new M(p, 0, f, g);
    }
    d = 9999999;
    if (!(null === n || 2 > n.length || null === r || 2 > r.length))
      for (e = c = 0; c < n.length && e < r.length; )
        (f = n[c]),
          (w = r[e]),
          (k = w.x),
          (l = w.y),
          (l += p),
          (y = f),
          c + 1 < n.length && (y = n[c + 1]),
          (z = w),
          (w = z.x),
          (z = z.y),
          e + 1 < r.length && ((z = r[e + 1]), (w = z.x), (z = z.y), (z += p)),
          (B = d),
          f.x === k
            ? (B = l - f.y)
            : f.x > k && f.x < w
            ? (B = l + ((f.x - k) / (w - k)) * (z - l) - f.y)
            : k > f.x &&
              k < y.x &&
              (B = l - (f.y + ((k - f.x) / (y.x - f.x)) * (y.y - f.y))),
          B < d && (d = B),
          y.x <= f.x ? c++ : w <= k ? e++ : (y.x <= w && c++, w <= y.x && e++);
    p -= d;
    p += m;
    c = r;
    e = p;
    if (null === b || 2 > b.length || null === c || 2 > c.length) d = null;
    else {
      m = Bu(a, b.length + c.length);
      for (d = f = k = 0; f < c.length && c[f].x < b[0].x; )
        (l = c[f++]), m[d++].h(l.x, l.y + e);
      for (; k < b.length; ) (l = b[k++]), m[d++].h(l.x, l.y);
      for (k = b[b.length - 1].x; f < c.length && c[f].x <= k; ) f++;
      for (; f < c.length && c[f].x > k; ) (l = c[f++]), m[d++].h(l.x, l.y + e);
      c = Bu(a, d);
      for (k = 0; k < d; k++) c[k].assign(m[k]);
      Mu(a, m);
      d = c;
    }
    f = q;
    k = p;
    if (null === n || 2 > n.length || null === f || 2 > f.length) e = null;
    else {
      m = Bu(a, n.length + f.length);
      for (e = l = c = 0; c < n.length && n[c].x < f[0].x; )
        (y = n[c++]), m[e++].h(y.x, y.y);
      for (; l < f.length; ) (y = f[l++]), m[e++].h(y.x, y.y + k);
      for (f = f[f.length - 1].x; c < n.length && n[c].x <= f; ) c++;
      for (; c < n.length && n[c].x > f; ) (k = n[c++]), m[e++].h(k.x, k.y);
      f = Bu(a, e);
      for (c = 0; c < e; c++) f[c].assign(m[c]);
      Mu(a, m);
      e = f;
    }
    f = u;
    g = Math.max(0, p) + g.height;
    Mu(a, b);
    Mu(a, r);
    Mu(a, n);
    Mu(a, q);
    h[0] = d;
    h[1] = e;
    return new M(p, 0, f, g);
  }
  function Bu(a, b) {
    a = a.Pu[b];
    if (void 0 !== a && ((a = a.pop()), void 0 !== a)) return a;
    a = [];
    for (var c = 0; c < b; c++) a[c] = new K();
    return a;
  }
  function Mu(a, b) {
    var c = b.length,
      d = a.Pu[c];
    void 0 === d && ((d = []), (a.Pu[c] = d));
    d.push(b);
  }
  Z.prototype.arrangeTrees = function () {
    if (this.Pb === Qt)
      for (var a = this.Sb.iterator; a.next(); ) {
        var b = a.value;
        if (b instanceof Pt) {
          var c = b.node;
          if (null !== c) {
            var d = c.position;
            c = d.x;
            d = d.y;
            isFinite(c) || (c = 0);
            isFinite(d) || (d = 0);
            Qu(this, b, c, d);
          }
        }
      }
    else {
      a = [];
      for (b = this.Sb.iterator; b.next(); )
        (c = b.value), c instanceof Pt && a.push(c);
      switch (this.sorting) {
        case fu:
          break;
        case gu:
          a.reverse();
          break;
        case hu:
          a.sort(this.comparer);
          break;
        case iu:
          a.sort(this.comparer);
          a.reverse();
          break;
        default:
          v("Unhandled sorting value " + this.sorting.toString());
      }
      c = this.arrangementOrigin;
      b = c.x;
      c = c.y;
      for (d = 0; d < a.length; d++) {
        var e = a[d];
        Qu(this, e, b + e.ma.x, c + e.ma.y);
        switch (this.Pb) {
          case Nt:
            c += e.Ea.height + this.Wd.height;
            break;
          case Ru:
            b += e.Ea.width + this.Wd.width;
            break;
          default:
            v("Unhandled arrangement value " + this.Pb.toString());
        }
      }
    }
  };
  function Qu(a, b, c, d) {
    if (null !== b) {
      G && x(b, Pt, Z, "assignAbsolutePositions:v");
      b.x = c;
      b.y = d;
      b = b.children;
      for (var e = b.length, f = 0; f < e; f++) {
        var g = b[f];
        Qu(a, g, c + g.Y.x, d + g.Y.y);
      }
    }
  }
  Z.prototype.commitLayout = function () {
    this.Yv();
    this.commitNodes();
    this.fv();
    this.isRouting && this.commitLinks();
  };
  Z.prototype.commitNodes = function () {
    for (var a = this.network.vertexes.iterator; a.next(); ) a.value.commit();
    for (a.reset(); a.next(); ) this.layoutComments(a.value);
  };
  Z.prototype.fv = function () {
    if (this.layerStyle === Yt) {
      for (
        var a = this.Aw, b = [], c = null, d = this.network.vertexes.iterator;
        d.next();

      ) {
        var e = d.value;
        null === c ? (c = e.bounds.copy()) : c.Xc(e.bounds);
        var f = b[e.level];
        void 0 === f ? (f = xu(e)) : (f = Math.max(f, xu(e)));
        b[e.level] = f;
      }
      for (d = 0; d < b.length; d++) void 0 === b[d] && (b[d] = 0);
      90 === this.angle || 270 === this.angle
        ? (c.Qc(this.nodeSpacing / 2, this.layerSpacing),
          (d = new K(-this.nodeSpacing / 2, -this.layerSpacing / 2)))
        : (c.Qc(this.layerSpacing, this.nodeSpacing / 2),
          (d = new K(-this.layerSpacing / 2, -this.nodeSpacing / 2)));
      e = [];
      c = 90 === this.angle || 270 === this.angle ? c.width : c.height;
      f = 0;
      if (180 === this.angle || 270 === this.angle)
        for (var g = 0; g < a.length; g++) f += a[g] + b[g];
      for (g = 0; g < a.length; g++) {
        var h = a[g] + b[g];
        270 === this.angle
          ? ((f -= h), e.push(new M(0, f, c, h)))
          : 90 === this.angle
          ? (e.push(new M(0, f, c, h)), (f += h))
          : 180 === this.angle
          ? ((f -= h), e.push(new M(f, 0, h, c)))
          : (e.push(new M(f, 0, h, c)), (f += h));
      }
      this.commitLayers(e, d);
    }
  };
  Z.prototype.commitLayers = function () {};
  Z.prototype.commitLinks = function () {
    for (var a = this.network.edges.iterator; a.next(); ) a.value.commit();
  };
  Z.prototype.Yv = function () {
    for (var a = this.Sb.iterator; a.next(); ) {
      var b = a.value;
      b instanceof Pt && Su(this, b);
    }
  };
  function Su(a, b) {
    if (null !== b) {
      G && x(b, Pt, Z, "setPortSpotsTree:v");
      a.setPortSpots(b);
      b = b.children;
      for (var c = b.length, d = 0; d < c; d++) Su(a, b[d]);
    }
  }
  Z.prototype.setPortSpots = function (a) {
    G && x(a, Pt, Z, "setPortSpots:v");
    var b = a.alignment;
    if (ju(b)) {
      G && x(a, Pt, Z, "setPortSpotsBus:v");
      G && x(b, F, Z, "setPortSpots:align");
      var c = this.td === Kt,
        d = su(a);
      switch (d) {
        case 0:
          var e = qd;
          break;
        case 90:
          e = rd;
          break;
        case 180:
          e = pd;
          break;
        default:
          e = od;
      }
      var f = a.children,
        g = f.length;
      switch (b) {
        case ku:
        case au:
          for (b = 0; b < g; b++) {
            var h = f[b];
            h = (c ? h.sourceEdges : h.destinationEdges).first();
            if (null !== h && ((h = h.link), null !== h)) {
              var k = 90 === d || 270 === d ? pd : od;
              if (1 === g || (b === g - 1 && 1 === g % 2))
                switch (d) {
                  case 0:
                    k = pd;
                    break;
                  case 90:
                    k = od;
                    break;
                  case 180:
                    k = qd;
                    break;
                  default:
                    k = rd;
                }
              else 0 === b % 2 && (k = 90 === d || 270 === d ? qd : rd);
              c
                ? (a.setsPortSpot && (h.fromSpot = e),
                  a.setsChildPortSpot && (h.toSpot = k))
                : (a.setsPortSpot && (h.fromSpot = k),
                  a.setsChildPortSpot && (h.toSpot = e));
            }
          }
          break;
        case lu:
          d = 90 === d || 270 === d ? qd : rd;
          for (f = c ? a.destinationEdges : a.sourceEdges; f.next(); )
            (g = f.value.link),
              null !== g &&
                (c
                  ? (a.setsPortSpot && (g.fromSpot = e),
                    a.setsChildPortSpot && (g.toSpot = d))
                  : (a.setsPortSpot && (g.fromSpot = d),
                    a.setsChildPortSpot && (g.toSpot = e)));
          break;
        case mu:
          for (
            d = 90 === d || 270 === d ? pd : od,
              f = c ? a.destinationEdges : a.sourceEdges;
            f.next();

          )
            (g = f.value.link),
              null !== g &&
                (c
                  ? (a.setsPortSpot && (g.fromSpot = e),
                    a.setsChildPortSpot && (g.toSpot = d))
                  : (a.setsPortSpot && (g.fromSpot = d),
                    a.setsChildPortSpot && (g.toSpot = e)));
      }
    } else if (((c = su(a)), this.td === Kt))
      for (e = a.destinationEdges; e.next(); ) {
        if (((d = e.value.link), null !== d)) {
          if (a.setsPortSpot)
            if (a.portSpot.Nb())
              switch (c) {
                case 0:
                  d.fromSpot = qd;
                  break;
                case 90:
                  d.fromSpot = rd;
                  break;
                case 180:
                  d.fromSpot = pd;
                  break;
                default:
                  d.fromSpot = od;
              }
            else d.fromSpot = a.portSpot;
          if (a.setsChildPortSpot)
            if (a.childPortSpot.Nb())
              switch (c) {
                case 0:
                  d.toSpot = pd;
                  break;
                case 90:
                  d.toSpot = od;
                  break;
                case 180:
                  d.toSpot = qd;
                  break;
                default:
                  d.toSpot = rd;
              }
            else d.toSpot = a.childPortSpot;
        }
      }
    else
      for (e = a.sourceEdges; e.next(); )
        if (((d = e.value.link), null !== d)) {
          if (a.setsPortSpot)
            if (a.portSpot.Nb())
              switch (c) {
                case 0:
                  d.toSpot = qd;
                  break;
                case 90:
                  d.toSpot = rd;
                  break;
                case 180:
                  d.toSpot = pd;
                  break;
                default:
                  d.toSpot = od;
              }
            else d.toSpot = a.portSpot;
          if (a.setsChildPortSpot)
            if (a.childPortSpot.Nb())
              switch (c) {
                case 0:
                  d.fromSpot = pd;
                  break;
                case 90:
                  d.fromSpot = od;
                  break;
                case 180:
                  d.fromSpot = qd;
                  break;
                default:
                  d.fromSpot = rd;
              }
            else d.fromSpot = a.childPortSpot;
        }
  };
  function su(a) {
    a = a.angle;
    return 45 >= a ? 0 : 135 >= a ? 90 : 225 >= a ? 180 : 315 >= a ? 270 : 0;
  }
  function xu(a) {
    G && x(a, Pt, Z, "computeLayerSpacing:v");
    var b = su(a);
    b = 90 === b || 270 === b;
    var c = a.layerSpacing;
    if (0 < a.layerSpacingParentOverlap) {
      var d = Math.min(1, a.layerSpacingParentOverlap);
      c -= b ? a.height * d : a.width * d;
    }
    c < (b ? -a.height : -a.width) && (c = b ? -a.height : -a.width);
    return c;
  }
  function yu(a) {
    G && x(a, Pt, Z, "computeNodeIndent:v");
    var b = su(a),
      c = a.nodeIndent;
    if (0 < a.nodeIndentPastParent) {
      var d = Math.min(1, a.nodeIndentPastParent);
      c += 90 === b || 270 === b ? a.width * d : a.height * d;
    }
    return (c = Math.max(0, c));
  }
  oa.Object.defineProperties(Z.prototype, {
    roots: {
      configurable: !0,
      get: function () {
        return this.Sb;
      },
      set: function (a) {
        this.Sb !== a && (x(a, I, Z, "roots"), (this.Sb = a), this.F());
      },
    },
    path: {
      configurable: !0,
      get: function () {
        return this.Xo;
      },
      set: function (a) {
        this.Xo !== a && (cb(a, Z, Z, "path"), (this.Xo = a), this.F());
      },
    },
    treeStyle: {
      configurable: !0,
      get: function () {
        return this.Np;
      },
      set: function (a) {
        this.Pb !== a &&
          (cb(a, Z, Z, "treeStyle"),
          a === Lt || a === du || a === eu || a === cu) &&
          ((this.Np = a), this.F());
      },
    },
    layerStyle: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Er;
      },
      set: function (a) {
        this.Pb !== a &&
          (cb(a, Z, Z, "layerStyle"), a === Mt || a === Zt || a === Yt) &&
          ((this.Er = a), this.F());
      },
    },
    comments: {
      configurable: !0,
      get: function () {
        return this.rd;
      },
      set: function (a) {
        this.rd !== a &&
          (A(a, "boolean", Z, "comments"), (this.rd = a), this.F());
      },
    },
    arrangement: {
      configurable: !0,
      get: function () {
        return this.Pb;
      },
      set: function (a) {
        this.Pb !== a &&
          (cb(a, Z, Z, "arrangement"), a === Nt || a === Ru || a === Qt) &&
          ((this.Pb = a), this.F());
      },
    },
    arrangementSpacing: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Wd;
      },
      set: function (a) {
        x(a, Gb, Z, "arrangementSpacing");
        this.Wd.D(a) || (this.Wd.assign(a), this.F());
      },
    },
    rootDefaults: {
      configurable: !0,
      get: function () {
        return this.Z;
      },
      set: function (a) {
        this.Z !== a && (x(a, Pt, Z, "rootDefaults"), (this.Z = a), this.F());
      },
    },
    alternateDefaults: {
      configurable: !0,
      get: function () {
        return this.$;
      },
      set: function (a) {
        this.$ !== a &&
          (x(a, Pt, Z, "alternateDefaults"), (this.$ = a), this.F());
      },
    },
    sorting: {
      configurable: !0,
      get: function () {
        return this.Z.sorting;
      },
      set: function (a) {
        this.Z.sorting !== a &&
          (cb(a, Z, Z, "sorting"), a === fu || a === gu || a === hu || iu) &&
          ((this.Z.sorting = a), this.F());
      },
    },
    comparer: {
      configurable: !0,
      get: function () {
        return this.Z.comparer;
      },
      set: function (a) {
        this.Z.comparer !== a &&
          (A(a, "function", Z, "comparer"), (this.Z.comparer = a), this.F());
      },
    },
    angle: {
      configurable: !0,
      get: function () {
        return this.Z.angle;
      },
      set: function (a) {
        this.Z.angle !== a &&
          (A(a, "number", Z, "angle"),
          0 === a || 90 === a || 180 === a || 270 === a
            ? ((this.Z.angle = a), this.F())
            : v("TreeLayout.angle must be 0, 90, 180, or 270"));
      },
    },
    alignment: {
      configurable: !0,
      get: function () {
        return this.Z.alignment;
      },
      set: function (a) {
        this.Z.alignment !== a &&
          (cb(a, Z, Z, "alignment"), (this.Z.alignment = a), this.F());
      },
    },
    nodeIndent: {
      configurable: !0,
      get: function () {
        return this.Z.nodeIndent;
      },
      set: function (a) {
        this.Z.nodeIndent !== a &&
          (A(a, "number", Z, "nodeIndent"),
          0 <= a && ((this.Z.nodeIndent = a), this.F()));
      },
    },
    nodeIndentPastParent: {
      configurable: !0,
      get: function () {
        return this.Z.nodeIndentPastParent;
      },
      set: function (a) {
        this.Z.nodeIndentPastParent !== a &&
          (A(a, "number", Z, "nodeIndentPastParent"),
          0 <= a && 1 >= a && ((this.Z.nodeIndentPastParent = a), this.F()));
      },
    },
    nodeSpacing: {
      configurable: !0,
      get: function () {
        return this.Z.nodeSpacing;
      },
      set: function (a) {
        this.Z.nodeSpacing !== a &&
          (A(a, "number", Z, "nodeSpacing"),
          (this.Z.nodeSpacing = a),
          this.F());
      },
    },
    layerSpacing: {
      configurable: !0,
      get: function () {
        return this.Z.layerSpacing;
      },
      set: function (a) {
        this.Z.layerSpacing !== a &&
          (A(a, "number", Z, "layerSpacing"),
          (this.Z.layerSpacing = a),
          this.F());
      },
    },
    layerSpacingParentOverlap: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Z.layerSpacingParentOverlap;
      },
      set: function (a) {
        this.Z.layerSpacingParentOverlap !== a &&
          (A(a, "number", Z, "layerSpacingParentOverlap"),
          0 <= a &&
            1 >= a &&
            ((this.Z.layerSpacingParentOverlap = a), this.F()));
      },
    },
    compaction: {
      configurable: !0,
      get: function () {
        return this.Z.compaction;
      },
      set: function (a) {
        this.Z.compaction !== a &&
          (cb(a, Z, Z, "compaction"), a === pu || a === ru) &&
          ((this.Z.compaction = a), this.F());
      },
    },
    breadthLimit: {
      configurable: !0,
      get: function () {
        return this.Z.breadthLimit;
      },
      set: function (a) {
        this.Z.breadthLimit !== a &&
          (A(a, "number", Z, "breadthLimit"),
          0 <= a && ((this.Z.breadthLimit = a), this.F()));
      },
    },
    rowSpacing: {
      configurable: !0,
      get: function () {
        return this.Z.rowSpacing;
      },
      set: function (a) {
        this.Z.rowSpacing !== a &&
          (A(a, "number", Z, "rowSpacing"), (this.Z.rowSpacing = a), this.F());
      },
    },
    rowIndent: {
      configurable: !0,
      get: function () {
        return this.Z.rowIndent;
      },
      set: function (a) {
        this.Z.rowIndent !== a &&
          (A(a, "number", Z, "rowIndent"),
          0 <= a && ((this.Z.rowIndent = a), this.F()));
      },
    },
    commentSpacing: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Z.commentSpacing;
      },
      set: function (a) {
        this.Z.commentSpacing !== a &&
          (A(a, "number", Z, "commentSpacing"),
          (this.Z.commentSpacing = a),
          this.F());
      },
    },
    commentMargin: {
      configurable: !0,
      get: function () {
        return this.Z.commentMargin;
      },
      set: function (a) {
        this.Z.commentMargin !== a &&
          (A(a, "number", Z, "commentMargin"),
          (this.Z.commentMargin = a),
          this.F());
      },
    },
    setsPortSpot: {
      configurable: !0,
      get: function () {
        return this.Z.setsPortSpot;
      },
      set: function (a) {
        this.Z.setsPortSpot !== a &&
          (A(a, "boolean", Z, "setsPortSpot"),
          (this.Z.setsPortSpot = a),
          this.F());
      },
    },
    portSpot: {
      configurable: !0,
      get: function () {
        return this.Z.portSpot;
      },
      set: function (a) {
        x(a, Ib, Z, "portSpot");
        this.Z.portSpot.D(a) || ((this.Z.portSpot = a), this.F());
      },
    },
    setsChildPortSpot: {
      configurable: !0,
      get: function () {
        return this.Z.setsChildPortSpot;
      },
      set: function (a) {
        this.Z.setsChildPortSpot !== a &&
          (A(a, "boolean", Z, "setsChildPortSpot"),
          (this.Z.setsChildPortSpot = a),
          this.F());
      },
    },
    childPortSpot: {
      configurable: !0,
      get: function () {
        return this.Z.childPortSpot;
      },
      set: function (a) {
        x(a, Ib, Z, "childPortSpot");
        this.Z.childPortSpot.D(a) || ((this.Z.childPortSpot = a), this.F());
      },
    },
    alternateSorting: {
      configurable: !0,
      get: function () {
        return this.$.sorting;
      },
      set: function (a) {
        this.$.sorting !== a &&
          (cb(a, Z, Z, "alternateSorting"),
          a === fu || a === gu || a === hu || iu) &&
          ((this.$.sorting = a), this.F());
      },
    },
    alternateComparer: {
      configurable: !0,
      get: function () {
        return this.$.comparer;
      },
      set: function (a) {
        this.$.comparer !== a &&
          (A(a, "function", Z, "alternateComparer"),
          (this.$.comparer = a),
          this.F());
      },
    },
    alternateAngle: {
      configurable: !0,
      get: function () {
        return this.$.angle;
      },
      set: function (a) {
        this.$.angle !== a &&
          (A(a, "number", Z, "alternateAngle"),
          0 === a || 90 === a || 180 === a || 270 === a) &&
          ((this.$.angle = a), this.F());
      },
    },
    alternateAlignment: {
      configurable: !0,
      get: function () {
        return this.$.alignment;
      },
      set: function (a) {
        this.$.alignment !== a &&
          (cb(a, Z, Z, "alternateAlignment"), (this.$.alignment = a), this.F());
      },
    },
    alternateNodeIndent: {
      configurable: !0,
      get: function () {
        return this.$.nodeIndent;
      },
      set: function (a) {
        this.$.nodeIndent !== a &&
          (A(a, "number", Z, "alternateNodeIndent"),
          0 <= a && ((this.$.nodeIndent = a), this.F()));
      },
    },
    alternateNodeIndentPastParent: {
      configurable: !0,
      get: function () {
        return this.$.nodeIndentPastParent;
      },
      set: function (a) {
        this.$.nodeIndentPastParent !== a &&
          (A(a, "number", Z, "alternateNodeIndentPastParent"),
          0 <= a && 1 >= a && ((this.$.nodeIndentPastParent = a), this.F()));
      },
    },
    alternateNodeSpacing: {
      configurable: !0,
      get: function () {
        return this.$.nodeSpacing;
      },
      set: function (a) {
        this.$.nodeSpacing !== a &&
          (A(a, "number", Z, "alternateNodeSpacing"),
          (this.$.nodeSpacing = a),
          this.F());
      },
    },
    alternateLayerSpacing: {
      configurable: !0,
      get: function () {
        return this.$.layerSpacing;
      },
      set: function (a) {
        this.$.layerSpacing !== a &&
          (A(a, "number", Z, "alternateLayerSpacing"),
          (this.$.layerSpacing = a),
          this.F());
      },
    },
    alternateLayerSpacingParentOverlap: {
      configurable: !0,
      get: function () {
        return this.$.layerSpacingParentOverlap;
      },
      set: function (a) {
        this.$.layerSpacingParentOverlap !== a &&
          (A(a, "number", Z, "alternateLayerSpacingParentOverlap"),
          0 <= a &&
            1 >= a &&
            ((this.$.layerSpacingParentOverlap = a), this.F()));
      },
    },
    alternateCompaction: {
      configurable: !0,
      get: function () {
        return this.$.compaction;
      },
      set: function (a) {
        this.$.compaction !== a &&
          (cb(a, Z, Z, "alternateCompaction"), a === pu || a === ru) &&
          ((this.$.compaction = a), this.F());
      },
    },
    alternateBreadthLimit: {
      configurable: !0,
      get: function () {
        return this.$.breadthLimit;
      },
      set: function (a) {
        this.$.breadthLimit !== a &&
          (A(a, "number", Z, "alternateBreadthLimit"),
          0 <= a && ((this.$.breadthLimit = a), this.F()));
      },
    },
    alternateRowSpacing: {
      configurable: !0,
      get: function () {
        return this.$.rowSpacing;
      },
      set: function (a) {
        this.$.rowSpacing !== a &&
          (A(a, "number", Z, "alternateRowSpacing"),
          (this.$.rowSpacing = a),
          this.F());
      },
    },
    alternateRowIndent: {
      configurable: !0,
      get: function () {
        return this.$.rowIndent;
      },
      set: function (a) {
        this.$.rowIndent !== a &&
          (A(a, "number", Z, "alternateRowIndent"),
          0 <= a && ((this.$.rowIndent = a), this.F()));
      },
    },
    alternateCommentSpacing: {
      configurable: !0,
      get: function () {
        return this.$.commentSpacing;
      },
      set: function (a) {
        this.$.commentSpacing !== a &&
          (A(a, "number", Z, "alternateCommentSpacing"),
          (this.$.commentSpacing = a),
          this.F());
      },
    },
    alternateCommentMargin: {
      configurable: !0,
      get: function () {
        return this.$.commentMargin;
      },
      set: function (a) {
        this.$.commentMargin !== a &&
          (A(a, "number", Z, "alternateCommentMargin"),
          (this.$.commentMargin = a),
          this.F());
      },
    },
    alternateSetsPortSpot: {
      configurable: !0,
      get: function () {
        return this.$.setsPortSpot;
      },
      set: function (a) {
        this.$.setsPortSpot !== a &&
          (A(a, "boolean", Z, "alternateSetsPortSpot"),
          (this.$.setsPortSpot = a),
          this.F());
      },
    },
    alternatePortSpot: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.$.portSpot;
      },
      set: function (a) {
        x(a, Ib, Z, "alternatePortSpot");
        this.$.portSpot.D(a) || ((this.$.portSpot = a), this.F());
      },
    },
    alternateSetsChildPortSpot: {
      configurable: !0,
      get: function () {
        return this.$.setsChildPortSpot;
      },
      set: function (a) {
        this.$.setsChildPortSpot !== a &&
          (A(a, "boolean", Z, "alternateSetsChildPortSpot"),
          (this.$.setsChildPortSpot = a),
          this.F());
      },
    },
    alternateChildPortSpot: {
      configurable: !0,
      get: function () {
        return this.$.childPortSpot;
      },
      set: function (a) {
        x(a, Ib, Z, "alternateChildPortSpot");
        this.$.childPortSpot.D(a) || ((this.$.childPortSpot = a), this.F());
      },
    },
  });
  var Jt = new F(Z, "PathDefault", -1),
    Kt = new F(Z, "PathDestination", 0),
    Rt = new F(Z, "PathSource", 1),
    fu = new F(Z, "SortingForwards", 10),
    gu = new F(Z, "SortingReverse", 11),
    hu = new F(Z, "SortingAscending", 12),
    iu = new F(Z, "SortingDescending", 13),
    Hu = new F(Z, "AlignmentCenterSubtrees", 20),
    Iu = new F(Z, "AlignmentCenterChildren", 21),
    tu = new F(Z, "AlignmentStart", 22),
    uu = new F(Z, "AlignmentEnd", 23),
    ku = new F(Z, "AlignmentBus", 24),
    au = new F(Z, "AlignmentBusBranching", 25),
    lu = new F(Z, "AlignmentTopLeftBus", 26),
    mu = new F(Z, "AlignmentBottomRightBus", 27),
    pu = new F(Z, "CompactionNone", 30),
    ru = new F(Z, "CompactionBlock", 31),
    Lt = new F(Z, "StyleLayered", 40),
    eu = new F(Z, "StyleLastParents", 41),
    du = new F(Z, "StyleAlternating", 42),
    cu = new F(Z, "StyleRootOnly", 43),
    Nt = new F(Z, "ArrangementVertical", 50),
    Ru = new F(Z, "ArrangementHorizontal", 51),
    Qt = new F(Z, "ArrangementFixedRoots", 52),
    Mt = new F(Z, "LayerIndividual", 60),
    Zt = new F(Z, "LayerSiblings", 61),
    Yt = new F(Z, "LayerUniform", 62);
  Z.className = "TreeLayout";
  Z.PathDefault = Jt;
  Z.PathDestination = Kt;
  Z.PathSource = Rt;
  Z.SortingForwards = fu;
  Z.SortingReverse = gu;
  Z.SortingAscending = hu;
  Z.SortingDescending = iu;
  Z.AlignmentCenterSubtrees = Hu;
  Z.AlignmentCenterChildren = Iu;
  Z.AlignmentStart = tu;
  Z.AlignmentEnd = uu;
  Z.AlignmentBus = ku;
  Z.AlignmentBusBranching = au;
  Z.AlignmentTopLeftBus = lu;
  Z.AlignmentBottomRightBus = mu;
  Z.CompactionNone = pu;
  Z.CompactionBlock = ru;
  Z.StyleLayered = Lt;
  Z.StyleLastParents = eu;
  Z.StyleAlternating = du;
  Z.StyleRootOnly = cu;
  Z.ArrangementVertical = Nt;
  Z.ArrangementHorizontal = Ru;
  Z.ArrangementFixedRoots = Qt;
  Z.LayerIndividual = Mt;
  Z.LayerSiblings = Zt;
  Z.LayerUniform = Yt;
  function Ot(a) {
    mq.call(this, a);
  }
  na(Ot, mq);
  Ot.prototype.createVertex = function () {
    return new Pt(this);
  };
  Ot.prototype.createEdge = function () {
    return new Tu(this);
  };
  Ot.className = "TreeNetwork";
  function Pt(a) {
    Aq.call(this, a);
    this.Ba = !1;
    this.Hc = null;
    this.B = [];
    this.Yc = this.eb = this.M = this.Na = 0;
    this.rd = null;
    this.Y = new K(0, 0);
    this.Ea = new Gb(0, 0);
    this.ma = new K(0, 0);
    this.Fm = this.Em = this.YA = !1;
    this.Cq = this.qq = null;
    this.hd = fu;
    this.ad = Hq;
    this.Fb = 0;
    this.Eb = Iu;
    this.Nr = this.Mr = 0;
    this.Or = 20;
    this.de = 50;
    this.Dr = 0;
    this.Wq = ru;
    this.Pq = 0;
    this.Xr = 25;
    this.Vq = this.Wr = 10;
    this.Uq = 20;
    this.cs = !0;
    this.Tr = gd;
    this.bs = !0;
    this.Sq = gd;
  }
  na(Pt, Aq);
  Pt.prototype.copyInheritedPropertiesFrom = function (a) {
    null !== a &&
      ((this.hd = a.sorting),
      (this.ad = a.comparer),
      (this.Fb = a.angle),
      (this.Eb = a.alignment),
      (this.Mr = a.nodeIndent),
      (this.Nr = a.nodeIndentPastParent),
      (this.Or = a.nodeSpacing),
      (this.de = a.layerSpacing),
      (this.Dr = a.layerSpacingParentOverlap),
      (this.Wq = a.compaction),
      (this.Pq = a.breadthLimit),
      (this.Xr = a.rowSpacing),
      (this.Wr = a.rowIndent),
      (this.Vq = a.commentSpacing),
      (this.Uq = a.commentMargin),
      (this.cs = a.setsPortSpot),
      (this.Tr = a.portSpot),
      (this.bs = a.setsChildPortSpot),
      (this.Sq = a.childPortSpot));
  };
  oa.Object.defineProperties(Pt.prototype, {
    initialized: {
      configurable: !0,
      get: function () {
        return this.Ba;
      },
      set: function (a) {
        this.Ba !== a && (A(a, "boolean", Pt, "initialized"), (this.Ba = a));
      },
    },
    parent: {
      configurable: !0,
      get: function () {
        return this.Hc;
      },
      set: function (a) {
        this.Hc !== a &&
          (G && null !== a && x(a, Pt, Pt, "parent"), (this.Hc = a));
      },
    },
    children: {
      configurable: !0,
      get: function () {
        return this.B;
      },
      set: function (a) {
        if (this.B !== a) {
          null === a ||
            Array.isArray(a) ||
            za(a, "Array", Pt, "children:value");
          if (null !== a)
            for (var b = a.length, c = 0; c < b; c++) {
              var d = a[c];
              G && x(d, Pt, Pt, "children");
            }
          this.B = a;
        }
      },
    },
    level: {
      configurable: !0,
      get: function () {
        return this.Na;
      },
      set: function (a) {
        this.Na !== a && (A(a, "number", Pt, "level"), (this.Na = a));
      },
    },
    descendantCount: {
      configurable: !0,
      get: function () {
        return this.M;
      },
      set: function (a) {
        this.M !== a && (A(a, "number", Pt, "descendantCount"), (this.M = a));
      },
    },
    maxChildrenCount: {
      configurable: !0,
      get: function () {
        return this.eb;
      },
      set: function (a) {
        this.eb !== a &&
          (A(a, "number", Pt, "maxChildrenCount"), (this.eb = a));
      },
    },
    maxGenerationCount: {
      configurable: !0,
      get: function () {
        return this.Yc;
      },
      set: function (a) {
        this.Yc !== a &&
          (A(a, "number", Pt, "maxGenerationCount"), (this.Yc = a));
      },
    },
    comments: {
      configurable: !0,
      get: function () {
        return this.rd;
      },
      set: function (a) {
        if (this.rd !== a) {
          null === a ||
            Array.isArray(a) ||
            za(a, "Array", Pt, "comments:value");
          if (null !== a)
            for (var b = a.length, c = 0; c < b; c++) {
              var d = a[c];
              G && x(d, V, Pt, "comments");
            }
          this.rd = a;
        }
      },
    },
    sorting: {
      configurable: !0,
      get: function () {
        return this.hd;
      },
      set: function (a) {
        this.hd !== a && (cb(a, Z, Pt, "sorting"), (this.hd = a));
      },
    },
    comparer: {
      configurable: !0,
      get: function () {
        return this.ad;
      },
      set: function (a) {
        this.ad !== a && (A(a, "function", Pt, "comparer"), (this.ad = a));
      },
    },
    angle: {
      configurable: !0,
      get: function () {
        return this.Fb;
      },
      set: function (a) {
        this.Fb !== a && (A(a, "number", Pt, "angle"), (this.Fb = a));
      },
    },
    alignment: {
      configurable: !0,
      get: function () {
        return this.Eb;
      },
      set: function (a) {
        this.Eb !== a && (cb(a, Z, Pt, "alignment"), (this.Eb = a));
      },
    },
    nodeIndent: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Mr;
      },
      set: function (a) {
        this.Mr !== a && (A(a, "number", Pt, "nodeIndent"), (this.Mr = a));
      },
    },
    nodeIndentPastParent: {
      configurable: !0,
      get: function () {
        return this.Nr;
      },
      set: function (a) {
        this.Nr !== a &&
          (A(a, "number", Pt, "nodeIndentPastParent"), (this.Nr = a));
      },
    },
    nodeSpacing: {
      configurable: !0,
      get: function () {
        return this.Or;
      },
      set: function (a) {
        this.Or !== a && (A(a, "number", Pt, "nodeSpacing"), (this.Or = a));
      },
    },
    layerSpacing: {
      configurable: !0,
      get: function () {
        return this.de;
      },
      set: function (a) {
        this.de !== a && (A(a, "number", Pt, "layerSpacing"), (this.de = a));
      },
    },
    layerSpacingParentOverlap: {
      configurable: !0,
      get: function () {
        return this.Dr;
      },
      set: function (a) {
        this.Dr !== a &&
          (A(a, "number", Pt, "layerSpacingParentOverlap"), (this.Dr = a));
      },
    },
    compaction: {
      configurable: !0,
      get: function () {
        return this.Wq;
      },
      set: function (a) {
        this.Wq !== a && (cb(a, Z, Pt, "compaction"), (this.Wq = a));
      },
    },
    breadthLimit: {
      configurable: !0,
      get: function () {
        return this.Pq;
      },
      set: function (a) {
        this.Pq !== a && (A(a, "number", Pt, "breadthLimit"), (this.Pq = a));
      },
    },
    rowSpacing: {
      configurable: !0,
      get: function () {
        return this.Xr;
      },
      set: function (a) {
        this.Xr !== a && (A(a, "number", Pt, "rowSpacing"), (this.Xr = a));
      },
    },
    rowIndent: {
      configurable: !0,
      get: function () {
        return this.Wr;
      },
      set: function (a) {
        this.Wr !== a && (A(a, "number", Pt, "rowIndent"), (this.Wr = a));
      },
    },
    commentSpacing: {
      configurable: !0,
      get: function () {
        return this.Vq;
      },
      set: function (a) {
        this.Vq !== a && (A(a, "number", Pt, "commentSpacing"), (this.Vq = a));
      },
    },
    commentMargin: {
      configurable: !0,
      enumerable: !0,
      get: function () {
        return this.Uq;
      },
      set: function (a) {
        this.Uq !== a && (A(a, "number", Pt, "commentMargin"), (this.Uq = a));
      },
    },
    setsPortSpot: {
      configurable: !0,
      get: function () {
        return this.cs;
      },
      set: function (a) {
        this.cs !== a && (A(a, "boolean", Pt, "setsPortSpot"), (this.cs = a));
      },
    },
    portSpot: {
      configurable: !0,
      get: function () {
        return this.Tr;
      },
      set: function (a) {
        x(a, Ib, Pt, "portSpot");
        this.Tr.D(a) || (this.Tr = a);
      },
    },
    setsChildPortSpot: {
      configurable: !0,
      get: function () {
        return this.bs;
      },
      set: function (a) {
        this.bs !== a &&
          (A(a, "boolean", Pt, "setsChildPortSpot"), (this.bs = a));
      },
    },
    childPortSpot: {
      configurable: !0,
      get: function () {
        return this.Sq;
      },
      set: function (a) {
        x(a, Ib, Pt, "childPortSpot");
        this.Sq.D(a) || (this.Sq = a);
      },
    },
    childrenCount: {
      configurable: !0,
      get: function () {
        return this.children.length;
      },
    },
    relativePosition: {
      configurable: !0,
      get: function () {
        return this.Y;
      },
      set: function (a) {
        this.Y.set(a);
      },
    },
    subtreeSize: {
      configurable: !0,
      get: function () {
        return this.Ea;
      },
      set: function (a) {
        this.Ea.set(a);
      },
    },
    subtreeOffset: {
      configurable: !0,
      get: function () {
        return this.ma;
      },
      set: function (a) {
        this.ma.set(a);
      },
    },
  });
  Pt.className = "TreeVertex";
  function Tu(a) {
    Bq.call(this, a);
    this.xu = new K(0, 0);
  }
  na(Tu, Bq);
  Tu.prototype.commit = function () {
    var a = this.link;
    if (null !== a && !a.isAvoiding) {
      var b = this.network.layout,
        c = null,
        d = null;
      switch (b.td) {
        case Kt:
          c = this.fromVertex;
          d = this.toVertex;
          break;
        case Rt:
          c = this.toVertex;
          d = this.fromVertex;
          break;
        default:
          v("Unhandled path value " + b.td.toString());
      }
      if (null !== c && null !== d)
        if (((b = this.xu), 0 !== b.x || 0 !== b.y || c.YA)) {
          d = c.bounds;
          var e = su(c),
            f = xu(c),
            g = c.rowSpacing;
          a.Ag();
          var h = a.curve === kg,
            k = a.isOrthogonal,
            l;
          a.Qh();
          if (k || h) {
            for (l = 2; 4 < a.pointsCount; ) a.Rv(2);
            var m = a.i(1);
            var n = a.i(2);
          } else {
            for (l = 1; 3 < a.pointsCount; ) a.Rv(1);
            m = a.i(0);
            n = a.i(a.pointsCount - 1);
          }
          var p = a.i(a.pointsCount - 1);
          0 === e
            ? (c.alignment === uu
                ? ((e = d.bottom + b.y),
                  0 === b.y &&
                    m.y > p.y + c.rowIndent &&
                    (e = Math.min(e, Math.max(m.y, e - yu(c)))))
                : c.alignment === tu
                ? ((e = d.top + b.y),
                  0 === b.y &&
                    m.y < p.y - c.rowIndent &&
                    (e = Math.max(e, Math.min(m.y, e + yu(c)))))
                : (e =
                    c.Em || (c.Fm && 1 === c.maxGenerationCount)
                      ? d.top - c.ma.y + b.y
                      : d.y + d.height / 2 + b.y),
              h
                ? (a.l(l, m.x, e),
                  l++,
                  a.l(l, d.right + f, e),
                  l++,
                  a.l(l, d.right + f + (b.x - g) / 3, e),
                  l++,
                  a.l(l, d.right + f + (2 * (b.x - g)) / 3, e),
                  l++,
                  a.l(l, d.right + f + (b.x - g), e),
                  l++,
                  a.l(l, n.x, e))
                : (k && (a.l(l, d.right + f / 2, m.y), l++),
                  a.l(l, d.right + f / 2, e),
                  l++,
                  a.l(l, d.right + f + b.x - (k ? g / 2 : g), e),
                  l++,
                  k && a.l(l, a.i(l - 1).x, n.y)))
            : 90 === e
            ? (c.alignment === uu
                ? ((e = d.right + b.x),
                  0 === b.x &&
                    m.x > p.x + c.rowIndent &&
                    (e = Math.min(e, Math.max(m.x, e - yu(c)))))
                : c.alignment === tu
                ? ((e = d.left + b.x),
                  0 === b.x &&
                    m.x < p.x - c.rowIndent &&
                    (e = Math.max(e, Math.min(m.x, e + yu(c)))))
                : (e =
                    c.Em || (c.Fm && 1 === c.maxGenerationCount)
                      ? d.left - c.ma.x + b.x
                      : d.x + d.width / 2 + b.x),
              h
                ? (a.l(l, e, m.y),
                  l++,
                  a.l(l, e, d.bottom + f),
                  l++,
                  a.l(l, e, d.bottom + f + (b.y - g) / 3),
                  l++,
                  a.l(l, e, d.bottom + f + (2 * (b.y - g)) / 3),
                  l++,
                  a.l(l, e, d.bottom + f + (b.y - g)),
                  l++,
                  a.l(l, e, n.y))
                : (k && (a.l(l, m.x, d.bottom + f / 2), l++),
                  a.l(l, e, d.bottom + f / 2),
                  l++,
                  a.l(l, e, d.bottom + f + b.y - (k ? g / 2 : g)),
                  l++,
                  k && a.l(l, n.x, a.i(l - 1).y)))
            : 180 === e
            ? (c.alignment === uu
                ? ((e = d.bottom + b.y),
                  0 === b.y &&
                    m.y > p.y + c.rowIndent &&
                    (e = Math.min(e, Math.max(m.y, e - yu(c)))))
                : c.alignment === tu
                ? ((e = d.top + b.y),
                  0 === b.y &&
                    m.y < p.y - c.rowIndent &&
                    (e = Math.max(e, Math.min(m.y, e + yu(c)))))
                : (e =
                    c.Em || (c.Fm && 1 === c.maxGenerationCount)
                      ? d.top - c.ma.y + b.y
                      : d.y + d.height / 2 + b.y),
              h
                ? (a.l(l, m.x, e),
                  l++,
                  a.l(l, d.left - f, e),
                  l++,
                  a.l(l, d.left - f + (b.x + g) / 3, e),
                  l++,
                  a.l(l, d.left - f + (2 * (b.x + g)) / 3, e),
                  l++,
                  a.l(l, d.left - f + (b.x + g), e),
                  l++,
                  a.l(l, n.x, e))
                : (k && (a.l(l, d.left - f / 2, m.y), l++),
                  a.l(l, d.left - f / 2, e),
                  l++,
                  a.l(l, d.left - f + b.x + (k ? g / 2 : g), e),
                  l++,
                  k && a.l(l, a.i(l - 1).x, n.y)))
            : 270 === e
            ? (c.alignment === uu
                ? ((e = d.right + b.x),
                  0 === b.x &&
                    m.x > p.x + c.rowIndent &&
                    (e = Math.min(e, Math.max(m.x, e - yu(c)))))
                : c.alignment === tu
                ? ((e = d.left + b.x),
                  0 === b.x &&
                    m.x < p.x - c.rowIndent &&
                    (e = Math.max(e, Math.min(m.x, e + yu(c)))))
                : (e =
                    c.Em || (c.Fm && 1 === c.maxGenerationCount)
                      ? d.left - c.ma.x + b.x
                      : d.x + d.width / 2 + b.x),
              h
                ? (a.l(l, e, m.y),
                  l++,
                  a.l(l, e, d.top - f),
                  l++,
                  a.l(l, e, d.top - f + (b.y + g) / 3),
                  l++,
                  a.l(l, e, d.top - f + (2 * (b.y + g)) / 3),
                  l++,
                  a.l(l, e, d.top - f + (b.y + g)),
                  l++,
                  a.l(l, e, n.y))
                : (k && (a.l(l, m.x, d.top - f / 2), l++),
                  a.l(l, e, d.top - f / 2),
                  l++,
                  a.l(l, e, d.top - f + b.y + (k ? g / 2 : g)),
                  l++,
                  k && a.l(l, n.x, a.i(l - 1).y)))
            : v("Invalid angle " + e);
          a.Df();
        } else
          (b = d),
            G && x(c, Pt, Tu, "adjustRouteForAngleChange:parent"),
            G && x(b, Pt, Tu, "adjustRouteForAngleChange:child"),
            (a = this.link),
            (f = su(c)),
            f !== su(b) &&
              ((g = xu(c)),
              (h = c.bounds),
              (c = b.bounds),
              (0 === f && c.left - h.right < g + 1) ||
                (90 === f && c.top - h.bottom < g + 1) ||
                (180 === f && h.left - c.right < g + 1) ||
                (270 === f && h.top - c.bottom < g + 1) ||
                (a.Ag(),
                (c = a.curve === kg),
                (b = a.isOrthogonal),
                (d = ju(this.fromVertex.alignment)),
                a.Qh(),
                0 === f
                  ? ((f = h.right + g / 2),
                    c
                      ? 4 === a.pointsCount &&
                        ((c = a.i(3).y),
                        a.P(1, f - 20, a.i(1).y),
                        a.l(2, f - 20, c),
                        a.l(3, f, c),
                        a.l(4, f + 20, c),
                        a.P(5, a.i(5).x, c))
                      : b
                      ? d
                        ? a.P(3, a.i(2).x, a.i(4).y)
                        : 6 === a.pointsCount &&
                          (a.P(2, f, a.i(2).y), a.P(3, f, a.i(3).y))
                      : 4 === a.pointsCount
                      ? a.l(2, f, a.i(2).y)
                      : 3 === a.pointsCount
                      ? a.P(1, f, a.i(2).y)
                      : 2 === a.pointsCount && a.l(1, f, a.i(1).y))
                  : 90 === f
                  ? ((f = h.bottom + g / 2),
                    c
                      ? 4 === a.pointsCount &&
                        ((c = a.i(3).x),
                        a.P(1, a.i(1).x, f - 20),
                        a.l(2, c, f - 20),
                        a.l(3, c, f),
                        a.l(4, c, f + 20),
                        a.P(5, c, a.i(5).y))
                      : b
                      ? d
                        ? a.P(3, a.i(2).x, a.i(4).y)
                        : 6 === a.pointsCount &&
                          (a.P(2, a.i(2).x, f), a.P(3, a.i(3).x, f))
                      : 4 === a.pointsCount
                      ? a.l(2, a.i(2).x, f)
                      : 3 === a.pointsCount
                      ? a.P(1, a.i(2).x, f)
                      : 2 === a.pointsCount && a.l(1, a.i(1).x, f))
                  : 180 === f
                  ? ((f = h.left - g / 2),
                    c
                      ? 4 === a.pointsCount &&
                        ((c = a.i(3).y),
                        a.P(1, f + 20, a.i(1).y),
                        a.l(2, f + 20, c),
                        a.l(3, f, c),
                        a.l(4, f - 20, c),
                        a.P(5, a.i(5).x, c))
                      : b
                      ? d
                        ? a.P(3, a.i(2).x, a.i(4).y)
                        : 6 === a.pointsCount &&
                          (a.P(2, f, a.i(2).y), a.P(3, f, a.i(3).y))
                      : 4 === a.pointsCount
                      ? a.l(2, f, a.i(2).y)
                      : 3 === a.pointsCount
                      ? a.P(1, f, a.i(2).y)
                      : 2 === a.pointsCount && a.l(1, f, a.i(1).y))
                  : 270 === f &&
                    ((f = h.top - g / 2),
                    c
                      ? 4 === a.pointsCount &&
                        ((c = a.i(3).x),
                        a.P(1, a.i(1).x, f + 20),
                        a.l(2, c, f + 20),
                        a.l(3, c, f),
                        a.l(4, c, f - 20),
                        a.P(5, c, a.i(5).y))
                      : b
                      ? d
                        ? a.P(3, a.i(2).x, a.i(4).y)
                        : 6 === a.pointsCount &&
                          (a.P(2, a.i(2).x, f), a.P(3, a.i(3).x, f))
                      : 4 === a.pointsCount
                      ? a.l(2, a.i(2).x, f)
                      : 3 === a.pointsCount
                      ? a.P(1, a.i(2).x, f)
                      : 2 === a.pointsCount && a.l(1, a.i(1).x, f)),
                a.Df()));
    }
  };
  oa.Object.defineProperties(Tu.prototype, {
    fromVertex: {
      configurable: !0,
      get: function () {
        return this.cd;
      },
      set: function (a) {
        this.cd !== a &&
          (G && null !== a && x(a, Pt, Tu, "fromVertex"), (this.cd = a));
      },
    },
    toVertex: {
      configurable: !0,
      get: function () {
        return this.ld;
      },
      set: function (a) {
        this.ld !== a &&
          (G && null !== a && x(a, Pt, Tu, "toVertex"), (this.ld = a));
      },
    },
    relativePoint: {
      configurable: !0,
      get: function () {
        return this.xu;
      },
      set: function (a) {
        this.xu.set(a);
      },
    },
  });
  Tu.className = "TreeEdge";
  Ua.prototype.initializeStandardTools = function () {
    this.jb("Action", new yg(), this.mouseDownTools);
    this.jb("Relinking", new $e(), this.mouseDownTools);
    this.jb("LinkReshaping", new ig(), this.mouseDownTools);
    this.jb("Rotating", new wg(), this.mouseDownTools);
    this.jb("Resizing", new pg(), this.mouseDownTools);
    this.jb("Linking", new bg(), this.mouseMoveTools);
    this.jb("Dragging", new Qe(), this.mouseMoveTools);
    this.jb("DragSelecting", new Jg(), this.mouseMoveTools);
    this.jb("Panning", new Kg(), this.mouseMoveTools);
    this.jb("ContextMenu", new Mg(), this.mouseUpTools);
    this.jb("TextEditing", new Xg(), this.mouseUpTools);
    this.jb("ClickCreating", new zg(), this.mouseUpTools);
    this.jb("ClickSelecting", new xg(), this.mouseUpTools);
  };
  In("Horizontal", new Jm());
  In("Spot", new Lm());
  In("Table", new Qm());
  In("Viewbox", new Vm());
  In("TableRow", new Tm());
  In("TableColumn", new Um());
  In("Graduated", new en());
  In("Grid", new Wm());
  ui.add("GraphLinksModel", $q);
  ui.add("TreeModel", nr);
  sq(vs, null);
  sq(Ls, null);
  var Uu = sa.go,
    Vu = {
      get licenseKey() {
        return Q.licenseKey;
      },
      set licenseKey(a) {
        Q.licenseKey = a;
      },
      get version() {
        return Q.version;
      },
      Group: vf,
      EnumValue: F,
      List: H,
      Set: I,
      Map: xb,
      Point: K,
      Size: Gb,
      Rect: M,
      Margin: ic,
      Spot: Ib,
      Geometry: N,
      PathFigure: ie,
      PathSegment: je,
      InputEvent: le,
      DiagramEvent: ne,
      ChangedEvent: oe,
      Model: X,
      GraphLinksModel: Jr,
      TreeModel: Or,
      Binding: Fi,
      Transaction: te,
      UndoManager: ue,
      CommandHandler: dl,
      Tool: we,
      DraggingTool: Qe,
      DraggingInfo: af,
      DraggingOptions: Re,
      LinkingBaseTool: Gf,
      LinkingTool: bg,
      RelinkingTool: $e,
      LinkReshapingTool: ig,
      ResizingTool: pg,
      RotatingTool: wg,
      ClickSelectingTool: xg,
      ActionTool: yg,
      ClickCreatingTool: zg,
      HTMLInfo: Oe,
      ContextMenuTool: Mg,
      DragSelectingTool: Jg,
      PanningTool: Kg,
      TextEditingTool: Xg,
      ToolManager: Ua,
      Animation: sh,
      AnimationManager: oh,
      AnimationTrigger: hi,
      Layer: mi,
      Diagram: Q,
      Palette: Xk,
      Overview: $k,
      Brush: Al,
      GraphObject: O,
      Panel: W,
      RowColumnDefinition: bk,
      Shape: Hf,
      TextBlock: Yg,
      Picture: jk,
      Part: U,
      Adornment: Je,
      Node: V,
      Link: R,
      Placeholder: rg,
      Layout: zi,
      LayoutNetwork: mq,
      LayoutVertex: Aq,
      LayoutEdge: Bq,
      GridLayout: Zk,
      PanelLayout: Yl,
      CircularLayout: Pr,
      CircularNetwork: fs,
      CircularVertex: ts,
      CircularEdge: us,
      ForceDirectedLayout: vs,
      ForceDirectedNetwork: ws,
      ForceDirectedVertex: Gs,
      ForceDirectedEdge: Ks,
      LayeredDigraphLayout: Ls,
      LayeredDigraphNetwork: Qs,
      LayeredDigraphVertex: Ht,
      LayeredDigraphEdge: It,
      TreeLayout: Z,
      TreeNetwork: Ot,
      TreeVertex: Pt,
      TreeEdge: Tu,
    };
  "object" === typeof Uu &&
    Uu.version &&
    v(
      "WARNING: a `go` object on the root object is already defined.  " +
        ("Debug" in Uu ? "debug " : "") +
        "version: " +
        Uu.version +
        ", replaced with version: " +
        Vu.version
    );
  Q.prototype.go = Vu;
  sa.go = Vu;
  Vu.Debug = G;
  G.qz(Vu);
  "undefined" !== typeof module &&
    "object" === typeof module.exports &&
    (module.exports = "undefined" !== typeof global ? global.go : self.go);
})();

"function" === typeof define &&
  define.amd &&
  define("undefined" !== typeof global ? global.go : self.go);
